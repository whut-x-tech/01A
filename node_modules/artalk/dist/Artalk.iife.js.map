{"version":3,"file":"Artalk.iife.js","sources":["../src/api/v2.ts","../src/api/fetch.ts","../src/api/index.ts","../../../node_modules/.pnpm/marked@14.1.2/node_modules/marked/lib/marked.esm.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/she.js","../../../node_modules/.pnpm/assignment@2.0.0/node_modules/assignment/assignment.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/lowercase.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/toMap.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/attributes.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/elements.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/parser.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/sanitizer.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/insane.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/defaults.js","../src/lib/sanitizer.ts","../../../node_modules/.pnpm/hanabi@0.4.0/node_modules/hanabi/dist/hanabi.js","../src/lib/highlight.ts","../src/lib/marked-renderer.ts","../src/lib/marked.ts","../src/lib/merge-deep.ts","../src/data.ts","../src/lib/utils.ts","../src/i18n/en.ts","../src/i18n/external.ts","../src/i18n/index.ts","../src/i18n/zh-CN.ts","../src/lib/event-manager.ts","../src/defaults.ts","../src/config.ts","../src/lib/watch-conf.ts","../src/context.ts","../src/api/handler.ts","../src/lib/ui.ts","../src/components/checker/captcha-renders.ts","../src/components/checker/captcha.ts","../src/components/checker/admin.ts","../src/components/dialog.ts","../src/components/checker/index.ts","../src/lib/component.ts","../src/editor/editor.html?raw","../src/editor/ui.ts","../src/plugins/editor/_plug.ts","../src/plugins/editor/mover.ts","../src/editor/state.ts","../src/editor/editor.ts","../src/layer/sidebar-layer.ts","../src/layer/sidebar-layer.html?raw","../src/list/layout/nest.ts","../src/list/nest.ts","../src/list/layout/flat.ts","../src/list/layout/index.ts","../src/comment/height-limit.ts","../src/comment/renders/header.ts","../src/components/action-btn.ts","../src/comment/renders/actions.ts","../src/comment/renders/index.ts","../src/comment/renders/avatar.ts","../src/comment/renders/content.ts","../src/comment/renders/reply-at.ts","../src/comment/renders/reply-to.ts","../src/comment/renders/pending.ts","../src/comment/render.ts","../src/comment/comment.html?raw","../src/comment/actions.ts","../src/comment/comment-node.ts","../src/lib/detect.ts","../src/components/read-more-btn.ts","../src/list/paginator/read-more.ts","../src/components/pagination.ts","../src/list/paginator/up-down.ts","../src/list/page.ts","../src/list/list.ts","../src/list/list.html?raw","../src/list/comment.ts","../src/layer/scrollbar-helper.ts","../src/layer/layer.ts","../src/layer/wrap.ts","../src/layer/layer-manager.ts","../src/lib/user.ts","../src/service.ts","../src/plugins/stat.ts","../src/plugins/markdown.ts","../src/plugins/editor/local-storage.ts","../src/plugins/editor/submit-add.ts","../src/plugins/editor/submit.ts","../src/plugins/editor/emoticons.ts","../src/plugins/editor/upload.ts","../src/plugins/editor/preview.ts","../src/plugins/editor/index.ts","../src/plugins/editor/header-event.ts","../src/plugins/editor/header-user.ts","../src/plugins/editor/header-link.ts","../src/plugins/editor/textarea.ts","../src/plugins/editor/submit-btn.ts","../src/plugins/editor/state-reply.ts","../src/plugins/editor/state-edit.ts","../src/plugins/editor/closable.ts","../src/plugins/editor/_kit.ts","../src/plugins/editor-kit.ts","../src/plugins/list/goto-focus.ts","../src/components/error-dialog.ts","../src/plugins/version-check.ts","../src/plugins/dark-mode.ts","../src/plugins/index.ts","../src/plugins/admin-only-elem.ts","../src/plugins/list/index.ts","../src/plugins/list/fetch.ts","../src/plugins/list/loading.ts","../src/plugins/list/unread.ts","../src/plugins/list/with-editor.ts","../src/plugins/list/count.ts","../src/plugins/list/sidebar-btn.ts","../src/plugins/list/unread-badge.ts","../src/plugins/list/dropdown.ts","../src/plugins/list/goto-dispatcher.ts","../src/plugins/list/no-comment.ts","../src/plugins/list/copyright.ts","../src/plugins/list/time-ticking.ts","../src/plugins/list/error-dialog.ts","../src/plugins/list/reach-bottom.ts","../src/plugins/list/goto-first.ts","../src/plugins/notifies.ts","../src/load.ts","../src/artalk.ts","../src/main.ts"],"sourcesContent":["/* eslint-disable */\n/* tslint:disable */\n/*\n * ---------------------------------------------------------------\n * ## THIS FILE WAS GENERATED VIA SWAGGER-TYPESCRIPT-API        ##\n * ##                                                           ##\n * ## AUTHOR: acacode                                           ##\n * ## SOURCE: https://github.com/acacode/swagger-typescript-api ##\n * ---------------------------------------------------------------\n */\n\nexport interface AuthAuthProviderInfo {\n  icon: string\n  label: string\n  name: string\n  path?: string\n}\n\nexport interface CommonApiVersionData {\n  app: string\n  commit_hash: string\n  version: string\n}\n\nexport interface CommonConfData {\n  frontend_conf: CommonMap\n  version: CommonApiVersionData\n}\n\nexport interface CommonJSONResult {\n  /** Data */\n  data: any\n  /** Message */\n  msg: string\n}\n\nexport type CommonMap = Record<string, any>\n\nexport interface EntityCookedComment {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  is_verified: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface EntityCookedNotify {\n  comment_id: number\n  id: number\n  is_emailed: boolean\n  is_read: boolean\n  read_link: string\n  user_id: number\n}\n\nexport interface EntityCookedPage {\n  admin_only: boolean\n  date: string\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface EntityCookedSite {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface EntityCookedUser {\n  badge_color: string\n  badge_name: string\n  email: string\n  id: number\n  is_admin: boolean\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface EntityCookedUserForAdmin {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport type HandlerMap = Record<string, any>\n\nexport interface HandlerParamsCaptchaVerify {\n  /** The captcha value to check */\n  value: string\n}\n\nexport interface HandlerParamsCommentCreate {\n  /** The comment content */\n  content: string\n  /** The comment email */\n  email: string\n  /** The comment link */\n  link?: string\n  /** The comment name */\n  name: string\n  /** The comment page_key */\n  page_key: string\n  /** The comment page_title */\n  page_title?: string\n  /** The comment rid */\n  rid?: number\n  /** The site name of your content scope */\n  site_name: string\n  /** The comment ua */\n  ua?: string\n}\n\nexport interface HandlerParamsCommentUpdate {\n  /** The comment content */\n  content: string\n  /** The comment email */\n  email?: string\n  /** The comment ip */\n  ip?: string\n  /** The comment is_collapsed */\n  is_collapsed: boolean\n  /** The comment is_pending */\n  is_pending: boolean\n  /** The comment is_pinned */\n  is_pinned: boolean\n  /** The comment link */\n  link?: string\n  /** The comment nick */\n  nick?: string\n  /** The comment page_key */\n  page_key: string\n  /** The comment rid */\n  rid: number\n  /** The site name of your content scope */\n  site_name: string\n  /** The comment ua */\n  ua?: string\n}\n\nexport interface HandlerParamsEmailSend {\n  /** The body of email */\n  body: string\n  /** The subject of email */\n  subject: string\n  /** The email address of the receiver */\n  to_addr: string\n}\n\nexport interface HandlerParamsNotifyReadAll {\n  /** The user email */\n  email: string\n  /** The username */\n  name: string\n}\n\nexport interface HandlerParamsPageFetchAll {\n  /** If not empty, only fetch pages of this site */\n  site_name?: string\n}\n\nexport interface HandlerParamsPagePV {\n  /** The page key */\n  page_key: string\n  /** The page title */\n  page_title?: string\n  /** The site name of your content scope */\n  site_name?: string\n}\n\nexport interface HandlerParamsPageUpdate {\n  /** Updated page admin_only option */\n  admin_only: boolean\n  /** Updated page key */\n  key: string\n  /** The site name of your content scope */\n  site_name: string\n  /** Updated page title */\n  title: string\n}\n\nexport interface HandlerParamsSettingApply {\n  /** The content of the config file in YAML format */\n  yaml: string\n}\n\nexport interface HandlerParamsSiteCreate {\n  /** The site name */\n  name: string\n  /** The site urls */\n  urls: string[]\n}\n\nexport interface HandlerParamsSiteUpdate {\n  /** Updated site name */\n  name: string\n  /** Updated site urls */\n  urls: string[]\n}\n\nexport interface HandlerParamsTransferImport {\n  /** Automatically answer yes for all questions */\n  assumeyes?: boolean\n  /** The JSON data */\n  json_data?: string\n  /** The JSON file path */\n  json_file?: string\n  /** The target site name */\n  target_site_name?: string\n  /** The target site url */\n  target_site_url?: string\n  /** Keep domain */\n  url_keep_domain?: boolean\n  /** Enable URL resolver */\n  url_resolver?: boolean\n}\n\nexport interface HandlerParamsUserCreate {\n  /** The user badge color (hex format) */\n  badge_color?: string\n  /** The user badge name */\n  badge_name?: string\n  /** The user email */\n  email: string\n  /** The user is an admin */\n  is_admin: boolean\n  /** The user link */\n  link?: string\n  /** The user name */\n  name: string\n  /** The user password */\n  password?: string\n  /** The user receive email */\n  receive_email: boolean\n}\n\nexport interface HandlerParamsUserLogin {\n  /** The user email */\n  email: string\n  /** The username */\n  name?: string\n  /** The user password */\n  password: string\n}\n\nexport interface HandlerParamsUserUpdate {\n  /** The user badge color (hex format) */\n  badge_color?: string\n  /** The user badge name */\n  badge_name?: string\n  /** The user email */\n  email: string\n  /** The user is an admin */\n  is_admin: boolean\n  /** The user link */\n  link?: string\n  /** The user name */\n  name: string\n  /** The user password */\n  password?: string\n  /** The user receive email */\n  receive_email: boolean\n}\n\nexport interface HandlerParamsVote {\n  /** The user email */\n  email?: string\n  /** The username */\n  name?: string\n}\n\nexport interface HandlerRequestAuthDataMergeApply {\n  user_name: string\n}\n\nexport interface HandlerRequestAuthEmailLogin {\n  code?: string\n  email: string\n  password?: string\n}\n\nexport interface HandlerRequestAuthEmailRegister {\n  code: string\n  email: string\n  link?: string\n  name?: string\n  password: string\n}\n\nexport interface HandlerRequestAuthEmailSend {\n  email: string\n}\n\nexport interface HandlerRequestUserInfoUpdate {\n  code?: string\n  email: string\n  link?: string\n  name: string\n}\n\nexport interface HandlerResponseAdminUserList {\n  count: number\n  users: EntityCookedUserForAdmin[]\n}\n\nexport interface HandlerResponseAuthDataMergeApply {\n  deleted_user_count: number\n  update_comments_count: number\n  update_notifies_count: number\n  update_votes_count: number\n  /** Empty if login user is target user no need to re-login */\n  user_token: string\n}\n\nexport interface HandlerResponseAuthDataMergeCheck {\n  need_merge: boolean\n  user_names: string[]\n}\n\nexport interface HandlerResponseCaptchaGet {\n  img_data: string\n}\n\nexport interface HandlerResponseCaptchaStatus {\n  is_pass: boolean\n}\n\nexport interface HandlerResponseCommentCreate {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  is_verified: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseCommentGet {\n  /** The comment detail */\n  comment: EntityCookedComment\n  /** The reply comment if exists (like reply) */\n  reply_comment: EntityCookedComment\n}\n\nexport interface HandlerResponseCommentList {\n  comments: EntityCookedComment[]\n  count: number\n  page: EntityCookedPage\n  roots_count: number\n}\n\nexport interface HandlerResponseCommentUpdate {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  is_verified: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseConfAuthProviders {\n  anonymous: boolean\n  providers: AuthAuthProviderInfo[]\n}\n\nexport interface HandlerResponseConfDomain {\n  /** Is the domain trusted */\n  is_trusted: boolean\n  /** The origin of the domain */\n  origin: string\n}\n\nexport interface HandlerResponseNotifyList {\n  count: number\n  notifies: EntityCookedNotify[]\n}\n\nexport interface HandlerResponsePageFetch {\n  admin_only: boolean\n  date: string\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponsePageFetchStatus {\n  /** The number of pages that have been fetched */\n  done: number\n  /** If the task is in progress */\n  is_progress: boolean\n  /** The message of the task status */\n  msg: string\n  /** The total number of pages */\n  total: number\n}\n\nexport interface HandlerResponsePageList {\n  count: number\n  pages: EntityCookedPage[]\n}\n\nexport interface HandlerResponsePagePV {\n  pv: number\n}\n\nexport interface HandlerResponsePageUpdate {\n  admin_only: boolean\n  date: string\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseSettingGet {\n  envs: string[]\n  yaml: string\n}\n\nexport interface HandlerResponseSettingTemplate {\n  yaml: string\n}\n\nexport interface HandlerResponseSiteCreate {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface HandlerResponseSiteList {\n  count: number\n  sites: EntityCookedSite[]\n}\n\nexport interface HandlerResponseSiteUpdate {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface HandlerResponseTransferExport {\n  /** The exported data which is a JSON string */\n  artrans: string\n}\n\nexport interface HandlerResponseTransferUpload {\n  /** The uploaded file name which can be used to import */\n  filename: string\n}\n\nexport interface HandlerResponseUpload {\n  file_name: string\n  file_type: string\n  public_url: string\n}\n\nexport interface HandlerResponseUserCreate {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface HandlerResponseUserInfo {\n  is_login: boolean\n  notifies: EntityCookedNotify[]\n  notifies_count: number\n  user: EntityCookedUser\n}\n\nexport interface HandlerResponseUserInfoUpdate {\n  user: EntityCookedUser\n}\n\nexport interface HandlerResponseUserLogin {\n  token: string\n  user: EntityCookedUser\n}\n\nexport interface HandlerResponseUserStatus {\n  is_admin: boolean\n  is_login: boolean\n}\n\nexport interface HandlerResponseUserUpdate {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface HandlerResponseVote {\n  down: number\n  up: number\n}\n\nexport type QueryParamsType = Record<string | number, any>\nexport type ResponseFormat = keyof Omit<Body, 'body' | 'bodyUsed'>\n\nexport interface FullRequestParams extends Omit<RequestInit, 'body'> {\n  /** set parameter to `true` for call `securityWorker` for this request */\n  secure?: boolean\n  /** request path */\n  path: string\n  /** content type of request body */\n  type?: ContentType\n  /** query params */\n  query?: QueryParamsType\n  /** format of response (i.e. response.json() -> format: \"json\") */\n  format?: ResponseFormat\n  /** request body */\n  body?: unknown\n  /** base url */\n  baseUrl?: string\n  /** request cancellation token */\n  cancelToken?: CancelToken\n}\n\nexport type RequestParams = Omit<FullRequestParams, 'body' | 'method' | 'query' | 'path'>\n\nexport interface ApiConfig<SecurityDataType = unknown> {\n  baseUrl?: string\n  baseApiParams?: Omit<RequestParams, 'baseUrl' | 'cancelToken' | 'signal'>\n  securityWorker?: (\n    securityData: SecurityDataType | null,\n  ) => Promise<RequestParams | void> | RequestParams | void\n  customFetch?: typeof fetch\n}\n\nexport interface HttpResponse<D extends unknown, E extends unknown = unknown> extends Response {\n  data: D\n  error: E\n}\n\ntype CancelToken = Symbol | string | number\n\nexport enum ContentType {\n  Json = 'application/json',\n  FormData = 'multipart/form-data',\n  UrlEncoded = 'application/x-www-form-urlencoded',\n  Text = 'text/plain',\n}\n\nexport class HttpClient<SecurityDataType = unknown> {\n  public baseUrl: string = '/api/v2'\n  private securityData: SecurityDataType | null = null\n  private securityWorker?: ApiConfig<SecurityDataType>['securityWorker']\n  private abortControllers = new Map<CancelToken, AbortController>()\n  private customFetch = (...fetchParams: Parameters<typeof fetch>) => fetch(...fetchParams)\n\n  private baseApiParams: RequestParams = {\n    credentials: 'same-origin',\n    headers: {},\n    redirect: 'follow',\n    referrerPolicy: 'no-referrer',\n  }\n\n  constructor(apiConfig: ApiConfig<SecurityDataType> = {}) {\n    Object.assign(this, apiConfig)\n  }\n\n  public setSecurityData = (data: SecurityDataType | null) => {\n    this.securityData = data\n  }\n\n  protected encodeQueryParam(key: string, value: any) {\n    const encodedKey = encodeURIComponent(key)\n    return `${encodedKey}=${encodeURIComponent(typeof value === 'number' ? value : `${value}`)}`\n  }\n\n  protected addQueryParam(query: QueryParamsType, key: string) {\n    return this.encodeQueryParam(key, query[key])\n  }\n\n  protected addArrayQueryParam(query: QueryParamsType, key: string) {\n    const value = query[key]\n    return value.map((v: any) => this.encodeQueryParam(key, v)).join('&')\n  }\n\n  protected toQueryString(rawQuery?: QueryParamsType): string {\n    const query = rawQuery || {}\n    const keys = Object.keys(query).filter((key) => 'undefined' !== typeof query[key])\n    return keys\n      .map((key) =>\n        Array.isArray(query[key])\n          ? this.addArrayQueryParam(query, key)\n          : this.addQueryParam(query, key),\n      )\n      .join('&')\n  }\n\n  protected addQueryParams(rawQuery?: QueryParamsType): string {\n    const queryString = this.toQueryString(rawQuery)\n    return queryString ? `?${queryString}` : ''\n  }\n\n  private contentFormatters: Record<ContentType, (input: any) => any> = {\n    [ContentType.Json]: (input: any) =>\n      input !== null && (typeof input === 'object' || typeof input === 'string')\n        ? JSON.stringify(input)\n        : input,\n    [ContentType.Text]: (input: any) =>\n      input !== null && typeof input !== 'string' ? JSON.stringify(input) : input,\n    [ContentType.FormData]: (input: any) =>\n      Object.keys(input || {}).reduce((formData, key) => {\n        const property = input[key]\n        formData.append(\n          key,\n          property instanceof Blob\n            ? property\n            : typeof property === 'object' && property !== null\n              ? JSON.stringify(property)\n              : `${property}`,\n        )\n        return formData\n      }, new FormData()),\n    [ContentType.UrlEncoded]: (input: any) => this.toQueryString(input),\n  }\n\n  protected mergeRequestParams(params1: RequestParams, params2?: RequestParams): RequestParams {\n    return {\n      ...this.baseApiParams,\n      ...params1,\n      ...(params2 || {}),\n      headers: {\n        ...(this.baseApiParams.headers || {}),\n        ...(params1.headers || {}),\n        ...((params2 && params2.headers) || {}),\n      },\n    }\n  }\n\n  protected createAbortSignal = (cancelToken: CancelToken): AbortSignal | undefined => {\n    if (this.abortControllers.has(cancelToken)) {\n      const abortController = this.abortControllers.get(cancelToken)\n      if (abortController) {\n        return abortController.signal\n      }\n      return void 0\n    }\n\n    const abortController = new AbortController()\n    this.abortControllers.set(cancelToken, abortController)\n    return abortController.signal\n  }\n\n  public abortRequest = (cancelToken: CancelToken) => {\n    const abortController = this.abortControllers.get(cancelToken)\n\n    if (abortController) {\n      abortController.abort()\n      this.abortControllers.delete(cancelToken)\n    }\n  }\n\n  public request = async <T = any, E = any>({\n    body,\n    secure,\n    path,\n    type,\n    query,\n    format,\n    baseUrl,\n    cancelToken,\n    ...params\n  }: FullRequestParams): Promise<HttpResponse<T, E>> => {\n    const secureParams =\n      ((typeof secure === 'boolean' ? secure : this.baseApiParams.secure) &&\n        this.securityWorker &&\n        (await this.securityWorker(this.securityData))) ||\n      {}\n    const requestParams = this.mergeRequestParams(params, secureParams)\n    const queryString = query && this.toQueryString(query)\n    const payloadFormatter = this.contentFormatters[type || ContentType.Json]\n    const responseFormat = format || requestParams.format\n\n    return this.customFetch(\n      `${baseUrl || this.baseUrl || ''}${path}${queryString ? `?${queryString}` : ''}`,\n      {\n        ...requestParams,\n        headers: {\n          ...(requestParams.headers || {}),\n          ...(type && type !== ContentType.FormData ? { 'Content-Type': type } : {}),\n        },\n        signal: (cancelToken ? this.createAbortSignal(cancelToken) : requestParams.signal) || null,\n        body: typeof body === 'undefined' || body === null ? null : payloadFormatter(body),\n      },\n    ).then(async (response) => {\n      const r = response.clone() as HttpResponse<T, E>\n      r.data = null as unknown as T\n      r.error = null as unknown as E\n\n      const data = !responseFormat\n        ? r\n        : await response[responseFormat]()\n            .then((data) => {\n              if (r.ok) {\n                r.data = data\n              } else {\n                r.error = data\n              }\n              return r\n            })\n            .catch((e) => {\n              r.error = e\n              return r\n            })\n\n      if (cancelToken) {\n        this.abortControllers.delete(cancelToken)\n      }\n\n      if (!response.ok) throw data\n      return data\n    })\n  }\n}\n\n/**\n * @title Artalk API\n * @version 2.0\n * @license MIT (https://github.com/ArtalkJS/Artalk/blob/master/LICENSE)\n * @baseUrl /api/v2\n * @contact API Support <artalkjs@gmail.com> (https://artalk.js.org)\n *\n * Artalk is a modern comment system based on Golang.\n */\nexport class Api<SecurityDataType extends unknown> extends HttpClient<SecurityDataType> {\n  auth = {\n    /**\n * @description Login by email with verify code (Need send email verify code first) or password\n *\n * @tags Auth\n * @name LoginByEmail\n * @summary Login by email\n * @request POST:/auth/email/login\n * @response `200` `HandlerResponseUserLogin` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    loginByEmail: (data: HandlerRequestAuthEmailLogin, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserLogin,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/email/login`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Register by email and verify code (if user exists, will update user, like forget or change password. Need send email verify code first)\n *\n * @tags Auth\n * @name RegisterByEmail\n * @summary Register by email\n * @request POST:/auth/email/register\n * @response `200` `HandlerResponseUserLogin` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    registerByEmail: (data: HandlerRequestAuthEmailRegister, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserLogin,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/email/register`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Send email including verify code to user\n *\n * @tags Auth\n * @name SendVerifyEmail\n * @summary Send verify email\n * @request POST:/auth/email/send\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    sendVerifyEmail: (data: HandlerRequestAuthEmailSend, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/email/send`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get all users with same email, if there are more than one user with same email, need merge\n *\n * @tags Auth\n * @name CheckDataMerge\n * @summary Check data merge\n * @request GET:/auth/merge\n * @secure\n * @response `200` `HandlerResponseAuthDataMergeCheck` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    checkDataMerge: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseAuthDataMergeCheck,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/merge`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description This function is to solve the problem of multiple users with the same email address, should be called after user login and then check, and perform data merge.\n *\n * @tags Auth\n * @name ApplyDataMerge\n * @summary Apply data merge\n * @request POST:/auth/merge\n * @secure\n * @response `200` `HandlerResponseAuthDataMergeApply` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    applyDataMerge: (data: HandlerRequestAuthDataMergeApply, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseAuthDataMergeApply,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/auth/merge`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  cache = {\n    /**\n * @description Flush all cache on the server\n *\n * @tags Cache\n * @name FlushCache\n * @summary Flush Cache\n * @request POST:/cache/flush\n * @secure\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    flushCache: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/cache/flush`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Cache warming helps you to pre-load the cache to improve the performance of the first request\n *\n * @tags Cache\n * @name WarmUpCache\n * @summary Warm-Up Cache\n * @request POST:/cache/warm_up\n * @secure\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    warmUpCache: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/cache/warm_up`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  captcha = {\n    /**\n * @description Get a base64 encoded captcha image or a HTML page to verify for user\n *\n * @tags Captcha\n * @name GetCaptcha\n * @summary Get Captcha\n * @request GET:/captcha\n * @response `200` `HandlerResponseCaptchaGet` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getCaptcha: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCaptchaGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/captcha`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get the status of the user's captcha verification\n     *\n     * @tags Captcha\n     * @name GetCaptchaStatus\n     * @summary Get Captcha Status\n     * @request GET:/captcha/status\n     * @response `200` `HandlerResponseCaptchaStatus` OK\n     */\n    getCaptchaStatus: (params: RequestParams = {}) =>\n      this.request<HandlerResponseCaptchaStatus, any>({\n        path: `/captcha/status`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Verify user enters correct captcha code\n *\n * @tags Captcha\n * @name VerifyCaptcha\n * @summary Verify Captcha\n * @request POST:/captcha/verify\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    img_data?: string,\n\n})` Forbidden\n */\n    verifyCaptcha: (data: HandlerParamsCaptchaVerify, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          img_data?: string\n        }\n      >({\n        path: `/captcha/verify`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  comments = {\n    /**\n * @description Get a list of comments by some conditions\n *\n * @tags Comment\n * @name GetComments\n * @summary Get Comment List\n * @request GET:/comments\n * @secure\n * @response `200` `HandlerResponseCommentList` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getComments: (\n      query: {\n        /** The user email */\n        email?: string\n        /** Enable flat_mode */\n        flat_mode?: boolean\n        /** The limit for pagination */\n        limit?: number\n        /** The username */\n        name?: string\n        /** The offset for pagination */\n        offset?: number\n        /** The comment page_key */\n        page_key: string\n        /** The scope of comments */\n        scope?: 'page' | 'user' | 'site'\n        /** Search keywords */\n        search?: string\n        /** The site name of your content scope */\n        site_name?: string\n        /** Sort by condition */\n        sort_by?: 'date_asc' | 'date_desc' | 'vote'\n        /** Message center show type */\n        type?: 'all' | 'mentions' | 'mine' | 'pending'\n        /** Only show comments by admin */\n        view_only_admin?: boolean\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseCommentList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Create a new comment\n *\n * @tags Comment\n * @name CreateComment\n * @summary Create Comment\n * @request POST:/comments\n * @secure\n * @response `200` `HandlerResponseCommentCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createComment: (comment: HandlerParamsCommentCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments`,\n        method: 'POST',\n        body: comment,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get the detail of a comment by comment id\n *\n * @tags Comment\n * @name GetComment\n * @summary Get a comment\n * @request GET:/comments/{id}\n * @response `200` `HandlerResponseCommentGet` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getComment: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'GET',\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific comment\n *\n * @tags Comment\n * @name UpdateComment\n * @summary Update Comment\n * @request PUT:/comments/{id}\n * @secure\n * @response `200` `HandlerResponseCommentUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updateComment: (id: number, comment: HandlerParamsCommentUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'PUT',\n        body: comment,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific comment\n *\n * @tags Comment\n * @name DeleteComment\n * @summary Delete Comment\n * @request DELETE:/comments/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteComment: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  conf = {\n    /**\n     * @description Get System Configs for UI\n     *\n     * @tags System\n     * @name Conf\n     * @summary Get System Configs\n     * @request GET:/conf\n     * @response `200` `CommonConfData` OK\n     */\n    conf: (params: RequestParams = {}) =>\n      this.request<CommonConfData, any>({\n        path: `/conf`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get social login providers\n *\n * @tags System\n * @name GetSocialLoginProviders\n * @summary Get Social Login Providers\n * @request GET:/conf/auth/providers\n * @response `200` `HandlerResponseConfAuthProviders` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n */\n    getSocialLoginProviders: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseConfAuthProviders,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/conf/auth/providers`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get Domain Info\n     *\n     * @tags System\n     * @name GetDomain\n     * @summary Get Domain Info\n     * @request GET:/conf/domain\n     * @response `200` `HandlerResponseConfDomain` OK\n     */\n    getDomain: (\n      query?: {\n        /** Domain URL */\n        url?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<HandlerResponseConfDomain, any>({\n        path: `/conf/domain`,\n        method: 'GET',\n        query: query,\n        format: 'json',\n        ...params,\n      }),\n  }\n  notifies = {\n    /**\n * @description Get a list of notifies for user\n *\n * @tags Notify\n * @name GetNotifies\n * @summary Get Notifies\n * @request GET:/notifies\n * @response `200` `HandlerResponseNotifyList` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getNotifies: (\n      query: {\n        /** The user email */\n        email: string\n        /** The user name */\n        name: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseNotifyList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies`,\n        method: 'GET',\n        query: query,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Mark all notifies as read for user\n *\n * @tags Notify\n * @name MarkAllNotifyRead\n * @summary Mark All Notifies as Read\n * @request POST:/notifies/read\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    markAllNotifyRead: (options: HandlerParamsNotifyReadAll, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies/read`,\n        method: 'POST',\n        body: options,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Mark specific notification as read for user\n *\n * @tags Notify\n * @name MarkNotifyRead\n * @summary Mark Notify as Read\n * @request POST:/notifies/{comment_id}/{notify_key}\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    markNotifyRead: (commentId: number, notifyKey: string, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies/${commentId}/${notifyKey}`,\n        method: 'POST',\n        format: 'json',\n        ...params,\n      }),\n  }\n  pages = {\n    /**\n * @description Get a list of pages by some conditions\n *\n * @tags Page\n * @name GetPages\n * @summary Get Page List\n * @request GET:/pages\n * @secure\n * @response `200` `HandlerResponsePageList` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    getPages: (\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** The offset for pagination */\n        offset?: number\n        /** Search keywords */\n        search?: string\n        /** The site name of your content scope */\n        site_name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponsePageList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Fetch the data of all pages\n *\n * @tags Page\n * @name FetchAllPages\n * @summary Fetch All Pages Data\n * @request POST:/pages/fetch\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    fetchAllPages: (options: HandlerParamsPageFetchAll, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/fetch`,\n        method: 'POST',\n        body: options,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get the status of the task of fetching all pages\n     *\n     * @tags Page\n     * @name GetPageFetchStatus\n     * @summary Get Pages Fetch Status\n     * @request GET:/pages/fetch/status\n     * @secure\n     * @response `200` `HandlerResponsePageFetchStatus` OK\n     */\n    getPageFetchStatus: (params: RequestParams = {}) =>\n      this.request<HandlerResponsePageFetchStatus, any>({\n        path: `/pages/fetch/status`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Increase and get the number of page views\n     *\n     * @tags Page\n     * @name LogPv\n     * @summary Increase Page Views (PV)\n     * @request POST:/pages/pv\n     * @response `200` `HandlerResponsePagePV` OK\n     */\n    logPv: (page: HandlerParamsPagePV, params: RequestParams = {}) =>\n      this.request<HandlerResponsePagePV, any>({\n        path: `/pages/pv`,\n        method: 'POST',\n        body: page,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific page\n *\n * @tags Page\n * @name UpdatePage\n * @summary Update Page\n * @request PUT:/pages/{id}\n * @secure\n * @response `200` `HandlerResponsePageUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updatePage: (id: number, page: HandlerParamsPageUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponsePageUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}`,\n        method: 'PUT',\n        body: page,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific page\n *\n * @tags Page\n * @name DeletePage\n * @summary Delete Page\n * @request DELETE:/pages/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deletePage: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Fetch the data of a specific page\n *\n * @tags Page\n * @name FetchPage\n * @summary Fetch Page Data\n * @request POST:/pages/{id}/fetch\n * @secure\n * @response `200` `HandlerResponsePageFetch` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    fetchPage: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponsePageFetch,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}/fetch`,\n        method: 'POST',\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  sendEmail = {\n    /**\n * @description Send an email to test the email sender\n *\n * @tags System\n * @name SendEmail\n * @summary Send Email\n * @request POST:/send_email\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `HandlerMap` Internal Server Error\n */\n    sendEmail: (email: HandlerParamsEmailSend, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        | (HandlerMap & {\n            msg?: string\n          })\n        | HandlerMap\n      >({\n        path: `/send_email`,\n        method: 'POST',\n        body: email,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  settings = {\n    /**\n * @description Get settings from app config file\n *\n * @tags System\n * @name GetSettings\n * @summary Get Settings\n * @request GET:/settings\n * @secure\n * @response `200` `HandlerResponseSettingGet` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getSettings: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseSettingGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/settings`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Apply settings and restart the server\n *\n * @tags System\n * @name ApplySettings\n * @summary Save and apply Settings\n * @request PUT:/settings\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    applySettings: (settings: HandlerParamsSettingApply, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/settings`,\n        method: 'PUT',\n        body: settings,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get config templates in different languages for rendering the settings page in the frontend\n     *\n     * @tags System\n     * @name GetSettingsTemplate\n     * @summary Get Settings Template\n     * @request GET:/settings/template/{locale}\n     * @secure\n     * @response `200` `HandlerResponseSettingTemplate` OK\n     */\n    getSettingsTemplate: (locale: string, params: RequestParams = {}) =>\n      this.request<HandlerResponseSettingTemplate, any>({\n        path: `/settings/template/${locale}`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  sites = {\n    /**\n     * @description Get a list of sites by some conditions\n     *\n     * @tags Site\n     * @name GetSites\n     * @summary Get Site List\n     * @request GET:/sites\n     * @secure\n     * @response `200` `HandlerResponseSiteList` OK\n     */\n    getSites: (params: RequestParams = {}) =>\n      this.request<HandlerResponseSiteList, any>({\n        path: `/sites`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Create a new site\n *\n * @tags Site\n * @name CreateSite\n * @summary Create Site\n * @request POST:/sites\n * @secure\n * @response `200` `HandlerResponseSiteCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createSite: (site: HandlerParamsSiteCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseSiteCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/sites`,\n        method: 'POST',\n        body: site,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Update a specific site\n     *\n     * @tags Site\n     * @name UpdateSite\n     * @summary Update Site\n     * @request PUT:/sites/{id}\n     * @secure\n     * @response `200` `HandlerResponseSiteUpdate` OK\n     */\n    updateSite: (id: number, site: HandlerParamsSiteUpdate, params: RequestParams = {}) =>\n      this.request<HandlerResponseSiteUpdate, any>({\n        path: `/sites/${id}`,\n        method: 'PUT',\n        body: site,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific site\n *\n * @tags Site\n * @name DeleteSite\n * @summary Site Delete\n * @request DELETE:/sites/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteSite: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/sites/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  stats = {\n    /**\n * @description Get the statistics of various data analysis\n *\n * @tags Statistic\n * @name GetStats\n * @summary Statistic\n * @request GET:/stats/{type}\n * @response `200` `CommonJSONResult` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getStats: (\n      type:\n        | 'latest_comments'\n        | 'latest_pages'\n        | 'pv_most_pages'\n        | 'comment_most_pages'\n        | 'page_pv'\n        | 'site_pv'\n        | 'page_comment'\n        | 'site_comment'\n        | 'rand_comments'\n        | 'rand_pages',\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** multiple page keys separated by commas */\n        page_keys?: string\n        /** The site name of your content scope */\n        site_name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        CommonJSONResult,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/stats/${type}`,\n        method: 'GET',\n        query: query,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  transfer = {\n    /**\n * @description Export data from Artalk\n *\n * @tags Transfer\n * @name ExportArtrans\n * @summary Export Artrans\n * @request GET:/transfer/export\n * @secure\n * @response `200` `HandlerResponseTransferExport` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    exportArtrans: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseTransferExport,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/transfer/export`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Import data to Artalk\n     *\n     * @tags Transfer\n     * @name ImportArtrans\n     * @summary Import Artrans\n     * @request POST:/transfer/import\n     * @secure\n     * @response `200` `string` OK\n     */\n    importArtrans: (data: HandlerParamsTransferImport, params: RequestParams = {}) =>\n      this.request<string, any>({\n        path: `/transfer/import`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.Json,\n        ...params,\n      }),\n\n    /**\n * @description Upload a file to prepare to import\n *\n * @tags Transfer\n * @name UploadArtrans\n * @summary Upload Artrans\n * @request POST:/transfer/upload\n * @secure\n * @response `200` `(HandlerResponseTransferUpload & {\n    filename?: string,\n\n})` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    uploadArtrans: (\n      data: {\n        /**\n         * Upload file in preparation for import task\n         * @format binary\n         */\n        file: File\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseTransferUpload & {\n          filename?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/transfer/upload`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.FormData,\n        format: 'json',\n        ...params,\n      }),\n  }\n  upload = {\n    /**\n * @description Upload file from this endpoint\n *\n * @tags Upload\n * @name Upload\n * @summary Upload\n * @request POST:/upload\n * @secure\n * @response `200` `HandlerResponseUpload` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    upload: (\n      data: {\n        /**\n         * Upload file\n         * @format binary\n         */\n        file: File\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseUpload,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/upload`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.FormData,\n        format: 'json',\n        ...params,\n      }),\n  }\n  user = {\n    /**\n * @description Get user info to prepare for login or check current user status\n *\n * @tags Auth\n * @name GetUser\n * @summary Get User Info\n * @request GET:/user\n * @secure\n * @response `200` `HandlerResponseUserInfo` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n */\n    getUser: (\n      query?: {\n        /** The user email */\n        email?: string\n        /** The username */\n        name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseUserInfo,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/user`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update user profile when user is logged in\n *\n * @tags Auth\n * @name UpdateProfile\n * @summary Update user profile\n * @request POST:/user\n * @secure\n * @response `200` `HandlerResponseUserInfoUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updateProfile: (data: HandlerRequestUserInfoUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserInfoUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/user`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Login user by name or email\n *\n * @tags Auth\n * @name Login\n * @summary Get Access Token\n * @request POST:/user/access_token\n * @response `200` `HandlerResponseUserLogin` OK\n * @response `400` `(HandlerMap & {\n    data?: {\n    need_name_select?: (string)[],\n\n},\n    msg?: string,\n\n})` Multiple users with the same email address are matched\n * @response `401` `(HandlerMap & {\n    msg?: string,\n\n})` Unauthorized\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    login: (user: HandlerParamsUserLogin, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserLogin,\n        | (HandlerMap & {\n            data?: {\n              need_name_select?: string[]\n            }\n            msg?: string\n          })\n        | (HandlerMap & {\n            msg?: string\n          })\n      >({\n        path: `/user/access_token`,\n        method: 'POST',\n        body: user,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get user login status by header Authorization\n     *\n     * @tags Auth\n     * @name GetUserStatus\n     * @summary Get Login Status\n     * @request GET:/user/status\n     * @secure\n     * @response `200` `HandlerResponseUserStatus` OK\n     */\n    getUserStatus: (\n      query?: {\n        /** The user email */\n        email?: string\n        /** The username */\n        name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<HandlerResponseUserStatus, any>({\n        path: `/user/status`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  users = {\n    /**\n * @description Create a new user\n *\n * @tags User\n * @name CreateUser\n * @summary Create User\n * @request POST:/users\n * @secure\n * @response `200` `HandlerResponseUserCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createUser: (user: HandlerParamsUserCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users`,\n        method: 'POST',\n        body: user,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific user\n *\n * @tags User\n * @name UpdateUser\n * @summary Update User\n * @request PUT:/users/{id}\n * @secure\n * @response `200` `HandlerResponseUserUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updateUser: (id: number, user: HandlerParamsUserUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${id}`,\n        method: 'PUT',\n        body: user,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific user\n *\n * @tags User\n * @name DeleteUser\n * @summary Delete User\n * @request DELETE:/users/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteUser: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get a list of users by some conditions\n *\n * @tags User\n * @name GetUsers\n * @summary Get User List\n * @request GET:/users/{type}\n * @secure\n * @response `200` `HandlerResponseAdminUserList` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    getUsers: (\n      type?: 'all' | 'admin' | 'in_conf',\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** The offset for pagination */\n        offset?: number\n        /** Search keywords */\n        search?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseAdminUserList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${type}`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  version = {\n    /**\n     * @description Get the version of Artalk\n     *\n     * @tags System\n     * @name GetVersion\n     * @summary Get Version Info\n     * @request GET:/version\n     * @response `200` `CommonApiVersionData` OK\n     */\n    getVersion: (params: RequestParams = {}) =>\n      this.request<CommonApiVersionData, any>({\n        path: `/version`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n  }\n  votes = {\n    /**\n * @description Sync the number of votes in the `comments` or `pages` data tables to keep them the same as the `votes` table\n *\n * @tags Vote\n * @name SyncVotes\n * @summary Sync Vote Data\n * @request POST:/votes/sync\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    syncVotes: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/votes/sync`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Vote for a specific comment or page\n *\n * @tags Vote\n * @name Vote\n * @summary Vote\n * @request POST:/votes/{type}/{target_id}\n * @response `200` `HandlerResponseVote` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    vote: (\n      type: 'comment_up' | 'comment_down' | 'page_up' | 'page_down',\n      targetId: number,\n      vote: HandlerParamsVote,\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseVote,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/votes/${type}/${targetId}`,\n        method: 'POST',\n        body: vote,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n}\n","import { ApiOptions } from './options'\nimport { FetchError } from '@/types'\n\nexport const Fetch = async (\n  opts: ApiOptions,\n  input: string | URL | Request,\n  init?: RequestInit,\n) => {\n  const apiToken = opts.getApiToken && opts.getApiToken()\n\n  const headers = new Headers({\n    Authorization: apiToken ? `Bearer ${apiToken}` : '',\n    ...init?.headers,\n  })\n\n  if (!headers.get('Authorization')) headers.delete('Authorization')\n\n  // 请求操作\n  const resp = await fetch(input, {\n    ...init,\n    headers,\n  })\n\n  if (!resp.ok) {\n    // Deserialize response body (if it is JSON, otherwise returns `{}`)\n    const json: any = (await resp.json().catch(() => {})) || {}\n\n    let retry = false\n    opts.handlers &&\n      (await opts.handlers.get().reduce(async (promise, item) => {\n        await promise\n        if (json[item.action] === true) {\n          await item.handler(json)\n          retry = true\n        }\n      }, Promise.resolve()))\n\n    if (retry) return Fetch(opts, input, init)\n    throw createError(resp.status, json)\n  }\n\n  return resp\n}\n\nexport class FetchException extends Error implements FetchError {\n  code: number = 0\n  message: string = 'fetch error'\n  data?: any\n}\n\nfunction createError(code: number, data: any): FetchException {\n  const err = new FetchException()\n  err.message = data.msg || data.message || 'fetch error'\n  err.code = code\n  err.data = data\n  console.error(err)\n  return err\n}\n","import { ApiOptions } from './options'\nimport { Api as ApiV2 } from './v2'\nimport { Fetch } from './fetch'\n\nexport * from './options'\nexport * from './handler'\n\nexport class Api extends ApiV2<void> {\n  private _opts: ApiOptions\n\n  constructor(opts: ApiOptions) {\n    super({\n      baseUrl: opts.baseURL,\n      customFetch: (input, init) => Fetch(opts, input, init),\n    })\n\n    this._opts = opts\n  }\n\n  /**\n   * Get user info as params for request\n   *\n   * @returns Request params with user info\n   */\n  getUserFields() {\n    const user = this._opts.userInfo\n    if (!user?.name || !user?.email) return undefined\n    return { name: user.name, email: user.email }\n  }\n}\n","/**\n * marked v14.1.2 - a markdown parser\n * Copyright (c) 2011-2024, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\n/**\n * Gets the original marked default options.\n */\nfunction _getDefaults() {\n    return {\n        async: false,\n        breaks: false,\n        extensions: null,\n        gfm: true,\n        hooks: null,\n        pedantic: false,\n        renderer: null,\n        silent: false,\n        tokenizer: null,\n        walkTokens: null,\n    };\n}\nlet _defaults = _getDefaults();\nfunction changeDefaults(newDefaults) {\n    _defaults = newDefaults;\n}\n\n/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = new RegExp(escapeTest.source, 'g');\nconst escapeTestNoEncode = /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/;\nconst escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');\nconst escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n};\nconst getEscapeReplacement = (ch) => escapeReplacements[ch];\nfunction escape$1(html, encode) {\n    if (encode) {\n        if (escapeTest.test(html)) {\n            return html.replace(escapeReplace, getEscapeReplacement);\n        }\n    }\n    else {\n        if (escapeTestNoEncode.test(html)) {\n            return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n        }\n    }\n    return html;\n}\nconst caret = /(^|[^\\[])\\^/g;\nfunction edit(regex, opt) {\n    let source = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    const obj = {\n        replace: (name, val) => {\n            let valSource = typeof val === 'string' ? val : val.source;\n            valSource = valSource.replace(caret, '$1');\n            source = source.replace(name, valSource);\n            return obj;\n        },\n        getRegex: () => {\n            return new RegExp(source, opt);\n        },\n    };\n    return obj;\n}\nfunction cleanUrl(href) {\n    try {\n        href = encodeURI(href).replace(/%25/g, '%');\n    }\n    catch {\n        return null;\n    }\n    return href;\n}\nconst noopTest = { exec: () => null };\nfunction splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n        let escaped = false;\n        let curr = offset;\n        while (--curr >= 0 && str[curr] === '\\\\')\n            escaped = !escaped;\n        if (escaped) {\n            // odd number of slashes means | is escaped\n            // so we leave it alone\n            return '|';\n        }\n        else {\n            // add space before unescaped |\n            return ' |';\n        }\n    }), cells = row.split(/ \\|/);\n    let i = 0;\n    // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n    if (!cells[0].trim()) {\n        cells.shift();\n    }\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n        cells.pop();\n    }\n    if (count) {\n        if (cells.length > count) {\n            cells.splice(count);\n        }\n        else {\n            while (cells.length < count)\n                cells.push('');\n        }\n    }\n    for (; i < cells.length; i++) {\n        // leading or trailing whitespace is ignored per the gfm spec\n        cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n    return cells;\n}\n/**\n * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n * /c*$/ is vulnerable to REDOS.\n *\n * @param str\n * @param c\n * @param invert Remove suffix of non-c chars instead. Default falsey.\n */\nfunction rtrim(str, c, invert) {\n    const l = str.length;\n    if (l === 0) {\n        return '';\n    }\n    // Length of suffix matching the invert condition.\n    let suffLen = 0;\n    // Step left until we fail to match the invert condition.\n    while (suffLen < l) {\n        const currChar = str.charAt(l - suffLen - 1);\n        if (currChar === c && !invert) {\n            suffLen++;\n        }\n        else if (currChar !== c && invert) {\n            suffLen++;\n        }\n        else {\n            break;\n        }\n    }\n    return str.slice(0, l - suffLen);\n}\nfunction findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n        return -1;\n    }\n    let level = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '\\\\') {\n            i++;\n        }\n        else if (str[i] === b[0]) {\n            level++;\n        }\n        else if (str[i] === b[1]) {\n            level--;\n            if (level < 0) {\n                return i;\n            }\n        }\n    }\n    return -1;\n}\n\nfunction outputLink(cap, link, raw, lexer) {\n    const href = link.href;\n    const title = link.title ? escape$1(link.title) : null;\n    const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n    if (cap[0].charAt(0) !== '!') {\n        lexer.state.inLink = true;\n        const token = {\n            type: 'link',\n            raw,\n            href,\n            title,\n            text,\n            tokens: lexer.inlineTokens(text),\n        };\n        lexer.state.inLink = false;\n        return token;\n    }\n    return {\n        type: 'image',\n        raw,\n        href,\n        title,\n        text: escape$1(text),\n    };\n}\nfunction indentCodeCompensation(raw, text) {\n    const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n    if (matchIndentToCode === null) {\n        return text;\n    }\n    const indentToCode = matchIndentToCode[1];\n    return text\n        .split('\\n')\n        .map(node => {\n        const matchIndentInNode = node.match(/^\\s+/);\n        if (matchIndentInNode === null) {\n            return node;\n        }\n        const [indentInNode] = matchIndentInNode;\n        if (indentInNode.length >= indentToCode.length) {\n            return node.slice(indentToCode.length);\n        }\n        return node;\n    })\n        .join('\\n');\n}\n/**\n * Tokenizer\n */\nclass _Tokenizer {\n    options;\n    rules; // set by the lexer\n    lexer; // set by the lexer\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    space(src) {\n        const cap = this.rules.block.newline.exec(src);\n        if (cap && cap[0].length > 0) {\n            return {\n                type: 'space',\n                raw: cap[0],\n            };\n        }\n    }\n    code(src) {\n        const cap = this.rules.block.code.exec(src);\n        if (cap) {\n            const text = cap[0].replace(/^(?: {1,4}| {0,3}\\t)/gm, '');\n            return {\n                type: 'code',\n                raw: cap[0],\n                codeBlockStyle: 'indented',\n                text: !this.options.pedantic\n                    ? rtrim(text, '\\n')\n                    : text,\n            };\n        }\n    }\n    fences(src) {\n        const cap = this.rules.block.fences.exec(src);\n        if (cap) {\n            const raw = cap[0];\n            const text = indentCodeCompensation(raw, cap[3] || '');\n            return {\n                type: 'code',\n                raw,\n                lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, '$1') : cap[2],\n                text,\n            };\n        }\n    }\n    heading(src) {\n        const cap = this.rules.block.heading.exec(src);\n        if (cap) {\n            let text = cap[2].trim();\n            // remove trailing #s\n            if (/#$/.test(text)) {\n                const trimmed = rtrim(text, '#');\n                if (this.options.pedantic) {\n                    text = trimmed.trim();\n                }\n                else if (!trimmed || / $/.test(trimmed)) {\n                    // CommonMark requires space before trailing #s\n                    text = trimmed.trim();\n                }\n            }\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[1].length,\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n    hr(src) {\n        const cap = this.rules.block.hr.exec(src);\n        if (cap) {\n            return {\n                type: 'hr',\n                raw: rtrim(cap[0], '\\n'),\n            };\n        }\n    }\n    blockquote(src) {\n        const cap = this.rules.block.blockquote.exec(src);\n        if (cap) {\n            let lines = rtrim(cap[0], '\\n').split('\\n');\n            let raw = '';\n            let text = '';\n            const tokens = [];\n            while (lines.length > 0) {\n                let inBlockquote = false;\n                const currentLines = [];\n                let i;\n                for (i = 0; i < lines.length; i++) {\n                    // get lines up to a continuation\n                    if (/^ {0,3}>/.test(lines[i])) {\n                        currentLines.push(lines[i]);\n                        inBlockquote = true;\n                    }\n                    else if (!inBlockquote) {\n                        currentLines.push(lines[i]);\n                    }\n                    else {\n                        break;\n                    }\n                }\n                lines = lines.slice(i);\n                const currentRaw = currentLines.join('\\n');\n                const currentText = currentRaw\n                    // precede setext continuation with 4 spaces so it isn't a setext\n                    .replace(/\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g, '\\n    $1')\n                    .replace(/^ {0,3}>[ \\t]?/gm, '');\n                raw = raw ? `${raw}\\n${currentRaw}` : currentRaw;\n                text = text ? `${text}\\n${currentText}` : currentText;\n                // parse blockquote lines as top level tokens\n                // merge paragraphs if this is a continuation\n                const top = this.lexer.state.top;\n                this.lexer.state.top = true;\n                this.lexer.blockTokens(currentText, tokens, true);\n                this.lexer.state.top = top;\n                // if there is no continuation then we are done\n                if (lines.length === 0) {\n                    break;\n                }\n                const lastToken = tokens[tokens.length - 1];\n                if (lastToken?.type === 'code') {\n                    // blockquote continuation cannot be preceded by a code block\n                    break;\n                }\n                else if (lastToken?.type === 'blockquote') {\n                    // include continuation in nested blockquote\n                    const oldToken = lastToken;\n                    const newText = oldToken.raw + '\\n' + lines.join('\\n');\n                    const newToken = this.blockquote(newText);\n                    tokens[tokens.length - 1] = newToken;\n                    raw = raw.substring(0, raw.length - oldToken.raw.length) + newToken.raw;\n                    text = text.substring(0, text.length - oldToken.text.length) + newToken.text;\n                    break;\n                }\n                else if (lastToken?.type === 'list') {\n                    // include continuation in nested list\n                    const oldToken = lastToken;\n                    const newText = oldToken.raw + '\\n' + lines.join('\\n');\n                    const newToken = this.list(newText);\n                    tokens[tokens.length - 1] = newToken;\n                    raw = raw.substring(0, raw.length - lastToken.raw.length) + newToken.raw;\n                    text = text.substring(0, text.length - oldToken.raw.length) + newToken.raw;\n                    lines = newText.substring(tokens[tokens.length - 1].raw.length).split('\\n');\n                    continue;\n                }\n            }\n            return {\n                type: 'blockquote',\n                raw,\n                tokens,\n                text,\n            };\n        }\n    }\n    list(src) {\n        let cap = this.rules.block.list.exec(src);\n        if (cap) {\n            let bull = cap[1].trim();\n            const isordered = bull.length > 1;\n            const list = {\n                type: 'list',\n                raw: '',\n                ordered: isordered,\n                start: isordered ? +bull.slice(0, -1) : '',\n                loose: false,\n                items: [],\n            };\n            bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n            if (this.options.pedantic) {\n                bull = isordered ? bull : '[*+-]';\n            }\n            // Get next list item\n            const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))`);\n            let endsWithBlankLine = false;\n            // Check if current bullet point can start a new List Item\n            while (src) {\n                let endEarly = false;\n                let raw = '';\n                let itemContents = '';\n                if (!(cap = itemRegex.exec(src))) {\n                    break;\n                }\n                if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)\n                    break;\n                }\n                raw = cap[0];\n                src = src.substring(raw.length);\n                let line = cap[2].split('\\n', 1)[0].replace(/^\\t+/, (t) => ' '.repeat(3 * t.length));\n                let nextLine = src.split('\\n', 1)[0];\n                let blankLine = !line.trim();\n                let indent = 0;\n                if (this.options.pedantic) {\n                    indent = 2;\n                    itemContents = line.trimStart();\n                }\n                else if (blankLine) {\n                    indent = cap[1].length + 1;\n                }\n                else {\n                    indent = cap[2].search(/[^ ]/); // Find first non-space char\n                    indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n                    itemContents = line.slice(indent);\n                    indent += cap[1].length;\n                }\n                if (blankLine && /^[ \\t]*$/.test(nextLine)) { // Items begin with at most one blank line\n                    raw += nextLine + '\\n';\n                    src = src.substring(nextLine.length + 1);\n                    endEarly = true;\n                }\n                if (!endEarly) {\n                    const nextBulletRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \\t][^\\\\n]*)?(?:\\\\n|$))`);\n                    const hrRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`);\n                    const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`);\n                    const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);\n                    const htmlBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}<[a-z].*>`, 'i');\n                    // Check if following lines should be included in List Item\n                    while (src) {\n                        const rawLine = src.split('\\n', 1)[0];\n                        let nextLineWithoutTabs;\n                        nextLine = rawLine;\n                        // Re-align to follow commonmark nesting rules\n                        if (this.options.pedantic) {\n                            nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n                            nextLineWithoutTabs = nextLine;\n                        }\n                        else {\n                            nextLineWithoutTabs = nextLine.replace(/\\t/g, '    ');\n                        }\n                        // End list item if found code fences\n                        if (fencesBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new heading\n                        if (headingBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of html block\n                        if (htmlBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new bullet\n                        if (nextBulletRegex.test(nextLine)) {\n                            break;\n                        }\n                        // Horizontal rule found\n                        if (hrRegex.test(nextLine)) {\n                            break;\n                        }\n                        if (nextLineWithoutTabs.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible\n                            itemContents += '\\n' + nextLineWithoutTabs.slice(indent);\n                        }\n                        else {\n                            // not enough indentation\n                            if (blankLine) {\n                                break;\n                            }\n                            // paragraph continuation unless last line was a different block level element\n                            if (line.replace(/\\t/g, '    ').search(/[^ ]/) >= 4) { // indented code block\n                                break;\n                            }\n                            if (fencesBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (headingBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (hrRegex.test(line)) {\n                                break;\n                            }\n                            itemContents += '\\n' + nextLine;\n                        }\n                        if (!blankLine && !nextLine.trim()) { // Check if current line is blank\n                            blankLine = true;\n                        }\n                        raw += rawLine + '\\n';\n                        src = src.substring(rawLine.length + 1);\n                        line = nextLineWithoutTabs.slice(indent);\n                    }\n                }\n                if (!list.loose) {\n                    // If the previous item ended with a blank line, the list is loose\n                    if (endsWithBlankLine) {\n                        list.loose = true;\n                    }\n                    else if (/\\n[ \\t]*\\n[ \\t]*$/.test(raw)) {\n                        endsWithBlankLine = true;\n                    }\n                }\n                let istask = null;\n                let ischecked;\n                // Check for task list items\n                if (this.options.gfm) {\n                    istask = /^\\[[ xX]\\] /.exec(itemContents);\n                    if (istask) {\n                        ischecked = istask[0] !== '[ ] ';\n                        itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n                    }\n                }\n                list.items.push({\n                    type: 'list_item',\n                    raw,\n                    task: !!istask,\n                    checked: ischecked,\n                    loose: false,\n                    text: itemContents,\n                    tokens: [],\n                });\n                list.raw += raw;\n            }\n            // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n            list.items[list.items.length - 1].raw = list.items[list.items.length - 1].raw.trimEnd();\n            list.items[list.items.length - 1].text = list.items[list.items.length - 1].text.trimEnd();\n            list.raw = list.raw.trimEnd();\n            // Item child tokens handled here at end because we needed to have the final item to trim it first\n            for (let i = 0; i < list.items.length; i++) {\n                this.lexer.state.top = false;\n                list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n                if (!list.loose) {\n                    // Check if list should be loose\n                    const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n                    const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\\n.*\\n/.test(t.raw));\n                    list.loose = hasMultipleLineBreaks;\n                }\n            }\n            // Set all items to loose if list is loose\n            if (list.loose) {\n                for (let i = 0; i < list.items.length; i++) {\n                    list.items[i].loose = true;\n                }\n            }\n            return list;\n        }\n    }\n    html(src) {\n        const cap = this.rules.block.html.exec(src);\n        if (cap) {\n            const token = {\n                type: 'html',\n                block: true,\n                raw: cap[0],\n                pre: cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style',\n                text: cap[0],\n            };\n            return token;\n        }\n    }\n    def(src) {\n        const cap = this.rules.block.def.exec(src);\n        if (cap) {\n            const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n            const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline.anyPunctuation, '$1') : '';\n            const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation, '$1') : cap[3];\n            return {\n                type: 'def',\n                tag,\n                raw: cap[0],\n                href,\n                title,\n            };\n        }\n    }\n    table(src) {\n        const cap = this.rules.block.table.exec(src);\n        if (!cap) {\n            return;\n        }\n        if (!/[:|]/.test(cap[2])) {\n            // delimiter row must have a pipe (|) or colon (:) otherwise it is a setext heading\n            return;\n        }\n        const headers = splitCells(cap[1]);\n        const aligns = cap[2].replace(/^\\||\\| *$/g, '').split('|');\n        const rows = cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : [];\n        const item = {\n            type: 'table',\n            raw: cap[0],\n            header: [],\n            align: [],\n            rows: [],\n        };\n        if (headers.length !== aligns.length) {\n            // header and align columns must be equal, rows can be different.\n            return;\n        }\n        for (const align of aligns) {\n            if (/^ *-+: *$/.test(align)) {\n                item.align.push('right');\n            }\n            else if (/^ *:-+: *$/.test(align)) {\n                item.align.push('center');\n            }\n            else if (/^ *:-+ *$/.test(align)) {\n                item.align.push('left');\n            }\n            else {\n                item.align.push(null);\n            }\n        }\n        for (let i = 0; i < headers.length; i++) {\n            item.header.push({\n                text: headers[i],\n                tokens: this.lexer.inline(headers[i]),\n                header: true,\n                align: item.align[i],\n            });\n        }\n        for (const row of rows) {\n            item.rows.push(splitCells(row, item.header.length).map((cell, i) => {\n                return {\n                    text: cell,\n                    tokens: this.lexer.inline(cell),\n                    header: false,\n                    align: item.align[i],\n                };\n            }));\n        }\n        return item;\n    }\n    lheading(src) {\n        const cap = this.rules.block.lheading.exec(src);\n        if (cap) {\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[2].charAt(0) === '=' ? 1 : 2,\n                text: cap[1],\n                tokens: this.lexer.inline(cap[1]),\n            };\n        }\n    }\n    paragraph(src) {\n        const cap = this.rules.block.paragraph.exec(src);\n        if (cap) {\n            const text = cap[1].charAt(cap[1].length - 1) === '\\n'\n                ? cap[1].slice(0, -1)\n                : cap[1];\n            return {\n                type: 'paragraph',\n                raw: cap[0],\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n    text(src) {\n        const cap = this.rules.block.text.exec(src);\n        if (cap) {\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                tokens: this.lexer.inline(cap[0]),\n            };\n        }\n    }\n    escape(src) {\n        const cap = this.rules.inline.escape.exec(src);\n        if (cap) {\n            return {\n                type: 'escape',\n                raw: cap[0],\n                text: escape$1(cap[1]),\n            };\n        }\n    }\n    tag(src) {\n        const cap = this.rules.inline.tag.exec(src);\n        if (cap) {\n            if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n                this.lexer.state.inLink = true;\n            }\n            else if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n                this.lexer.state.inLink = false;\n            }\n            if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = true;\n            }\n            else if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = false;\n            }\n            return {\n                type: 'html',\n                raw: cap[0],\n                inLink: this.lexer.state.inLink,\n                inRawBlock: this.lexer.state.inRawBlock,\n                block: false,\n                text: cap[0],\n            };\n        }\n    }\n    link(src) {\n        const cap = this.rules.inline.link.exec(src);\n        if (cap) {\n            const trimmedUrl = cap[2].trim();\n            if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n                // commonmark requires matching angle brackets\n                if (!(/>$/.test(trimmedUrl))) {\n                    return;\n                }\n                // ending angle bracket cannot be escaped\n                const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n                if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n                    return;\n                }\n            }\n            else {\n                // find closing parenthesis\n                const lastParenIndex = findClosingBracket(cap[2], '()');\n                if (lastParenIndex > -1) {\n                    const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n                    const linkLen = start + cap[1].length + lastParenIndex;\n                    cap[2] = cap[2].substring(0, lastParenIndex);\n                    cap[0] = cap[0].substring(0, linkLen).trim();\n                    cap[3] = '';\n                }\n            }\n            let href = cap[2];\n            let title = '';\n            if (this.options.pedantic) {\n                // split pedantic href and title\n                const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n                if (link) {\n                    href = link[1];\n                    title = link[3];\n                }\n            }\n            else {\n                title = cap[3] ? cap[3].slice(1, -1) : '';\n            }\n            href = href.trim();\n            if (/^</.test(href)) {\n                if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {\n                    // pedantic allows starting angle bracket without ending angle bracket\n                    href = href.slice(1);\n                }\n                else {\n                    href = href.slice(1, -1);\n                }\n            }\n            return outputLink(cap, {\n                href: href ? href.replace(this.rules.inline.anyPunctuation, '$1') : href,\n                title: title ? title.replace(this.rules.inline.anyPunctuation, '$1') : title,\n            }, cap[0], this.lexer);\n        }\n    }\n    reflink(src, links) {\n        let cap;\n        if ((cap = this.rules.inline.reflink.exec(src))\n            || (cap = this.rules.inline.nolink.exec(src))) {\n            const linkString = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n            const link = links[linkString.toLowerCase()];\n            if (!link) {\n                const text = cap[0].charAt(0);\n                return {\n                    type: 'text',\n                    raw: text,\n                    text,\n                };\n            }\n            return outputLink(cap, link, cap[0], this.lexer);\n        }\n    }\n    emStrong(src, maskedSrc, prevChar = '') {\n        let match = this.rules.inline.emStrongLDelim.exec(src);\n        if (!match)\n            return;\n        // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n        if (match[3] && prevChar.match(/[\\p{L}\\p{N}]/u))\n            return;\n        const nextChar = match[1] || match[2] || '';\n        if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\n            // unicode Regex counts emoji as 1 char; spread into array for proper count (used multiple times below)\n            const lLength = [...match[0]].length - 1;\n            let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\n            const endReg = match[0][0] === '*' ? this.rules.inline.emStrongRDelimAst : this.rules.inline.emStrongRDelimUnd;\n            endReg.lastIndex = 0;\n            // Clip maskedSrc to same section of string as src (move to lexer?)\n            maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n            while ((match = endReg.exec(maskedSrc)) != null) {\n                rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n                if (!rDelim)\n                    continue; // skip single * in __abc*abc__\n                rLength = [...rDelim].length;\n                if (match[3] || match[4]) { // found another Left Delim\n                    delimTotal += rLength;\n                    continue;\n                }\n                else if (match[5] || match[6]) { // either Left or Right Delim\n                    if (lLength % 3 && !((lLength + rLength) % 3)) {\n                        midDelimTotal += rLength;\n                        continue; // CommonMark Emphasis Rules 9-10\n                    }\n                }\n                delimTotal -= rLength;\n                if (delimTotal > 0)\n                    continue; // Haven't found enough closing delimiters\n                // Remove extra characters. *a*** -> *a*\n                rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n                // char length can be >1 for unicode characters;\n                const lastCharLength = [...match[0]][0].length;\n                const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\n                // Create `em` if smallest delimiter has odd char count. *a***\n                if (Math.min(lLength, rLength) % 2) {\n                    const text = raw.slice(1, -1);\n                    return {\n                        type: 'em',\n                        raw,\n                        text,\n                        tokens: this.lexer.inlineTokens(text),\n                    };\n                }\n                // Create 'strong' if smallest delimiter has even char count. **a***\n                const text = raw.slice(2, -2);\n                return {\n                    type: 'strong',\n                    raw,\n                    text,\n                    tokens: this.lexer.inlineTokens(text),\n                };\n            }\n        }\n    }\n    codespan(src) {\n        const cap = this.rules.inline.code.exec(src);\n        if (cap) {\n            let text = cap[2].replace(/\\n/g, ' ');\n            const hasNonSpaceChars = /[^ ]/.test(text);\n            const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n            if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n                text = text.substring(1, text.length - 1);\n            }\n            text = escape$1(text, true);\n            return {\n                type: 'codespan',\n                raw: cap[0],\n                text,\n            };\n        }\n    }\n    br(src) {\n        const cap = this.rules.inline.br.exec(src);\n        if (cap) {\n            return {\n                type: 'br',\n                raw: cap[0],\n            };\n        }\n    }\n    del(src) {\n        const cap = this.rules.inline.del.exec(src);\n        if (cap) {\n            return {\n                type: 'del',\n                raw: cap[0],\n                text: cap[2],\n                tokens: this.lexer.inlineTokens(cap[2]),\n            };\n        }\n    }\n    autolink(src) {\n        const cap = this.rules.inline.autolink.exec(src);\n        if (cap) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape$1(cap[1]);\n                href = 'mailto:' + text;\n            }\n            else {\n                text = escape$1(cap[1]);\n                href = text;\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n    url(src) {\n        let cap;\n        if (cap = this.rules.inline.url.exec(src)) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape$1(cap[0]);\n                href = 'mailto:' + text;\n            }\n            else {\n                // do extended autolink path validation\n                let prevCapZero;\n                do {\n                    prevCapZero = cap[0];\n                    cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? '';\n                } while (prevCapZero !== cap[0]);\n                text = escape$1(cap[0]);\n                if (cap[1] === 'www.') {\n                    href = 'http://' + cap[0];\n                }\n                else {\n                    href = cap[0];\n                }\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n    inlineText(src) {\n        const cap = this.rules.inline.text.exec(src);\n        if (cap) {\n            let text;\n            if (this.lexer.state.inRawBlock) {\n                text = cap[0];\n            }\n            else {\n                text = escape$1(cap[0]);\n            }\n            return {\n                type: 'text',\n                raw: cap[0],\n                text,\n            };\n        }\n    }\n}\n\n/**\n * Block-Level Grammar\n */\nconst newline = /^(?:[ \\t]*(?:\\n|$))+/;\nconst blockCode = /^((?: {4}| {0,3}\\t)[^\\n]+(?:\\n(?:[ \\t]*(?:\\n|$))*)?)+/;\nconst fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\nconst hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\nconst heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\nconst bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nconst lheading = edit(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .replace(/blockCode/g, /(?: {4}| {0,3}\\t)/) // indented code blocks can interrupt\n    .replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/) // fenced code blocks can interrupt\n    .replace(/blockquote/g, / {0,3}>/) // blockquote can interrupt\n    .replace(/heading/g, / {0,3}#{1,6}/) // ATX heading can interrupt\n    .replace(/html/g, / {0,3}<[^\\n>]+>\\n/) // block html can interrupt\n    .getRegex();\nconst _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\nconst blockText = /^[^\\n]+/;\nconst _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nconst def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n[ \\t]*)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n[ \\t]*)?| *\\n[ \\t]*)(title))? *(?:\\n+|$)/)\n    .replace('label', _blockLabel)\n    .replace('title', /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/)\n    .getRegex();\nconst list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/)\n    .replace(/bull/g, bullet)\n    .getRegex();\nconst _tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n    + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n    + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n    + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n    + '|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title'\n    + '|tr|track|ul';\nconst _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\nconst html = edit('^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n[ \\t]*)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \\t]*)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \\t]*)+\\\\n|$)' // (7) closing tag\n    + ')', 'i')\n    .replace('comment', _comment)\n    .replace('tag', _tag)\n    .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst paragraph = edit(_paragraph)\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n    .replace('|table', '')\n    .replace('blockquote', ' {0,3}>')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/)\n    .replace('paragraph', paragraph)\n    .getRegex();\n/**\n * Normal Block Grammar\n */\nconst blockNormal = {\n    blockquote,\n    code: blockCode,\n    def,\n    fences,\n    heading,\n    hr,\n    html,\n    lheading,\n    list,\n    newline,\n    paragraph,\n    table: noopTest,\n    text: blockText,\n};\n/**\n * GFM Block Grammar\n */\nconst gfmTable = edit('^ *([^\\\\n ].*)\\\\n' // Header\n    + ' {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)') // Cells\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('blockquote', ' {0,3}>')\n    .replace('code', '(?: {4}| {0,3}\\t)[^\\\\n]')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // tables can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockGfm = {\n    ...blockNormal,\n    table: gfmTable,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n        .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n        .replace('table', gfmTable) // interrupt paragraphs with table\n        .replace('blockquote', ' {0,3}>')\n        .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n        .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n        .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n        .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n        .getRegex(),\n};\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\nconst blockPedantic = {\n    ...blockNormal,\n    html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)'\n        + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n        + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n        .replace('comment', _comment)\n        .replace(/tag/g, '(?!(?:'\n        + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n        + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n        + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n        .getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest, // fences not supported\n    lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' *#{1,6} *[^\\n]')\n        .replace('lheading', lheading)\n        .replace('|table', '')\n        .replace('blockquote', ' {0,3}>')\n        .replace('|fences', '')\n        .replace('|list', '')\n        .replace('|html', '')\n        .replace('|tag', '')\n        .getRegex(),\n};\n/**\n * Inline-Level Grammar\n */\nconst escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\nconst inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\nconst br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\nconst inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\n// list of unicode punctuation marks, plus any missing characters from CommonMark spec\nconst _punctuation = '\\\\p{P}\\\\p{S}';\nconst punctuation = edit(/^((?![*_])[\\spunctuation])/, 'u')\n    .replace(/punctuation/g, _punctuation).getRegex();\n// sequences em should skip over [title](link), `code`, <html>\nconst blockSkip = /\\[[^[\\]]*?\\]\\([^\\(\\)]*?\\)|`[^`]*?`|<[^<>]*?>/g;\nconst emStrongLDelim = edit(/^(?:\\*+(?:((?!\\*)[punct])|[^\\s*]))|^_+(?:((?!_)[punct])|([^\\s_]))/, 'u')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst emStrongRDelimAst = edit('^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)' // Skip orphan inside strong\n    + '|[^*]+(?=[^*])' // Consume to delim\n    + '|(?!\\\\*)[punct](\\\\*+)(?=[\\\\s]|$)' // (1) #*** can only be a Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?!\\\\*)(?=[punct\\\\s]|$)' // (2) a***#, a*** can only be a Right Delimiter\n    + '|(?!\\\\*)[punct\\\\s](\\\\*+)(?=[^punct\\\\s])' // (3) #***a, ***a can only be Left Delimiter\n    + '|[\\\\s](\\\\*+)(?!\\\\*)(?=[punct])' // (4) ***# can only be Left Delimiter\n    + '|(?!\\\\*)[punct](\\\\*+)(?!\\\\*)(?=[punct])' // (5) #***# can be either Left or Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?=[^punct\\\\s])', 'gu') // (6) a***a can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n// (6) Not allowed for _\nconst emStrongRDelimUnd = edit('^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)' // Skip orphan inside strong\n    + '|[^_]+(?=[^_])' // Consume to delim\n    + '|(?!_)[punct](_+)(?=[\\\\s]|$)' // (1) #___ can only be a Right Delimiter\n    + '|[^punct\\\\s](_+)(?!_)(?=[punct\\\\s]|$)' // (2) a___#, a___ can only be a Right Delimiter\n    + '|(?!_)[punct\\\\s](_+)(?=[^punct\\\\s])' // (3) #___a, ___a can only be Left Delimiter\n    + '|[\\\\s](_+)(?!_)(?=[punct])' // (4) ___# can only be Left Delimiter\n    + '|(?!_)[punct](_+)(?!_)(?=[punct])', 'gu') // (5) #___# can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst anyPunctuation = edit(/\\\\([punct])/, 'gu')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/)\n    .replace('scheme', /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/)\n    .replace('email', /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/)\n    .getRegex();\nconst _inlineComment = edit(_comment).replace('(?:-->|$)', '-->').getRegex();\nconst tag = edit('^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>') // CDATA section\n    .replace('comment', _inlineComment)\n    .replace('attribute', /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\nconst link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/)\n    .replace('label', _inlineLabel)\n    .replace('href', /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/)\n    .replace('title', /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/)\n    .getRegex();\nconst reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/)\n    .replace('label', _inlineLabel)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst reflinkSearch = edit('reflink|nolink(?!\\\\()', 'g')\n    .replace('reflink', reflink)\n    .replace('nolink', nolink)\n    .getRegex();\n/**\n * Normal Inline Grammar\n */\nconst inlineNormal = {\n    _backpedal: noopTest, // only used for GFM url\n    anyPunctuation,\n    autolink,\n    blockSkip,\n    br,\n    code: inlineCode,\n    del: noopTest,\n    emStrongLDelim,\n    emStrongRDelimAst,\n    emStrongRDelimUnd,\n    escape,\n    link,\n    nolink,\n    punctuation,\n    reflink,\n    reflinkSearch,\n    tag,\n    text: inlineText,\n    url: noopTest,\n};\n/**\n * Pedantic Inline Grammar\n */\nconst inlinePedantic = {\n    ...inlineNormal,\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n};\n/**\n * GFM Inline Grammar\n */\nconst inlineGfm = {\n    ...inlineNormal,\n    escape: edit(escape).replace('])', '~|])').getRegex(),\n    url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, 'i')\n        .replace('email', /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/)\n        .getRegex(),\n    _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/,\n};\n/**\n * GFM + Line Breaks Inline Grammar\n */\nconst inlineBreaks = {\n    ...inlineGfm,\n    br: edit(br).replace('{2,}', '*').getRegex(),\n    text: edit(inlineGfm.text)\n        .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n        .replace(/\\{2,\\}/g, '*')\n        .getRegex(),\n};\n/**\n * exports\n */\nconst block = {\n    normal: blockNormal,\n    gfm: blockGfm,\n    pedantic: blockPedantic,\n};\nconst inline = {\n    normal: inlineNormal,\n    gfm: inlineGfm,\n    breaks: inlineBreaks,\n    pedantic: inlinePedantic,\n};\n\n/**\n * Block Lexer\n */\nclass _Lexer {\n    tokens;\n    options;\n    state;\n    tokenizer;\n    inlineQueue;\n    constructor(options) {\n        // TokenList cannot be created in one go\n        this.tokens = [];\n        this.tokens.links = Object.create(null);\n        this.options = options || _defaults;\n        this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\n        this.tokenizer = this.options.tokenizer;\n        this.tokenizer.options = this.options;\n        this.tokenizer.lexer = this;\n        this.inlineQueue = [];\n        this.state = {\n            inLink: false,\n            inRawBlock: false,\n            top: true,\n        };\n        const rules = {\n            block: block.normal,\n            inline: inline.normal,\n        };\n        if (this.options.pedantic) {\n            rules.block = block.pedantic;\n            rules.inline = inline.pedantic;\n        }\n        else if (this.options.gfm) {\n            rules.block = block.gfm;\n            if (this.options.breaks) {\n                rules.inline = inline.breaks;\n            }\n            else {\n                rules.inline = inline.gfm;\n            }\n        }\n        this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n    static get rules() {\n        return {\n            block,\n            inline,\n        };\n    }\n    /**\n     * Static Lex Method\n     */\n    static lex(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    static lexInline(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    lex(src) {\n        src = src\n            .replace(/\\r\\n|\\r/g, '\\n');\n        this.blockTokens(src, this.tokens);\n        for (let i = 0; i < this.inlineQueue.length; i++) {\n            const next = this.inlineQueue[i];\n            this.inlineTokens(next.src, next.tokens);\n        }\n        this.inlineQueue = [];\n        return this.tokens;\n    }\n    blockTokens(src, tokens = [], lastParagraphClipped = false) {\n        if (this.options.pedantic) {\n            src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n        }\n        let token;\n        let lastToken;\n        let cutSrc;\n        while (src) {\n            if (this.options.extensions\n                && this.options.extensions.block\n                && this.options.extensions.block.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // newline\n            if (token = this.tokenizer.space(src)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.length === 1 && tokens.length > 0) {\n                    // if there's a single \\n as a spacer, it's terminating the last line,\n                    // so move it there so that we don't get unnecessary paragraph tags\n                    tokens[tokens.length - 1].raw += '\\n';\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.code(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                // An indented code block cannot interrupt a paragraph.\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // fences\n            if (token = this.tokenizer.fences(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // heading\n            if (token = this.tokenizer.heading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // hr\n            if (token = this.tokenizer.hr(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // blockquote\n            if (token = this.tokenizer.blockquote(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // list\n            if (token = this.tokenizer.list(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // html\n            if (token = this.tokenizer.html(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // def\n            if (token = this.tokenizer.def(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.raw;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else if (!this.tokens.links[token.tag]) {\n                    this.tokens.links[token.tag] = {\n                        href: token.href,\n                        title: token.title,\n                    };\n                }\n                continue;\n            }\n            // table (gfm)\n            if (token = this.tokenizer.table(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // lheading\n            if (token = this.tokenizer.lheading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // top-level paragraph\n            // prevent paragraph consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startBlock) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startBlock.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n                lastToken = tokens[tokens.length - 1];\n                if (lastParagraphClipped && lastToken?.type === 'paragraph') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                lastParagraphClipped = (cutSrc.length !== src.length);\n                src = src.substring(token.raw.length);\n                continue;\n            }\n            // text\n            if (token = this.tokenizer.text(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        this.state.top = true;\n        return tokens;\n    }\n    inline(src, tokens = []) {\n        this.inlineQueue.push({ src, tokens });\n        return tokens;\n    }\n    /**\n     * Lexing/Compiling\n     */\n    inlineTokens(src, tokens = []) {\n        let token, lastToken, cutSrc;\n        // String with links masked to avoid interference with em and strong\n        let maskedSrc = src;\n        let match;\n        let keepPrevChar, prevChar;\n        // Mask out reflinks\n        if (this.tokens.links) {\n            const links = Object.keys(this.tokens.links);\n            if (links.length > 0) {\n                while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n                    if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n                        maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n                    }\n                }\n            }\n        }\n        // Mask out other blocks\n        while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n        }\n        // Mask out escaped characters\n        while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);\n        }\n        while (src) {\n            if (!keepPrevChar) {\n                prevChar = '';\n            }\n            keepPrevChar = false;\n            // extensions\n            if (this.options.extensions\n                && this.options.extensions.inline\n                && this.options.extensions.inline.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // escape\n            if (token = this.tokenizer.escape(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // tag\n            if (token = this.tokenizer.tag(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // link\n            if (token = this.tokenizer.link(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // reflink, nolink\n            if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // em & strong\n            if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.codespan(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // br\n            if (token = this.tokenizer.br(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // del (gfm)\n            if (token = this.tokenizer.del(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // autolink\n            if (token = this.tokenizer.autolink(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // url (gfm)\n            if (!this.state.inLink && (token = this.tokenizer.url(src))) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // text\n            // prevent inlineText consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startInline) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startInline.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (token = this.tokenizer.inlineText(cutSrc)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started\n                    prevChar = token.raw.slice(-1);\n                }\n                keepPrevChar = true;\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        return tokens;\n    }\n}\n\n/**\n * Renderer\n */\nclass _Renderer {\n    options;\n    parser; // set by the parser\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    space(token) {\n        return '';\n    }\n    code({ text, lang, escaped }) {\n        const langString = (lang || '').match(/^\\S*/)?.[0];\n        const code = text.replace(/\\n$/, '') + '\\n';\n        if (!langString) {\n            return '<pre><code>'\n                + (escaped ? code : escape$1(code, true))\n                + '</code></pre>\\n';\n        }\n        return '<pre><code class=\"language-'\n            + escape$1(langString)\n            + '\">'\n            + (escaped ? code : escape$1(code, true))\n            + '</code></pre>\\n';\n    }\n    blockquote({ tokens }) {\n        const body = this.parser.parse(tokens);\n        return `<blockquote>\\n${body}</blockquote>\\n`;\n    }\n    html({ text }) {\n        return text;\n    }\n    heading({ tokens, depth }) {\n        return `<h${depth}>${this.parser.parseInline(tokens)}</h${depth}>\\n`;\n    }\n    hr(token) {\n        return '<hr>\\n';\n    }\n    list(token) {\n        const ordered = token.ordered;\n        const start = token.start;\n        let body = '';\n        for (let j = 0; j < token.items.length; j++) {\n            const item = token.items[j];\n            body += this.listitem(item);\n        }\n        const type = ordered ? 'ol' : 'ul';\n        const startAttr = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n        return '<' + type + startAttr + '>\\n' + body + '</' + type + '>\\n';\n    }\n    listitem(item) {\n        let itemBody = '';\n        if (item.task) {\n            const checkbox = this.checkbox({ checked: !!item.checked });\n            if (item.loose) {\n                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                    }\n                }\n                else {\n                    item.tokens.unshift({\n                        type: 'text',\n                        raw: checkbox + ' ',\n                        text: checkbox + ' ',\n                    });\n                }\n            }\n            else {\n                itemBody += checkbox + ' ';\n            }\n        }\n        itemBody += this.parser.parse(item.tokens, !!item.loose);\n        return `<li>${itemBody}</li>\\n`;\n    }\n    checkbox({ checked }) {\n        return '<input '\n            + (checked ? 'checked=\"\" ' : '')\n            + 'disabled=\"\" type=\"checkbox\">';\n    }\n    paragraph({ tokens }) {\n        return `<p>${this.parser.parseInline(tokens)}</p>\\n`;\n    }\n    table(token) {\n        let header = '';\n        // header\n        let cell = '';\n        for (let j = 0; j < token.header.length; j++) {\n            cell += this.tablecell(token.header[j]);\n        }\n        header += this.tablerow({ text: cell });\n        let body = '';\n        for (let j = 0; j < token.rows.length; j++) {\n            const row = token.rows[j];\n            cell = '';\n            for (let k = 0; k < row.length; k++) {\n                cell += this.tablecell(row[k]);\n            }\n            body += this.tablerow({ text: cell });\n        }\n        if (body)\n            body = `<tbody>${body}</tbody>`;\n        return '<table>\\n'\n            + '<thead>\\n'\n            + header\n            + '</thead>\\n'\n            + body\n            + '</table>\\n';\n    }\n    tablerow({ text }) {\n        return `<tr>\\n${text}</tr>\\n`;\n    }\n    tablecell(token) {\n        const content = this.parser.parseInline(token.tokens);\n        const type = token.header ? 'th' : 'td';\n        const tag = token.align\n            ? `<${type} align=\"${token.align}\">`\n            : `<${type}>`;\n        return tag + content + `</${type}>\\n`;\n    }\n    /**\n     * span level renderer\n     */\n    strong({ tokens }) {\n        return `<strong>${this.parser.parseInline(tokens)}</strong>`;\n    }\n    em({ tokens }) {\n        return `<em>${this.parser.parseInline(tokens)}</em>`;\n    }\n    codespan({ text }) {\n        return `<code>${text}</code>`;\n    }\n    br(token) {\n        return '<br>';\n    }\n    del({ tokens }) {\n        return `<del>${this.parser.parseInline(tokens)}</del>`;\n    }\n    link({ href, title, tokens }) {\n        const text = this.parser.parseInline(tokens);\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = '<a href=\"' + href + '\"';\n        if (title) {\n            out += ' title=\"' + title + '\"';\n        }\n        out += '>' + text + '</a>';\n        return out;\n    }\n    image({ href, title, text }) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = `<img src=\"${href}\" alt=\"${text}\"`;\n        if (title) {\n            out += ` title=\"${title}\"`;\n        }\n        out += '>';\n        return out;\n    }\n    text(token) {\n        return 'tokens' in token && token.tokens ? this.parser.parseInline(token.tokens) : token.text;\n    }\n}\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\nclass _TextRenderer {\n    // no need for block level renderers\n    strong({ text }) {\n        return text;\n    }\n    em({ text }) {\n        return text;\n    }\n    codespan({ text }) {\n        return text;\n    }\n    del({ text }) {\n        return text;\n    }\n    html({ text }) {\n        return text;\n    }\n    text({ text }) {\n        return text;\n    }\n    link({ text }) {\n        return '' + text;\n    }\n    image({ text }) {\n        return '' + text;\n    }\n    br() {\n        return '';\n    }\n}\n\n/**\n * Parsing & Compiling\n */\nclass _Parser {\n    options;\n    renderer;\n    textRenderer;\n    constructor(options) {\n        this.options = options || _defaults;\n        this.options.renderer = this.options.renderer || new _Renderer();\n        this.renderer = this.options.renderer;\n        this.renderer.options = this.options;\n        this.renderer.parser = this;\n        this.textRenderer = new _TextRenderer();\n    }\n    /**\n     * Static Parse Method\n     */\n    static parse(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    static parseInline(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    parse(tokens, top = true) {\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const anyToken = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[anyToken.type]) {\n                const genericToken = anyToken;\n                const ret = this.options.extensions.renderers[genericToken.type].call({ parser: this }, genericToken);\n                if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(genericToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            const token = anyToken;\n            switch (token.type) {\n                case 'space': {\n                    out += this.renderer.space(token);\n                    continue;\n                }\n                case 'hr': {\n                    out += this.renderer.hr(token);\n                    continue;\n                }\n                case 'heading': {\n                    out += this.renderer.heading(token);\n                    continue;\n                }\n                case 'code': {\n                    out += this.renderer.code(token);\n                    continue;\n                }\n                case 'table': {\n                    out += this.renderer.table(token);\n                    continue;\n                }\n                case 'blockquote': {\n                    out += this.renderer.blockquote(token);\n                    continue;\n                }\n                case 'list': {\n                    out += this.renderer.list(token);\n                    continue;\n                }\n                case 'html': {\n                    out += this.renderer.html(token);\n                    continue;\n                }\n                case 'paragraph': {\n                    out += this.renderer.paragraph(token);\n                    continue;\n                }\n                case 'text': {\n                    let textToken = token;\n                    let body = this.renderer.text(textToken);\n                    while (i + 1 < tokens.length && tokens[i + 1].type === 'text') {\n                        textToken = tokens[++i];\n                        body += '\\n' + this.renderer.text(textToken);\n                    }\n                    if (top) {\n                        out += this.renderer.paragraph({\n                            type: 'paragraph',\n                            raw: body,\n                            text: body,\n                            tokens: [{ type: 'text', raw: body, text: body }],\n                        });\n                    }\n                    else {\n                        out += body;\n                    }\n                    continue;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    parseInline(tokens, renderer) {\n        renderer = renderer || this.renderer;\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const anyToken = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[anyToken.type]) {\n                const ret = this.options.extensions.renderers[anyToken.type].call({ parser: this }, anyToken);\n                if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(anyToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            const token = anyToken;\n            switch (token.type) {\n                case 'escape': {\n                    out += renderer.text(token);\n                    break;\n                }\n                case 'html': {\n                    out += renderer.html(token);\n                    break;\n                }\n                case 'link': {\n                    out += renderer.link(token);\n                    break;\n                }\n                case 'image': {\n                    out += renderer.image(token);\n                    break;\n                }\n                case 'strong': {\n                    out += renderer.strong(token);\n                    break;\n                }\n                case 'em': {\n                    out += renderer.em(token);\n                    break;\n                }\n                case 'codespan': {\n                    out += renderer.codespan(token);\n                    break;\n                }\n                case 'br': {\n                    out += renderer.br(token);\n                    break;\n                }\n                case 'del': {\n                    out += renderer.del(token);\n                    break;\n                }\n                case 'text': {\n                    out += renderer.text(token);\n                    break;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n}\n\nclass _Hooks {\n    options;\n    block;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    static passThroughHooks = new Set([\n        'preprocess',\n        'postprocess',\n        'processAllTokens',\n    ]);\n    /**\n     * Process markdown before marked\n     */\n    preprocess(markdown) {\n        return markdown;\n    }\n    /**\n     * Process HTML after marked is finished\n     */\n    postprocess(html) {\n        return html;\n    }\n    /**\n     * Process all tokens before walk tokens\n     */\n    processAllTokens(tokens) {\n        return tokens;\n    }\n    /**\n     * Provide function to tokenize markdown\n     */\n    provideLexer() {\n        return this.block ? _Lexer.lex : _Lexer.lexInline;\n    }\n    /**\n     * Provide function to parse tokens\n     */\n    provideParser() {\n        return this.block ? _Parser.parse : _Parser.parseInline;\n    }\n}\n\nclass Marked {\n    defaults = _getDefaults();\n    options = this.setOptions;\n    parse = this.parseMarkdown(true);\n    parseInline = this.parseMarkdown(false);\n    Parser = _Parser;\n    Renderer = _Renderer;\n    TextRenderer = _TextRenderer;\n    Lexer = _Lexer;\n    Tokenizer = _Tokenizer;\n    Hooks = _Hooks;\n    constructor(...args) {\n        this.use(...args);\n    }\n    /**\n     * Run callback for every token\n     */\n    walkTokens(tokens, callback) {\n        let values = [];\n        for (const token of tokens) {\n            values = values.concat(callback.call(this, token));\n            switch (token.type) {\n                case 'table': {\n                    const tableToken = token;\n                    for (const cell of tableToken.header) {\n                        values = values.concat(this.walkTokens(cell.tokens, callback));\n                    }\n                    for (const row of tableToken.rows) {\n                        for (const cell of row) {\n                            values = values.concat(this.walkTokens(cell.tokens, callback));\n                        }\n                    }\n                    break;\n                }\n                case 'list': {\n                    const listToken = token;\n                    values = values.concat(this.walkTokens(listToken.items, callback));\n                    break;\n                }\n                default: {\n                    const genericToken = token;\n                    if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\n                        this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\n                            const tokens = genericToken[childTokens].flat(Infinity);\n                            values = values.concat(this.walkTokens(tokens, callback));\n                        });\n                    }\n                    else if (genericToken.tokens) {\n                        values = values.concat(this.walkTokens(genericToken.tokens, callback));\n                    }\n                }\n            }\n        }\n        return values;\n    }\n    use(...args) {\n        const extensions = this.defaults.extensions || { renderers: {}, childTokens: {} };\n        args.forEach((pack) => {\n            // copy options to new object\n            const opts = { ...pack };\n            // set async to true if it was set to true before\n            opts.async = this.defaults.async || opts.async || false;\n            // ==-- Parse \"addon\" extensions --== //\n            if (pack.extensions) {\n                pack.extensions.forEach((ext) => {\n                    if (!ext.name) {\n                        throw new Error('extension name required');\n                    }\n                    if ('renderer' in ext) { // Renderer extensions\n                        const prevRenderer = extensions.renderers[ext.name];\n                        if (prevRenderer) {\n                            // Replace extension with func to run new extension but fall back if false\n                            extensions.renderers[ext.name] = function (...args) {\n                                let ret = ext.renderer.apply(this, args);\n                                if (ret === false) {\n                                    ret = prevRenderer.apply(this, args);\n                                }\n                                return ret;\n                            };\n                        }\n                        else {\n                            extensions.renderers[ext.name] = ext.renderer;\n                        }\n                    }\n                    if ('tokenizer' in ext) { // Tokenizer Extensions\n                        if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {\n                            throw new Error(\"extension level must be 'block' or 'inline'\");\n                        }\n                        const extLevel = extensions[ext.level];\n                        if (extLevel) {\n                            extLevel.unshift(ext.tokenizer);\n                        }\n                        else {\n                            extensions[ext.level] = [ext.tokenizer];\n                        }\n                        if (ext.start) { // Function to check for start of token\n                            if (ext.level === 'block') {\n                                if (extensions.startBlock) {\n                                    extensions.startBlock.push(ext.start);\n                                }\n                                else {\n                                    extensions.startBlock = [ext.start];\n                                }\n                            }\n                            else if (ext.level === 'inline') {\n                                if (extensions.startInline) {\n                                    extensions.startInline.push(ext.start);\n                                }\n                                else {\n                                    extensions.startInline = [ext.start];\n                                }\n                            }\n                        }\n                    }\n                    if ('childTokens' in ext && ext.childTokens) { // Child tokens to be visited by walkTokens\n                        extensions.childTokens[ext.name] = ext.childTokens;\n                    }\n                });\n                opts.extensions = extensions;\n            }\n            // ==-- Parse \"overwrite\" extensions --== //\n            if (pack.renderer) {\n                const renderer = this.defaults.renderer || new _Renderer(this.defaults);\n                for (const prop in pack.renderer) {\n                    if (!(prop in renderer)) {\n                        throw new Error(`renderer '${prop}' does not exist`);\n                    }\n                    if (['options', 'parser'].includes(prop)) {\n                        // ignore options property\n                        continue;\n                    }\n                    const rendererProp = prop;\n                    const rendererFunc = pack.renderer[rendererProp];\n                    const prevRenderer = renderer[rendererProp];\n                    // Replace renderer with func to run extension, but fall back if false\n                    renderer[rendererProp] = (...args) => {\n                        let ret = rendererFunc.apply(renderer, args);\n                        if (ret === false) {\n                            ret = prevRenderer.apply(renderer, args);\n                        }\n                        return ret || '';\n                    };\n                }\n                opts.renderer = renderer;\n            }\n            if (pack.tokenizer) {\n                const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\n                for (const prop in pack.tokenizer) {\n                    if (!(prop in tokenizer)) {\n                        throw new Error(`tokenizer '${prop}' does not exist`);\n                    }\n                    if (['options', 'rules', 'lexer'].includes(prop)) {\n                        // ignore options, rules, and lexer properties\n                        continue;\n                    }\n                    const tokenizerProp = prop;\n                    const tokenizerFunc = pack.tokenizer[tokenizerProp];\n                    const prevTokenizer = tokenizer[tokenizerProp];\n                    // Replace tokenizer with func to run extension, but fall back if false\n                    // @ts-expect-error cannot type tokenizer function dynamically\n                    tokenizer[tokenizerProp] = (...args) => {\n                        let ret = tokenizerFunc.apply(tokenizer, args);\n                        if (ret === false) {\n                            ret = prevTokenizer.apply(tokenizer, args);\n                        }\n                        return ret;\n                    };\n                }\n                opts.tokenizer = tokenizer;\n            }\n            // ==-- Parse Hooks extensions --== //\n            if (pack.hooks) {\n                const hooks = this.defaults.hooks || new _Hooks();\n                for (const prop in pack.hooks) {\n                    if (!(prop in hooks)) {\n                        throw new Error(`hook '${prop}' does not exist`);\n                    }\n                    if (['options', 'block'].includes(prop)) {\n                        // ignore options and block properties\n                        continue;\n                    }\n                    const hooksProp = prop;\n                    const hooksFunc = pack.hooks[hooksProp];\n                    const prevHook = hooks[hooksProp];\n                    if (_Hooks.passThroughHooks.has(prop)) {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (arg) => {\n                            if (this.defaults.async) {\n                                return Promise.resolve(hooksFunc.call(hooks, arg)).then(ret => {\n                                    return prevHook.call(hooks, ret);\n                                });\n                            }\n                            const ret = hooksFunc.call(hooks, arg);\n                            return prevHook.call(hooks, ret);\n                        };\n                    }\n                    else {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (...args) => {\n                            let ret = hooksFunc.apply(hooks, args);\n                            if (ret === false) {\n                                ret = prevHook.apply(hooks, args);\n                            }\n                            return ret;\n                        };\n                    }\n                }\n                opts.hooks = hooks;\n            }\n            // ==-- Parse WalkTokens extensions --== //\n            if (pack.walkTokens) {\n                const walkTokens = this.defaults.walkTokens;\n                const packWalktokens = pack.walkTokens;\n                opts.walkTokens = function (token) {\n                    let values = [];\n                    values.push(packWalktokens.call(this, token));\n                    if (walkTokens) {\n                        values = values.concat(walkTokens.call(this, token));\n                    }\n                    return values;\n                };\n            }\n            this.defaults = { ...this.defaults, ...opts };\n        });\n        return this;\n    }\n    setOptions(opt) {\n        this.defaults = { ...this.defaults, ...opt };\n        return this;\n    }\n    lexer(src, options) {\n        return _Lexer.lex(src, options ?? this.defaults);\n    }\n    parser(tokens, options) {\n        return _Parser.parse(tokens, options ?? this.defaults);\n    }\n    parseMarkdown(blockType) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const parse = (src, options) => {\n            const origOpt = { ...options };\n            const opt = { ...this.defaults, ...origOpt };\n            const throwError = this.onError(!!opt.silent, !!opt.async);\n            // throw error if an extension set async to true but parse was called with async: false\n            if (this.defaults.async === true && origOpt.async === false) {\n                return throwError(new Error('marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise.'));\n            }\n            // throw error in case of non string input\n            if (typeof src === 'undefined' || src === null) {\n                return throwError(new Error('marked(): input parameter is undefined or null'));\n            }\n            if (typeof src !== 'string') {\n                return throwError(new Error('marked(): input parameter is of type '\n                    + Object.prototype.toString.call(src) + ', string expected'));\n            }\n            if (opt.hooks) {\n                opt.hooks.options = opt;\n                opt.hooks.block = blockType;\n            }\n            const lexer = opt.hooks ? opt.hooks.provideLexer() : (blockType ? _Lexer.lex : _Lexer.lexInline);\n            const parser = opt.hooks ? opt.hooks.provideParser() : (blockType ? _Parser.parse : _Parser.parseInline);\n            if (opt.async) {\n                return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src)\n                    .then(src => lexer(src, opt))\n                    .then(tokens => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens)\n                    .then(tokens => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(() => tokens) : tokens)\n                    .then(tokens => parser(tokens, opt))\n                    .then(html => opt.hooks ? opt.hooks.postprocess(html) : html)\n                    .catch(throwError);\n            }\n            try {\n                if (opt.hooks) {\n                    src = opt.hooks.preprocess(src);\n                }\n                let tokens = lexer(src, opt);\n                if (opt.hooks) {\n                    tokens = opt.hooks.processAllTokens(tokens);\n                }\n                if (opt.walkTokens) {\n                    this.walkTokens(tokens, opt.walkTokens);\n                }\n                let html = parser(tokens, opt);\n                if (opt.hooks) {\n                    html = opt.hooks.postprocess(html);\n                }\n                return html;\n            }\n            catch (e) {\n                return throwError(e);\n            }\n        };\n        return parse;\n    }\n    onError(silent, async) {\n        return (e) => {\n            e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n            if (silent) {\n                const msg = '<p>An error occurred:</p><pre>'\n                    + escape$1(e.message + '', true)\n                    + '</pre>';\n                if (async) {\n                    return Promise.resolve(msg);\n                }\n                return msg;\n            }\n            if (async) {\n                return Promise.reject(e);\n            }\n            throw e;\n        };\n    }\n}\n\nconst markedInstance = new Marked();\nfunction marked(src, opt) {\n    return markedInstance.parse(src, opt);\n}\n/**\n * Sets the default options.\n *\n * @param options Hash of options\n */\nmarked.options =\n    marked.setOptions = function (options) {\n        markedInstance.setOptions(options);\n        marked.defaults = markedInstance.defaults;\n        changeDefaults(marked.defaults);\n        return marked;\n    };\n/**\n * Gets the original marked default options.\n */\nmarked.getDefaults = _getDefaults;\nmarked.defaults = _defaults;\n/**\n * Use Extension\n */\nmarked.use = function (...args) {\n    markedInstance.use(...args);\n    marked.defaults = markedInstance.defaults;\n    changeDefaults(marked.defaults);\n    return marked;\n};\n/**\n * Run callback for every token\n */\nmarked.walkTokens = function (tokens, callback) {\n    return markedInstance.walkTokens(tokens, callback);\n};\n/**\n * Compiles markdown to HTML without enclosing `p` tag.\n *\n * @param src String of markdown source to be compiled\n * @param options Hash of options\n * @return String of compiled HTML\n */\nmarked.parseInline = markedInstance.parseInline;\n/**\n * Expose\n */\nmarked.Parser = _Parser;\nmarked.parser = _Parser.parse;\nmarked.Renderer = _Renderer;\nmarked.TextRenderer = _TextRenderer;\nmarked.Lexer = _Lexer;\nmarked.lexer = _Lexer.lex;\nmarked.Tokenizer = _Tokenizer;\nmarked.Hooks = _Hooks;\nmarked.parse = marked;\nconst options = marked.options;\nconst setOptions = marked.setOptions;\nconst use = marked.use;\nconst walkTokens = marked.walkTokens;\nconst parseInline = marked.parseInline;\nconst parse = marked;\nconst parser = _Parser.parse;\nconst lexer = _Lexer.lex;\n\nexport { _Hooks as Hooks, _Lexer as Lexer, Marked, _Parser as Parser, _Renderer as Renderer, _TextRenderer as TextRenderer, _Tokenizer as Tokenizer, _defaults as defaults, _getDefaults as getDefaults, lexer, marked, options, parse, parseInline, parser, setOptions, use, walkTokens };\n//# sourceMappingURL=marked.esm.js.map\n","'use strict';\n\nvar escapes = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\nvar unescapes = {\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>',\n  '&quot;': '\"',\n  '&#39;': \"'\"\n};\nvar rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\nvar runescaped = /[&<>\"']/g;\n\nfunction escapeHtmlChar (match) {\n  return escapes[match];\n}\nfunction unescapeHtmlChar (match) {\n  return unescapes[match];\n}\n\nfunction escapeHtml (text) {\n  return text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n}\n\nfunction unescapeHtml (html) {\n  return html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n}\n\nescapeHtml.options = unescapeHtml.options = {};\n\nmodule.exports = {\n  encode: escapeHtml,\n  escape: escapeHtml,\n  decode: unescapeHtml,\n  unescape: unescapeHtml,\n  version: '1.0.0-browser'\n};\n","'use strict';\n\nfunction assignment (result) {\n  var stack = Array.prototype.slice.call(arguments, 1);\n  var item;\n  var key;\n  while (stack.length) {\n    item = stack.shift();\n    for (key in item) {\n      if (item.hasOwnProperty(key)) {\n        if (Object.prototype.toString.call(result[key]) === '[object Object]') {\n          result[key] = assignment(result[key], item[key]);\n        } else {\n          result[key] = item[key];\n        }\n      }\n    }\n  }\n  return result;\n}\n\nmodule.exports = assignment;\n","'use strict';\n\nmodule.exports = function lowercase (string) {\n  return typeof string === 'string' ? string.toLowerCase() : string;\n};\n","'use strict';\n\nfunction toMap (list) {\n  return list.reduce(asKey, {});\n}\n\nfunction asKey (accumulator, item) {\n  accumulator[item] = true;\n  return accumulator;\n}\n\nmodule.exports = toMap;\n","'use strict';\n\nvar toMap = require('./toMap');\nvar uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n\nmodule.exports = {\n  uris: toMap(uris) // attributes that have an href and hence need to be sanitized\n};\n","'use strict';\n\nvar toMap = require('./toMap');\nvar voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n\nmodule.exports = {\n  voids: toMap(voids)\n};\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\nvar rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\nvar rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\nvar rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\nvar rtag = /^</;\nvar rtagend = /^<\\s*\\//;\n\nfunction createStack () {\n  var stack = [];\n  stack.lastItem = function lastItem () {\n    return stack[stack.length - 1];\n  };\n  return stack;\n}\n\nfunction parser (html, handler) {\n  var stack = createStack();\n  var last = html;\n  var chars;\n\n  while (html) {\n    parsePart();\n  }\n  parseEndTag(); // clean up any remaining tags\n\n  function parsePart () {\n    chars = true;\n    parseTag();\n\n    var same = html === last;\n    last = html;\n\n    if (same) { // discard, because it's invalid\n      html = '';\n    }\n  }\n\n  function parseTag () {\n    if (html.substr(0, 4) === '<!--') { // comments\n      parseComment();\n    } else if (rtagend.test(html)) {\n      parseEdge(rend, parseEndTag);\n    } else if (rtag.test(html)) {\n      parseEdge(rstart, parseStartTag);\n    }\n    parseTagDecode();\n  }\n\n  function parseEdge (regex, parser) {\n    var match = html.match(regex);\n    if (match) {\n      html = html.substring(match[0].length);\n      match[0].replace(regex, parser);\n      chars = false;\n    }\n  }\n\n  function parseComment () {\n    var index = html.indexOf('-->');\n    if (index >= 0) {\n      if (handler.comment) {\n        handler.comment(html.substring(4, index));\n      }\n      html = html.substring(index + 3);\n      chars = false;\n    }\n  }\n\n  function parseTagDecode () {\n    if (!chars) {\n      return;\n    }\n    var text;\n    var index = html.indexOf('<');\n    if (index >= 0) {\n      text = html.substring(0, index);\n      html = html.substring(index);\n    } else {\n      text = html;\n      html = '';\n    }\n    if (handler.chars) {\n      handler.chars(text);\n    }\n  }\n\n  function parseStartTag (tag, tagName, rest, unary) {\n    var attrs = {};\n    var low = lowercase(tagName);\n    var u = elements.voids[low] || !!unary;\n\n    rest.replace(rattrs, attrReplacer);\n\n    if (!u) {\n      stack.push(low);\n    }\n    if (handler.start) {\n      handler.start(low, attrs, u);\n    }\n\n    function attrReplacer (match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n      if (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n        attrs[name] = void 0; // attribute is like <button disabled></button>\n      } else {\n        attrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n      }\n    }\n  }\n\n  function parseEndTag (tag, tagName) {\n    var i;\n    var pos = 0;\n    var low = lowercase(tagName);\n    if (low) {\n      for (pos = stack.length - 1; pos >= 0; pos--) {\n        if (stack[pos] === low) {\n          break; // find the closest opened tag of the same type\n        }\n      }\n    }\n    if (pos >= 0) {\n      for (i = stack.length - 1; i >= pos; i--) {\n        if (handler.end) { // close all the open elements, up the stack\n          handler.end(stack[i]);\n        }\n      }\n      stack.length = pos;\n    }\n  }\n}\n\nmodule.exports = parser;\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\n\nfunction sanitizer (buffer, options) {\n  var last;\n  var context;\n  var o = options || {};\n\n  reset();\n\n  return {\n    start: start,\n    end: end,\n    chars: chars\n  };\n\n  function out (value) {\n    buffer.push(value);\n  }\n\n  function start (tag, attrs, unary) {\n    var low = lowercase(tag);\n\n    if (context.ignoring) {\n      ignore(low); return;\n    }\n    if ((o.allowedTags || []).indexOf(low) === -1) {\n      ignore(low); return;\n    }\n    if (o.filter && !o.filter({ tag: low, attrs: attrs })) {\n      ignore(low); return;\n    }\n\n    out('<');\n    out(low);\n    Object.keys(attrs).forEach(parse);\n    out(unary ? '/>' : '>');\n\n    function parse (key) {\n      var value = attrs[key];\n      var classesOk = (o.allowedClasses || {})[low] || [];\n      var attrsOk = (o.allowedAttributes || {})[low] || [];\n      var valid;\n      var lkey = lowercase(key);\n      if (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n        value = value.split(' ').filter(isValidClass).join(' ').trim();\n        valid = value.length;\n      } else {\n        valid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n      }\n      if (valid) {\n        out(' ');\n        out(key);\n        if (typeof value === 'string') {\n          out('=\"');\n          out(he.encode(value));\n          out('\"');\n        }\n      }\n      function isValidClass (className) {\n        return classesOk && classesOk.indexOf(className) !== -1;\n      }\n    }\n  }\n\n  function end (tag) {\n    var low = lowercase(tag);\n    var allowed = (o.allowedTags || []).indexOf(low) !== -1;\n    if (allowed) {\n      if (context.ignoring === false) {\n        out('</');\n        out(low);\n        out('>');\n      } else {\n        unignore(low);\n      }\n    } else {\n      unignore(low);\n    }\n  }\n\n  function testUrl (text) {\n    var start = text[0];\n    if (start === '#' || start === '/') {\n      return true;\n    }\n    var colon = text.indexOf(':');\n    if (colon === -1) {\n      return true;\n    }\n    var questionmark = text.indexOf('?');\n    if (questionmark !== -1 && colon > questionmark) {\n      return true;\n    }\n    var hash = text.indexOf('#');\n    if (hash !== -1 && colon > hash) {\n      return true;\n    }\n    return o.allowedSchemes.some(matches);\n\n    function matches (scheme) {\n      return text.indexOf(scheme + ':') === 0;\n    }\n  }\n\n  function chars (text) {\n    if (context.ignoring === false) {\n      out(o.transformText ? o.transformText(text) : text);\n    }\n  }\n\n  function ignore (tag) {\n    if (elements.voids[tag]) {\n      return;\n    }\n    if (context.ignoring === false) {\n      context = { ignoring: tag, depth: 1 };\n    } else if (context.ignoring === tag) {\n      context.depth++;\n    }\n  }\n\n  function unignore (tag) {\n    if (context.ignoring === tag) {\n      if (--context.depth <= 0) {\n        reset();\n      }\n    }\n  }\n\n  function reset () {\n    context = { ignoring: false, depth: 0 };\n  }\n}\n\nmodule.exports = sanitizer;\n","'use strict';\n\nvar he = require('he');\nvar assign = require('assignment');\nvar parser = require('./parser');\nvar sanitizer = require('./sanitizer');\nvar defaults = require('./defaults');\n\nfunction insane (html, options, strict) {\n  var buffer = [];\n  var configuration = strict === true ? options : assign({}, defaults, options);\n  var handler = sanitizer(buffer, configuration);\n\n  parser(html, handler);\n\n  return buffer.join('');\n}\n\ninsane.defaults = defaults;\nmodule.exports = insane;\n","'use strict';\n\nvar defaults = {\n  allowedAttributes: {\n    a: ['href', 'name', 'target', 'title', 'aria-label'],\n    iframe: ['allowfullscreen', 'frameborder', 'src'],\n    img: ['src', 'alt', 'title', 'aria-label']\n  },\n  allowedClasses: {},\n  allowedSchemes: ['http', 'https', 'mailto'],\n  allowedTags: [\n    'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n    'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n    'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n  ],\n  filter: null\n};\n\nmodule.exports = defaults;\n","import insane from 'insane'\n\nconst insaneOptions = {\n  allowedClasses: {},\n  // @refer CVE-2018-8495\n  // @link https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8495\n  // @link https://leucosite.com/Microsoft-Edge-RCE/\n  // @link https://medium.com/@knownsec404team/analysis-of-the-security-issues-of-url-scheme-in-pc-from-cve-2018-8495-934478a36756\n  allowedSchemes: [\n    'http',\n    'https',\n    'mailto',\n    'data', // for support base64 encoded image (安全性有待考虑)\n  ],\n  allowedTags: [\n    'a',\n    'abbr',\n    'article',\n    'b',\n    'blockquote',\n    'br',\n    'caption',\n    'code',\n    'del',\n    'details',\n    'div',\n    'em',\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'hr',\n    'i',\n    'img',\n    'ins',\n    'kbd',\n    'li',\n    'main',\n    'mark',\n    'ol',\n    'p',\n    'pre',\n    'section',\n    'span',\n    'strike',\n    'strong',\n    'sub',\n    'summary',\n    'sup',\n    'table',\n    'tbody',\n    'td',\n    'th',\n    'thead',\n    'tr',\n    'u',\n    'ul',\n  ],\n  allowedAttributes: {\n    '*': ['title', 'accesskey'],\n    a: ['href', 'name', 'target', 'aria-label', 'rel'],\n    img: ['src', 'alt', 'title', 'atk-emoticon', 'aria-label', 'data-src', 'class', 'loading'],\n    // for code highlight\n    code: ['class'],\n    span: ['class', 'style'],\n  },\n  filter: (node) => {\n    // class whitelist\n    const allowed = [\n      ['code', /^hljs\\W+language-(.*)$/],\n      ['span', /^(hljs-.*)$/],\n      ['img', /^lazyload$/],\n    ]\n    allowed.forEach(([tag, reg]) => {\n      if (node.tag === tag && !!node.attrs.class && !(reg as RegExp).test(node.attrs.class)) {\n        delete node.attrs.class\n      }\n    })\n\n    // allow <span> set color sty\n    if (\n      node.tag === 'span' &&\n      !!node.attrs.style &&\n      !/^color:(\\W+)?#[0-9a-f]{3,6};?$/i.test(node.attrs.style)\n    ) {\n      delete node.attrs.style\n    }\n\n    return true\n  },\n}\n\nexport function sanitize(content: string): string {\n  // @link https://github.com/markedjs/marked/discussions/1232\n  // @link https://gist.github.com/lionel-rowe/bb384465ba4e4c81a9c8dada84167225\n  return insane(content, insaneOptions)\n}\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.hanabi = factory());\n}(this, (function () { 'use strict';\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar index$1 = createCommonjsModule(function (module) {\n'use strict';\n\nvar comment = module.exports = function () {\n\treturn new RegExp('(?:' + comment.line().source + ')|(?:' + comment.block().source + ')', 'gm');\n};\n\ncomment.line = function () {\n\treturn /(?:^|\\s)\\/\\/(.+?)$/gm;\n};\n\ncomment.block = function () {\n\treturn /\\/\\*([\\S\\s]*?)\\*\\//gm;\n};\n});\n\nvar defaultColors = ['23AC69', '91C132', 'F19726', 'E8552D', '1AAB8E', 'E1147F', '2980C1', '1BA1E6', '9FA0A0', 'F19726', 'E30B20', 'E30B20', 'A3338B'];\n\nvar index = function (input, ref) {\n  if ( ref === void 0 ) ref = {};\n  var colors = ref.colors; if ( colors === void 0 ) colors = defaultColors;\n\n  var index = 0;\n  var cache = {};\n  var wordRe = /[\\u4E00-\\u9FFF\\u3400-\\u4dbf\\uf900-\\ufaff\\u3040-\\u309f\\uac00-\\ud7af\\u0400-\\u04FF]+|\\w+/;\n  var leftAngleRe = /</;\n\n  var re = new RegExp((\"(\" + (wordRe.source) + \"|\" + (leftAngleRe.source) + \")|(\" + (index$1().source) + \")\"), 'gmi');\n  return input\n  .replace(re, function (m, word, cm) {\n    if (cm) {\n      return toComment(cm)\n    }\n\n    if (word === '<') {\n      return '&lt;'\n    }\n    var color;\n    if (cache[word]) {\n      color = cache[word];\n    } else {\n      color = colors[index];\n      cache[word] = color;\n    }\n\n    var out = \"<span style=\\\"color: #\" + color + \"\\\">\" + word + \"</span>\";\n    index = ++index % colors.length;\n    return out\n  })\n};\n\nfunction toComment(cm) {\n  return (\"<span style=\\\"color: slategray\\\">\" + cm + \"</span>\")\n}\n\nreturn index;\n\n})));\n","import hanabi from 'hanabi'\n\nexport function renderCode(code: string) {\n  return hanabi(code)\n}\n","import { marked, Tokens } from 'marked'\nimport { renderCode } from './highlight'\nimport type { ArtalkConfig } from '@/types'\n\nexport interface RendererOptions {\n  imgLazyLoad: ArtalkConfig['imgLazyLoad']\n}\n\nexport function getRenderer(options: RendererOptions) {\n  const renderer = new marked.Renderer()\n  renderer.link = markedLinkRenderer(renderer, renderer.link)\n  renderer.code = markedCodeRenderer()\n  renderer.image = markedImageRenderer(renderer, renderer.image, options)\n  return renderer\n}\n\nconst markedLinkRenderer =\n  (renderer: any, orgLinkRenderer: (args: Tokens.Link) => string) => (args: Tokens.Link) => {\n    const getLinkOrigin = (link: string) => {\n      try {\n        return new URL(link).origin\n      } catch {\n        return ''\n      }\n    }\n    const isSameOriginLink = getLinkOrigin(args.href) === window.location.origin\n    const html = orgLinkRenderer.call(renderer, args)\n    return html.replace(\n      /^<a /,\n      `<a target=\"_blank\" ${!isSameOriginLink ? `rel=\"noreferrer noopener nofollow\"` : ''} `,\n    )\n  }\n\nconst markedCodeRenderer =\n  () =>\n  ({ lang, text }: Tokens.Code): string => {\n    // Colorize the block only if the language is known to highlight.js\n    const realLang = !lang ? 'plaintext' : lang\n    let colorized = text\n    if ((window as any).hljs) {\n      if (realLang && (window as any).hljs.getLanguage(realLang)) {\n        colorized = (window as any).hljs.highlight(realLang, text).value\n      }\n    } else {\n      colorized = renderCode(text)\n    }\n\n    return (\n      `<pre rel=\"${realLang}\">\\n` +\n      `<code class=\"hljs language-${realLang}\">${colorized.replace(/&amp;/g, '&')}</code>\\n` +\n      `</pre>`\n    )\n  }\n\nconst markedImageRenderer =\n  (\n    renderer: any,\n    orgImageRenderer: (args: Tokens.Image) => string,\n    { imgLazyLoad }: RendererOptions,\n  ) =>\n  (args: Tokens.Image): string => {\n    const html = orgImageRenderer.call(renderer, args)\n    if (!imgLazyLoad) return html\n    if (imgLazyLoad === 'native' || (imgLazyLoad as any) === true)\n      return html.replace(/^<img /, '<img class=\"lazyload\" loading=\"lazy\" ')\n    if (imgLazyLoad === 'data-src')\n      return html.replace(/^<img /, '<img class=\"lazyload\" ').replace('src=', 'data-src=')\n    return html\n  }\n","import { Marked } from 'marked'\nimport type { MarkedOptions } from 'marked'\n\nimport { sanitize } from './sanitizer'\nimport { renderCode } from './highlight'\nimport { getRenderer } from './marked-renderer'\nimport type { ArtalkConfig } from '@/types'\n\ntype Replacer = (raw: string) => string\n\nlet instance: Marked | undefined\nlet replacers: Replacer[] = []\n\nconst markedOptions: MarkedOptions = {\n  gfm: true,\n  breaks: true,\n  async: false,\n}\n\n/** Get Marked instance */\nexport function getInstance() {\n  return instance\n}\n\nexport function setReplacers(arr: Replacer[]) {\n  replacers = arr\n}\n\nexport interface MarkedInitOptions {\n  markedOptions: ArtalkConfig['markedOptions']\n  imgLazyLoad: ArtalkConfig['imgLazyLoad']\n}\n\n/** 初始化 marked */\nexport function initMarked(options: MarkedInitOptions) {\n  try {\n    if (!Marked.name) return\n  } catch {\n    return\n  }\n\n  // @see https://github.com/markedjs/marked/blob/4afb228d956a415624c4e5554bb8f25d047676fe/src/Tokenizer.js#L329\n  const marked = new Marked()\n  marked.setOptions({\n    renderer: getRenderer({\n      imgLazyLoad: options.imgLazyLoad,\n    }),\n    ...markedOptions,\n    ...options.markedOptions,\n  })\n\n  instance = marked\n}\n\n/** 解析 markdown */\nexport default function marked(src: string): string {\n  let markedContent = getInstance()?.parse(src) as string\n  if (!markedContent) {\n    // 无 Markdown 模式简单处理\n    markedContent = simpleMarked(src)\n  }\n\n  let dest = sanitize(markedContent)\n\n  // 内容替换器\n  replacers.forEach((replacer) => {\n    if (typeof replacer === 'function') dest = replacer(dest)\n  })\n\n  return dest\n}\n\nfunction simpleMarked(src: string) {\n  return (\n    src\n      // .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(\n        /```\\s*([^]+?.*?[^]+?[^]+?)```/g,\n        (_, code) => `<pre><code>${renderCode(code)}</code></pre>`,\n      )\n      // .replace(/`([^`]+?)`/g, '<code>$1</code>')\n      .replace(/!\\[(.*?)\\]\\((.*?)\\)/g, (_, alt, imgSrc) => `<img src=\"${imgSrc}\" alt=\"${alt}\" />`)\n      .replace(\n        /\\[(.*?)\\]\\((.*?)\\)/g,\n        (_, text, link) => `<a href=\"${link}\" target=\"_blank\">${text}</a>`,\n      )\n      .replace(/\\n/g, '<br>')\n  )\n}\n","/**\n * Performs a deep merge of objects and returns new object.\n * Does not modify objects (immutable) and merges arrays via concatenation.\n *\n * @param objects - Objects to merge\n * @returns New object with merged key/values\n */\nexport function mergeDeep<T>(...objects: any[]): T {\n  const isObject = (obj: any) => obj && typeof obj === 'object' && obj.constructor === Object\n\n  return objects.reduce((prev, obj) => {\n    Object.keys(obj ?? {}).forEach((key) => {\n      // Avoid prototype pollution\n      if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n        return\n      }\n\n      const pVal = prev[key]\n      const oVal = obj[key]\n\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        prev[key] = pVal.concat(...oVal)\n      } else if (isObject(pVal) && isObject(oVal)) {\n        prev[key] = mergeDeep(pVal, oVal)\n      } else {\n        prev[key] = oVal\n      }\n    })\n\n    return prev\n  }, {})\n}\n","import EventManager from './lib/event-manager'\nimport type {\n  NotifyData,\n  PageData,\n  CommentData,\n  DataManagerApi,\n  ListFetchParams,\n  ListLastFetchData,\n  EventPayloadMap,\n} from '@/types'\n\nexport class DataManager implements DataManagerApi {\n  private loading: boolean = false\n  private listLastFetch?: ListLastFetchData\n  private comments: CommentData[] = [] // Note: 无层级结构 + 无须排列\n  private notifies: NotifyData[] = []\n  private page?: PageData\n\n  constructor(protected events: EventManager<EventPayloadMap>) {}\n\n  getLoading() {\n    return this.loading\n  }\n\n  setLoading(val: boolean) {\n    this.loading = val\n  }\n\n  getListLastFetch() {\n    return this.listLastFetch\n  }\n\n  setListLastFetch(val: ListLastFetchData) {\n    this.listLastFetch = val\n  }\n\n  // -------------------------------------------------------------------\n  //  Comments\n  // -------------------------------------------------------------------\n  getComments() {\n    return this.comments\n  }\n\n  fetchComments(params: Partial<ListFetchParams>) {\n    this.events.trigger('list-fetch', params)\n  }\n\n  findComment(id: number) {\n    return this.comments.find((c) => c.id === id)\n  }\n\n  clearComments() {\n    this.comments = []\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  loadComments(partialComments: CommentData[]) {\n    this.events.trigger('list-load', partialComments)\n\n    this.comments.push(...partialComments)\n\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  insertComment(comment: CommentData) {\n    this.comments.push(comment)\n\n    this.events.trigger('comment-inserted', comment)\n    this.events.trigger('list-loaded', this.comments) // list-loaded should always keep the last\n  }\n\n  updateComment(comment: CommentData) {\n    this.comments = this.comments.map((c) => {\n      if (c.id === comment.id) return comment\n      return c\n    })\n\n    this.events.trigger('comment-updated', comment)\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  deleteComment(id: number) {\n    const comment = this.comments.find((c) => c.id === id)\n    if (!comment) throw new Error(`Comment ${id} not found`)\n    this.comments = this.comments.filter((c) => c.id !== id)\n\n    this.events.trigger('comment-deleted', comment)\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  // -------------------------------------------------------------------\n  //  Notifies\n  // -------------------------------------------------------------------\n  getNotifies() {\n    return this.notifies\n  }\n\n  updateNotifies(notifies: NotifyData[]) {\n    this.notifies = notifies\n\n    this.events.trigger('notifies-updated', this.notifies)\n  }\n\n  // -------------------------------------------------------------------\n  // Page\n  // -------------------------------------------------------------------\n  getPage() {\n    return this.page\n  }\n\n  updatePage(pageData: PageData) {\n    this.page = pageData\n\n    this.events.trigger('page-loaded', pageData)\n  }\n}\n","export function createElement<E extends HTMLElement = HTMLElement>(htmlStr: string = ''): E {\n  const div = document.createElement('div')\n  div.innerHTML = htmlStr.trim()\n  return (div.firstElementChild || div) as E\n}\n\nexport function getHeight(el: HTMLElement): number {\n  const num = parseFloat(getComputedStyle(el, null).height.replace('px', ''))\n  return num || 0 // NaN -> 0\n}\n\nexport function htmlEncode(str: string) {\n  const temp = document.createElement('div')\n  temp.innerText = str\n  const output = temp.innerHTML\n  return output\n}\n\nexport function htmlDecode(str: string) {\n  const temp = document.createElement('div')\n  temp.innerHTML = str\n  const output = temp.innerText\n  return output\n}\n\nexport function getQueryParam(name: string) {\n  const match = RegExp(`[?&]${name}=([^&]*)`).exec(window.location.search)\n  return match && decodeURIComponent(match[1].replace(/\\+/g, ' '))\n}\n\nexport function getOffset(el: HTMLElement, relativeTo?: HTMLElement) {\n  const getOffsetRecursive = (element: HTMLElement): { top: number; left: number } => {\n    const rect = element.getBoundingClientRect()\n    const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop\n    return {\n      top: rect.top + scrollTop,\n      left: rect.left + scrollLeft,\n    }\n  }\n\n  const elOffset = getOffsetRecursive(el)\n  if (!relativeTo) return elOffset\n\n  const relativeToOffset = getOffsetRecursive(relativeTo)\n\n  return {\n    top: elOffset.top - relativeToOffset.top,\n    left: elOffset.left - relativeToOffset.left,\n  }\n}\n\nexport function padWithZeros(vNumber: number, width: number) {\n  let numAsString = vNumber.toString()\n  while (numAsString.length < width) {\n    numAsString = `0${numAsString}`\n  }\n  return numAsString\n}\n\nexport function dateFormat(date: Date) {\n  const vDay = padWithZeros(date.getDate(), 2)\n  const vMonth = padWithZeros(date.getMonth() + 1, 2)\n  const vYear = padWithZeros(date.getFullYear(), 2)\n  // var vHour = padWithZeros(date.getHours(), 2);\n  // var vMinute = padWithZeros(date.getMinutes(), 2);\n  // var vSecond = padWithZeros(date.getSeconds(), 2);\n  return `${vYear}-${vMonth}-${vDay}`\n}\n\nexport function timeAgo(date: Date, $t = (n: any) => n) {\n  try {\n    const oldTime = date.getTime()\n    const currTime = new Date().getTime()\n    const diffValue = currTime - oldTime\n\n    const days = Math.floor(diffValue / (24 * 3600 * 1000))\n    if (days === 0) {\n      // 计算相差小时数\n      const leave1 = diffValue % (24 * 3600 * 1000) // 计算天数后剩余的毫秒数\n      const hours = Math.floor(leave1 / (3600 * 1000))\n      if (hours === 0) {\n        // 计算相差分钟数\n        const leave2 = leave1 % (3600 * 1000) // 计算小时数后剩余的毫秒数\n        const minutes = Math.floor(leave2 / (60 * 1000))\n        if (minutes === 0) {\n          // 计算相差秒数\n          const leave3 = leave2 % (60 * 1000) // 计算分钟数后剩余的毫秒数\n          const seconds = Math.round(leave3 / 1000)\n          if (seconds < 10) return $t('now')\n          return `${seconds} ${$t('seconds')}`\n        }\n        return `${minutes} ${$t('minutes')}`\n      }\n      return `${hours} ${$t('hours')}`\n    }\n    if (days < 0) return $t('now')\n\n    if (days < 8) {\n      return `${days} ${$t('days')}`\n    }\n\n    return dateFormat(date)\n  } catch (error) {\n    console.error(error)\n    return ' - '\n  }\n}\n\nexport function getGravatarURL(opts: { params: string; mirror: string; emailHash: string }) {\n  return `${opts.mirror.replace(/\\/$/, '')}/${opts.emailHash}?${opts.params.replace(/^\\?/, '')}`\n}\n\nexport function sleep(ms: number) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms)\n  })\n}\n\n/** 版本号比较（a < b :-1 | 0 | b < a :1） */\nexport function versionCompare(a: string, b: string) {\n  const pa = a.split('.')\n  const pb = b.split('.')\n  for (let i = 0; i < 3; i++) {\n    const na = Number(pa[i])\n    const nb = Number(pb[i])\n    if (na > nb) return 1\n    if (nb > na) return -1\n    if (!Number.isNaN(na) && Number.isNaN(nb)) return 1\n    if (Number.isNaN(na) && !Number.isNaN(nb)) return -1\n  }\n  return 0\n}\n\n/** 获取修正后的 UserAgent */\nexport async function getCorrectUserAgent() {\n  const uaRaw = navigator.userAgent\n  if (!(navigator as any).userAgentData || !(navigator as any).userAgentData.getHighEntropyValues) {\n    return uaRaw\n  }\n\n  // @link https://web.dev/migrate-to-ua-ch/\n  // @link https://web.dev/user-agent-client-hints/\n  const uaData = (navigator as any).userAgentData\n  let uaGot: any = null\n  try {\n    uaGot = await uaData.getHighEntropyValues(['platformVersion'])\n  } catch (err) {\n    console.error(err)\n    return uaRaw\n  }\n  const majorPlatformVersion = Number(uaGot.platformVersion.split('.')[0])\n\n  if (uaData.platform === 'Windows') {\n    if (majorPlatformVersion >= 13) {\n      // @link https://docs.microsoft.com/en-us/microsoft-edge/web-platform/how-to-detect-win11\n      // @date 2022-4-29\n      // Win 11 样本：\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36\"\n      return uaRaw.replace(/Windows NT 10.0/, 'Windows NT 11.0')\n    }\n  }\n  if (uaData.platform === 'macOS') {\n    if (majorPlatformVersion >= 11) {\n      // 11 => BigSur\n      // @date 2022-4-29\n      // (Intel Chip) macOS 12.3 样本：\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36\"\n      // (Arm Chip) macOS 样本：\"Mozilla/5.0 (Macintosh; ARM Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.2 Safari/605.1.15\"\n      return uaRaw.replace(\n        /(Mac OS X \\d+_\\d+_\\d+|Mac OS X)/,\n        `Mac OS X ${uaGot.platformVersion.replace(/\\./g, '_')}`,\n      )\n    }\n  }\n\n  return uaRaw\n}\n\n/** 是否为完整的 URL */\nexport function isValidURL(urlRaw: string) {\n  // @link https://www.rfc-editor.org/rfc/rfc3986\n  let url: URL\n  try {\n    url = new URL(urlRaw)\n  } catch (_) {\n    return false\n  }\n  return url.protocol === 'http:' || url.protocol === 'https:'\n}\n\n/** 获取基于 conf.server 的 URL */\nexport function getURLBasedOnApi(opts: { base: string; path: string }) {\n  return getURLBasedOn(opts.base, opts.path)\n}\n\n/** 获取基于某个 baseURL 的 URL */\nexport function getURLBasedOn(baseURL: string, path: string) {\n  return `${baseURL.replace(/\\/$/, '')}/${path.replace(/^\\//, '')}`\n}\n","const en = {\n  /* Editor */\n  placeholder: 'Leave a comment',\n  noComment: 'No Comment',\n  send: 'Send',\n  signIn: 'Sign in',\n  signUp: 'Sign up',\n  save: 'Save',\n  nick: 'Nickname',\n  email: 'Email',\n  link: 'Website',\n  emoticon: 'Emoji',\n  preview: 'Preview',\n  uploadImage: 'Upload Image',\n  uploadFail: 'Upload Failed',\n  commentFail: 'Failed to comment',\n  restoredMsg: 'Content has been restored',\n  onlyAdminCanReply: 'Only admin can reply',\n  uploadLoginMsg: 'Please fill in your name and email to upload',\n\n  /* List */\n  counter: '{count} Comments',\n  sortLatest: 'Latest',\n  sortOldest: 'Oldest',\n  sortBest: 'Best',\n  sortAuthor: 'Author',\n  openComment: 'Open Comment',\n  closeComment: 'Close Comment',\n  listLoadFailMsg: 'Failed to load comments',\n  listRetry: 'Retry',\n  loadMore: 'Load More',\n\n  /* Comment */\n  admin: 'Admin',\n  reply: 'Reply',\n  voteUp: 'Up',\n  voteDown: 'Down',\n  voteFail: 'Vote Failed',\n  readMore: 'Read More',\n  actionConfirm: 'Confirm',\n  collapse: 'Collapse',\n  collapsed: 'Collapsed',\n  collapsedMsg: 'This comment has been collapsed',\n  expand: 'Expand',\n  approved: 'Approved',\n  pending: 'Pending',\n  pendingMsg: 'Pending, visible only to commenter.',\n  edit: 'Edit',\n  editCancel: 'Cancel Edit',\n  delete: 'Delete',\n  deleteConfirm: 'Confirm',\n  pin: 'Pin',\n  unpin: 'Unpin',\n\n  /* Time */\n  seconds: 'seconds ago',\n  minutes: 'minutes ago',\n  hours: 'hours ago',\n  days: 'days ago',\n  now: 'just now',\n\n  /* Checker */\n  adminCheck: 'Enter admin password:',\n  captchaCheck: 'Enter the CAPTCHA to continue:',\n  confirm: 'Confirm',\n  cancel: 'Cancel',\n\n  /* Sidebar */\n  msgCenter: 'Messages',\n  ctrlCenter: 'Dashboard',\n\n  /* Auth */\n  userProfile: 'Profile',\n  noAccountPrompt: \"Don't have an account?\",\n  haveAccountPrompt: 'Already have an account?',\n  forgetPassword: 'Forget Password',\n  resetPassword: 'Reset Password',\n  changePassword: 'Change Password',\n  confirmPassword: 'Confirm Password',\n  passwordMismatch: 'Passwords do not match',\n  verificationCode: 'Verification Code',\n  verifySend: 'Send Code',\n  verifyResend: 'Resend',\n  waitSeconds: 'Wait {seconds}s',\n  emailVerified: 'Email has been verified',\n  password: 'Password',\n  username: 'Username',\n  nextStep: 'Next Step',\n  skipVerify: 'Skip verification',\n  logoutConfirm: 'Are you sure to logout?',\n  accountMergeNotice: 'Your email has multiple accounts with different id.',\n  accountMergeSelectOne: 'Please select one you want to merge all the data into it.',\n  accountMergeConfirm: 'All data will be merged into one account, the id is {id}.',\n  dismiss: 'Dismiss',\n  merge: 'Merge',\n\n  /* General */\n  frontend: 'Frontend',\n  backend: 'Backend',\n  loading: 'Loading',\n  loadFail: 'Load Failed',\n  editing: 'Editing',\n  editFail: 'Edit Failed',\n  deleting: 'Deleting',\n  deleteFail: 'Delete Failed',\n  reqGot: 'Request got',\n  reqAborted: 'Request timed out or terminated unexpectedly',\n  updateMsg: 'Please update Artalk {name} to get the best experience!',\n  currentVersion: 'Current Version',\n  ignore: 'Ignore',\n  open: 'Open',\n  openName: 'Open {name}',\n}\n\nexport type I18n = typeof en\nexport type I18nKeys = keyof I18n\n\nexport default en\n","import type { I18n } from '.'\n\nexport const GLOBAL_LOCALES_KEY = 'ArtalkI18n'\n\nexport function defineLocaleExternal(lang: string, locale: I18n, aliases?: string[]) {\n  if (!window[GLOBAL_LOCALES_KEY]) window[GLOBAL_LOCALES_KEY] = {}\n  window[GLOBAL_LOCALES_KEY][lang] = locale\n  if (aliases)\n    aliases.forEach((l) => {\n      window[GLOBAL_LOCALES_KEY][l] = locale\n    })\n  return locale\n}\n","import * as Utils from '../lib/utils'\nimport en, { I18n, I18nKeys } from './en'\nimport zhCN from './zh-CN'\nimport { GLOBAL_LOCALES_KEY } from './external'\n\nexport type * from './en'\n\n// @note the key of language is followed by `ISO 639`\n// https://en.wikipedia.org/wiki/ISO_639\n// https://datatracker.ietf.org/doc/html/rfc5646#section-2.1\nexport const internal = {\n  en,\n  'en-US': en,\n  'zh-CN': zhCN,\n}\n\n/**\n * find a locale object by language name\n */\nexport function findLocaleSet(lang: string): I18n {\n  // normalize a key of language to `ISO 639`\n  lang = lang.replace(\n    /^([a-zA-Z]+)(-[a-zA-Z]+)?$/,\n    (_, p1: string, p2: string) => p1.toLowerCase() + (p2 || '').toUpperCase(),\n  )\n\n  // internal finding\n  if (internal[lang]) {\n    return internal[lang]\n  }\n\n  // external finding\n  if (window[GLOBAL_LOCALES_KEY] && window[GLOBAL_LOCALES_KEY][lang]) {\n    return window[GLOBAL_LOCALES_KEY][lang]\n  }\n\n  // case when not found:\n  // use `en` by default\n  return internal.en\n}\n\n/**\n * System locale setting\n */\nlet LocaleConf: I18n | string = 'en'\nlet LocaleDict: I18n = findLocaleSet(LocaleConf) // en by default\n\n/**\n * Set system locale\n */\nexport function setLocale(locale: I18n | string) {\n  if (locale === LocaleConf) return\n  LocaleConf = locale\n  LocaleDict = typeof locale === 'string' ? findLocaleSet(locale) : locale\n}\n\n/**\n * Get an i18n message by key\n */\nexport function t(key: I18nKeys, args: { [key: string]: string } = {}) {\n  let str = LocaleDict?.[key] || key\n  str = str.replace(/\\{\\s*(\\w+?)\\s*\\}/g, (_, token) => args[token] || '')\n\n  return Utils.htmlEncode(str)\n}\n\nexport default t\n","import type { I18n } from '.'\n\nconst zhCN: I18n = {\n  /* Editor */\n  placeholder: '键入内容...',\n  noComment: '「此时无声胜有声」',\n  send: '发送',\n  signIn: '登录',\n  signUp: '注册',\n  save: '保存',\n  nick: '昵称',\n  email: '邮箱',\n  link: '网址',\n  emoticon: '表情',\n  preview: '预览',\n  uploadImage: '上传图片',\n  uploadFail: '上传失败',\n  commentFail: '评论失败',\n  restoredMsg: '内容已自动恢复',\n  onlyAdminCanReply: '仅管理员可评论',\n  uploadLoginMsg: '填入你的名字邮箱才能上传哦',\n\n  /* List */\n  counter: '{count} 条评论',\n  sortLatest: '最新',\n  sortOldest: '最早',\n  sortBest: '最热',\n  sortAuthor: '作者',\n  openComment: '打开评论',\n  closeComment: '关闭评论',\n  listLoadFailMsg: '无法获取评论列表数据',\n  listRetry: '点击重新获取',\n  loadMore: '加载更多',\n\n  /* Comment */\n  admin: '管理员',\n  reply: '回复',\n  voteUp: '赞同',\n  voteDown: '反对',\n  voteFail: '投票失败',\n  readMore: '阅读更多',\n  actionConfirm: '确认操作',\n  collapse: '折叠',\n  collapsed: '已折叠',\n  collapsedMsg: '该评论已被系统或管理员折叠',\n  expand: '展开',\n  approved: '已审',\n  pending: '待审',\n  pendingMsg: '审核中，仅本人可见。',\n  edit: '编辑',\n  editCancel: '取消编辑',\n  delete: '删除',\n  deleteConfirm: '确认删除',\n  pin: '置顶',\n  unpin: '取消置顶',\n\n  /* Time */\n  seconds: '秒前',\n  minutes: '分钟前',\n  hours: '小时前',\n  days: '天前',\n  now: '刚刚',\n\n  /* Checker */\n  adminCheck: '键入密码来验证管理员身份：',\n  captchaCheck: '键入验证码继续：',\n  confirm: '确认',\n  cancel: '取消',\n\n  /* Sidebar */\n  msgCenter: '通知中心',\n  ctrlCenter: '控制中心',\n\n  /* Auth */\n  userProfile: '个人资料',\n  noAccountPrompt: '没有账号？',\n  haveAccountPrompt: '已有账号？',\n  forgetPassword: '忘记密码',\n  resetPassword: '重置密码',\n  changePassword: '修改密码',\n  confirmPassword: '确认密码',\n  passwordMismatch: '两次输入的密码不一致',\n  verificationCode: '验证码',\n  verifySend: '发送验证码',\n  verifyResend: '重新发送',\n  waitSeconds: '等待 {seconds}秒',\n  emailVerified: '邮箱已验证',\n  password: '密码',\n  username: '用户名',\n  nextStep: '下一步',\n  skipVerify: '跳过验证',\n  logoutConfirm: '确定要退出登录吗？',\n  accountMergeNotice: '您的电子邮件下有多个不同 ID 的账户。',\n  accountMergeSelectOne: '请选择将所有数据合并到其中的一个。',\n  accountMergeConfirm: '所有数据将合并到 ID 为 {id} 的账户中。',\n  dismiss: '忽略',\n  merge: '合并',\n\n  /* General */\n  frontend: '前端',\n  backend: '后端',\n  loading: '加载中',\n  loadFail: '加载失败',\n  editing: '修改中',\n  editFail: '修改失败',\n  deleting: '删除中',\n  deleteFail: '删除失败',\n  reqGot: '请求响应',\n  reqAborted: '请求超时或意外终止',\n  updateMsg: '请更新 Artalk {name} 以获得更好的体验！',\n  currentVersion: '当前版本',\n  ignore: '忽略',\n  open: '打开',\n  openName: '打开{name}',\n}\n\nexport default zhCN\n","export type EventHandler<T> = (payload: T) => void\nexport interface Event<PayloadMap, K extends keyof PayloadMap = keyof PayloadMap>\n  extends EventOptions {\n  name: K\n  handler: EventHandler<PayloadMap[K]>\n}\nexport interface EventOptions {\n  once?: boolean\n}\n\nexport interface EventManagerFuncs<PayloadMap> {\n  on<K extends keyof PayloadMap>(\n    name: K,\n    handler: EventHandler<PayloadMap[K]>,\n    opts?: EventOptions,\n  ): void\n  off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>): void\n  trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]): void\n}\n\nexport default class EventManager<PayloadMap> implements EventManagerFuncs<PayloadMap> {\n  private events: Event<PayloadMap>[] = []\n\n  /**\n   * Add an event listener for a specific event name\n   */\n  public on<K extends keyof PayloadMap>(\n    name: K,\n    handler: EventHandler<PayloadMap[K]>,\n    opts: EventOptions = {},\n  ) {\n    this.events.push({\n      name,\n      handler: handler as EventHandler<PayloadMap[keyof PayloadMap]>,\n      ...opts,\n    })\n  }\n\n  /**\n   * Remove an event listener for a specific event name and handler\n   */\n  public off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>) {\n    if (!handler) return // not allow remove all events with same name\n    this.events = this.events.filter((evt) => !(evt.name === name && evt.handler === handler))\n  }\n\n  /**\n   * Trigger an event with an optional payload\n   */\n  public trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]) {\n    this.events\n      .slice(0) // make a copy, in case listeners are removed while iterating\n      .filter((evt) => evt.name === name && typeof evt.handler === 'function')\n      .forEach((evt) => {\n        if (evt.once) this.off(name, evt.handler)\n        evt.handler(payload!)\n      })\n  }\n}\n","import type { ArtalkConfig } from '@/types'\n\nconst defaults: ArtalkConfig = {\n  el: '',\n  pageKey: '',\n  pageTitle: '',\n  server: '',\n  site: '',\n\n  placeholder: '',\n  noComment: '',\n  sendBtn: '',\n  darkMode: false,\n  editorTravel: true,\n\n  flatMode: 'auto',\n  nestMax: 2,\n  nestSort: 'DATE_ASC',\n\n  emoticons: 'https://cdn.jsdelivr.net/gh/ArtalkJS/Emoticons/grps/default.json',\n\n  vote: true,\n  voteDown: false,\n  uaBadge: true,\n  listSort: true,\n  preview: true,\n  countEl: '.artalk-comment-count',\n  pvEl: '.artalk-pv-count',\n  statPageKeyAttr: 'data-page-key',\n\n  gravatar: {\n    mirror: 'https://www.gravatar.com/avatar/',\n    params: 'sha256=1&d=mp&s=240',\n  },\n\n  pagination: {\n    pageSize: 20,\n    readMore: true,\n    autoLoad: true,\n  },\n\n  heightLimit: {\n    content: 300,\n    children: 400,\n    scrollable: false,\n  },\n\n  imgUpload: true,\n  reqTimeout: 15000,\n  versionCheck: true,\n  useBackendConf: true,\n\n  locale: 'en',\n}\n\nif (ARTALK_LITE) {\n  defaults.vote = false\n  defaults.uaBadge = false\n  defaults.emoticons = false\n  defaults.preview = false\n}\n\nexport default defaults\n","import type { ApiOptions } from './api/options'\nimport { mergeDeep } from './lib/merge-deep'\nimport { createApiHandlers } from './api'\nimport Defaults from './defaults'\nimport type { ArtalkConfig, ContextApi } from '@/types'\n\n/**\n * Handle the custom config which is provided by the user\n *\n * @param customConf - The custom config object which is provided by the user\n * @param full - If `full` is `true`, the return value will be the complete config for Artalk instance creation\n * @returns The config for Artalk instance creation\n */\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full: true): ArtalkConfig\nexport function handelCustomConf(\n  customConf: Partial<ArtalkConfig>,\n  full?: false,\n): Partial<ArtalkConfig>\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full = false) {\n  // 合并默认配置\n  const conf: Partial<ArtalkConfig> = full ? mergeDeep(Defaults, customConf) : customConf\n\n  // 绑定元素\n  if (conf.el && typeof conf.el === 'string') {\n    try {\n      const findEl = document.querySelector<HTMLElement>(conf.el)\n      if (!findEl) throw Error(`Target element \"${conf.el}\" was not found.`)\n      conf.el = findEl\n    } catch (e) {\n      console.error(e)\n      throw new Error('Please check your Artalk `el` config.')\n    }\n  }\n\n  // 默认 pageKey\n  if (conf.pageKey === '') conf.pageKey = `${window.location.pathname}` // @link http://bl.ocks.org/abernier/3070589\n\n  // 默认 pageTitle\n  if (conf.pageTitle === '') conf.pageTitle = `${document.title}`\n\n  // 服务器配置\n  if (conf.server) conf.server = conf.server.replace(/\\/$/, '').replace(/\\/api\\/?$/, '')\n\n  // 自适应语言\n  if (conf.locale === 'auto') conf.locale = navigator.language\n\n  // 自动判断启用平铺模式\n  if (conf.flatMode === 'auto') conf.flatMode = window.matchMedia('(max-width: 768px)').matches\n\n  // flatMode\n  if (typeof conf.nestMax === 'number' && Number(conf.nestMax) <= 1) conf.flatMode = true\n\n  return conf\n}\n\n/**\n * Handle the config which is provided by the server\n *\n * @param conf - The Server response config for control the frontend of Artalk remotely\n * @returns The config for Artalk instance creation\n */\nexport function handleConfFormServer(conf: Partial<ArtalkConfig>) {\n  const ExcludedKeys: (keyof ArtalkConfig)[] = [\n    'el',\n    'pageKey',\n    'pageTitle',\n    'server',\n    'site',\n    'pvEl',\n    'countEl',\n    'statPageKeyAttr',\n  ]\n  Object.keys(conf).forEach((k) => {\n    if (ExcludedKeys.includes(k as any)) delete conf[k]\n    if (k === 'darkMode' && conf[k] !== 'auto') delete conf[k]\n  })\n\n  // Patch: `emoticons` config string to json\n  if (conf.emoticons && typeof conf.emoticons === 'string') {\n    conf.emoticons = conf.emoticons.trim()\n    if (conf.emoticons.startsWith('[') || conf.emoticons.startsWith('{')) {\n      conf.emoticons = JSON.parse(conf.emoticons) // parse json\n    } else if (conf.emoticons === 'false') {\n      conf.emoticons = false\n    }\n  }\n\n  return conf\n}\n\n/**\n * Convert Artalk Config to ApiOptions for Api client\n *\n * @param conf - Artalk config\n * @param ctx - If `ctx` not provided, `checkAdmin` and `checkCaptcha` will be disabled\n * @returns ApiOptions for Api client instance creation\n */\nexport function convertApiOptions(conf: Partial<ArtalkConfig>, ctx?: ContextApi): ApiOptions {\n  return {\n    baseURL: `${conf.server}/api/v2`,\n    siteName: conf.site || '',\n    pageKey: conf.pageKey || '',\n    pageTitle: conf.pageTitle || '',\n    timeout: conf.reqTimeout,\n    getApiToken: () => ctx?.get('user').getData().token,\n    userInfo: ctx?.get('user').checkHasBasicUserInfo()\n      ? {\n          name: ctx?.get('user').getData().name,\n          email: ctx?.get('user').getData().email,\n        }\n      : undefined,\n    handlers: ctx?.getApiHandlers(),\n  }\n}\n\nexport function createNewApiHandlers(ctx: ContextApi) {\n  const h = createApiHandlers()\n  h.add('need_captcha', (res) => ctx.checkCaptcha(res))\n  h.add('need_login', () => ctx.checkAdmin({}))\n\n  return h\n}\n","import type { ArtalkConfig, ContextApi } from '@/types'\n\nexport function watchConf<T extends (keyof ArtalkConfig)[]>(\n  ctx: ContextApi,\n  keys: T,\n  effect: (conf: Pick<ArtalkConfig, T[number]>) => void,\n): void {\n  const deepEqual = (a: any, b: any) => JSON.stringify(a) === JSON.stringify(b)\n  const val = () => {\n    const conf = ctx.getConf()\n    const res: any = {}\n    keys.forEach((key) => {\n      res[key] = conf[key]\n    })\n    return res\n  }\n  let lastVal: any = null\n  const handler = () => {\n    const newVal = val()\n    const isDiff = lastVal == null || !deepEqual(lastVal, newVal)\n    // only trigger when specific keys changed\n    if (isDiff) {\n      lastVal = newVal\n      effect(newVal)\n    }\n  }\n  ctx.on('mounted', handler)\n  ctx.on('updated', handler)\n}\n","/* eslint-disable @typescript-eslint/no-unsafe-declaration-merging */\nimport type { TInjectedServices } from './service'\nimport { Api, ApiHandlers } from './api'\n\nimport * as marked from './lib/marked'\nimport { mergeDeep } from './lib/merge-deep'\nimport { CheckerCaptchaPayload, CheckerPayload } from './components/checker'\n\nimport { DataManager } from './data'\nimport * as I18n from './i18n'\n\nimport EventManager from './lib/event-manager'\nimport { convertApiOptions, createNewApiHandlers, handelCustomConf } from './config'\nimport { watchConf } from './lib/watch-conf'\n\nimport type {\n  ArtalkConfig,\n  CommentData,\n  ListFetchParams,\n  ContextApi,\n  EventPayloadMap,\n  SidebarShowPayload,\n} from '@/types'\n\n// Auto dependency injection\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\ninterface Context extends TInjectedServices {}\n\n/**\n * Artalk Context\n */\nclass Context implements ContextApi {\n  /* 运行参数 */\n  conf: ArtalkConfig\n  data: DataManager\n  $root: HTMLElement\n\n  /* Event Manager */\n  private events = new EventManager<EventPayloadMap>()\n  private mounted = false\n\n  constructor(conf: ArtalkConfig) {\n    this.conf = conf\n\n    this.$root = conf.el as HTMLElement\n    this.$root.classList.add('artalk')\n    this.$root.innerHTML = ''\n    conf.darkMode && this.$root.classList.add('atk-dark-mode')\n\n    this.data = new DataManager(this.events)\n\n    this.on('mounted', () => {\n      this.mounted = true\n    })\n  }\n\n  inject(depName: string, obj: any) {\n    this[depName] = obj\n  }\n\n  get(depName: string) {\n    return this[depName]\n  }\n\n  getApi() {\n    return new Api(convertApiOptions(this.conf, this))\n  }\n\n  private apiHandlers = <ApiHandlers | null>null\n  getApiHandlers() {\n    if (!this.apiHandlers) this.apiHandlers = createNewApiHandlers(this)\n    return this.apiHandlers\n  }\n\n  getData() {\n    return this.data\n  }\n\n  replyComment(commentData: CommentData, $comment: HTMLElement): void {\n    this.editor.setReply(commentData, $comment)\n  }\n\n  editComment(commentData: CommentData, $comment: HTMLElement): void {\n    this.editor.setEditComment(commentData, $comment)\n  }\n\n  fetch(params: Partial<ListFetchParams>): void {\n    this.data.fetchComments(params)\n  }\n\n  reload(): void {\n    this.data.fetchComments({ offset: 0 })\n  }\n\n  /* List */\n  listGotoFirst(): void {\n    this.events.trigger('list-goto-first')\n  }\n\n  getCommentNodes() {\n    return this.list.getCommentNodes()\n  }\n\n  getComments() {\n    return this.data.getComments()\n  }\n\n  getCommentList = this.getCommentNodes\n  getCommentDataList = this.getComments\n\n  /* Editor */\n  editorShowLoading(): void {\n    this.editor.showLoading()\n  }\n\n  editorHideLoading(): void {\n    this.editor.hideLoading()\n  }\n\n  editorShowNotify(msg, type): void {\n    this.editor.showNotify(msg, type)\n  }\n\n  editorResetState(): void {\n    this.editor.resetState()\n  }\n\n  /* Sidebar */\n  showSidebar(payload?: SidebarShowPayload): void {\n    this.sidebarLayer.show(payload)\n  }\n\n  hideSidebar(): void {\n    this.sidebarLayer.hide()\n  }\n\n  /* Checker */\n  checkAdmin(payload: CheckerPayload): Promise<void> {\n    return this.checkerLauncher.checkAdmin(payload)\n  }\n\n  checkCaptcha(payload: CheckerCaptchaPayload): Promise<void> {\n    return this.checkerLauncher.checkCaptcha(payload)\n  }\n\n  /* Events */\n  on(name: any, handler: any) {\n    this.events.on(name, handler)\n  }\n\n  off(name: any, handler: any) {\n    this.events.off(name, handler)\n  }\n\n  trigger(name: any, payload?: any) {\n    this.events.trigger(name, payload)\n  }\n\n  /* i18n */\n  $t(key: I18n.I18nKeys, args: { [key: string]: string } = {}): string {\n    return I18n.t(key, args)\n  }\n\n  setDarkMode(darkMode: boolean | 'auto'): void {\n    this.updateConf({ darkMode })\n  }\n\n  updateConf(nConf: Partial<ArtalkConfig>): void {\n    this.conf = mergeDeep(this.conf, handelCustomConf(nConf, false))\n    this.mounted && this.events.trigger('updated', this.conf)\n  }\n\n  getConf(): ArtalkConfig {\n    return this.conf\n  }\n\n  getEl(): HTMLElement {\n    return this.$root\n  }\n\n  getMarked() {\n    return marked.getInstance()\n  }\n\n  watchConf<T extends (keyof ArtalkConfig)[]>(\n    keys: T,\n    effect: (conf: Pick<ArtalkConfig, T[number]>) => void,\n  ): void {\n    watchConf(this, keys, effect)\n  }\n}\n\nexport default Context\n","export interface ApiHandlerPayload {\n  need_captcha: { img_data?: string; iframe?: string }\n  need_login: object\n  need_auth_login: object\n}\n\ntype PayloadKey = keyof ApiHandlerPayload\n\nexport interface ApiHandler<T extends PayloadKey = PayloadKey> {\n  action: T\n  handler: (data: ApiHandlerPayload[T]) => Promise<void>\n}\n\nexport interface ApiHandlers {\n  add: <T extends PayloadKey>(\n    action: T,\n    handler: (data: ApiHandlerPayload[T]) => Promise<void>,\n  ) => void\n  remove: (action: PayloadKey) => void\n  get: () => ApiHandler[]\n}\n\nexport function createApiHandlers(): ApiHandlers {\n  const handlers: ApiHandler[] = []\n  return {\n    add: (action, handler) => {\n      handlers.push({ action, handler })\n    },\n    remove: (action) => {\n      const index = handlers.findIndex((h) => h.action === action)\n      if (index !== -1) handlers.splice(index, 1)\n    },\n    get: () => handlers,\n  }\n}\n","import * as Utils from './utils'\nimport type { NotifyLevel } from '@/types'\n\n/** 显示加载 */\nexport function showLoading(parentElem: HTMLElement, conf?: { transparentBg?: boolean }) {\n  // Use :scope https://developer.mozilla.org/en-US/docs/Web/CSS/:scope\n  let $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\n  if (!$loading) {\n    $loading = Utils.createElement(\n      `<div class=\"atk-loading\" style=\"display: none;\">\n      <div class=\"atk-loading-spinner\">\n        <svg viewBox=\"25 25 50 50\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\" stroke-miterlimit=\"10\"></circle></svg>\n      </div>\n    </div>`,\n    )\n    if (conf?.transparentBg) $loading.style.background = 'transparent'\n    parentElem.appendChild($loading)\n  }\n  $loading.style.display = ''\n\n  // spinner 延迟显示，若加载等待时间太短，没必要显示（闪一下即可）\n  const $spinner = $loading.querySelector<HTMLElement>('.atk-loading-spinner')\n  if ($spinner) {\n    $spinner.style.display = 'none'\n    window.setTimeout(() => {\n      if ($spinner.isConnected) $spinner.style.display = ''\n    }, 500)\n  }\n}\n\n/** 隐藏加载 */\nexport function hideLoading(parentElem: HTMLElement) {\n  const $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\n  if ($loading) $loading.style.display = 'none'\n}\n\n/** 元素加载动画 */\nexport function setLoading(val: boolean, parentElem: HTMLElement) {\n  if (val) showLoading(parentElem)\n  else hideLoading(parentElem)\n}\n\n/** 元素是否用户可见 */\nexport function isVisible(el: HTMLElement, viewport: HTMLElement = document.documentElement) {\n  const viewportHeight = viewport.clientHeight\n\n  const docViewTop = viewport.scrollTop\n  const docViewBottom = docViewTop + viewportHeight\n\n  const rect = el.getBoundingClientRect()\n  const elemTop = rect.top + docViewTop\n  const elemBottom = elemTop + rect.height\n\n  return elemBottom <= docViewBottom //&& (elemTop >= docViewTop) 注释因为假如 el 比 viewport 还高就会失效\n}\n\n/** 滚动到元素中心 */\nexport function scrollIntoView(\n  elem: HTMLElement,\n  enableAnim: boolean = true,\n  relativeTo?: HTMLElement,\n) {\n  let top: number\n\n  if (relativeTo) {\n    const containerRect = relativeTo.getBoundingClientRect()\n    const elementRect = elem.getBoundingClientRect()\n    top =\n      elementRect.top -\n      containerRect.top +\n      relativeTo.scrollTop -\n      relativeTo.clientHeight / 2 +\n      elem.clientHeight / 2\n  } else {\n    const rect = elem.getBoundingClientRect()\n    const elemTop = rect.top + window.scrollY\n    top = elemTop - (window.innerHeight / 2 - rect.height / 2)\n  }\n\n  const scrollOptions: ScrollToOptions = {\n    top,\n    left: 0,\n    // behavior: enableAnim ? 'smooth' : 'instant',\n    behavior: 'instant',\n  }\n\n  if (relativeTo) relativeTo.scroll(scrollOptions)\n  else window.scroll(scrollOptions)\n}\n\n/** 显示消息 */\nexport function showNotify(wrapElem: HTMLElement, msg: string, type: NotifyLevel) {\n  const colors = { s: '#57d59f', e: '#ff6f6c', w: '#ffc721', i: '#2ebcfc' }\n  const timeout = 3000 // 持续显示时间 ms\n\n  const notifyElem = Utils.createElement(\n    `<div class=\"atk-notify atk-fade-in\" style=\"background-color: ${colors[type]}\"><span class=\"atk-notify-content\"></span></div>`,\n  )\n  const notifyContentEl = notifyElem.querySelector<HTMLElement>('.atk-notify-content')!\n  notifyContentEl.innerHTML = Utils.htmlEncode(msg).replace('\\n', '<br/>')\n\n  wrapElem.appendChild(notifyElem)\n\n  const notifyRemove = () => {\n    notifyElem.classList.add('atk-fade-out')\n    setTimeout(() => {\n      notifyElem.remove()\n    }, 200)\n  }\n\n  let timeoutFn: number\n  if (timeout > 0) {\n    timeoutFn = window.setTimeout(() => {\n      notifyRemove()\n    }, timeout)\n  }\n\n  notifyElem.addEventListener('click', () => {\n    notifyRemove()\n    window.clearTimeout(timeoutFn)\n  })\n}\n\n/** fade 动画 */\nexport function playFadeAnim(elem: HTMLElement, after?: () => void, type: 'in' | 'out' = 'in') {\n  elem.classList.add(`atk-fade-${type}`)\n  // 动画结束清除 class\n  const onAnimEnded = () => {\n    elem.classList.remove(`atk-fade-${type}`)\n    elem.removeEventListener('animationend', onAnimEnded)\n    if (after) after()\n  }\n  elem.addEventListener('animationend', onAnimEnded)\n}\n\n/** 渐入动画 */\nexport function playFadeInAnim(elem: HTMLElement, after?: () => void) {\n  playFadeAnim(elem, after, 'in')\n}\n\n/** 渐出动画 */\nexport function playFadeOutAnim(elem: HTMLElement, after?: () => void) {\n  playFadeAnim(elem, after, 'out')\n}\n\n/** 设置全局错误 */\nexport function setError(\n  parentElem: HTMLElement,\n  html: string | HTMLElement | null,\n  title: string = '<span class=\"atk-error-title\">Artalk Error</span>',\n) {\n  let elem = parentElem.querySelector<HTMLElement>('.atk-error-layer')\n  if (html === null) {\n    if (elem !== null) elem.remove()\n    return\n  }\n  if (!elem) {\n    elem = Utils.createElement(\n      `<div class=\"atk-error-layer\">${title}<span class=\"atk-error-text\"></span></div>`,\n    )\n    parentElem.appendChild(elem)\n  }\n\n  const errorTextEl = elem.querySelector<HTMLElement>('.atk-error-text')!\n  errorTextEl.innerHTML = ''\n  if (html === null) return\n\n  if (html instanceof HTMLElement) {\n    errorTextEl.appendChild(html)\n  } else {\n    errorTextEl.innerText = html\n  }\n}\n\nexport function getScrollBarWidth() {\n  const inner = document.createElement('p')\n  inner.style.width = '100%'\n  inner.style.height = '200px'\n\n  const outer = document.createElement('div')\n  outer.style.position = 'absolute'\n  outer.style.top = '0px'\n  outer.style.left = '0px'\n  outer.style.visibility = 'hidden'\n  outer.style.width = '200px'\n  outer.style.height = '150px'\n  outer.style.overflow = 'hidden'\n  outer.appendChild(inner)\n\n  document.body.appendChild(outer)\n  const w1 = inner.offsetWidth\n  outer.style.overflow = 'scroll'\n  let w2 = inner.offsetWidth\n  if (w1 === w2) w2 = outer.clientWidth\n\n  document.body.removeChild(outer)\n\n  return w1 - w2\n}\n","import type { CheckerCtx } from '.'\nimport $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\n\n/** 图片验证码 */\nexport function imgBody(checker: CheckerCtx) {\n  // 图片验证方式\n  const elem = Utils.createElement(\n    `<span><img class=\"atk-captcha-img\" src=\"${checker.get('img_data') || ''}\">${$t('captchaCheck')}</span>`,\n  )\n\n  // 刷新验证码\n  elem.querySelector<HTMLElement>('.atk-captcha-img')!.onclick = () => {\n    const imgEl = elem.querySelector('.atk-captcha-img')\n    checker\n      .getApi()\n      .captcha.getCaptcha()\n      .then((res) => {\n        imgEl!.setAttribute('src', res.data.img_data)\n      })\n      .catch((err) => {\n        console.error('Failed to get captcha image ', err)\n      })\n  }\n  return elem\n}\n\n/** iframe 形式的通用验证服务 */\nexport function iframeBody(checker: CheckerCtx) {\n  const $iframeWrap = Utils.createElement(`<div class=\"atk-checker-iframe-wrap\"></div>`)\n  const $iframe = Utils.createElement<HTMLIFrameElement>(\n    `<iframe class=\"atk-fade-in\" referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>`,\n  )\n  $iframe.style.display = 'none'\n  Ui.showLoading($iframeWrap, { transparentBg: true })\n  $iframe.src = checker.getOpts().getCaptchaIframeURL()\n  $iframe.onload = () => {\n    $iframe.style.display = ''\n    Ui.hideLoading($iframeWrap)\n  }\n  $iframeWrap.append($iframe)\n\n  const $closeBtn = Utils.createElement(\n    `<div class=\"atk-close-btn\"><i class=\"atk-icon atk-icon-close\"></i></div>`,\n  )\n  $iframeWrap.append($closeBtn)\n\n  checker.hideInteractInput()\n\n  // 轮询状态\n  let stop = false // 打断\n  const sleep = (ms: number) =>\n    new Promise((resolve) => {\n      window.setTimeout(() => {\n        resolve(null)\n      }, ms)\n    })\n  ;(async function queryStatus() {\n    await sleep(1000)\n    if (stop) return\n    let isPass = false\n    try {\n      const resp = await checker.getApi().captcha.getCaptchaStatus()\n      isPass = resp.data.is_pass\n    } catch {\n      isPass = false\n    }\n    if (isPass) {\n      checker.triggerSuccess()\n    } else {\n      queryStatus()\n    }\n  })()\n\n  $closeBtn.onclick = () => {\n    stop = true\n    checker.cancel()\n  }\n\n  return $iframeWrap\n}\n","import * as render from './captcha-renders'\nimport type { Checker } from '.'\n\nconst CaptchaChecker: Checker = {\n  request(checker, inputVal) {\n    return checker.getApi().captcha.verifyCaptcha({\n      value: inputVal,\n    })\n  },\n\n  body(checker) {\n    if (checker.get('iframe')) return render.iframeBody(checker)\n    return render.imgBody(checker)\n  },\n\n  onSuccess(checker, data, inputVal, formEl) {\n    checker.set('val', inputVal)\n  },\n\n  onError(checker, err, inputVal, formEl) {\n    formEl.querySelector<HTMLElement>('.atk-captcha-img')!.click() // 刷新验证码\n    formEl.querySelector<HTMLInputElement>('input[type=\"text\"]')!.value = '' // 清空输入框输入\n  },\n}\n\nexport default CaptchaChecker\n","import type { Checker } from '.'\nimport $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\n\nconst AdminChecker: Checker<{ token: string }> = {\n  inputType: 'password',\n\n  async request(checker, inputVal) {\n    return (\n      await checker.getApi().user.login({\n        name: checker.getUser().getData().name,\n        email: checker.getUser().getData().email,\n        password: inputVal,\n      })\n    ).data\n  },\n\n  body(checker) {\n    return Utils.createElement(`<span>${$t('adminCheck')}</span>`)\n  },\n\n  onSuccess(checker, res, inputVal, formEl) {\n    checker.getUser().update({\n      is_admin: true,\n      token: res.token,\n    })\n    checker.getOpts().onReload()\n  },\n\n  onError(checker, err, inputVal, formEl) {},\n}\n\nexport default AdminChecker\n","import * as Utils from '../lib/utils'\nimport $t from '@/i18n'\n\ntype BtnClickHandler = (btnEl: HTMLElement, dialog: Dialog) => boolean | void\n\n/**\n * 对话框\n */\nexport default class Dialog {\n  public $el: HTMLElement\n  public $content: HTMLElement\n  public $actions: HTMLElement\n\n  constructor(contentEl: HTMLElement) {\n    this.$el = Utils.createElement(\n      `<div class=\"atk-layer-dialog-wrap\">\n        <div class=\"atk-layer-dialog\">\n          <div class=\"atk-layer-dialog-content\"></div>\n          <div class=\"atk-layer-dialog-actions\"></div>\n        </div>\n      </div>`,\n    )\n\n    // 按钮\n    this.$actions = this.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!\n\n    // 内容\n    this.$content = this.$el.querySelector('.atk-layer-dialog-content')!\n    this.$content.appendChild(contentEl)\n  }\n\n  /** 按钮 · 确定 */\n  public setYes(handler: BtnClickHandler) {\n    const btn = Utils.createElement<HTMLButtonElement>(\n      `<button data-action=\"confirm\">${$t('confirm')}</button>`,\n    )\n    btn.onclick = this.onBtnClick(handler)\n    this.$actions.appendChild(btn)\n\n    return this\n  }\n\n  /** 按钮 · 取消 */\n  public setNo(handler: BtnClickHandler) {\n    const btn = Utils.createElement<HTMLButtonElement>(\n      `<button data-action=\"cancel\">${$t('cancel')}</button>`,\n    )\n    btn.onclick = this.onBtnClick(handler)\n    this.$actions.appendChild(btn)\n\n    return this\n  }\n\n  private onBtnClick(handler: BtnClickHandler) {\n    return (evt: Event) => {\n      const re = handler(evt.currentTarget as HTMLElement, this)\n      if (re === undefined || re === true) {\n        this.$el.remove()\n      }\n    }\n  }\n}\n","import CaptchaChecker from './captcha'\nimport AdminChecker from './admin'\nimport type { Api } from '@/api'\nimport Dialog from '@/components/dialog'\nimport $t from '@/i18n'\nimport type { ContextApi } from '@/types'\nimport type User from '@/lib/user'\nimport * as Utils from '@/lib/utils'\n\nexport interface CheckerCaptchaPayload extends CheckerPayload {\n  img_data?: string\n  iframe?: string\n}\n\nexport interface CheckerPayload {\n  onSuccess?: () => void\n  onMount?: (dialogEl: HTMLElement) => void\n  onCancel?: () => void\n}\n\nexport interface CheckerLauncherOptions {\n  getCtx: () => ContextApi\n  getApi: () => Api\n  getCaptchaIframeURL: () => string\n  onReload: () => void\n}\n\nfunction wrapPromise<P extends CheckerPayload = CheckerPayload>(fn: (p: P) => void) {\n  return (payload: P) =>\n    new Promise<void>((resolve, reject) => {\n      const cancelFn = payload.onCancel\n      payload.onCancel = () => {\n        cancelFn && cancelFn()\n        reject(new Error('user canceled the checker'))\n      }\n      const successFn = payload.onSuccess\n      payload.onSuccess = () => {\n        successFn && successFn()\n        resolve()\n      }\n      fn(payload)\n    })\n}\n\n/**\n * Checker 发射台\n */\nexport default class CheckerLauncher {\n  constructor(private opts: CheckerLauncherOptions) {}\n\n  public checkCaptcha: (payload: CheckerCaptchaPayload) => Promise<void> = wrapPromise((p) => {\n    this.fire(CaptchaChecker, p, (ctx) => {\n      ctx.set('img_data', p.img_data)\n      ctx.set('iframe', p.iframe)\n    })\n  })\n\n  public checkAdmin: (payload: CheckerPayload) => Promise<void> = wrapPromise((p) => {\n    this.fire(AdminChecker, p)\n  })\n\n  public fire(checker: Checker, payload: CheckerPayload, postFire?: (c: CheckerCtx) => void) {\n    // 显示层\n    const layer = this.opts.getCtx().get('layerManager').create(`checker-${new Date().getTime()}`)\n    layer.show()\n\n    const close = () => {\n      layer.destroy()\n    }\n\n    // 构建 Checker 的上下文\n    const checkerStore: CheckerStore = {}\n    let hideInteractInput = false\n    const checkerCtx: CheckerCtx = {\n      set: (key, val) => {\n        checkerStore[key] = val\n      },\n      get: (key) => checkerStore[key],\n      getOpts: () => this.opts,\n      getUser: () => this.opts.getCtx().get('user'),\n      getApi: () => this.opts.getApi(),\n      hideInteractInput: () => {\n        hideInteractInput = true\n      },\n      triggerSuccess: () => {\n        close()\n        if (checker.onSuccess) checker.onSuccess(checkerCtx, '', '', formEl)\n        if (payload.onSuccess) payload.onSuccess()\n      },\n      cancel: () => {\n        close()\n        if (payload.onCancel) payload.onCancel()\n      },\n    }\n\n    if (postFire) postFire(checkerCtx)\n\n    // 创建表单\n    const formEl = Utils.createElement()\n    formEl.appendChild(checker.body(checkerCtx))\n\n    // 输入框\n    const $input = Utils.createElement<HTMLInputElement>(\n      `<input id=\"check\" type=\"${checker.inputType || 'text'}\" autocomplete=\"off\" required placeholder=\"\">`,\n    )\n    formEl.appendChild($input)\n    setTimeout(() => $input.focus(), 80) // 延迟 Focus\n\n    // 绑定键盘事件\n    $input.onkeyup = (evt) => {\n      if (evt.key === 'Enter' || evt.keyCode === 13) {\n        // 按下回车键\n        evt.preventDefault()\n        layer.getEl().querySelector<HTMLButtonElement>('button[data-action=\"confirm\"]')!.click()\n      }\n    }\n\n    let btnTextOrg: string | undefined\n    const dialog = new Dialog(formEl)\n\n    // 确认按钮\n    dialog.setYes((btnEl) => {\n      const inputVal = $input.value.trim()\n\n      // 按钮操作\n      if (!btnTextOrg) btnTextOrg = btnEl.innerText\n      const btnTextSet = (btnText: string) => {\n        btnEl.innerText = btnText\n        btnEl.classList.add('error')\n      }\n      const btnTextRestore = () => {\n        btnEl.innerText = btnTextOrg || ''\n        btnEl.classList.remove('error')\n      }\n\n      btnEl.innerText = `${$t('loading')}...`\n\n      // 发送请求\n      checker\n        .request(checkerCtx, inputVal)\n        .then((data) => {\n          // 请求成功\n          close()\n\n          if (checker.onSuccess) checker.onSuccess(checkerCtx, data, inputVal, formEl)\n          if (payload.onSuccess) payload.onSuccess()\n        })\n        .catch((err) => {\n          // 请求失败\n          btnTextSet(String(err.message || String(err)))\n\n          if (checker.onError) checker.onError(checkerCtx, err, inputVal, formEl)\n\n          // 错误显示 3s 后恢复按钮\n          const tf = setTimeout(() => btnTextRestore(), 3000)\n          $input.onfocus = () => {\n            btnTextRestore()\n            clearTimeout(tf)\n          }\n        })\n\n      return false\n    })\n\n    // 取消按钮\n    dialog.setNo(() => {\n      close()\n      if (payload.onCancel) payload.onCancel()\n      return false\n    })\n\n    if (hideInteractInput) {\n      $input.style.display = 'none'\n      dialog.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!.style.display = 'none'\n    }\n\n    // 层装载 dialog 元素\n    layer.getEl().append(dialog.$el)\n\n    // onMount 回调\n    if (payload.onMount) payload.onMount(dialog.$el)\n  }\n}\n\nexport interface Checker<T = any> {\n  el?: HTMLElement\n  inputType?: 'password' | 'text'\n  body: (checker: CheckerCtx) => HTMLElement\n  request: (checker: CheckerCtx, inputVal: string) => Promise<T>\n  onSuccess?: (checker: CheckerCtx, respData: T, inputVal: string, formEl: HTMLElement) => void\n  onError?: (checker: CheckerCtx, errData: any, inputVal: string, formEl: HTMLElement) => void\n}\n\ninterface CheckerStore {\n  val?: string\n  img_data?: string\n  iframe?: string\n}\n\nexport interface CheckerCtx {\n  get<K extends keyof CheckerStore>(key: K): CheckerStore[K]\n  set<K extends keyof CheckerStore>(key: K, val: CheckerStore[K]): void\n  getOpts(): CheckerLauncherOptions\n  getApi(): Api\n  getUser(): User\n  hideInteractInput(): void\n  triggerSuccess(): void\n  cancel(): void\n}\n","import type { ContextApi } from '@/types'\n\nexport default abstract class Component {\n  public $el!: HTMLElement\n  public get conf() {\n    return this.ctx.conf\n  }\n\n  public constructor(public ctx: ContextApi) {}\n\n  getEl() {\n    return this.$el\n  }\n}\n","export default \"<div class=\\\"atk-main-editor\\\">\\n  <div class=\\\"atk-header\\\">\\n    <input name=\\\"name\\\" class=\\\"atk-name\\\" type=\\\"text\\\" required=\\\"required\\\" />\\n    <input name=\\\"email\\\" class=\\\"atk-email\\\" type=\\\"email\\\" required=\\\"required\\\" />\\n    <input name=\\\"link\\\" class=\\\"atk-link\\\" type=\\\"url\\\" />\\n  </div>\\n  <div class=\\\"atk-textarea-wrap\\\">\\n    <textarea class=\\\"atk-textarea\\\"></textarea>\\n  </div>\\n  <div class=\\\"atk-plug-panel-wrap\\\" style=\\\"display: none\\\"></div>\\n  <div class=\\\"atk-bottom\\\">\\n    <div class=\\\"atk-item atk-bottom-left\\\">\\n      <span class=\\\"atk-state-wrap\\\"></span>\\n      <span class=\\\"atk-plug-btn-wrap\\\"></span>\\n    </div>\\n    <div class=\\\"atk-item\\\">\\n      <button type=\\\"button\\\" class=\\\"atk-send-btn\\\"></button>\\n    </div>\\n  </div>\\n  <div class=\\\"atk-notify-wrap\\\"></div>\\n</div>\\n\"","import * as Utils from '../lib/utils'\nimport EditorHTML from './editor.html?raw'\n\nconst Sel = {\n  $header: '.atk-header',\n  $name: '.atk-header [name=\"name\"]',\n  $email: '.atk-header [name=\"email\"]',\n  $link: '.atk-header [name=\"link\"]',\n  $textareaWrap: '.atk-textarea-wrap',\n  $textarea: '.atk-textarea',\n  $bottom: '.atk-bottom',\n  $submitBtn: '.atk-send-btn',\n  $notifyWrap: '.atk-notify-wrap',\n  $bottomLeft: '.atk-bottom-left',\n  $stateWrap: '.atk-state-wrap',\n  $plugBtnWrap: '.atk-plug-btn-wrap',\n  $plugPanelWrap: '.atk-plug-panel-wrap',\n}\n\nexport interface EditorUI extends Record<keyof typeof Sel, HTMLElement> {\n  $el: HTMLElement\n  $name: HTMLInputElement\n  $email: HTMLInputElement\n  $link: HTMLInputElement\n  $textarea: HTMLTextAreaElement\n  $submitBtn: HTMLButtonElement\n  $sendReplyBtn?: HTMLElement\n  $editCancelBtn?: HTMLElement\n}\n\nexport function render() {\n  const $el = Utils.createElement(EditorHTML)\n  const ui = { $el }\n  Object.entries(Sel).forEach(([k, sel]) => {\n    ui[k] = $el.querySelector(sel)\n  })\n  return ui as EditorUI\n}\n","import type PlugKit from './_kit'\nimport type { CommentData, EditorState } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/**\n * Editor 插件\n */\nclass EditorPlug {\n  $btn?: HTMLElement\n  $panel?: HTMLElement\n  contentTransformer?(rawContent: string): string\n  editorStateEffectWhen?: EditorState\n  editorStateEffect?(comment: CommentData): () => void\n\n  constructor(protected kit: PlugKit) {}\n\n  /** Use plug btn will add a btn on the bottom of editor */\n  useBtn(html: string = '<div></div>') {\n    this.$btn = Utils.createElement(`<span class=\"atk-plug-btn\">${html}</span>`)\n    return this.$btn\n  }\n\n  /** Use plug panel will show the panel when btn is clicked */\n  usePanel(html: string = '<div></div>') {\n    this.$panel = Utils.createElement(html)\n    return this.$panel\n  }\n\n  /** Use the content transformer to handle the content of the last submit by the editor */\n  useContentTransformer(func: (raw: string) => string) {\n    this.contentTransformer = func\n  }\n\n  /** Listen the event of panel show */\n  usePanelShow(func: () => void) {\n    this.kit.useEvents().on('panel-show', (aPlug) => {\n      if (aPlug === this) func()\n    })\n  }\n\n  /** Listen the event of panel hide */\n  usePanelHide(func: () => void) {\n    this.kit.useEvents().on('panel-hide', (aPlug) => {\n      if (aPlug === this) func()\n    })\n  }\n\n  /** Use editor state modifier */\n  useEditorStateEffect(stateName: EditorState, effectFn: (comment: CommentData) => () => void) {\n    this.editorStateEffectWhen = stateName\n    this.editorStateEffect = effectFn\n  }\n}\n\nexport default EditorPlug\n","import EditorPlug from './_plug'\nimport * as Utils from '@/lib/utils'\n\nexport default class Mover extends EditorPlug {\n  private isMoved = false\n\n  move(afterEl: HTMLElement) {\n    if (this.isMoved) return\n    this.isMoved = true\n\n    const editorEl = this.kit.useUI().$el\n\n    editorEl.after(Utils.createElement('<div class=\"atk-editor-travel-placeholder\"></div>'))\n\n    const $travelPlace = Utils.createElement('<div></div>')\n    afterEl.after($travelPlace)\n    $travelPlace.replaceWith(editorEl)\n\n    editorEl.classList.add('atk-fade-in') // 添加渐入动画\n    editorEl.classList.add('editor-traveling')\n  }\n\n  back() {\n    if (!this.isMoved) return\n    this.isMoved = false\n    this.kit\n      .useGlobalCtx()\n      .$root.querySelector('.atk-editor-travel-placeholder')\n      ?.replaceWith(this.kit.useUI().$el)\n    this.kit.useUI().$el.classList.remove('editor-traveling')\n  }\n}\n","import Mover from '../plugins/editor/mover'\nimport type Editor from './editor'\nimport type { EditorState, CommentData } from '@/types'\nimport * as Ui from '@/lib/ui'\n\nexport default class EditorStateManager {\n  constructor(private editor: Editor) {}\n\n  private stateCurt: EditorState = 'normal'\n  private stateUnmountFn: (() => void) | null = null\n\n  /** Get current state */\n  get() {\n    return this.stateCurt\n  }\n\n  /**\n   * Switch editor state\n   *\n   * @param state The state to switch\n   * @param payload The cause of state switch\n   */\n  switch(state: EditorState, payload?: { $comment: HTMLElement; comment: CommentData }) {\n    // trigger unmount\n    if (this.stateUnmountFn) {\n      this.stateUnmountFn()\n      this.stateUnmountFn = null\n\n      // move editor back to the initial position\n      this.editor.getPlugs()?.get(Mover)?.back()\n    }\n\n    // invoke effect function and save unmount function\n    if (state !== 'normal' && payload) {\n      // move editor position\n      let moveAfterEl = payload.$comment\n      if (!this.editor.conf.flatMode)\n        moveAfterEl = moveAfterEl.querySelector<HTMLElement>('.atk-footer')!\n      this.editor.getPlugs()?.get(Mover)?.move(moveAfterEl)\n\n      const $relative =\n        this.editor.ctx.conf.scrollRelativeTo && this.editor.ctx.conf.scrollRelativeTo()\n      Ui.scrollIntoView(this.editor.getUI().$el, true, $relative)\n\n      const plugin = this.editor\n        .getPlugs()\n        ?.getPlugs()\n        .find((p) => p.editorStateEffectWhen === state)\n      if (plugin && plugin.editorStateEffect) {\n        this.stateUnmountFn = plugin.editorStateEffect(payload.comment)\n      }\n    }\n\n    // change current state\n    this.stateCurt = state\n  }\n}\n","import Component from '../lib/component'\nimport * as Ui from '../lib/ui'\nimport marked from '../lib/marked'\nimport { render, EditorUI } from './ui'\nimport EditorStateManager from './state'\nimport type { CommentData, ContextApi, EditorApi } from '@/types'\n\nclass Editor extends Component implements EditorApi {\n  private ui: EditorUI\n  private state: EditorStateManager\n\n  getUI() {\n    return this.ui\n  }\n  getPlugs() {\n    return this.ctx.get('editorPlugs')\n  }\n  getState() {\n    return this.state.get()\n  }\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    // init editor ui\n    this.ui = render()\n    this.$el = this.ui.$el\n\n    // init state manager\n    this.state = new EditorStateManager(this)\n  }\n\n  getHeaderInputEls() {\n    return { name: this.ui.$name, email: this.ui.$email, link: this.ui.$link }\n  }\n\n  getContentFinal() {\n    let content = this.getContentRaw()\n\n    // plug hook: final content transformer\n    const plugs = this.getPlugs()\n    if (plugs) content = plugs.getTransformedContent(content)\n\n    return content\n  }\n\n  getContentRaw() {\n    return this.ui.$textarea.value || ''\n  }\n\n  getContentMarked() {\n    return marked(this.getContentFinal())\n  }\n\n  setContent(val: string) {\n    this.ui.$textarea.value = val\n\n    // plug hook: content updated\n    this.getPlugs()?.getEvents().trigger('content-updated', val)\n  }\n\n  insertContent(val: string) {\n    if ((document as any).selection) {\n      this.ui.$textarea.focus()\n      ;(document as any).selection.createRange().text = val\n      this.ui.$textarea.focus()\n    } else if (this.ui.$textarea.selectionStart || this.ui.$textarea.selectionStart === 0) {\n      const sStart = this.ui.$textarea.selectionStart\n      const sEnd = this.ui.$textarea.selectionEnd\n      const sT = this.ui.$textarea.scrollTop\n      this.setContent(\n        this.ui.$textarea.value.substring(0, sStart) +\n          val +\n          this.ui.$textarea.value.substring(sEnd, this.ui.$textarea.value.length),\n      )\n      this.ui.$textarea.focus()\n      this.ui.$textarea.selectionStart = sStart + val.length\n      this.ui.$textarea.selectionEnd = sStart + val.length\n      this.ui.$textarea.scrollTop = sT\n    } else {\n      this.ui.$textarea.focus()\n      this.ui.$textarea.value += val\n    }\n  }\n\n  focus() {\n    this.ui.$textarea.focus()\n  }\n\n  reset() {\n    this.setContent('')\n    this.resetState()\n  }\n\n  resetState() {\n    this.state.switch('normal')\n  }\n\n  setReply(comment: CommentData, $comment: HTMLElement) {\n    this.state.switch('reply', { comment, $comment })\n  }\n\n  setEditComment(comment: CommentData, $comment: HTMLElement) {\n    this.state.switch('edit', { comment, $comment })\n  }\n\n  showNotify(msg: string, type: any) {\n    Ui.showNotify(this.ui.$notifyWrap, msg, type)\n  }\n\n  showLoading() {\n    Ui.showLoading(this.ui.$el)\n  }\n\n  hideLoading() {\n    Ui.hideLoading(this.ui.$el)\n  }\n\n  submit() {\n    const next = () => this.ctx.trigger('editor-submit')\n    if (this.ctx.conf.beforeSubmit) {\n      this.ctx.conf.beforeSubmit(this, next)\n    } else {\n      next()\n    }\n  }\n}\n\nexport default Editor\n","import SidebarHTML from './sidebar-layer.html?raw'\nimport type { Layer } from './layer'\nimport type { ContextApi, SidebarShowPayload } from '@/types'\nimport Component from '@/lib/component'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\n\nexport default class SidebarLayer extends Component {\n  public layer?: Layer\n  public $header: HTMLElement\n  public $closeBtn: HTMLElement\n  public $iframeWrap: HTMLElement\n  public $iframe?: HTMLIFrameElement\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    this.$el = Utils.createElement(SidebarHTML)\n    this.$header = this.$el.querySelector('.atk-sidebar-header')!\n    this.$closeBtn = this.$header.querySelector('.atk-sidebar-close')!\n    this.$iframeWrap = this.$el.querySelector('.atk-sidebar-iframe-wrap')!\n\n    this.$closeBtn.onclick = () => {\n      this.hide()\n    }\n\n    // event\n    this.ctx.on('user-changed', () => {\n      this.refreshWhenShow = true\n    })\n  }\n\n  /** Refresh iFrame when show */\n  private refreshWhenShow = true\n\n  /** Animation timer */\n  private animTimer?: any = undefined\n\n  /** 显示 */\n  public async show(conf: SidebarShowPayload = {}) {\n    this.$el.style.transform = '' // 动画清除，防止二次打开失效\n\n    // init layer\n    this.initLayer()\n    this.layer!.show()\n\n    // init iframe\n    if (this.refreshWhenShow) {\n      this.refreshWhenShow = false\n      this.$iframeWrap.innerHTML = ''\n      this.$iframe = this.createIframe(conf.view)\n      this.$iframeWrap.append(this.$iframe)\n    } else {\n      // Sync Dark Mode (reload iframe if not match)\n      const $iframe = this.$iframe!\n      const iFrameSrc = $iframe.src\n      if (this.getDarkMode() !== iFrameSrc.includes('&darkMode=1')) {\n        this.iframeLoad(\n          $iframe,\n          iFrameSrc.replace(/&darkMode=\\d/, `&darkMode=${Number(this.getDarkMode())}`),\n        )\n      }\n    }\n\n    // 管理员身份验证 (若身份失效，弹出验证窗口)\n    this.authCheck({\n      onSuccess: () => this.show(conf), // retry show after auth check\n    })\n\n    // 执行滑动显示动画\n    this.animTimer = setTimeout(() => {\n      this.animTimer = undefined\n      this.$el.style.transform = 'translate(0, 0)'\n\n      setTimeout(() => {\n        this.ctx.getData().updateNotifies([])\n      }, 0)\n\n      this.ctx.trigger('sidebar-show')\n    }, 100)\n  }\n\n  /** 隐藏 */\n  public hide() {\n    this.layer?.hide()\n  }\n\n  // --------------------------------------------------\n\n  private async authCheck(opts: { onSuccess: () => void }) {\n    const data = (\n      await this.ctx.getApi().user.getUserStatus({\n        ...this.ctx.getApi().getUserFields(),\n      })\n    ).data\n    if (data.is_admin && !data.is_login) {\n      this.refreshWhenShow = true\n\n      // show checker layer\n      this.ctx.checkAdmin({\n        onSuccess: () => {\n          setTimeout(() => {\n            opts.onSuccess()\n          }, 500)\n        },\n        onCancel: () => {\n          this.hide()\n        },\n      })\n\n      // hide sidebar layer\n      this.hide()\n    }\n  }\n\n  private initLayer() {\n    if (this.layer) return\n\n    this.layer = this.ctx.get('layerManager').create('sidebar', this.$el)\n    this.layer.setOnAfterHide(() => {\n      // 防止评论框被吞\n      this.ctx.editorResetState()\n\n      // interrupt animation\n      this.animTimer && clearTimeout(this.animTimer)\n\n      // perform transform\n      this.$el.style.transform = ''\n\n      // trigger event\n      this.ctx.trigger('sidebar-hide')\n    })\n  }\n\n  private createIframe(view?: string) {\n    const $iframe = Utils.createElement<HTMLIFrameElement>(\n      '<iframe referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>',\n    )\n\n    // 准备 Iframe 参数\n    const baseURL = import.meta.env.DEV\n      ? 'http://localhost:23367/'\n      : Utils.getURLBasedOnApi({\n          base: this.ctx.conf.server,\n          path: '/sidebar/',\n        })\n\n    const query: any = {\n      pageKey: this.conf.pageKey,\n      site: this.conf.site || '',\n      user: JSON.stringify(this.ctx.get('user').getData()),\n      time: +new Date(),\n    }\n\n    if (view) query.view = view\n    query.darkMode = this.getDarkMode() ? '1' : '0'\n\n    const urlParams = new URLSearchParams(query)\n    this.iframeLoad($iframe, `${baseURL}?${urlParams.toString()}`)\n\n    return $iframe\n  }\n\n  private getDarkMode() {\n    return this.conf.darkMode === 'auto'\n      ? window.matchMedia('(prefers-color-scheme: dark)').matches\n      : this.conf.darkMode\n  }\n\n  private iframeLoad($iframe: HTMLIFrameElement, src: string) {\n    $iframe.src = src\n\n    // 加载动画\n    Ui.showLoading(this.$iframeWrap)\n    $iframe.onload = () => {\n      Ui.hideLoading(this.$iframeWrap)\n    }\n  }\n}\n","export default \"<div class=\\\"atk-sidebar-layer\\\">\\n  <div class=\\\"atk-sidebar-inner\\\">\\n    <div class=\\\"atk-sidebar-header\\\">\\n      <div class=\\\"atk-sidebar-close\\\">\\n        <i class=\\\"atk-icon atk-icon-close-slim\\\"></i>\\n      </div>\\n    </div>\\n    <div class=\\\"atk-sidebar-iframe-wrap\\\"></div>\\n  </div>\\n</div>\\n\"","import type { LayoutStrategyCreator } from '.'\nimport type { CommentNode } from '@/comment'\nimport * as Ui from '@/lib/ui'\nimport * as ListNest from '@/list/nest'\n\nexport const createNestStrategy: LayoutStrategyCreator = (opts) => ({\n  import: (comments) => {\n    // 遍历 root 评论\n    const rootNodes = ListNest.makeNestCommentNodeList(comments, opts.nestSortBy, opts.nestMax)\n    rootNodes.forEach((rootNode: ListNest.CommentNode) => {\n      const rootC = opts.createCommentNode(rootNode.comment)\n\n      // 显示并播放渐入动画\n      opts.$commentsWrap?.appendChild(rootC.getEl())\n      rootC.getRender().playFadeAnim()\n\n      // 加载子评论\n      const loadChildren = (parentC: CommentNode, parentNode: ListNest.CommentNode) => {\n        parentNode.children.forEach((node: ListNest.CommentNode) => {\n          const replyD = comments.find((c) => c.id === node.comment.rid)\n          const childD = node.comment\n          const childC = opts.createCommentNode(childD, replyD)\n\n          // 插入到父评论中\n          parentC.putChild(childC)\n\n          // 递归加载子评论\n          loadChildren(childC, node)\n        })\n      }\n      loadChildren(rootC, rootNode)\n\n      // 限高检测\n      rootC.getRender().checkHeightLimit()\n    })\n  },\n  insert: (comment, replyComment) => {\n    // 嵌套模式\n    const node = opts.createCommentNode(comment, replyComment)\n\n    if (comment.rid === 0) {\n      // root评论 新增\n      opts.$commentsWrap?.prepend(node.getEl())\n    } else {\n      // 子评论 新增\n      const parent = opts.findCommentNode(comment.rid)\n      if (parent) {\n        parent.putChild(node, opts.nestSortBy === 'DATE_ASC' ? 'append' : 'prepend')\n\n        // 若父评论存在 “子评论部分” 限高，取消限高\n        node.getParents().forEach((p) => {\n          p.getRender().heightLimitRemoveForChildren()\n        })\n      }\n    }\n\n    node.getRender().checkHeightLimit()\n\n    node.scrollIntoView() // 滚动到可以见\n    node.getRender().playFadeAnim() // 播放评论渐出动画\n  },\n})\n","import type { CommentData } from '@/types'\n\nexport type CommentNode = {\n  id: number\n  comment: CommentData\n  children: CommentNode[]\n  parent?: CommentNode\n  level: number\n}\n\nexport type SortByType = 'DATE_DESC' | 'DATE_ASC' | 'SRC_INDEX' | 'VOTE_UP_DESC'\n\n// 构建树状结构列表\nexport function makeNestCommentNodeList(\n  srcData: CommentData[],\n  sortBy: SortByType = 'DATE_DESC',\n  nestMax = 2,\n) {\n  const nodeList: CommentNode[] = []\n\n  const roots = srcData.filter((o) => o.rid === 0)\n  roots.forEach((root: CommentData) => {\n    const rootNode: CommentNode = {\n      id: root.id,\n      comment: root,\n      children: [],\n      level: 1,\n    }\n\n    rootNode.parent = rootNode\n    nodeList.push(rootNode)\n    ;(function loadChildren(parentNode: CommentNode) {\n      const children = srcData.filter((o) => o.rid === parentNode.id)\n      if (children.length === 0) return\n      if (parentNode.level >= nestMax) parentNode = parentNode.parent!\n      children.forEach((child: CommentData) => {\n        const childNode: CommentNode = {\n          id: child.id,\n          comment: child,\n          children: [],\n          parent: parentNode,\n          level: parentNode.level + 1,\n        }\n\n        parentNode.children.push(childNode)\n        loadChildren(childNode)\n      })\n    })(rootNode)\n  })\n\n  // 排序\n  const sortFunc = (a: CommentNode, b: CommentNode): number => {\n    let v = a.id - b.id\n    if (sortBy === 'DATE_ASC') v = +new Date(a.comment.date) - +new Date(b.comment.date)\n    else if (sortBy === 'DATE_DESC') v = +new Date(b.comment.date) - +new Date(a.comment.date)\n    else if (sortBy === 'SRC_INDEX') v = srcData.indexOf(a.comment) - srcData.indexOf(b.comment)\n    else if (sortBy === 'VOTE_UP_DESC') v = b.comment.vote_up - a.comment.vote_up\n    return v\n  }\n\n  ;(function sortLevels(nodes: CommentNode[]) {\n    nodes.forEach((node) => {\n      node.children = node.children.sort(sortFunc)\n      sortLevels(node.children)\n    })\n  })(nodeList)\n\n  return nodeList\n}\n","import type { LayoutStrategyCreator, LayoutOptions } from '.'\nimport type { CommentData } from '@/types'\nimport * as Ui from '@/lib/ui'\n\nexport const createFlatStrategy: LayoutStrategyCreator = (opts) => ({\n  import: (comments) => {\n    comments.forEach((comment: CommentData) => {\n      const replyComment =\n        comment.rid === 0 ? undefined : comments.find((c) => c.id === comment.rid)\n      insertComment(opts, 'append', comment, replyComment)\n    })\n  },\n  insert: (comment, replyComment) => {\n    const node = insertComment(opts, 'prepend', comment, replyComment)\n    node.scrollIntoView()\n  },\n})\n\n/** 导入评论 · 平铺模式 */\nfunction insertComment(\n  opts: LayoutOptions,\n  insertMode: 'append' | 'prepend',\n  comment: CommentData,\n  replyComment?: CommentData | undefined,\n) {\n  if (comment.is_collapsed) comment.is_allow_reply = false\n  const node = opts.createCommentNode(comment, replyComment)\n\n  // 可见评论添加到界面\n  // 注：不可见评论用于显示 “引用内容”\n  if (comment.visible) {\n    const $comment = node.getEl()\n    const $listCommentsWrap = opts.$commentsWrap\n    if (insertMode === 'append') $listCommentsWrap?.append($comment)\n    if (insertMode === 'prepend') $listCommentsWrap?.prepend($comment)\n    node.getRender().playFadeAnim()\n  }\n\n  // 平铺评论插入后 · 内容限高检测\n  // 插入列表的评论 (visible=true) 和关联的评论 (visible=false) 都需要检测\n  node.getRender().checkHeightLimit()\n\n  return node\n}\n","import * as ListNest from '../nest'\nimport { createNestStrategy } from './nest'\nimport { createFlatStrategy } from './flat'\nimport type { CommentNode } from '@/comment'\nimport type { CommentData } from '@/types'\n\nexport interface LayoutOptions {\n  /** The comments wrap of list */\n  $commentsWrap: HTMLElement\n  nestSortBy: ListNest.SortByType\n  nestMax: number\n  flatMode: boolean\n\n  createCommentNode(comment: CommentData, replyComment?: CommentData): CommentNode\n  findCommentNode(id: number): CommentNode | undefined\n}\n\nexport interface LayoutStrategy {\n  import(comments: CommentData[]): void\n  insert(comment: CommentData, replyComment?: CommentData): void\n}\n\nexport type LayoutStrategyCreator = (opts: LayoutOptions) => LayoutStrategy\n\nexport class ListLayout {\n  constructor(private options: LayoutOptions) {}\n\n  private getStrategy() {\n    return this.options.flatMode\n      ? createFlatStrategy(this.options)\n      : createNestStrategy(this.options)\n  }\n\n  import(comments: CommentData[]) {\n    this.getStrategy().import(comments)\n  }\n\n  insert(comment: CommentData, replyComment?: CommentData) {\n    this.getStrategy().insert(comment, replyComment)\n  }\n}\n","import * as Utils from '../lib/utils'\nimport $t from '../i18n'\n\nexport interface IHeightLimitConf {\n  /** After expand btn click */\n  afterExpandBtnClick?: () => void\n  /** Allow Scroll */\n  scrollable?: boolean\n}\n\nexport interface IHeightLimitRule {\n  /** Target element need to check */\n  el: HTMLElement | null | undefined\n\n  /** Max height (unit: px) */\n  max: number\n\n  /** Whether or not the element contains `<img />` */\n  imgCheck?: boolean\n}\n\nexport type THeightLimitRuleSet = IHeightLimitRule[]\n\n/** Check all elements below the max height limit */\nexport function check(conf: IHeightLimitConf, rules: THeightLimitRuleSet) {\n  rules.forEach(({ el, max, imgCheck }) => {\n    if (!el) return\n\n    // set max height for avoiding img exceed the limit while loading\n    if (imgCheck) el.style.maxHeight = `${max + 1}px` // allow 1px more for next detecting\n\n    let lock = false\n    const _check = () => {\n      if (lock) return\n      if (Utils.getHeight(el) <= max) return // if not exceed the limit, do nothing\n\n      const afterExpandBtnClick = () => {\n        lock = true // add lock to prevent collapse again after expand when image lazy loaded\n        conf.afterExpandBtnClick?.()\n      }\n\n      !conf.scrollable\n        ? applyHeightLimit({ el, max, afterExpandBtnClick })\n        : applyScrollableHeightLimit({ el, max })\n    }\n\n    // check immediately\n    _check()\n\n    // check images after loaded\n    if (imgCheck) {\n      // check again when image loaded\n      const imgs = el.querySelectorAll<HTMLImageElement>('.atk-content img')\n      if (imgs.length === 0) el.style.maxHeight = ''\n      imgs.forEach((img) => {\n        img.onload = () => _check()\n      })\n    }\n  })\n}\n\n/** Height limit CSS class name */\nconst HEIGHT_LIMIT_CSS = 'atk-height-limit'\n\n/** Apply height limit on an element and add expand btn */\nexport function applyHeightLimit(obj: {\n  el: HTMLElement\n  max: number\n  afterExpandBtnClick?: (e: MouseEvent) => void\n}) {\n  if (!obj.el) return\n  if (!obj.max) return\n  if (obj.el.classList.contains(HEIGHT_LIMIT_CSS)) return\n\n  obj.el.classList.add(HEIGHT_LIMIT_CSS)\n  obj.el.style.height = `${obj.max}px`\n  obj.el.style.overflow = 'hidden'\n\n  /* Expand button */\n  const $expandBtn = Utils.createElement(\n    `<div class=\"atk-height-limit-btn\">${$t('readMore')}</span>`,\n  )\n  $expandBtn.onclick = (e) => {\n    e.stopPropagation()\n    disposeHeightLimit(obj.el)\n\n    if (obj.afterExpandBtnClick) obj.afterExpandBtnClick(e)\n  }\n  obj.el.append($expandBtn)\n}\n\n/** Dispose height limit on an element and remove expand btn */\nexport function disposeHeightLimit($el: HTMLElement) {\n  if (!$el) return\n  if (!$el.classList.contains(HEIGHT_LIMIT_CSS)) return\n\n  $el.classList.remove(HEIGHT_LIMIT_CSS)\n  Array.from($el.children).forEach((e) => {\n    if (e.classList.contains('atk-height-limit-btn')) e.remove()\n  })\n  $el.style.height = ''\n  $el.style.maxHeight = ''\n  $el.style.overflow = ''\n}\n\n/** Height limit scrollable CSS class name */\nconst HEIGHT_LIMIT_SCROLL_CSS = 'atk-height-limit-scroll'\n\n/** Apply scrollable height limit */\nexport function applyScrollableHeightLimit(opt: { el: HTMLElement; max: number }) {\n  if (!opt.el) return\n  if (opt.el.classList.contains(HEIGHT_LIMIT_SCROLL_CSS)) return\n  opt.el.classList.add(HEIGHT_LIMIT_SCROLL_CSS)\n  opt.el.style.height = `${opt.max}px`\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * 评论头部界面\n */\nexport default function renderHeader(r: Render) {\n  Object.entries({\n    renderNick,\n    renderVerifyBadge,\n    renderDate,\n    renderUABadge,\n  }).forEach(([name, render]) => {\n    render(r)\n  })\n}\n\nfunction renderNick(r: Render) {\n  r.$headerNick = r.$el.querySelector<HTMLElement>('.atk-nick')!\n\n  if (r.data.link) {\n    const $nickA = Utils.createElement<HTMLLinkElement>(\n      '<a target=\"_blank\" rel=\"noreferrer noopener nofollow\"></a>',\n    )\n    $nickA.innerText = r.data.nick\n    $nickA.href = Utils.isValidURL(r.data.link) ? r.data.link : `https://${r.data.link}`\n    r.$headerNick.append($nickA)\n  } else {\n    r.$headerNick.innerText = r.data.nick\n  }\n}\n\nfunction renderVerifyBadge(ctx: Render) {\n  ctx.$headerBadgeWrap = ctx.$el.querySelector<HTMLElement>('.atk-badge-wrap')!\n  ctx.$headerBadgeWrap.innerHTML = ''\n\n  const badgeText = ctx.data.badge_name\n  const badgeColor = ctx.data.badge_color\n  if (badgeText) {\n    const $badge = Utils.createElement(`<span class=\"atk-badge\"></span>`)\n    $badge.innerText = badgeText.replace('管理员', $t('admin')) // i18n patch\n    $badge.style.backgroundColor = badgeColor || ''\n    ctx.$headerBadgeWrap.append($badge)\n  } else if (ctx.data.is_verified) {\n    const $verifiedBadge = Utils.createElement(\n      `<span class=\"atk-verified-icon\" title=\"${$t('emailVerified')}\"></span>`,\n    ) // 邮箱验证徽章\n    ctx.$headerBadgeWrap.append($verifiedBadge)\n  }\n\n  if (ctx.data.is_pinned) {\n    const $pinnedBadge = Utils.createElement(`<span class=\"atk-pinned-badge\">${$t('pin')}</span>`) // 置顶徽章\n    ctx.$headerBadgeWrap.append($pinnedBadge)\n  }\n}\n\nfunction renderDate(ctx: Render) {\n  const $date = ctx.$el.querySelector<HTMLElement>('.atk-date')!\n  $date.innerText = ctx.comment.getDateFormatted()\n  $date.setAttribute('data-atk-comment-date', String(+new Date(ctx.data.date)))\n}\n\nfunction renderUABadge(ctx: Render) {\n  if (!ctx.opts.uaBadge && !ctx.data.ip_region) return\n\n  let $uaWrap = ctx.$header.querySelector('atk-ua-wrap')\n  if (!$uaWrap) {\n    $uaWrap = Utils.createElement(`<span class=\"atk-ua-wrap\"></span>`)\n    ctx.$header.append($uaWrap)\n  }\n\n  $uaWrap.innerHTML = ''\n\n  if (ctx.data.ip_region) {\n    const $regionBadge = Utils.createElement(`<span class=\"atk-region-badge\"></span>`)\n    $regionBadge.innerText = ctx.data.ip_region\n    $uaWrap.append($regionBadge)\n  }\n\n  if (ctx.opts.uaBadge) {\n    const { browser, os } = ctx.comment.getUserUA()\n    if (String(browser).trim()) {\n      const $uaBrowser = Utils.createElement(`<span class=\"atk-ua ua-browser\"></span>`)\n      $uaBrowser.innerText = browser\n      $uaWrap.append($uaBrowser)\n    }\n\n    if (String(os).trim()) {\n      const $usOS = Utils.createElement(`<span class=\"atk-ua ua-os\"></span>`)\n      $usOS.innerText = os\n      $uaWrap.append($usOS)\n    }\n  }\n}\n","import * as Utils from '../lib/utils'\nimport $t from '@/i18n'\n\ninterface ActionBtnOptions {\n  /** 按钮文字 (动态/静态) */\n  text: (() => string) | string\n\n  /** 仅管理员可用 */\n  adminOnly?: boolean\n\n  /** 确认操作 */\n  confirm?: boolean\n\n  /** 确认时提示文字 */\n  confirmText?: string\n}\n\n/**\n * 通用操作按钮\n */\nexport default class ActionBtn {\n  private opts: ActionBtnOptions\n  public $el: HTMLElement\n\n  public isLoading = false // 正在加载\n\n  public msgRecTimer?: number // 消息显示复原定时器\n  public msgRecTimerFunc?: () => void // 消息显示复原操作\n  public get isMessaging() {\n    return !!this.msgRecTimer\n  } // 消息正在显示\n\n  public isConfirming = false // 正在确认\n  public confirmRecTimer?: number // 确认消息复原定时器\n\n  /** 构造函数 */\n  constructor(opts: ActionBtnOptions | string | (() => string)) {\n    this.$el = Utils.createElement(`<span class=\"atk-common-action-btn\"></span>`)\n\n    this.opts = typeof opts !== 'object' ? { text: opts } : opts\n    this.$el.innerText = this.getText()\n\n    // 仅管理员可操作\n    if (this.opts.adminOnly) this.$el.setAttribute('atk-only-admin-show', '')\n  }\n\n  /** 将按钮装载到指定元素 */\n  public appendTo(dom: HTMLElement) {\n    dom.append(this.$el)\n    return this\n  }\n\n  /** 获取按钮文字（动态/静态） */\n  private getText() {\n    return typeof this.opts.text === 'string' ? this.opts.text : this.opts.text()\n  }\n\n  /** 设置点击事件 */\n  public setClick(func: () => void) {\n    this.$el.onclick = (e) => {\n      e.stopPropagation() // 防止穿透\n\n      // 按钮处于加载状态，禁止点击\n      if (this.isLoading) {\n        return\n      }\n\n      // 操作确认\n      if (this.opts.confirm && !this.isMessaging) {\n        const confirmRestore = () => {\n          this.isConfirming = false\n          this.$el.classList.remove('atk-btn-confirm')\n          this.$el.innerText = this.getText()\n        }\n\n        if (!this.isConfirming) {\n          this.isConfirming = true\n          this.$el.classList.add('atk-btn-confirm')\n          this.$el.innerText = this.opts.confirmText || $t('actionConfirm')\n          this.confirmRecTimer = window.setTimeout(() => confirmRestore(), 5000)\n          return\n        }\n\n        if (this.confirmRecTimer) window.clearTimeout(this.confirmRecTimer)\n        confirmRestore()\n      }\n\n      // 立刻释放掉原有的定时器（当显示消息后，用户立刻点击时）\n      if (this.msgRecTimer) {\n        this.fireMsgRecTimer()\n        this.clearMsgRecTimer()\n        return\n      }\n\n      // 触发设定的点击事件\n      func()\n    }\n  }\n\n  /** 文字刷新（动态/静态） */\n  public updateText(text?: (() => string) | string) {\n    if (text) this.opts.text = text\n    this.setLoading(false)\n    this.$el.innerText = this.getText()\n  }\n\n  /** 设置加载状态 */\n  public setLoading(value: boolean, loadingText?: string) {\n    if (this.isLoading === value) return\n    this.isLoading = value\n    if (value) {\n      this.$el.classList.add('atk-btn-loading')\n      this.$el.innerText = loadingText || `${$t('loading')}...`\n    } else {\n      this.$el.classList.remove('atk-btn-loading')\n      this.$el.innerText = this.getText()\n    }\n  }\n\n  /** 错误消息 */\n  public setError(text: string) {\n    this.setMsg(text, 'atk-btn-error')\n  }\n\n  /** 警告消息 */\n  public setWarn(text: string) {\n    this.setMsg(text, 'atk-btn-warn')\n  }\n\n  /** 成功消息 */\n  public setSuccess(text: string) {\n    this.setMsg(text, 'atk-btn-success')\n  }\n\n  /** 设置消息 */\n  public setMsg(text: string, className?: string, duringTime?: number, after?: () => void) {\n    this.setLoading(false)\n    if (className) this.$el.classList.add(className)\n    this.$el.innerText = text\n\n    // 设定复原 timer\n    this.setMsgRecTimer(() => {\n      this.$el.innerText = this.getText()\n      if (className) this.$el.classList.remove(className)\n      if (after) after()\n    }, duringTime || 2500) // 消息默认显示持续 2500s\n  }\n\n  /** 设置消息复原操作定时器 */\n  private setMsgRecTimer(func: () => void, duringTime: number) {\n    this.fireMsgRecTimer()\n    this.clearMsgRecTimer()\n\n    this.msgRecTimerFunc = func\n    this.msgRecTimer = window.setTimeout(() => {\n      func()\n      this.clearMsgRecTimer()\n    }, duringTime)\n  }\n\n  /** 立刻触发器复原定时器 */\n  private fireMsgRecTimer() {\n    if (this.msgRecTimerFunc) this.msgRecTimerFunc()\n  }\n\n  /** 仅清除 timer */\n  private clearMsgRecTimer() {\n    if (this.msgRecTimer) window.clearTimeout(this.msgRecTimer)\n    this.msgRecTimer = undefined\n    this.msgRecTimerFunc = undefined\n  }\n}\n","import * as Utils from '../../lib/utils'\nimport ActionBtn from '../../components/action-btn'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * 评论操作按钮界面\n */\nexport default function renderActions(r: Render) {\n  Object.entries({\n    renderVote,\n    renderReply,\n    // 管理员操作\n    renderCollapse,\n    renderModerator,\n    renderPin,\n    renderEdit,\n    renderDel,\n  }).forEach(([name, render]) => {\n    render(r)\n  })\n}\n\n// 操作按钮 - 投票\nfunction renderVote(r: Render) {\n  if (!r.opts.vote) return // 关闭投票功能\n\n  // 赞同按钮\n  r.voteBtnUp = new ActionBtn(() => `${$t('voteUp')} (${r.data.vote_up || 0})`).appendTo(r.$actions)\n  r.voteBtnUp.setClick(() => {\n    r.comment.getActions().vote('up')\n  })\n\n  // 反对按钮\n  if (r.opts.voteDown) {\n    r.voteBtnDown = new ActionBtn(() => `${$t('voteDown')} (${r.data.vote_down || 0})`).appendTo(\n      r.$actions,\n    )\n    r.voteBtnDown.setClick(() => {\n      r.comment.getActions().vote('down')\n    })\n  }\n}\n\n// 操作按钮 - 回复\nfunction renderReply(r: Render) {\n  if (!r.data.is_allow_reply) return // 不允许回复\n\n  const replyBtn = Utils.createElement(`<span>${$t('reply')}</span>`)\n  r.$actions.append(replyBtn)\n  replyBtn.addEventListener('click', (e) => {\n    e.stopPropagation() // 防止穿透\n    r.opts.replyComment(r.data, r.$el)\n  })\n}\n\n// 操作按钮 - 折叠\nfunction renderCollapse(r: Render) {\n  const collapseBtn = new ActionBtn({\n    text: () => (r.data.is_collapsed ? $t('expand') : $t('collapse')),\n    adminOnly: true,\n  })\n  collapseBtn.appendTo(r.$actions)\n  collapseBtn.setClick(() => {\n    r.comment.getActions().adminEdit('collapsed', collapseBtn)\n  })\n}\n\n// 操作按钮 - 审核\nfunction renderModerator(r: Render) {\n  const pendingBtn = new ActionBtn({\n    text: () => (r.data.is_pending ? $t('pending') : $t('approved')),\n    adminOnly: true,\n  })\n  pendingBtn.appendTo(r.$actions)\n  pendingBtn.setClick(() => {\n    r.comment.getActions().adminEdit('pending', pendingBtn)\n  })\n}\n\n// 操作按钮 - 置顶\nfunction renderPin(r: Render) {\n  const pinnedBtn = new ActionBtn({\n    text: () => (r.data.is_pinned ? $t('unpin') : $t('pin')),\n    adminOnly: true,\n  })\n  pinnedBtn.appendTo(r.$actions)\n  pinnedBtn.setClick(() => {\n    r.comment.getActions().adminEdit('pinned', pinnedBtn)\n  })\n}\n\n// 操作按钮 - 编辑\nfunction renderEdit(r: Render) {\n  const editBtn = new ActionBtn({\n    text: $t('edit'),\n    adminOnly: true,\n  })\n  editBtn.appendTo(r.$actions)\n  editBtn.setClick(() => {\n    r.opts.editComment(r.data, r.$el)\n  })\n}\n\n// 操作按钮 - 删除\nfunction renderDel(r: Render) {\n  const delBtn = new ActionBtn({\n    text: $t('delete'),\n    confirm: true,\n    confirmText: $t('deleteConfirm'),\n    adminOnly: true,\n  })\n  delBtn.appendTo(r.$actions)\n  delBtn.setClick(() => {\n    r.comment.getActions().adminDelete(delBtn)\n  })\n}\n","import type Render from '../render'\nimport Avatar from './avatar'\nimport Header from './header'\nimport Content from './content'\nimport ReplyAt from './reply-at'\nimport ReplyTo from './reply-to'\nimport Pending from './pending'\nimport Actions from './actions'\n\nconst Renders = {\n  Avatar,\n  Header,\n  Content,\n  ReplyAt,\n  ReplyTo,\n  Pending,\n  Actions,\n}\n\nexport default function loadRenders(r: Render) {\n  Object.entries(Renders).forEach(([name, render]) => {\n    render(r)\n  })\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * 评论头像界面\n */\nexport default function renderAvatar(r: Render) {\n  const $avatar = r.$el.querySelector<HTMLElement>('.atk-avatar')!\n  const $avatarImg = Utils.createElement<HTMLImageElement>('<img />')\n\n  const avatarURLBuilder = r.opts.avatarURLBuilder\n  $avatarImg.src = avatarURLBuilder ? avatarURLBuilder(r.data) : r.comment.getGravatarURL()\n\n  if (r.data.link) {\n    const $avatarA = Utils.createElement<HTMLLinkElement>(\n      '<a target=\"_blank\" rel=\"noreferrer noopener nofollow\"></a>',\n    )\n    $avatarA.href = Utils.isValidURL(r.data.link) ? r.data.link : `https://${r.data.link}`\n    $avatarA.append($avatarImg)\n    $avatar.append($avatarA)\n  } else {\n    $avatar.append($avatarImg)\n  }\n}\n","import * as Utils from '../../lib/utils'\nimport * as Ui from '../../lib/ui'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * 评论内容界面\n */\nexport default function renderContent(r: Render) {\n  if (!r.data.is_collapsed) {\n    r.$content.innerHTML = r.comment.getContentMarked()\n    r.$content.classList.remove('atk-hide', 'atk-collapsed')\n    return\n  }\n\n  // 内容 & 折叠\n  r.$content.classList.add('atk-hide', 'atk-type-collapsed')\n  const collapsedInfoEl = Utils.createElement(`\n    <div class=\"atk-collapsed\">\n      <span class=\"atk-text\">${$t('collapsedMsg')}</span>\n      <span class=\"atk-show-btn\">${$t('expand')}</span>\n    </div>`)\n  r.$body.insertAdjacentElement('beforeend', collapsedInfoEl)\n\n  const contentShowBtn = collapsedInfoEl.querySelector<HTMLElement>('.atk-show-btn')!\n  contentShowBtn.addEventListener('click', (e) => {\n    e.stopPropagation() // 防止穿透\n\n    if (r.$content.classList.contains('atk-hide')) {\n      r.$content.innerHTML = r.comment.getContentMarked()\n      r.$content.classList.remove('atk-hide')\n      Ui.playFadeInAnim(r.$content)\n      contentShowBtn.innerText = $t('collapse')\n    } else {\n      r.$content.innerHTML = ''\n      r.$content.classList.add('atk-hide')\n      contentShowBtn.innerText = $t('expand')\n    }\n  })\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * Reply user indicator (with arrow icon) in the comment meta header\n */\nexport default function renderReplyAt(r: Render) {\n  if (r.opts.flatMode || r.data.rid === 0) return // if not nested mode or root comment\n  if (!r.opts.replyTo) return // if no replyTo data\n\n  r.$replyAt = Utils.createElement(\n    `<span class=\"atk-item atk-reply-at\"><span class=\"atk-arrow\"></span><span class=\"atk-nick\"></span></span>`,\n  )\n  r.$replyAt.querySelector<HTMLElement>('.atk-nick')!.innerText = `${r.opts.replyTo.nick}`\n  r.$replyAt.onclick = () => {\n    r.comment.getActions().goToReplyComment()\n  }\n\n  r.$headerBadgeWrap.insertAdjacentElement('afterend', r.$replyAt)\n}\n","import type Render from '../render'\nimport * as Utils from '@/lib/utils'\nimport marked from '@/lib/marked'\nimport $t from '@/i18n'\n\n/**\n * 关联评论显示 (被回复的评论)\n */\nexport default function renderReplyTo(r: Render) {\n  if (!r.opts.flatMode) return // 仅平铺模式显示\n  if (!r.opts.replyTo) return\n\n  r.$replyTo = Utils.createElement(`\n    <div class=\"atk-reply-to\">\n      <div class=\"atk-meta\">${$t('reply')} <span class=\"atk-nick\"></span>:</div>\n      <div class=\"atk-content\"></div>\n    </div>`)\n\n  // Comment author name\n  const $nick = r.$replyTo.querySelector<HTMLElement>('.atk-nick')!\n  $nick.innerText = `@${r.opts.replyTo.nick}`\n  $nick.onclick = () => {\n    r.comment.getActions().goToReplyComment()\n  }\n\n  // Comment content\n  let replyContent = marked(r.opts.replyTo.content)\n  if (r.opts.replyTo.is_collapsed) replyContent = `[${$t('collapsed')}]`\n  r.$replyTo.querySelector<HTMLElement>('.atk-content')!.innerHTML = replyContent\n\n  // Mount the replyTo element\n  r.$body.prepend(r.$replyTo)\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\nimport $t from '@/i18n'\n\n/**\n * 待审核状态界面\n */\nexport default function renderPending(r: Render) {\n  if (!r.data.is_pending) return\n\n  const pendingEl = Utils.createElement(`<div class=\"atk-pending\">${$t('pendingMsg')}</div>`)\n  r.$body.prepend(pendingEl)\n}\n","import ActionBtn from '../components/action-btn'\nimport * as Utils from '../lib/utils'\nimport * as Ui from '../lib/ui'\n\nimport * as HeightLimit from './height-limit'\nimport CommentHTML from './comment.html?raw'\nimport loadRenders from './renders'\nimport type { CommentNode } from '.'\n\nexport default class Render {\n  public comment: CommentNode\n\n  public get data() {\n    return this.comment.getData()\n  }\n  public get opts() {\n    return this.comment.getOpts()\n  }\n\n  public $el!: HTMLElement\n  public $main!: HTMLElement\n  public $header!: HTMLElement\n  public $headerNick!: HTMLElement\n  public $headerBadgeWrap!: HTMLElement\n  public $body!: HTMLElement\n  public $content!: HTMLElement\n  public $childrenWrap!: HTMLElement | null\n  public $actions!: HTMLElement\n  public voteBtnUp?: ActionBtn\n  public voteBtnDown?: ActionBtn\n\n  public $replyTo?: HTMLElement // 回复评论内容 (平铺下显示)\n  public $replyAt?: HTMLElement // 回复 AT（层级嵌套下显示）\n\n  public constructor(comment: CommentNode) {\n    this.comment = comment\n  }\n\n  /**\n   * Render the comment ui\n   *\n   * If comment data is updated, call this method to re-render the comment ui.\n   * The method will be called multiple times, so it should be idempotent.\n   *\n   * Renders may add event listeners to the comment ui, so it should be called only once or override the original.\n   * Please be aware of the memory leak caused by the event listener.\n   */\n  public render() {\n    // init ui elements\n    this.$el = Utils.createElement(CommentHTML)\n\n    this.$main = this.$el.querySelector('.atk-main')!\n    this.$header = this.$el.querySelector('.atk-header')!\n    this.$body = this.$el.querySelector('.atk-body')!\n    this.$content = this.$body.querySelector('.atk-content')!\n    this.$actions = this.$el.querySelector('.atk-actions')!\n\n    this.$el.setAttribute('id', `atk-comment-${this.data.id}`)\n\n    // call all renders\n    loadRenders(this)\n\n    // append children wrap if exists\n    if (this.$childrenWrap) {\n      this.$main.append(this.$childrenWrap)\n    }\n\n    return this.$el\n  }\n\n  /** 内容限高检测 */\n  public checkHeightLimit() {\n    const conf = this.opts.heightLimit\n    if (!conf || !conf.content || !conf.children) return // 关闭限高\n\n    const contentMaxH = conf.content\n    const childrenMaxH = conf.children\n\n    HeightLimit.check(\n      {\n        afterExpandBtnClick: () => {\n          // 子评论数仅有 1，直接取消限高\n          const children = this.comment.getChildren()\n          if (children.length === 1)\n            HeightLimit.disposeHeightLimit(children[0].getRender().$content)\n        },\n        scrollable: conf.scrollable,\n      },\n      [\n        // 评论内容限高\n        { el: this.$content, max: contentMaxH, imgCheck: true },\n        { el: this.$replyTo, max: contentMaxH, imgCheck: true },\n        // 子评论区域限高（仅嵌套模式）\n        { el: this.$childrenWrap, max: childrenMaxH, imgCheck: false },\n      ],\n    )\n  }\n\n  /** 子评论区域移除限高 */\n  public heightLimitRemoveForChildren() {\n    if (!this.$childrenWrap) return\n    HeightLimit.disposeHeightLimit(this.$childrenWrap)\n  }\n\n  /** 渐出动画 */\n  playFadeAnim() {\n    Ui.playFadeInAnim(this.comment.getRender().$el)\n  }\n\n  /** 渐出动画 · 评论内容区域 */\n  playFadeAnimForBody() {\n    Ui.playFadeInAnim(this.comment.getRender().$body)\n  }\n\n  /** Perform the flash animation */\n  playFlashAnim() {\n    // Make sure the class is removed\n    this.$el.classList.remove('atk-flash-once')\n    window.setTimeout(() => {\n      // Add the class to perform the animation\n      this.$el.classList.add('atk-flash-once')\n    }, 150)\n  }\n\n  /** 获取子评论 Wrap */\n  public getChildrenWrap() {\n    if (!this.$childrenWrap) {\n      // if not exists, create a new one\n      this.$childrenWrap = Utils.createElement('<div class=\"atk-comment-children\"></div>')\n      this.$main.append(this.$childrenWrap)\n    }\n    return this.$childrenWrap\n  }\n\n  /** 设置已读 */\n  public setUnread(val: boolean) {\n    if (val) this.$el.classList.add('atk-unread')\n    else this.$el.classList.remove('atk-unread')\n  }\n\n  /** 设置为可点击的评论 */\n  public setOpenable(val: boolean) {\n    if (val) this.$el.classList.add('atk-openable')\n    else this.$el.classList.remove('atk-openable')\n  }\n\n  /** 设置点击评论打开置顶 URL */\n  public setOpenURL(url: string) {\n    this.setOpenable(true)\n    this.$el.onclick = (evt) => {\n      evt.stopPropagation()\n      window.open(url)\n    }\n  }\n\n  /** 设置点击评论时的操作 */\n  public setOpenAction(action: () => void) {\n    this.setOpenable(true)\n    this.$el.onclick = (evt) => {\n      evt.stopPropagation()\n      action()\n    }\n  }\n}\n","export default \"<div class=\\\"atk-comment-wrap\\\">\\n  <div class=\\\"atk-comment\\\">\\n    <div class=\\\"atk-avatar\\\"></div>\\n    <div class=\\\"atk-main\\\">\\n      <div class=\\\"atk-header\\\">\\n        <span class=\\\"atk-item atk-nick\\\"></span>\\n        <span class=\\\"atk-badge-wrap\\\"></span>\\n        <span class=\\\"atk-item atk-date\\\"></span>\\n      </div>\\n      <div class=\\\"atk-body\\\">\\n        <div class=\\\"atk-content\\\"></div>\\n      </div>\\n      <div class=\\\"atk-footer\\\">\\n        <div class=\\\"atk-actions\\\"></div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\"","import type { CommentNode } from '.'\nimport ActionBtn from '@/components/action-btn'\nimport $t from '@/i18n'\n\nexport default class CommentActions {\n  private comment: CommentNode\n\n  private get data() {\n    return this.comment.getData()\n  }\n  private get opts() {\n    return this.comment.getOpts()\n  }\n  private getApi() {\n    return this.comment.getOpts().getApi()\n  }\n\n  public constructor(comment: CommentNode) {\n    this.comment = comment\n  }\n\n  /** 投票操作 */\n  public vote(type: 'up' | 'down') {\n    const actionBtn =\n      type === 'up' ? this.comment.getRender().voteBtnUp : this.comment.getRender().voteBtnDown\n\n    this.getApi()\n      .votes.vote(`comment_${type}`, this.data.id, {\n        ...this.getApi().getUserFields(),\n      })\n      .then((res) => {\n        this.data.vote_up = res.data.up\n        this.data.vote_down = res.data.down\n        this.comment.getRender().voteBtnUp?.updateText()\n        this.comment.getRender().voteBtnDown?.updateText()\n      })\n      .catch((err) => {\n        actionBtn?.setError($t('voteFail'))\n        console.error(err)\n      })\n  }\n\n  /** 管理员 - 评论状态修改 */\n  public adminEdit(type: 'collapsed' | 'pending' | 'pinned', btnElem: ActionBtn) {\n    if (btnElem.isLoading) return // 若正在修改中\n\n    btnElem.setLoading(true, `${$t('editing')}...`)\n\n    // 克隆并修改当前数据\n    const modify = { ...this.data }\n    if (type === 'collapsed') {\n      modify.is_collapsed = !modify.is_collapsed\n    } else if (type === 'pending') {\n      modify.is_pending = !modify.is_pending\n    } else if (type === 'pinned') {\n      modify.is_pinned = !modify.is_pinned\n    }\n\n    this.getApi()\n      .comments.updateComment(this.data.id, {\n        ...modify,\n      })\n      .then((res) => {\n        btnElem.setLoading(false)\n\n        // 刷新当前 Comment UI\n        this.comment.setData(res.data)\n      })\n      .catch((err) => {\n        console.error(err)\n        btnElem.setError($t('editFail'))\n      })\n  }\n\n  /** 管理员 - 评论删除 */\n  public adminDelete(btnElem: ActionBtn) {\n    if (btnElem.isLoading) return // 若正在删除中\n\n    btnElem.setLoading(true, `${$t('deleting')}...`)\n    this.getApi()\n      .comments.deleteComment(this.data.id)\n      .then(() => {\n        btnElem.setLoading(false)\n        if (this.opts.onDelete) this.opts.onDelete(this.comment)\n      })\n      .catch((e) => {\n        console.error(e)\n        btnElem.setError($t('deleteFail'))\n      })\n  }\n\n  /** 快速跳转到该评论 */\n  public goToReplyComment() {\n    const origHash = window.location.hash\n    const modifyHash = `#atk-comment-${this.data.rid}`\n\n    window.location.hash = modifyHash\n    if (modifyHash === origHash) window.dispatchEvent(new Event('hashchange')) // 强制触发事件\n  }\n}\n","import type { Api } from '../api'\nimport * as Ui from '../lib/ui'\nimport * as Utils from '../lib/utils'\nimport marked from '../lib/marked'\nimport UADetect from '../lib/detect'\nimport CommentUI from './render'\nimport CommentActions from './actions'\nimport $t from '@/i18n'\nimport type { CommentData, ArtalkConfig, ContextApi } from '@/types'\n\nexport interface CommentOptions {\n  // Hooks\n  onAfterRender?: () => void\n  onDelete?: (c: CommentNode) => void\n\n  /** The comment being replied to (linked comment) */\n  replyTo?: CommentData\n\n  // Referenced from ArtalkConfig\n  flatMode: boolean\n  vote: boolean\n  voteDown: boolean\n  uaBadge: boolean\n  nestMax: number\n  gravatar: ArtalkConfig['gravatar']\n  heightLimit: ArtalkConfig['heightLimit']\n  avatarURLBuilder: ArtalkConfig['avatarURLBuilder']\n  scrollRelativeTo: ArtalkConfig['scrollRelativeTo']\n  dateFormatter: ArtalkConfig['dateFormatter']\n\n  // TODO: Move to plugin folder and remove from core\n  getApi: () => Api\n  replyComment: ContextApi['replyComment']\n  editComment: ContextApi['editComment']\n}\n\nexport default class CommentNode {\n  $el?: HTMLElement\n\n  private renderInstance: CommentUI\n  private actionInstance: CommentActions\n\n  private data: CommentData\n  private opts: CommentOptions\n\n  private parent: CommentNode | null\n  private children: CommentNode[] = []\n\n  private nestCurt: number // 当前嵌套层数\n\n  constructor(data: CommentData, opts: CommentOptions) {\n    this.opts = opts\n    this.data = { ...data }\n    this.data.date = this.data.date.replace(/-/g, '/') // 解决 Safari 日期解析 NaN 问题\n\n    this.parent = null\n    this.nestCurt = 1 // 现在已嵌套 n 层\n\n    this.actionInstance = new CommentActions(this)\n    this.renderInstance = new CommentUI(this)\n  }\n\n  /** 渲染 UI */\n  public render() {\n    const newEl = this.renderInstance.render()\n\n    if (this.$el) this.$el.replaceWith(newEl)\n    this.$el = newEl\n    // Please be aware of the memory leak, the $el may be replaced multiple times.\n    // If somewhere else has a reference to the old $el, it will cause a memory leak.\n    // So it's limited to use the $el reference by `getEl()`.\n    // The `getEl()` will always return the latest $el.\n\n    if (this.opts.onAfterRender) this.opts.onAfterRender()\n  }\n\n  /** 获取评论操作实例对象 */\n  public getActions() {\n    return this.actionInstance\n  }\n\n  /** 获取评论渲染器实例对象 */\n  public getRender() {\n    return this.renderInstance\n  }\n\n  /** 获取评论数据 */\n  public getData() {\n    return this.data\n  }\n\n  /** 设置数据 */\n  public setData(data: CommentData) {\n    this.data = data\n\n    this.render()\n    this.getRender().playFadeAnimForBody()\n  }\n\n  /** 获取父评论 */\n  public getParent() {\n    return this.parent\n  }\n\n  /** 获取所有子评论 */\n  public getChildren() {\n    return this.children\n  }\n\n  /** 获取当前嵌套层数 */\n  public getNestCurt() {\n    return this.nestCurt\n  }\n\n  /** 判断是否为根评论 */\n  public getIsRoot() {\n    return this.data.rid === 0\n  }\n\n  /** 获取评论 ID */\n  public getID() {\n    return this.data.id\n  }\n\n  /** 置入子评论 */\n  public putChild(childNode: CommentNode, insertMode: 'append' | 'prepend' = 'append') {\n    childNode.parent = this\n    childNode.nestCurt = this.nestCurt + 1 // 嵌套层数 +1\n    this.children.push(childNode)\n\n    const $childrenWrap = this.getChildrenWrapEl()\n    const $childComment = childNode.getEl()\n    if (insertMode === 'append') $childrenWrap.append($childComment)\n    else if (insertMode === 'prepend') $childrenWrap.prepend($childComment)\n\n    childNode.getRender().playFadeAnim()\n    childNode.getRender().checkHeightLimit() // 内容限高\n  }\n\n  /** 获取存放子评论的元素对象 */\n  public getChildrenWrapEl(): HTMLElement {\n    // console.log(this.nestCurt)\n    if (this.nestCurt >= this.opts.nestMax) {\n      return this.parent!.getChildrenWrapEl()\n    }\n    return this.getRender().getChildrenWrap()\n  }\n\n  /** 获取所有父评论 */\n  public getParents() {\n    const flattenParents: CommentNode[] = []\n    let parent = this.parent\n    while (parent) {\n      flattenParents.push(parent)\n      parent = parent.getParent()\n    }\n    return flattenParents\n  }\n\n  /**\n   * Get the element of the comment\n   *\n   * The `getEl()` will always return the latest $el after calling `render()`.\n   * Please be aware of the memory leak if you use the $el reference directly.\n   */\n  public getEl() {\n    if (!this.$el) throw new Error('comment element not initialized before `getEl()`')\n    return this.$el\n  }\n\n  /**\n   * Focus on the comment\n   *\n   * Scroll to the comment and perform flash animation\n   */\n  focus() {\n    if (!this.$el) throw new Error('comment element not initialized before `focus()`')\n\n    // 若父评论存在 “子评论部分” 限高，取消限高\n    this.getParents().forEach((p) => {\n      p.getRender().heightLimitRemoveForChildren()\n    })\n\n    // Scroll to comment\n    this.scrollIntoView()\n\n    // Perform flash animation\n    this.getRender().playFlashAnim()\n  }\n\n  scrollIntoView() {\n    this.$el &&\n      Ui.scrollIntoView(this.$el, false, this.opts.scrollRelativeTo && this.opts.scrollRelativeTo())\n  }\n\n  /**\n   * Remove the comment node\n   */\n  remove() {\n    this.$el?.remove()\n  }\n\n  /** 获取 Gravatar 头像 URL */\n  public getGravatarURL() {\n    return Utils.getGravatarURL({\n      mirror: this.opts.gravatar.mirror,\n      params: this.opts.gravatar.params,\n      emailHash: this.data.email_encrypted,\n    })\n  }\n\n  /** 获取评论 markdown 解析后的内容 */\n  public getContentMarked() {\n    return marked(this.data.content)\n  }\n\n  /** 获取格式化后的日期 */\n  public getDateFormatted() {\n    const date = new Date(this.data.date)\n    return this.opts.dateFormatter?.(date) || Utils.timeAgo(date, $t)\n  }\n\n  /** 获取用户 UserAgent 信息 */\n  public getUserUA() {\n    const info = UADetect(this.data.ua)\n    return {\n      browser: `${info.browser} ${info.version}`,\n      os: `${info.os} ${info.osVersion}`,\n    }\n  }\n\n  /** 获取配置 */\n  public getOpts() {\n    return this.opts\n  }\n}\n","function Detect(userAgent?: string) {\n  const win = (window as any) || {}\n  const nav = navigator || {}\n\n  const u = String(userAgent || nav.userAgent)\n  const dest = {\n    os: '',\n    osVersion: '',\n    engine: '',\n    browser: '',\n    device: '',\n    language: '',\n    version: ''\n  }\n\n  // 内核\n  const engineMatch = {\n    Trident: u.includes('Trident') || u.includes('NET CLR'),\n    Presto: u.includes('Presto'),\n    WebKit: u.includes('AppleWebKit'),\n    Gecko: u.includes('Gecko/')\n  }\n\n  // 浏览器\n  const browserMatch = {\n    Safari: u.includes('Safari'),\n    Chrome: u.includes('Chrome') || u.includes('CriOS'),\n    IE: u.includes('MSIE') || u.includes('Trident'),\n    Edge: u.includes('Edge') || u.includes('Edg'),\n    Firefox: u.includes('Firefox') || u.includes('FxiOS'),\n    'Firefox Focus': u.includes('Focus'),\n    Chromium: u.includes('Chromium'),\n    Opera: u.includes('Opera') || u.includes('OPR'),\n    Vivaldi: u.includes('Vivaldi'),\n    Yandex: u.includes('YaBrowser'),\n    Kindle: u.includes('Kindle') || u.includes('Silk/'),\n    360: u.includes('360EE') || u.includes('360SE'),\n    UC: u.includes('UC') || u.includes(' UBrowser'),\n    QQBrowser: u.includes('QQBrowser'),\n    QQ: u.includes('QQ/'),\n    Baidu: u.includes('Baidu') || u.includes('BIDUBrowser'),\n    Maxthon: u.includes('Maxthon'),\n    Sogou: u.includes('MetaSr') || u.includes('Sogou'),\n    LBBROWSER: u.includes('LBBROWSER'),\n    '2345Explorer': u.includes('2345Explorer'),\n    TheWorld: u.includes('TheWorld'),\n    MIUI: u.includes('MiuiBrowser'),\n    Quark: u.includes('Quark'),\n    Qiyu: u.includes('Qiyu'),\n    Wechat: u.includes('MicroMessenger'),\n    Taobao: u.includes('AliApp(TB'),\n    Alipay: u.includes('AliApp(AP'),\n    Weibo: u.includes('Weibo'),\n    Douban: u.includes('com.douban.frodo'),\n    Suning: u.includes('SNEBUY-APP'),\n    iQiYi: u.includes('IqiyiApp'),\n  }\n\n  // 系统或平台\n  const osMatch = {\n    Windows: u.includes('Windows'),\n    Linux: u.includes('Linux') || u.includes('X11'),\n    'macOS': u.includes('Macintosh'),\n    Android: u.includes('Android') || u.includes('Adr'),\n    Ubuntu: u.includes('Ubuntu'),\n    FreeBSD: u.includes('FreeBSD'),\n    Debian: u.includes('Debian'),\n    'Windows Phone': u.includes('IEMobile') || u.includes('Windows Phone'),\n    BlackBerry: u.includes('BlackBerry') || u.includes('RIM'),\n    MeeGo: u.includes('MeeGo'),\n    Symbian: u.includes('Symbian'),\n    iOS: u.includes('like Mac OS X'),\n    'Chrome OS': u.includes('CrOS'),\n    WebOS: u.includes('hpwOS'),\n  }\n\n  // 设备\n  const deviceMatch = {\n    Mobile: u.includes('Mobi') || u.includes('iPh') || u.includes('480'),\n    Tablet: u.includes('Tablet') || u.includes('Pad') || u.includes('Nexus 7')\n  }\n\n  // 修正\n  if (deviceMatch.Mobile) {\n    deviceMatch.Mobile = !(u.includes('iPad'))\n  } else if (browserMatch.Chrome && u.includes('Edg')) {\n    // Chrome 内核的 Edge\n    browserMatch.Chrome = false\n    browserMatch.Edge = true\n  } else if (win.showModalDialog && win.chrome) {\n    browserMatch.Chrome = false\n    browserMatch['360'] = true\n  }\n\n  // 默认设备\n  dest.device = 'PC'\n\n  // 语言\n  dest.language = (() => {\n    const g = ((nav as any).browserLanguage || nav.language)\n    const arr = g.split('-')\n    if (arr[1]) arr[1] = arr[1].toUpperCase()\n    return arr.join('_')\n  })()\n\n  // 应用判断数据\n  const hash = {\n    engine: engineMatch,\n    browser: browserMatch,\n    os: osMatch,\n    device: deviceMatch,\n  }\n  Object.entries(hash).forEach(([type, match]) => {\n    Object.entries(match).forEach(([name, result]) => {\n      if (result === true) dest[type] = name\n    })\n  })\n\n  // 系统版本信息\n  const osVersion = {\n    Windows: () => {\n      const v = u.replace(/^.*Windows NT ([\\d.]+);.*$/, '$1')\n      const wvHash = {\n        '6.4': '10',\n        '6.3': '8.1',\n        '6.2': '8',\n        '6.1': '7',\n        '6.0': 'Vista',\n        '5.2': 'XP',\n        '5.1': 'XP',\n        '5.0': '2000',\n        '10.0': '10',\n        '11.0': '11' // 自定的，不是微软官方的判断方法\n      }\n      return wvHash[v] || v\n    },\n    Android: () => u.replace(/^.*Android ([\\d.]+);.*$/, '$1'),\n    iOS: () => u.replace(/^.*OS ([\\d_]+) like.*$/, '$1').replace(/_/g, '.'),\n    Debian: () => u.replace(/^.*Debian\\/([\\d.]+).*$/, '$1'),\n    'Windows Phone': () => u.replace(/^.*Windows Phone( OS)? ([\\d.]+);.*$/, '$2'),\n    'macOS': () => u.replace(/^.*Mac OS X ([\\d_]+).*$/, '$1').replace(/_/g, '.'),\n    WebOS: () => u.replace(/^.*hpwOS\\/([\\d.]+);.*$/, '$1')\n  }\n\n  dest.osVersion = ''\n  if (osVersion[dest.os]) {\n    dest.osVersion = osVersion[dest.os]()\n    if (dest.osVersion === u) {\n      dest.osVersion = ''\n    }\n  }\n\n  // 浏览器版本信息\n  const version = {\n    Safari: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\n    Chrome: () => u.replace(/^.*Chrome\\/([\\d.]+).*$/, '$1').replace(/^.*CriOS\\/([\\d.]+).*$/, '$1'),\n    IE: () => u.replace(/^.*MSIE ([\\d.]+).*$/, '$1').replace(/^.*rv:([\\d.]+).*$/, '$1'),\n    Edge: () => u.replace(/^.*(Edge|Edg|Edg[A-Z]{1})\\/([\\d.]+).*$/, '$2'),\n    Firefox: () => u.replace(/^.*Firefox\\/([\\d.]+).*$/, '$1').replace(/^.*FxiOS\\/([\\d.]+).*$/, '$1'),\n    'Firefox Focus': () => u.replace(/^.*Focus\\/([\\d.]+).*$/, '$1'),\n    Chromium: () => u.replace(/^.*Chromium\\/([\\d.]+).*$/, '$1'),\n    Opera: () => u.replace(/^.*Opera\\/([\\d.]+).*$/, '$1').replace(/^.*OPR\\/([\\d.]+).*$/, '$1'),\n    Vivaldi: () => u.replace(/^.*Vivaldi\\/([\\d.]+).*$/, '$1'),\n    Yandex: () => u.replace(/^.*YaBrowser\\/([\\d.]+).*$/, '$1'),\n    Kindle: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\n    Maxthon: () => u.replace(/^.*Maxthon\\/([\\d.]+).*$/, '$1'),\n    QQBrowser: () => u.replace(/^.*QQBrowser\\/([\\d.]+).*$/, '$1'),\n    QQ: () => u.replace(/^.*QQ\\/([\\d.]+).*$/, '$1'),\n    Baidu: () => u.replace(/^.*BIDUBrowser[\\s/]([\\d.]+).*$/, '$1'),\n    UC: () => u.replace(/^.*UC?Browser\\/([\\d.]+).*$/, '$1'),\n    Sogou: () => u.replace(/^.*SE ([\\d.X]+).*$/, '$1').replace(/^.*SogouMobileBrowser\\/([\\d.]+).*$/, '$1'),\n    '2345Explorer': () => u.replace(/^.*2345Explorer\\/([\\d.]+).*$/, '$1'),\n    TheWorld: () => u.replace(/^.*TheWorld ([\\d.]+).*$/, '$1'),\n    MIUI: () => u.replace(/^.*MiuiBrowser\\/([\\d.]+).*$/, '$1'),\n    Quark: () => u.replace(/^.*Quark\\/([\\d.]+).*$/, '$1'),\n    Qiyu: () => u.replace(/^.*Qiyu\\/([\\d.]+).*$/, '$1'),\n    Wechat: () => u.replace(/^.*MicroMessenger\\/([\\d.]+).*$/, '$1'),\n    Taobao: () => u.replace(/^.*AliApp\\(TB\\/([\\d.]+).*$/, '$1'),\n    Alipay: () => u.replace(/^.*AliApp\\(AP\\/([\\d.]+).*$/, '$1'),\n    Weibo: () => u.replace(/^.*weibo__([\\d.]+).*$/, '$1'),\n    Douban: () => u.replace(/^.*com.douban.frodo\\/([\\d.]+).*$/, '$1'),\n    Suning: () => u.replace(/^.*SNEBUY-APP([\\d.]+).*$/, '$1'),\n    iQiYi: () => u.replace(/^.*IqiyiVersion\\/([\\d.]+).*$/, '$1'),\n  }\n\n  dest.version = ''\n  if (version[dest.browser]) {\n    dest.version = version[dest.browser]()\n    if (dest.version === u) {\n      dest.version = ''\n    }\n  }\n\n  // 简化版本号\n  /* if (_this.osVersion.indexOf('.')) {\n    _this.osVersion = _this.osVersion.substring(0, _this.osVersion.indexOf('.'))\n  } */\n  if (dest.version.indexOf('.')) {\n    dest.version = dest.version.substring(0, dest.version.indexOf('.'))\n  }\n\n  // 修正\n  if (dest.os === 'iOS' && u.includes('iPad')) {\n    dest.os = 'iPadOS'\n  } else if (dest.browser === 'Edge' && !u.includes('Edg')) {\n    dest.engine = 'EdgeHTML'\n  } else if (dest.browser === 'MIUI') {\n    dest.os = 'Android'\n  } else if (dest.browser === 'Chrome' && Number(dest.version) > 27) {\n    dest.engine = 'Blink'\n  } else if (dest.browser === 'Opera' && Number(dest.version) > 12) {\n    dest.engine = 'Blink'\n  } else if (dest.browser === 'Yandex') {\n    dest.engine = 'Blink'\n  } else if (dest.browser === undefined) {\n    dest.browser = 'Unknow App'\n  }\n\n  return dest\n}\n\nexport default Detect\n","import * as Utils from '../lib/utils'\n\nexport interface ReadMoreBtnOptions {\n  /** 回调函数 */\n  onClick: (offset: number) => void\n\n  pageSize: number\n\n  text?: string\n}\n\n/**\n * 阅读更多按钮\n */\nexport default class ReadMoreBtn {\n  public opts: ReadMoreBtnOptions\n  public $el: HTMLElement\n  private $loading: HTMLElement\n  private $text: HTMLElement\n  private offset: number = 0\n  private total: number = 0\n  private origText: string = 'Load More'\n\n  /** 是否有更多内容 */\n  get hasMore() {\n    return this.total > this.offset + this.opts.pageSize\n  }\n\n  public constructor(opts: ReadMoreBtnOptions) {\n    this.opts = opts\n    this.origText = this.opts.text || this.origText\n\n    this.$el = Utils.createElement(\n      `<div class=\"atk-list-read-more\" style=\"display: none;\">\n      <div class=\"atk-list-read-more-inner\">\n        <div class=\"atk-loading-icon\" style=\"display: none;\"></div>\n        <span class=\"atk-text\">${this.origText}</span>\n      </div>\n    </div>`,\n    )\n\n    this.$loading = this.$el.querySelector<HTMLElement>('.atk-loading-icon')!\n    this.$text = this.$el.querySelector<HTMLElement>('.atk-text')!\n\n    this.$el.onclick = () => {\n      this.click()\n    }\n  }\n\n  click() {\n    if (this.hasMore) this.opts.onClick(this.offset + this.opts.pageSize)\n    this.checkDisabled()\n  }\n\n  /** 显示 */\n  show() {\n    this.$el.style.display = ''\n  }\n\n  /** 隐藏 */\n  hide() {\n    this.$el.style.display = 'none'\n  }\n\n  /** 加载 */\n  setLoading(isLoading: boolean) {\n    this.$loading.style.display = isLoading ? '' : 'none'\n    this.$text.style.display = isLoading ? 'none' : ''\n  }\n\n  /** 错误提示 */\n  showErr(errMsg: string) {\n    this.setLoading(false)\n\n    this.$text.innerText = errMsg\n    this.$el.classList.add('atk-err')\n    window.setTimeout(() => {\n      this.$text.innerText = this.origText\n      this.$el.classList.remove('atk-err')\n    }, 2000) // 2s后错误提示复原\n  }\n\n  /** 更新数据 */\n  public update(offset: number, total: number) {\n    this.offset = offset\n    this.total = total\n\n    this.checkDisabled()\n  }\n\n  public checkDisabled() {\n    if (this.hasMore) this.show()\n    else this.hide()\n  }\n}\n","import type { Paginator, IPgHolderOpt } from '.'\nimport type { ListFetchParams } from '@/types'\nimport ReadMoreBtn from '@/components/read-more-btn'\nimport $t from '@/i18n'\n\n/**\n * 阅读更多形式的分页\n */\nexport default class ReadMorePaginator implements Paginator {\n  private instance!: ReadMoreBtn\n  private onReachedBottom: (() => void) | null = null\n  private opt!: IPgHolderOpt\n\n  create(opt: IPgHolderOpt) {\n    this.opt = opt\n\n    this.instance = new ReadMoreBtn({\n      pageSize: opt.pageSize,\n      onClick: async (o) => {\n        opt.ctx.fetch({\n          offset: o,\n        })\n      },\n      text: $t('loadMore'),\n    })\n\n    // 滚动到底部自动加载\n    if (opt.readMoreAutoLoad) {\n      this.onReachedBottom = () => {\n        if (!this.instance.hasMore || this.opt.ctx.getData().getLoading()) return\n        this.instance.click()\n      }\n      this.opt.ctx.on('list-reach-bottom', this.onReachedBottom)\n    }\n\n    return this.instance.$el\n  }\n\n  setLoading(val: boolean) {\n    this.instance.setLoading(val)\n  }\n\n  update(offset: number, total: number) {\n    this.instance.update(offset, total)\n  }\n\n  showErr(msg: string) {\n    this.instance.showErr(msg)\n  }\n\n  next() {\n    this.instance.click()\n  }\n\n  getHasMore(): boolean {\n    return this.instance.hasMore\n  }\n\n  getIsClearComments(params: { offset?: number }): boolean {\n    return params.offset === 0\n  }\n\n  dispose(): void {\n    this.onReachedBottom && this.opt.ctx.off('list-reach-bottom', this.onReachedBottom)\n    this.instance.$el.remove()\n  }\n}\n","import * as Utils from '../lib/utils'\nimport * as Ui from '../lib/ui'\n\nexport interface PaginationOptions {\n  /** 每页条数 */\n  pageSize: number\n\n  /** 回调函数 */\n  onChange: (offset: number) => void\n}\n\nexport default class Pagination {\n  private opts: PaginationOptions\n  public total: number\n  public $el: HTMLElement\n  public $input: HTMLInputElement\n  public inputTimer?: number\n  public $prevBtn: HTMLElement\n  public $nextBtn: HTMLElement\n\n  public page: number = 1\n  get pageSize(): number {\n    return this.opts.pageSize\n  }\n  get offset(): number {\n    return this.pageSize * (this.page - 1)\n  }\n  get maxPage(): number {\n    return Math.ceil(this.total / this.pageSize)\n  }\n\n  public constructor(total: number, opts: PaginationOptions) {\n    this.total = total\n    this.opts = opts\n\n    this.$el = Utils.createElement(\n      `<div class=\"atk-pagination-wrap\">\n        <div class=\"atk-pagination\">\n          <div class=\"atk-btn atk-btn-prev\" aria-label=\"Previous page\">\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z\"></path></svg>\n          </div>\n          <input type=\"text\" class=\"atk-input\" aria-label=\"Enter the number of page\" />\n          <div class=\"atk-btn atk-btn-next\" aria-label=\"Next page\">\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z\"></path></svg>\n          </div>\n        </div>\n      </div>`,\n    )\n    this.$input = this.$el.querySelector('.atk-input')!\n    this.$input.value = `${this.page}`\n\n    this.$input.oninput = () => this.input()\n    this.$input.onkeydown = (e) => this.keydown(e)\n\n    this.$prevBtn = this.$el.querySelector('.atk-btn-prev')!\n    this.$nextBtn = this.$el.querySelector('.atk-btn-next')!\n\n    this.$prevBtn.onclick = () => this.prev()\n    this.$nextBtn.onclick = () => this.next()\n\n    this.checkDisabled()\n  }\n\n  public update(offset: number, total: number) {\n    this.page = Math.ceil(offset / this.pageSize) + 1\n    this.total = total\n\n    this.setInput(this.page)\n    this.checkDisabled()\n  }\n\n  public setInput(page: number) {\n    this.$input.value = `${page}`\n  }\n\n  public input(now: boolean = false) {\n    window.clearTimeout(this.inputTimer)\n\n    const value = this.$input.value.trim()\n\n    const modify = () => {\n      if (value === '') {\n        this.setInput(this.page)\n        return\n      }\n      let page = Number(value)\n      if (Number.isNaN(page)) {\n        this.setInput(this.page)\n        return\n      }\n      if (page < 1) {\n        this.setInput(this.page)\n        return\n      }\n      if (page > this.maxPage) {\n        this.setInput(this.maxPage)\n        page = this.maxPage\n      }\n      this.change(page)\n    }\n\n    // 延迟 800ms 执行\n    if (!now) this.inputTimer = window.setTimeout(() => modify(), 800)\n    else modify()\n  }\n\n  public prev() {\n    const page = this.page - 1\n    if (page < 1) {\n      return\n    }\n    this.change(page)\n  }\n\n  public next() {\n    const page = this.page + 1\n    if (page > this.maxPage) {\n      return\n    }\n    this.change(page)\n  }\n\n  public getHasMore() {\n    return this.page + 1 <= this.maxPage\n  }\n\n  public change(page: number) {\n    this.page = page\n    this.opts.onChange(this.offset)\n    this.setInput(page)\n    this.checkDisabled()\n  }\n\n  public checkDisabled() {\n    if (this.page + 1 > this.maxPage) {\n      this.$nextBtn.classList.add('atk-disabled')\n    } else {\n      this.$nextBtn.classList.remove('atk-disabled')\n    }\n\n    if (this.page - 1 < 1) {\n      this.$prevBtn.classList.add('atk-disabled')\n    } else {\n      this.$prevBtn.classList.remove('atk-disabled')\n    }\n  }\n\n  public keydown(e: KeyboardEvent) {\n    const keyCode = e.keyCode || e.which\n\n    if (keyCode === 38) {\n      // 上键\n      const page = Number(this.$input.value) + 1\n      if (page > this.maxPage) {\n        return\n      }\n      this.setInput(page)\n      this.input()\n    } else if (keyCode === 40) {\n      // 下键\n      const page = Number(this.$input.value) - 1\n      if (page < 1) {\n        return\n      }\n      this.setInput(page)\n      this.input()\n    } else if (keyCode === 13) {\n      // 回车\n      this.input(true)\n    }\n  }\n\n  /** 加载 */\n  setLoading(isLoading: boolean) {\n    if (isLoading) Ui.showLoading(this.$el)\n    else Ui.hideLoading(this.$el)\n  }\n}\n","import type { Paginator, IPgHolderOpt } from '.'\nimport PaginationComponent from '@/components/pagination'\n\n/**\n * 翻页形式的分页\n */\nexport default class UpDownPaginator implements Paginator {\n  private instance!: PaginationComponent\n\n  create(opt: IPgHolderOpt) {\n    this.instance = new PaginationComponent(opt.total, {\n      pageSize: opt.pageSize,\n      onChange: async (o) => {\n        opt.ctx.editorResetState() // 防止评论框被吞\n\n        opt.ctx.fetch({\n          offset: o,\n          onSuccess: () => {\n            opt.ctx.listGotoFirst()\n          },\n        })\n      },\n    })\n\n    return this.instance.$el\n  }\n\n  setLoading(val: boolean) {\n    this.instance.setLoading(val)\n  }\n\n  update(offset: number, total: number) {\n    this.instance.update(offset, total)\n  }\n\n  next() {\n    this.instance.next()\n  }\n\n  getHasMore(): boolean {\n    return this.instance.getHasMore()\n  }\n\n  getIsClearComments(): boolean {\n    return true\n  }\n\n  dispose(): void {\n    this.instance.$el.remove()\n  }\n}\n","import { Paginator } from './paginator'\nimport ReadMorePaginator from './paginator/read-more'\nimport UpDownPaginator from './paginator/up-down'\nimport $t from '@/i18n'\nimport type { ArtalkConfig, ContextApi } from '@/types'\n\nfunction createPaginatorByConf(conf: Pick<ArtalkConfig, 'pagination'>): Paginator {\n  if (conf.pagination.readMore) return new ReadMorePaginator()\n  return new UpDownPaginator()\n}\n\nfunction getPageDataByLastData(ctx: ContextApi): {\n  offset: number\n  total: number\n} {\n  const last = ctx.getData().getListLastFetch()\n  const r = { offset: 0, total: 0 }\n  if (!last) return r\n\n  r.offset = last.params.offset\n  if (last.data) r.total = last.params.flatMode ? last.data.count : last.data.roots_count\n\n  return r\n}\n\nexport const initListPaginatorFunc = (ctx: ContextApi) => {\n  let paginator: Paginator | null = null\n\n  // Init paginator when conf loaded\n  ctx.watchConf(['pagination', 'locale'], (conf) => {\n    const list = ctx.get('list')\n\n    if (paginator) paginator.dispose() // if had been init, dispose it\n\n    // create paginator instance\n    paginator = createPaginatorByConf(conf)\n\n    // create paginator dom\n    const { offset, total } = getPageDataByLastData(ctx)\n    const $paginator = paginator.create({\n      ctx,\n      pageSize: conf.pagination.pageSize,\n      total,\n\n      readMoreAutoLoad: conf.pagination.autoLoad,\n    })\n\n    // mount paginator dom\n    list.$commentsWrap.after($paginator)\n\n    // update paginator info\n    paginator?.update(offset, total)\n  })\n\n  // When list loaded\n  ctx.on('list-loaded', (comments) => {\n    // update paginator info\n    const { offset, total } = getPageDataByLastData(ctx)\n    paginator?.update(offset, total)\n  })\n\n  // When list fetch\n  ctx.on('list-fetch', (params) => {\n    // if clear comments when fetch new page data\n    if (ctx.getData().getComments().length > 0 && paginator?.getIsClearComments(params)) {\n      ctx.getData().clearComments()\n    }\n  })\n\n  // When list error\n  ctx.on('list-failed', () => {\n    paginator?.showErr?.($t('loadFail'))\n  })\n\n  // loading\n  ctx.on('list-fetch', (params) => {\n    paginator?.setLoading(true)\n  })\n  ctx.on('list-fetched', ({ params }) => {\n    paginator?.setLoading(false)\n  })\n}\n","import ListHTML from './list.html?raw'\nimport { ListLayout } from './layout'\nimport { createCommentNode } from './comment'\nimport { initListPaginatorFunc } from './page'\nimport type { ContextApi } from '@/types'\nimport Component from '@/lib/component'\nimport * as Utils from '@/lib/utils'\nimport { CommentNode } from '@/comment'\n\nexport default class List extends Component {\n  /** 列表评论集区域元素 */\n  $commentsWrap!: HTMLElement\n  public getCommentsWrapEl() {\n    return this.$commentsWrap\n  }\n\n  protected commentNodes: CommentNode[] = []\n  getCommentNodes() {\n    return this.commentNodes\n  }\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    // Init base element\n    this.$el = Utils.createElement(ListHTML)\n    this.$commentsWrap = this.$el.querySelector('.atk-list-comments-wrap')!\n\n    // Init paginator\n    initListPaginatorFunc(ctx)\n\n    // Bind events\n    this.initCrudEvents()\n  }\n\n  getListLayout({ forceFlatMode }: { forceFlatMode?: boolean } = {}) {\n    return new ListLayout({\n      $commentsWrap: this.$commentsWrap,\n      nestSortBy: this.ctx.conf.nestSort,\n      nestMax: this.ctx.conf.nestMax,\n      flatMode:\n        typeof forceFlatMode === 'boolean' ? forceFlatMode : (this.ctx.conf.flatMode as boolean),\n      // flatMode must be boolean because it had been handled when Artalk.init\n      createCommentNode: (d, r) => {\n        const node = createCommentNode(this.ctx, d, r, { forceFlatMode })\n        this.commentNodes.push(node) // store node instance\n        return node\n      },\n      findCommentNode: (id) => this.commentNodes.find((c) => c.getID() === id),\n    })\n  }\n\n  private initCrudEvents() {\n    this.ctx.on('list-load', (comments) => {\n      // 导入数据\n      this.getListLayout().import(comments)\n    })\n\n    this.ctx.on('list-loaded', (comments) => {\n      if (comments.length === 0) {\n        this.commentNodes = []\n        this.$commentsWrap.innerHTML = ''\n      }\n    })\n\n    // When comment insert\n    this.ctx.on('comment-inserted', (comment) => {\n      const replyComment = comment.rid\n        ? this.commentNodes.find((c) => c.getID() === comment.rid)?.getData()\n        : undefined\n      this.getListLayout().insert(comment, replyComment)\n    })\n\n    // When comment delete\n    this.ctx.on('comment-deleted', (comment) => {\n      const node = this.commentNodes.find((c) => c.getID() === comment.id)\n      if (!node) {\n        console.error(`comment node id=${comment.id} not found`)\n        return\n      }\n      node.remove()\n      this.commentNodes = this.commentNodes.filter((c) => c.getID() !== comment.id)\n      // TODO: remove child nodes\n    })\n\n    // When comment update\n    this.ctx.on('comment-updated', (comment) => {\n      const node = this.commentNodes.find((c) => c.getID() === comment.id)\n      node && node.setData(comment)\n    })\n  }\n}\n","export default \"<div class=\\\"atk-list\\\">\\n  <div class=\\\"atk-list-header\\\">\\n    <div class=\\\"atk-comment-count\\\">\\n      <div class=\\\"atk-text\\\"></div>\\n    </div>\\n    <div class=\\\"atk-right-action\\\">\\n      <span data-action=\\\"admin-close-comment\\\" class=\\\"atk-hide\\\" atk-only-admin-show></span>\\n      <span data-action=\\\"open-sidebar\\\" class=\\\"atk-hide atk-on\\\">\\n        <span class=\\\"atk-unread-badge\\\" style=\\\"display: none\\\"></span>\\n        <div class=\\\"atk-text\\\"></div>\\n      </span>\\n    </div>\\n  </div>\\n  <div class=\\\"atk-list-body\\\">\\n    <div class=\\\"atk-list-comments-wrap\\\"></div>\\n  </div>\\n  <div class=\\\"atk-list-footer\\\">\\n    <div class=\\\"atk-copyright\\\"></div>\\n  </div>\\n</div>\\n\"","import type { ContextApi, CommentData } from '@/types'\nimport { CommentNode } from '@/comment'\n\ninterface CreateCommentNodeOptions {\n  forceFlatMode?: boolean\n}\n\nexport function createCommentNode(\n  ctx: ContextApi,\n  comment: CommentData,\n  replyComment?: CommentData,\n  opts?: CreateCommentNodeOptions,\n): CommentNode {\n  const instance = new CommentNode(comment, {\n    onAfterRender: () => {\n      ctx.trigger('comment-rendered', instance)\n    },\n    onDelete: (c: CommentNode) => {\n      ctx.getData().deleteComment(c.getID())\n    },\n\n    replyTo: replyComment,\n\n    // TODO simplify reference\n    flatMode:\n      typeof opts?.forceFlatMode === 'boolean'\n        ? opts?.forceFlatMode\n        : (ctx.conf.flatMode as boolean),\n    gravatar: ctx.conf.gravatar,\n    nestMax: ctx.conf.nestMax,\n    heightLimit: ctx.conf.heightLimit,\n    avatarURLBuilder: ctx.conf.avatarURLBuilder,\n    scrollRelativeTo: ctx.conf.scrollRelativeTo,\n    vote: ctx.conf.vote,\n    voteDown: ctx.conf.voteDown,\n    uaBadge: ctx.conf.uaBadge,\n    dateFormatter: ctx.conf.dateFormatter,\n\n    // TODO: move to plugin folder and remove from core\n    getApi: () => ctx.getApi(),\n    replyComment: (c, $el) => ctx.replyComment(c, $el),\n    editComment: (c, $el) => ctx.editComment(c, $el),\n  })\n\n  // 渲染元素\n  instance.render()\n\n  return instance\n}\n","import * as Ui from '@/lib/ui'\n\nlet bodyOrgOverflow: string\nlet bodyOrgPaddingRight: string\n\nexport function getScrollbarHelper() {\n  return {\n    init() {\n      bodyOrgOverflow = document.body.style.overflow\n      bodyOrgPaddingRight = document.body.style.paddingRight\n    },\n\n    unlock() {\n      document.body.style.overflow = bodyOrgOverflow\n      document.body.style.paddingRight = bodyOrgPaddingRight\n    },\n\n    lock() {\n      document.body.style.overflow = 'hidden'\n      const barPaddingRight = parseInt(\n        window.getComputedStyle(document.body, null).getPropertyValue('padding-right'),\n        10,\n      )\n      document.body.style.paddingRight = `${Ui.getScrollBarWidth() + barPaddingRight || 0}px`\n    },\n  }\n}\n","import type { Layer as LayerApi } from '@/types/layer'\n\nexport interface LayerOptions {\n  onShow: () => void\n  onHide: () => void\n}\n\nexport class Layer implements LayerApi {\n  private allowMaskClose = true\n  private onAfterHide?: () => void\n\n  constructor(\n    private $el: HTMLElement,\n    private opts: LayerOptions,\n  ) {}\n\n  setOnAfterHide(func: () => void) {\n    this.onAfterHide = func\n  }\n\n  setAllowMaskClose(allow: boolean) {\n    this.allowMaskClose = allow\n  }\n\n  getAllowMaskClose() {\n    return this.allowMaskClose\n  }\n\n  getEl() {\n    return this.$el\n  }\n\n  show() {\n    this.opts.onShow()\n    this.$el.style.display = ''\n  }\n\n  hide() {\n    this.opts.onHide()\n    this.$el.style.display = 'none'\n    this.onAfterHide && this.onAfterHide()\n  }\n\n  destroy() {\n    this.opts.onHide()\n    this.$el.remove()\n    this.onAfterHide && this.onAfterHide()\n  }\n}\n","import { getScrollbarHelper } from './scrollbar-helper'\nimport { Layer } from './layer'\nimport * as Utils from '@/lib/utils'\n\nexport class LayerWrap {\n  private $wrap: HTMLElement\n  private $mask: HTMLElement\n  private items: Layer[] = []\n\n  constructor() {\n    this.$wrap = Utils.createElement(\n      `<div class=\"atk-layer-wrap\" style=\"display: none;\"><div class=\"atk-layer-mask\"></div></div>`,\n    )\n    this.$mask = this.$wrap.querySelector<HTMLElement>('.atk-layer-mask')!\n  }\n\n  createItem(name: string, el?: HTMLElement) {\n    // init element\n    el = el || this.createItemElement(name)\n    el.setAttribute('data-layer-name', name)\n    this.$wrap.appendChild(el)\n\n    // create layer instance\n    const layer = new Layer(el, {\n      onHide: () => this.hideWrap(el!),\n      onShow: () => this.showWrap(),\n    })\n\n    // register mask click event\n    this.getMask().addEventListener('click', () => {\n      layer.getAllowMaskClose() && layer.hide()\n    })\n\n    // add to items\n    this.items.push(layer)\n\n    return layer\n  }\n\n  private createItemElement(name: string) {\n    const el = document.createElement('div')\n    el.classList.add('atk-layer-item')\n    el.style.display = 'none'\n    this.$wrap.appendChild(el)\n    return el\n  }\n\n  getWrap() {\n    return this.$wrap\n  }\n\n  getMask() {\n    return this.$mask\n  }\n\n  showWrap() {\n    this.$wrap.style.display = 'block'\n    this.$mask.style.display = 'block'\n    this.$mask.classList.add('atk-fade-in')\n    getScrollbarHelper().lock()\n  }\n\n  hideWrap($el: HTMLElement) {\n    // if wrap contains more than one item, do not hide entire wrap\n    if (\n      this.items\n        .map((l) => l.getEl())\n        .filter((e) => e !== $el && e.isConnected && e.style.display !== 'none').length > 0\n    ) {\n      return\n    }\n\n    this.$wrap.style.display = 'none'\n    getScrollbarHelper().unlock()\n  }\n}\n","import { getScrollbarHelper } from './scrollbar-helper'\nimport { LayerWrap } from './wrap'\nimport type { ContextApi } from '@/types'\n\nexport class LayerManager {\n  private wrap: LayerWrap\n\n  constructor(ctx: ContextApi) {\n    this.wrap = new LayerWrap()\n    document.body.appendChild(this.wrap.getWrap())\n\n    ctx.on('unmounted', () => {\n      this.wrap.getWrap().remove()\n    })\n\n    // 记录页面原始 CSS 属性\n    getScrollbarHelper().init()\n  }\n\n  getEl() {\n    return this.wrap.getWrap()\n  }\n\n  create(name: string, el?: HTMLElement) {\n    return this.wrap.createItem(name, el)\n  }\n}\n","import type { LocalUser } from '@/types'\n\nconst LOCAL_USER_KEY = 'ArtalkUser'\n\ninterface UserOpts {\n  onUserChanged?: (user: LocalUser) => void\n}\n\nclass User {\n  private data: LocalUser\n\n  constructor(private opts: UserOpts) {\n    // Import from localStorage\n    const localUser = JSON.parse(window.localStorage.getItem(LOCAL_USER_KEY) || '{}')\n\n    // Initialize\n    this.data = {\n      name: localUser.name || localUser.nick || '', // nick is deprecated (for historical compatibility)\n      email: localUser.email || '',\n      link: localUser.link || '',\n      token: localUser.token || '',\n      is_admin: localUser.is_admin || localUser.isAdmin || false,\n    }\n  }\n\n  getData() {\n    return this.data\n  }\n\n  /** Update user data and save to localStorage */\n  update(obj: Partial<LocalUser> = {}) {\n    Object.entries(obj).forEach(([key, value]) => {\n      this.data[key] = value\n    })\n\n    window.localStorage.setItem(LOCAL_USER_KEY, JSON.stringify(this.data))\n    this.opts.onUserChanged && this.opts.onUserChanged(this.data)\n  }\n\n  /**\n   * Logout\n   *\n   * @description Logout will clear login status, but not clear user data (name, email, link)\n   */\n  logout() {\n    this.update({\n      token: '',\n      is_admin: false,\n    })\n  }\n\n  /** Check if user has filled basic data */\n  checkHasBasicUserInfo() {\n    return !!this.data.name && !!this.data.email\n  }\n}\n\nexport default User\n","import CheckerLauncher from './components/checker'\nimport Editor from './editor/editor'\nimport SidebarLayer from './layer/sidebar-layer'\n\nimport List from './list/list'\n\nimport * as I18n from './i18n'\nimport { PlugManager } from './plugins/editor-kit'\nimport { LayerManager } from './layer/layer-manager'\nimport User from './lib/user'\nimport type { ContextApi } from '@/types'\n\n/**\n * Services\n *\n * @description Call these services by `ctx.get('serviceName')` or `ctx.serviceName`\n */\nconst services = {\n  // I18n\n  i18n(ctx: ContextApi) {\n    I18n.setLocale(ctx.conf.locale)\n\n    ctx.watchConf(['locale'], (conf) => {\n      I18n.setLocale(conf.locale)\n    })\n  },\n\n  // User Store\n  user(ctx: ContextApi) {\n    const user = new User({\n      onUserChanged: (data) => {\n        ctx.trigger('user-changed', data)\n      },\n    })\n    return user\n  },\n\n  // 弹出层\n  layerManager(ctx: ContextApi) {\n    return new LayerManager(ctx)\n  },\n\n  // CheckerLauncher\n  checkerLauncher(ctx: ContextApi) {\n    const checkerLauncher = new CheckerLauncher({\n      getCtx: () => ctx,\n      getApi: () => ctx.getApi(),\n      onReload: () => ctx.reload(),\n\n      // make sure suffix with a slash, because it will be used as a base url when call `fetch`\n      getCaptchaIframeURL: () => `${ctx.conf.server}/api/v2/captcha/?t=${+new Date()}`,\n    })\n    return checkerLauncher\n  },\n\n  // 编辑器\n  editor(ctx: ContextApi) {\n    const editor = new Editor(ctx)\n    ctx.$root.appendChild(editor.$el)\n    return editor\n  },\n\n  // 评论列表\n  list(ctx: ContextApi): List {\n    const list = new List(ctx)\n    ctx.$root.appendChild(list.$el)\n    return list\n  },\n\n  // 侧边栏 Layer\n  sidebarLayer(ctx: ContextApi) {\n    const sidebarLayer = new SidebarLayer(ctx)\n    return sidebarLayer\n  },\n\n  // Extra Service\n  // -----------------------------------------\n  // Only for type check\n  // Not inject to ctx immediately,\n  // but can be injected by other occasions\n\n  editorPlugs(): PlugManager | undefined {\n    return undefined\n  },\n}\n\nexport default services\n\n// type tricks for dependency injection\ntype TServiceImps = typeof services\ntype TObjectWithFuncs = { [k: string]: (...args: any) => any }\ntype TKeysOnlyReturn<T extends TObjectWithFuncs, V> = {\n  [K in keyof T]: ReturnType<T[K]> extends V ? K : never\n}[keyof T]\ntype TOmitConditions = TKeysOnlyReturn<TServiceImps, void>\ntype TServiceInjectors = Omit<TServiceImps, TOmitConditions>\nexport type TInjectedServices = {\n  [K in keyof TServiceInjectors]: ReturnType<TServiceInjectors[K]>\n}\n","import type { ContextApi, ArtalkPlugin, ArtalkConfig } from '@/types'\nimport { Api } from '@/api'\n\ntype CountCache = { [pageKey: string]: number }\n\nexport interface CountOptions {\n  getApi(): Api\n\n  siteName: string\n  pageKey?: string\n  pageTitle?: string\n  countEl: string\n  pvEl: string\n  pageKeyAttr: string\n\n  /** Whether to add PV count when initializing */\n  pvAdd?: boolean\n}\n\nexport const PvCountWidget: ArtalkPlugin = (ctx: ContextApi) => {\n  ctx.watchConf(['site', 'pageKey', 'pageTitle', 'countEl', 'pvEl', 'statPageKeyAttr'], (conf) => {\n    initCountWidget({\n      getApi: () => ctx.getApi(),\n      siteName: conf.site,\n      pageKey: conf.pageKey,\n      pageTitle: conf.pageTitle,\n      countEl: conf.countEl,\n      pvEl: conf.pvEl,\n      pageKeyAttr: conf.statPageKeyAttr,\n      pvAdd: typeof ctx.conf.pvAdd === 'boolean' ? ctx.conf.pvAdd : true,\n    })\n  })\n}\n\n/** Initialize count widgets */\nexport async function initCountWidget(opt: CountOptions) {\n  // Load comment count\n  await loadCommentCount(opt)\n\n  // Increment PV count\n  const cacheData = await incrementPvCount(opt)\n\n  // Load PV count\n  await loadPvCount(opt, cacheData)\n}\n\n/** Increment PV count and get cache data that contains PV count */\nasync function incrementPvCount(opt: CountOptions) {\n  if (!opt.pvAdd || !opt.pageKey) return undefined\n\n  const pvCount = (\n    await opt.getApi().pages.logPv({\n      page_key: opt.pageKey,\n      page_title: opt.pageTitle,\n      site_name: opt.siteName,\n    })\n  ).data.pv // pv+1 and get pv count\n\n  return {\n    [opt.pageKey]: pvCount,\n  }\n}\n\n/** Load comment count */\nasync function loadCommentCount(opt: CountOptions) {\n  await loadStatCount({ opt, query: 'page_comment', containers: [opt.countEl, '#ArtalkCount'] })\n}\n\n/** Load PV count */\nasync function loadPvCount(opt: CountOptions, cache?: CountCache) {\n  await loadStatCount({ opt, query: 'page_pv', containers: [opt.pvEl, '#ArtalkPV'], cache })\n}\n\nasync function loadStatCount(args: {\n  opt: CountOptions\n  query: 'page_pv' | 'page_comment'\n  containers: string[]\n  cache?: CountCache\n}) {\n  const { opt } = args\n  let cache: CountCache = args.cache || {}\n\n  // Retrieve elements\n  const els = retrieveElements(args.containers)\n\n  // Get page keys which will be queried\n  const pageKeys = getPageKeys(els, opt.pageKeyAttr, opt.pageKey, cache)\n\n  // Fetch count data from server\n  if (pageKeys.length > 0) {\n    const res = (\n      await opt.getApi().stats.getStats(args.query, {\n        page_keys: pageKeys.join(','),\n        site_name: opt.siteName,\n      })\n    ).data.data as CountCache\n    cache = { ...cache, ...res }\n  }\n\n  updateElementsText(els, cache, opt.pageKey)\n}\n\n/** Retrieve elements based on selectors */\nfunction retrieveElements(containers: string[]): Set<HTMLElement> {\n  const els = new Set<HTMLElement>()\n  new Set(containers).forEach((selector) => {\n    document.querySelectorAll<HTMLElement>(selector).forEach((el) => els.add(el))\n  })\n  return els\n}\n\n/** Get page keys to be queried */\nfunction getPageKeys(\n  els: Set<HTMLElement>,\n  pageKeyAttr: string,\n  pageKey: string | undefined,\n  cache: CountCache,\n): string[] {\n  const pageKeys = Array.from(els)\n    .map((el) => el.getAttribute(pageKeyAttr) || pageKey)\n    .filter((key) => key && typeof cache[key] !== 'number') // filter out keys that already have data\n\n  return [...new Set(pageKeys as string[])] // deduplicate\n}\n\n/** Update elements text content with the count data */\nfunction updateElementsText(els: Set<HTMLElement>, data: CountCache, defaultPageKey?: string) {\n  els.forEach((el) => {\n    const pageKey = el.getAttribute('data-page-key')\n    const count = (pageKey && data[pageKey]) || (defaultPageKey && data[defaultPageKey]) || 0 // if pageKey is not set, use defaultCount\n    el.innerText = `${Number(count)}`\n  })\n}\n\nexport const exportedForTesting = {\n  incrementPvCount,\n  loadCommentCount,\n  loadPvCount,\n  retrieveElements,\n  getPageKeys,\n  updateElementsText,\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as marked from '@/lib/marked'\n\nexport const Markdown: ArtalkPlugin = (ctx) => {\n  ctx.watchConf(['imgLazyLoad', 'markedOptions'], (conf) => {\n    marked.initMarked({\n      markedOptions: ctx.getConf().markedOptions,\n      imgLazyLoad: ctx.getConf().imgLazyLoad,\n    })\n  })\n\n  ctx.watchConf(['markedReplacers'], (conf) => {\n    conf.markedReplacers && marked.setReplacers(conf.markedReplacers)\n  })\n}\n","import type PlugKit from './_kit'\nimport EditorPlug from './_plug'\nimport $t from '@/i18n'\n\nconst LocalStorageKey = 'ArtalkContent'\n\nexport default class LocalStorage extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onContentUpdated = () => {\n      this.save()\n    }\n\n    this.kit.useMounted(() => {\n      // load editor content from localStorage when init\n      const localContent = window.localStorage.getItem(LocalStorageKey) || ''\n      if (localContent.trim() !== '') {\n        this.kit.useEditor().showNotify($t('restoredMsg'), 'i')\n        this.kit.useEditor().setContent(localContent)\n      }\n\n      // bind event\n      this.kit.useEvents().on('content-updated', onContentUpdated)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('content-updated', onContentUpdated)\n    })\n  }\n\n  // Save editor content to localStorage\n  public save() {\n    window.localStorage.setItem(LocalStorageKey, this.kit.useEditor().getContentRaw().trim())\n  }\n}\n","import type PlugKit from './_kit'\nimport type { CommentData } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport default class SubmitAddPreset {\n  constructor(private kit: PlugKit) {}\n\n  async reqAdd() {\n    const nComment = (\n      await this.kit.useApi().comments.createComment({\n        ...(await this.getSubmitAddParams()),\n      })\n    ).data\n    return nComment\n  }\n\n  async getSubmitAddParams() {\n    const { name, email, link } = this.kit.useUser().getData()\n    const conf = this.kit.useConf()\n\n    return {\n      content: this.kit.useEditor().getContentFinal(),\n      name,\n      email,\n      link,\n      rid: 0,\n      page_key: conf.pageKey,\n      page_title: conf.pageTitle,\n      site_name: conf.site,\n      ua: await Utils.getCorrectUserAgent(), // Get the corrected UA\n    }\n  }\n\n  postSubmitAdd(commentNew: CommentData) {\n    // insert the new comment to list\n    this.kit.useGlobalCtx().getData().insertComment(commentNew)\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport SubmitAddPreset from './submit-add'\nimport $t from '@/i18n'\nimport type { CommentData } from '@/types'\n\ninterface CustomSubmit {\n  activeCond: () => void\n  pre?: () => void\n  req?: () => Promise<CommentData>\n  /** The `post` method is called after the comment is successfully submitted */\n  post?: (nComment: CommentData) => void\n}\n\nexport default class Submit extends EditorPlug {\n  private customs: CustomSubmit[] = []\n  private defaultPreset: SubmitAddPreset\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.defaultPreset = new SubmitAddPreset(this.kit)\n\n    const onEditorSubmit = () => this.do()\n\n    this.kit.useMounted(() => {\n      // invoke `do()` when event `editor-submit` is triggered\n      this.kit.useGlobalCtx().on('editor-submit', onEditorSubmit)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useGlobalCtx().off('editor-submit', onEditorSubmit)\n    })\n  }\n\n  registerCustom(c: CustomSubmit) {\n    this.customs.push(c)\n  }\n\n  private async do() {\n    if (this.kit.useEditor().getContentFinal().trim() === '') {\n      this.kit.useEditor().focus()\n      return\n    }\n\n    const custom = this.customs.find((o) => o.activeCond())\n\n    this.kit.useEditor().showLoading()\n\n    try {\n      // pre submit\n      if (custom?.pre) custom.pre()\n\n      let nComment: CommentData\n\n      // submit request\n      if (custom?.req) nComment = await custom.req()\n      else nComment = await this.defaultPreset.reqAdd()\n\n      // post submit\n      if (custom?.post) custom.post(nComment)\n      else this.defaultPreset.postSubmitAdd(nComment)\n    } catch (err: any) {\n      // submit error\n      console.error(err)\n      this.kit.useEditor().showNotify(`${$t('commentFail')}: ${err.message || String(err)}`, 'e')\n      return\n    } finally {\n      this.kit.useEditor().hideLoading()\n    }\n\n    this.kit.useEditor().reset() // 复原编辑器\n    this.kit.useGlobalCtx().trigger('editor-submitted')\n  }\n}\n","import './emoticons.scss'\n\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport type { EmoticonListData, EmoticonGrpData } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\n\ntype OwOFormatType = {\n  [key: string]: {\n    type: 'emoticon' | 'emoji' | 'image'\n    container: { icon: string; text: string }[]\n  }\n}\n\nexport default class Emoticons extends EditorPlug {\n  private emoticons: EmoticonListData = []\n  private loadingTask: Promise<void> | null = null\n\n  private $grpWrap!: HTMLElement\n  private $grpSwitcher!: HTMLElement\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => {\n      this.usePanel(`<div class=\"atk-editor-plug-emoticons\"></div>`)\n      this.useBtn(\n        `<i aria-label=\"${$t('emoticon')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m4.26829 5.29294c0-.94317.45893-1.7074 1.02439-1.7074.56547 0 1.02439.76423 1.02439 1.7074s-.45892 1.7074-1.02439 1.7074c-.56546 0-1.02439-.76423-1.02439-1.7074zm4.43903 1.7074c.56546 0 1.02439-.76423 1.02439-1.7074s-.45893-1.7074-1.02439-1.7074c-.56547 0-1.02439.76423-1.02439 1.7074s.45892 1.7074 1.02439 1.7074zm-1.70732 2.73184c-1.51883 0-2.06312-1.52095-2.08361-1.58173l-1.29551.43231c.03414.10244.868 2.51604 3.3798 2.51604 2.51181 0 3.34502-2.41291 3.37982-2.51604l-1.29484-.43573c-.02254.06488-.56683 1.58583-2.08498 1.58583zm7-2.73252c0 3.86004-3.1401 7.00034-7 7.00034s-7-3.1396-7-6.99966c0-3.86009 3.1401-7.00034 7-7.00034s7 3.14025 7 7.00034zm-1.3659 0c0-3.10679-2.5275-5.63442-5.6341-5.63442-3.10663 0-5.63415 2.52832-5.63415 5.6351 0 3.10676 2.52752 5.63446 5.63415 5.63446 3.1066 0 5.6341-2.5277 5.6341-5.63446z\"/></svg></i>`,\n      )\n    })\n    this.kit.useUnmounted(() => {})\n\n    this.useContentTransformer((raw) => this.transEmoticonImageText(raw))\n    this.usePanelShow(() => {\n      ;(async () => {\n        await this.loadEmoticonsData()\n\n        // 初始化元素\n        if (!this.isImgLoaded) {\n          this.initEmoticonsList()\n          this.isImgLoaded = true\n        }\n\n        // 延迟执行，防止无法读取高度\n        setTimeout(() => {\n          this.changeListHeight()\n        }, 30)\n      })()\n    })\n    this.usePanelHide(() => {\n      this.$panel!.parentElement!.style.height = ''\n    })\n\n    // 表情包预加载\n    window.setTimeout(() => {\n      this.loadEmoticonsData()\n    }, 1000) // 延迟 1s 加载\n  }\n\n  private isListLoaded = false\n  private isImgLoaded = false\n\n  public async loadEmoticonsData() {\n    if (this.isListLoaded) return\n    if (this.loadingTask !== null) {\n      await this.loadingTask\n      return\n    }\n\n    // 数据处理\n    this.loadingTask = (async () => {\n      Ui.showLoading(this.$panel!)\n      this.emoticons = await this.handleData(this.kit.useConf().emoticons)\n      Ui.hideLoading(this.$panel!)\n      this.loadingTask = null\n      this.isListLoaded = true\n    })()\n    await this.loadingTask\n  }\n\n  private async handleData(data: any): Promise<any[]> {\n    if (!Array.isArray(data) && ['object', 'string'].includes(typeof data)) {\n      data = [data]\n    }\n\n    if (!Array.isArray(data)) {\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] Data must be of Array/Object/String type`)\n      Ui.hideLoading(this.$panel!)\n      return []\n    }\n\n    const pushGrp = (grp: EmoticonGrpData) => {\n      if (typeof grp !== 'object') return\n      if (grp.name && data.find((o) => o.name === grp.name)) return\n      data.push(grp)\n    }\n\n    // 加载子内容\n    const remoteLoad = async (d: any[]) => {\n      await Promise.all(\n        d.map(async (grp, index) => {\n          if (typeof grp === 'object' && !Array.isArray(grp)) {\n            pushGrp(grp)\n          } else if (Array.isArray(grp)) {\n            await remoteLoad(grp)\n          } else if (typeof grp === 'string') {\n            const grpData = await this.remoteLoad(grp)\n\n            if (Array.isArray(grpData)) await remoteLoad(grpData)\n            else if (typeof grpData === 'object') pushGrp(grpData)\n          }\n        }),\n      )\n    }\n    await remoteLoad(data)\n\n    // 处理数组数据\n    data.forEach((item: any) => {\n      if (this.isOwOFormat(item)) {\n        const c = this.convertOwO(item)\n        c.forEach((grp) => {\n          pushGrp(grp)\n        })\n      } else if (Array.isArray(item)) {\n        item.forEach((grp) => {\n          pushGrp(grp)\n        })\n      }\n    })\n\n    // 剔除非法数据\n    data = data.filter(\n      (item: any) => typeof item === 'object' && !Array.isArray(item) && !!item && !!item.name,\n    )\n\n    // console.log(data)\n\n    this.solveNullKey(data)\n    this.solveSameKey(data)\n\n    return data\n  }\n\n  /** 远程加载 */\n  private async remoteLoad(url: string): Promise<any> {\n    if (!url) return []\n\n    try {\n      const resp = await fetch(url)\n      const json = await resp.json()\n      return json\n    } catch (err) {\n      Ui.hideLoading(this.$panel!)\n      console.error('[Emoticons] Load Failed:', err)\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] ${$t('loadFail')}: ${String(err)}`)\n      return []\n    }\n  }\n\n  /** 避免表情 item.key 为 null 的情况 */\n  private solveNullKey(data: EmoticonGrpData[]) {\n    data.forEach((grp) => {\n      grp.items.forEach((item, index) => {\n        if (!item.key) item.key = `${grp.name} ${index + 1}`\n      })\n    })\n  }\n\n  /** 避免相同 item.key */\n  private solveSameKey(data: EmoticonGrpData[]) {\n    const tmp: { [key: string]: number } = {}\n    data.forEach((grp) => {\n      grp.items.forEach((item) => {\n        if (!item.key || String(item.key).trim() === '') return\n        if (!tmp[item.key]) tmp[item.key] = 1\n        else tmp[item.key]++\n\n        if (tmp[item.key] > 1) item.key = `${item.key} ${tmp[item.key]}`\n      })\n    })\n  }\n\n  /** 判断是否为 OwO 格式 */\n  private isOwOFormat(data: any) {\n    try {\n      return (\n        typeof data === 'object' &&\n        !!Object.values(data).length &&\n        Array.isArray(Object.keys(Object.values<any>(data)[0].container)) &&\n        Object.keys(Object.values<any>(data)[0].container[0]).includes('icon')\n      )\n    } catch {\n      return false\n    }\n  }\n\n  /** 转换 OwO 格式数据 */\n  private convertOwO(owoData: OwOFormatType): EmoticonListData {\n    const dest: EmoticonListData = []\n    Object.entries(owoData).forEach(([grpName, grp]) => {\n      const nGrp: EmoticonGrpData = { name: grpName, type: grp.type, items: [] }\n      grp.container.forEach((item, index) => {\n        // 图片标签提取 src 属性值\n        const iconStr = item.icon\n        if (/<(img|IMG)/.test(iconStr)) {\n          const find = /src=[\"'](.*?)[\"']/.exec(iconStr)\n          if (find && find.length > 1) item.icon = find[1]\n        }\n        nGrp.items.push({\n          key: item.text || `${grpName} ${index + 1}`,\n          val: item.icon,\n        })\n      })\n      dest.push(nGrp)\n    })\n    return dest\n  }\n\n  /** 初始化表情列表界面 */\n  private initEmoticonsList() {\n    // 表情列表\n    this.$grpWrap = Utils.createElement(`<div class=\"atk-grp-wrap\"></div>`)\n    this.$panel!.append(this.$grpWrap)\n\n    this.emoticons.forEach((grp, index) => {\n      const $grp = Utils.createElement(`<div class=\"atk-grp\" style=\"display: none;\"></div>`)\n      this.$grpWrap.append($grp)\n      $grp.setAttribute('data-index', String(index))\n      $grp.setAttribute('data-grp-name', grp.name)\n      $grp.setAttribute('data-type', grp.type)\n      grp.items.forEach((item) => {\n        const $item = Utils.createElement(`<span class=\"atk-item\"></span>`)\n        $grp.append($item)\n\n        if (!!item.key && !new RegExp(`^(${grp.name})?\\\\s?[0-9]+$`).test(item.key))\n          $item.setAttribute('title', item.key)\n\n        if (grp.type === 'image') {\n          const imgEl = document.createElement('img')\n          imgEl.src = item.val\n          imgEl.alt = item.key\n          $item.append(imgEl)\n        } else {\n          $item.innerText = item.val\n        }\n\n        $item.onclick = () => {\n          if (grp.type === 'image') {\n            this.kit.useEditor().insertContent(`:[${item.key}]`)\n          } else {\n            this.kit.useEditor().insertContent(item.val || '')\n          }\n        }\n      })\n    })\n\n    // 表情分类切换 bar\n    if (this.emoticons.length > 1) {\n      this.$grpSwitcher = Utils.createElement(`<div class=\"atk-grp-switcher\"></div>`)\n      this.$panel!.append(this.$grpSwitcher)\n      this.emoticons.forEach((grp, index) => {\n        const $item = Utils.createElement('<span />')\n        $item.innerText = grp.name\n        $item.setAttribute('data-index', String(index))\n        $item.onclick = () => this.openGrp(index)\n        this.$grpSwitcher.append($item)\n      })\n    }\n\n    // 默认打开第一个分类\n    if (this.emoticons.length > 0) this.openGrp(0)\n  }\n\n  /** 打开一个表情组 */\n  public openGrp(index: number) {\n    Array.from(this.$grpWrap.children).forEach((item) => {\n      const el = item as HTMLElement\n      if (el.getAttribute('data-index') !== String(index)) {\n        el.style.display = 'none'\n      } else {\n        el.style.display = ''\n      }\n    })\n\n    this.$grpSwitcher\n      ?.querySelectorAll('span.active')\n      .forEach((item) => item.classList.remove('active'))\n    this.$grpSwitcher?.querySelector(`span[data-index=\"${index}\"]`)?.classList.add('active')\n\n    this.changeListHeight()\n  }\n\n  private changeListHeight() {\n    /* const listWrapHeight = Utils.getHeight(this.$grpWrapem)\n    this.editor.plugWrapEl.style.height = `${listWrapHeight > 150 ? listWrapHeight : 150}px` */\n  }\n\n  /** 处理评论 content 中的表情内容 */\n  public transEmoticonImageText(text: string) {\n    if (!this.emoticons || !Array.isArray(this.emoticons)) return text\n\n    this.emoticons.forEach((grp) => {\n      if (grp.type !== 'image') return\n      Object.entries(grp.items).forEach(([index, item]) => {\n        text = text\n          .split(`:[${item.key}]`)\n          .join(`<img src=\"${item.val}\" atk-emoticon=\"${item.key}\">`) // replaceAll(...)\n      })\n    })\n\n    return text\n  }\n}\n","import type PlugKit from './_kit'\nimport EditorPlug from './_plug'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\n/** 允许的图片格式 */\nconst AllowImgExts = ['png', 'jpg', 'jpeg', 'gif', 'bmp', 'svg', 'webp']\n\nexport default class Upload extends EditorPlug {\n  private $imgUploadInput?: HTMLInputElement\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => this.init())\n\n    this.initDragImg()\n  }\n\n  private init() {\n    this.$imgUploadInput = document.createElement('input')\n    this.$imgUploadInput.type = 'file'\n    this.$imgUploadInput.style.display = 'none'\n    this.$imgUploadInput.accept = AllowImgExts.map((o) => `.${o}`).join(',')\n\n    // TODO: Use btn cannot refresh when mounted event is triggered\n    const $btn = this.useBtn(\n      `<i aria-label=\"${$t('uploadImage')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m0 1.94444c0-1.074107.870333-1.94444 1.94444-1.94444h10.11116c1.0741 0 1.9444.870333 1.9444 1.94444v10.11116c0 1.0741-.8703 1.9444-1.9444 1.9444h-10.11116c-1.074107 0-1.94444-.8703-1.94444-1.9444zm1.94444-.38888c-.21466 0-.38888.17422-.38888.38888v7.06689l2.33333-2.33333 2.33333 2.33333 3.88888-3.88889 2.3333 2.33334v-5.51134c0-.21466-.1742-.38888-.3888-.38888zm10.49996 8.09977-2.3333-2.33333-3.88888 3.8889-2.33333-2.33334-2.33333 2.33334v.8447c0 .2146.17422.3888.38888.3888h10.11116c.2146 0 .3888-.1742.3888-.3888zm-7.1944-6.54422c-.75133 0-1.36111.60978-1.36111 1.36111 0 .75134.60978 1.36111 1.36111 1.36111s1.36111-.60977 1.36111-1.36111c0-.75133-.60978-1.36111-1.36111-1.36111z\"/></svg></i>`,\n    )\n    $btn.after(this.$imgUploadInput)\n    $btn.onclick = () => {\n      // 选择图片\n      const $input = this.$imgUploadInput!\n      $input.onchange = () => {\n        ;(async () => {\n          // 解决阻塞 UI 问题\n          if (!$input.files || $input.files.length === 0) return\n          const file = $input.files[0]\n          this.uploadImg(file)\n        })()\n      }\n      $input.click() // 显示选择图片对话框\n    }\n\n    if (!this.kit.useConf().imgUpload) {\n      this.$btn!.setAttribute('atk-only-admin-show', '')\n    }\n  }\n\n  private initDragImg() {\n    // 统一从 FileList 获取文件并上传图片方法\n    const uploadFromFileList = (files?: FileList) => {\n      if (!files) return\n\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i]\n        this.uploadImg(file)\n      }\n    }\n\n    // 拖拽图片\n    // @link https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/File_drag_and_drop\n    // 阻止浏览器的默认释放行为\n    const onDragover = (evt: Event) => {\n      evt.stopPropagation()\n      evt.preventDefault()\n    }\n\n    const onDrop = (evt: DragEvent) => {\n      const files = evt.dataTransfer?.files\n      if (files?.length) {\n        evt.preventDefault()\n        uploadFromFileList(files)\n      }\n    }\n\n    // 粘贴图片\n    const onPaste = (evt: ClipboardEvent) => {\n      const files = evt.clipboardData?.files\n      if (files?.length) {\n        evt.preventDefault()\n        uploadFromFileList(files)\n      }\n    }\n\n    this.kit.useMounted(() => {\n      this.kit.useUI().$textarea.addEventListener('dragover', onDragover)\n      this.kit.useUI().$textarea.addEventListener('drop', onDrop)\n      this.kit.useUI().$textarea.addEventListener('paste', onPaste)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useUI().$textarea.removeEventListener('dragover', onDragover)\n      this.kit.useUI().$textarea.removeEventListener('drop', onDrop)\n      this.kit.useUI().$textarea.removeEventListener('paste', onPaste)\n    })\n  }\n\n  async uploadImg(file: File) {\n    const fileExt = /[^.]+$/.exec(file.name)\n    if (!fileExt || !AllowImgExts.includes(String(fileExt[0]).toLowerCase())) return\n\n    // 未登录提示\n    if (!this.kit.useUser().checkHasBasicUserInfo()) {\n      this.kit.useEditor().showNotify($t('uploadLoginMsg'), 'w')\n      return\n    }\n\n    // 插入图片前换一行\n    let insertPrefix = '\\n'\n    if (this.kit.useUI().$textarea.value.trim() === '') insertPrefix = ''\n\n    // 插入占位加载文字\n    const uploadPlaceholderTxt = `${insertPrefix}![](Uploading ${file.name}...)`\n    this.kit.useEditor().insertContent(uploadPlaceholderTxt)\n\n    // 上传图片\n    let resp: { public_url: string } | undefined\n    try {\n      const customUploaderFn = this.kit.useConf().imgUploader\n      if (!customUploaderFn) {\n        // 使用 Artalk 进行图片上传\n        resp = (await this.kit.useApi().upload.upload({ file })).data\n      } else {\n        // 使用自定义的图片上传器\n        resp = { public_url: await customUploaderFn(file) }\n      }\n    } catch (err: any) {\n      console.error(err)\n      this.kit.useEditor().showNotify(`${$t('uploadFail')}: ${err.message}`, 'e')\n    }\n    if (!!resp && resp.public_url) {\n      let imgURL = resp.public_url as string\n\n      // 若为相对路径，加上 artalk server\n      if (!Utils.isValidURL(imgURL))\n        imgURL = Utils.getURLBasedOnApi({\n          base: this.kit.useConf().server,\n          path: imgURL,\n        })\n\n      // 上传成功插入图片\n      this.kit\n        .useEditor()\n        .setContent(\n          this.kit\n            .useUI()\n            .$textarea.value.replace(uploadPlaceholderTxt, `${insertPrefix}![](${imgURL})`),\n        )\n    } else {\n      // 上传失败删除加载文字\n      this.kit\n        .useEditor()\n        .setContent(this.kit.useUI().$textarea.value.replace(uploadPlaceholderTxt, ''))\n    }\n  }\n}\n","import './preview.scss'\n\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport * as marked from '@/lib/marked'\nimport $t from '@/i18n'\n\nexport default class Preview extends EditorPlug {\n  private isPlugPanelShow = false\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => {\n      this.usePanel(`<div class=\"atk-editor-plug-preview\"></div>`)\n\n      // initialize plug button\n      this.useBtn(\n        `<i aria-label=\"${$t('preview')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z\"></path></svg></i>`,\n      )\n    })\n    this.kit.useUnmounted(() => {})\n\n    // function to update content\n    this.kit.useEvents().on('content-updated', (content) => {\n      this.isPlugPanelShow && this.updateContent()\n    })\n\n    this.usePanelShow(() => {\n      this.isPlugPanelShow = true\n      this.updateContent()\n    })\n    this.usePanelHide(() => {\n      this.isPlugPanelShow = false\n    })\n  }\n\n  updateContent() {\n    this.$panel!.innerHTML = this.kit.useEditor().getContentMarked()\n  }\n}\n","import type EditorPlug from './_plug'\nimport LocalStorage from './local-storage'\nimport Textarea from './textarea'\nimport SubmitBtn from './submit-btn'\nimport Submit from './submit'\nimport StateReply from './state-reply'\nimport StateEdit from './state-edit'\nimport Closable from './closable'\nimport HeaderEvent from './header-event'\nimport HeaderUser from './header-user'\nimport HeaderLink from './header-link'\nimport Mover from './mover'\nimport Emoticons from './emoticons'\nimport Upload from './upload'\nimport Preview from './preview'\nimport type { ArtalkConfig } from '@/types'\n\n/** The default enabled plugs */\nconst EDITOR_PLUGS: (typeof EditorPlug)[] = [\n  // Core\n  LocalStorage,\n  HeaderEvent,\n  HeaderUser,\n  HeaderLink,\n  Textarea,\n  Submit,\n  SubmitBtn,\n  Mover,\n  StateReply,\n  StateEdit,\n  Closable,\n\n  // Extensions\n  Emoticons,\n  Upload,\n  Preview,\n]\n\n/**\n * Get the enabled plugs by config\n */\nexport function getEnabledPlugs(\n  conf: Pick<ArtalkConfig, 'imgUpload' | 'emoticons' | 'preview' | 'editorTravel'>,\n): (typeof EditorPlug)[] {\n  // The reference map of config and plugs\n  // (for check if the plug is enabled)\n  const confRefs = new Map<typeof EditorPlug, any>()\n  confRefs.set(Upload, conf.imgUpload)\n  confRefs.set(Emoticons, conf.emoticons)\n  confRefs.set(Preview, conf.preview)\n  confRefs.set(Mover, conf.editorTravel)\n\n  return EDITOR_PLUGS.filter((p) => !confRefs.has(p) || !!confRefs.get(p))\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class HeaderEvent extends EditorPlug {\n  private get $inputs() {\n    return this.kit.useEditor().getHeaderInputEls()\n  }\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const inputEventFns: { [name: string]: () => void } = {}\n    const changeEventFns: { [name: string]: () => void } = {}\n\n    const trigger =\n      (evt: 'header-input' | 'header-change', $input: HTMLInputElement, field: string) => () => {\n        this.kit.useEvents().trigger(evt, { field, $input })\n      }\n\n    this.kit.useMounted(() => {\n      // batch bind the events\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\n        $input.addEventListener(\n          'input',\n          (inputEventFns[key] = trigger('header-input', $input, key)),\n        )\n        $input.addEventListener(\n          'change',\n          (changeEventFns[key] = trigger('header-change', $input, key)),\n        )\n      })\n    })\n\n    this.kit.useUnmounted(() => {\n      // unmount the event\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\n        $input.removeEventListener('input', inputEventFns[key])\n        $input.removeEventListener('change', changeEventFns[key])\n      })\n    })\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport $t from '@/i18n'\nimport type { UserInfoApiResponseData } from '@/types'\n\nexport default class HeaderUser extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onInput = ({ $input, field }: { $input: HTMLInputElement; field: string }) => {\n      if (this.kit.useEditor().getState() === 'edit') return // TODO: prevent execute when editing, since update comment.user not support\n\n      // update user data\n      this.kit.useUser().update({ [field]: $input.value.trim() })\n\n      // remote fetch user info\n      if (field === 'name' || field === 'email') this.fetchUserInfo() // must after update user data, since fetchUserInfo() will use User.data\n    }\n\n    const placeholders = {\n      name: $t('nick'),\n      email: $t('email'),\n      link: $t('link'),\n    }\n\n    this.kit.useMounted(() => {\n      Object.entries(this.kit.useEditor().getHeaderInputEls()).forEach(([key, $input]) => {\n        // set placeholder\n        $input.placeholder = placeholders[key]\n\n        // sync header values from User.data\n        $input.value = this.kit.useUser().getData()[key] || ''\n      })\n\n      // bind events\n      this.kit.useEvents().on('header-input', onInput)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('header-input', onInput)\n    })\n  }\n\n  private query = {\n    timer: <number | null>null,\n    abortFn: <(() => void) | null>null,\n  }\n\n  /**\n   * Fetch user info from server\n   */\n  private fetchUserInfo() {\n    this.kit.useUser().logout() // clear login status\n\n    if (this.query.timer) window.clearTimeout(this.query.timer) // clear the not executed timeout task\n    if (this.query.abortFn) this.query.abortFn() // abort the last request (if request is pending not finished)\n\n    this.query.timer = window.setTimeout(() => {\n      this.query.timer = null // clear the timer (clarify the timer is executing)\n\n      const api = this.kit.useApi()\n      const CANCEL_TOKEN = 'getUserCancelToken'\n      this.query.abortFn = () => api.abortRequest(CANCEL_TOKEN)\n\n      api.user\n        .getUser(\n          { ...api.getUserFields() },\n          {\n            cancelToken: CANCEL_TOKEN,\n          },\n        )\n        .then((res) => this.onUserInfoFetched(res.data))\n        .catch((err) => {})\n        .finally(() => {\n          this.query.abortFn = null // clear the abort function (clarify the request is finished)\n        })\n    }, 400) // delay to reduce request\n  }\n\n  /**\n   * Function called when user info fetched\n   *\n   * @param data The response data from server\n   */\n  private onUserInfoFetched(data: UserInfoApiResponseData) {\n    // If api response is not login, logout\n    if (!data.is_login) this.kit.useUser().logout()\n\n    // Update unread notifies\n    this.kit.useGlobalCtx().getData().updateNotifies(data.notifies)\n\n    // If user is admin and not login,\n    if (this.kit.useUser().checkHasBasicUserInfo() && !data.is_login && data.user?.is_admin) {\n      // then show login window\n      this.kit.useGlobalCtx().checkAdmin({\n        onSuccess: () => {},\n      })\n    }\n\n    // Auto fill user link from server\n    if (data.user && data.user.link) {\n      this.kit.useUI().$link.value = data.user.link\n      this.kit.useUser().update({ link: data.user.link })\n    }\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class HeaderLink extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onLinkChange = ({ field }: { field: string }) => {\n      if (field === 'link') this.onLinkInputChange()\n    }\n\n    // bind events\n    this.kit.useMounted(() => {\n      this.kit.useEvents().on('header-change', onLinkChange)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('header-change', onLinkChange)\n    })\n  }\n\n  private onLinkInputChange() {\n    // auto and force add protocol prefix for user input link\n    const link = this.kit.useUI().$link.value.trim()\n    if (!!link && !/^(http|https):\\/\\//.test(link)) {\n      this.kit.useUI().$link.value = `https://${link}`\n      this.kit.useUser().update({ link: this.kit.useUI().$link.value })\n    }\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport $t from '@/i18n'\n\nexport default class Textarea extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onKeydown = (e: KeyboardEvent) => this.onKeydown(e)\n    const onInput = () => this.onInput()\n\n    this.kit.useMounted(() => {\n      // 占位符\n      this.kit.useUI().$textarea.placeholder = this.kit.useConf().placeholder || $t('placeholder')\n\n      // bind the event\n      this.kit.useUI().$textarea.addEventListener('keydown', onKeydown)\n      this.kit.useUI().$textarea.addEventListener('input', onInput)\n    })\n\n    this.kit.useUnmounted(() => {\n      // unmount the event\n      this.kit.useUI().$textarea.removeEventListener('keydown', onKeydown)\n      this.kit.useUI().$textarea.removeEventListener('input', onInput)\n    })\n\n    this.kit.useEvents().on('content-updated', () => {\n      // delay 80ms to prevent invalid execution\n      window.setTimeout(() => {\n        this.adaptiveHeightByContent()\n      }, 80)\n    })\n  }\n\n  // 按下 Tab 输入内容，而不是失去焦距\n  private onKeydown(e: KeyboardEvent) {\n    const keyCode = e.keyCode || e.which\n\n    if (keyCode === 9) {\n      e.preventDefault()\n      this.kit.useEditor().insertContent('\\t')\n    }\n  }\n\n  private onInput() {\n    this.kit.useEvents().trigger('content-updated', this.kit.useEditor().getContentRaw())\n  }\n\n  // Resize the textarea height by content\n  public adaptiveHeightByContent() {\n    const diff = this.kit.useUI().$textarea.offsetHeight - this.kit.useUI().$textarea.clientHeight\n    this.kit.useUI().$textarea.style.height = '0px' // it's a magic. 若不加此行，内容减少，高度回不去\n    this.kit.useUI().$textarea.style.height = `${this.kit.useUI().$textarea.scrollHeight + diff}px`\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport $t from '@/i18n'\n\nexport default class SubmitBtn extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onClick = () => {\n      this.kit.useEditor().submit()\n    }\n\n    this.kit.useMounted(() => {\n      // apply the submit button text from user custom config\n      this.kit.useUI().$submitBtn.innerText = this.kit.useConf().sendBtn || $t('send')\n\n      // bind the event when click the submit button\n      this.kit.useUI().$submitBtn.addEventListener('click', onClick)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useUI().$submitBtn.removeEventListener('click', onClick)\n    })\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport Submit from './submit'\nimport SubmitAddPreset from './submit-add'\nimport type { CommentData } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\n\nexport default class StateReply extends EditorPlug {\n  private comment?: CommentData\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    // add effect when state switch to `reply`\n    this.useEditorStateEffect('reply', (commentData) => {\n      this.setReply(commentData)\n\n      return () => {\n        this.cancelReply()\n      }\n    })\n\n    // register submit preset\n    this.kit.useEvents().on('mounted', () => {\n      const submitPlug = this.kit.useDeps(Submit)\n      if (!submitPlug) throw Error('SubmitPlug not initialized')\n\n      const defaultPreset = new SubmitAddPreset(this.kit)\n\n      submitPlug.registerCustom({\n        activeCond: () => !!this.comment, // active this custom submit when reply mode\n        req: async () => {\n          if (!this.comment) throw new Error('reply comment cannot be empty')\n\n          const nComment = (\n            await this.kit.useApi().comments.createComment({\n              ...(await defaultPreset.getSubmitAddParams()),\n              rid: this.comment.id,\n              page_key: this.comment.page_key,\n              page_title: undefined,\n              site_name: this.comment.site_name,\n            })\n          ).data\n\n          return nComment\n        },\n        post: (nComment: CommentData) => {\n          // open another page when reply comment is not the same pageKey\n          const conf = this.kit.useConf()\n          if (nComment.page_key !== conf.pageKey) {\n            window.open(`${nComment.page_url}#atk-comment-${nComment.id}`)\n          }\n\n          defaultPreset.postSubmitAdd(nComment)\n        },\n      })\n    })\n  }\n\n  private setReply(commentData: CommentData) {\n    const ui = this.kit.useUI()\n    if (!ui.$sendReplyBtn) {\n      const $btn = Utils.createElement(\n        `<span class=\"atk-state-btn\">` +\n          `<span class=\"atk-text-wrap\">` +\n          `${$t('reply')} <span class=\"atk-text\"></span>` +\n          `</span>` +\n          `<span class=\"atk-cancel atk-icon-close atk-icon\"></span>` +\n          `</span>`,\n      )\n      $btn.querySelector<HTMLElement>('.atk-text')!.innerText = `@${commentData.nick}`\n      $btn.addEventListener('click', () => {\n        this.kit.useEditor().resetState()\n      })\n      ui.$stateWrap.append($btn)\n      ui.$sendReplyBtn = $btn\n    }\n\n    this.comment = commentData\n\n    ui.$textarea.focus()\n  }\n\n  private cancelReply() {\n    if (!this.comment) return\n\n    const ui = this.kit.useUI()\n    if (ui.$sendReplyBtn) {\n      ui.$sendReplyBtn.remove()\n      ui.$sendReplyBtn = undefined\n    }\n    this.comment = undefined\n  }\n}\n","import type PlugKit from './_kit'\nimport EditorPlug from './_plug'\nimport Submit from './submit'\nimport type { CommentData } from '@/types'\nimport $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\n\nexport default class StateEdit extends EditorPlug {\n  private comment?: CommentData\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    // add effect when state switch to `edit`\n    this.useEditorStateEffect('edit', (comment) => {\n      this.edit(comment)\n\n      return () => {\n        this.cancelEdit()\n      }\n    })\n\n    // register submit preset\n    this.kit.useMounted(() => {\n      const submitPlug = this.kit.useDeps(Submit)\n      if (!submitPlug) throw Error('SubmitPlug not initialized')\n\n      submitPlug.registerCustom({\n        activeCond: () => !!this.comment, // active this custom submit when edit mode\n        req: async () => {\n          const saveData = {\n            content: this.kit.useEditor().getContentFinal(),\n            nick: this.kit.useUI().$name.value,\n            email: this.kit.useUI().$email.value,\n            link: this.kit.useUI().$link.value,\n          }\n          const comment = this.comment!\n          const nComment = await this.kit.useApi().comments.updateComment(comment.id, {\n            ...comment,\n            ...saveData,\n          })\n          return nComment.data\n        },\n        post: (nComment: CommentData) => {\n          this.kit.useGlobalCtx().getData().updateComment(nComment)\n        },\n      })\n    })\n  }\n\n  private edit(comment: CommentData) {\n    const ui = this.kit.useUI()\n    if (!ui.$editCancelBtn) {\n      const $btn = Utils.createElement(\n        `<span class=\"atk-state-btn\">` +\n          `<span class=\"atk-text-wrap\">` +\n          `${$t('editCancel')}` +\n          `</span>` +\n          `<span class=\"atk-cancel atk-icon-close atk-icon\"></span>` +\n          `</span>`,\n      )\n      $btn.onclick = () => {\n        this.kit.useEditor().resetState()\n      }\n      ui.$stateWrap.append($btn)\n      ui.$editCancelBtn = $btn\n    }\n    this.comment = comment\n\n    ui.$header.style.display = 'none' // TODO: support modify header information\n\n    ui.$name.value = comment.nick || ''\n    ui.$email.value = comment.email || ''\n    ui.$link.value = comment.link || ''\n\n    this.kit.useEditor().setContent(comment.content)\n    ui.$textarea.focus()\n\n    this.updateSubmitBtnText($t('save'))\n  }\n\n  private cancelEdit() {\n    if (!this.comment) return\n\n    const ui = this.kit.useUI()\n\n    if (ui.$editCancelBtn) {\n      ui.$editCancelBtn.remove()\n      ui.$editCancelBtn = undefined\n    }\n\n    this.comment = undefined\n\n    const { name, email, link } = this.kit.useUser().getData()\n    ui.$name.value = name\n    ui.$email.value = email\n    ui.$link.value = link\n\n    this.kit.useEditor().setContent('')\n    this.restoreSubmitBtnText()\n\n    ui.$header.style.display = '' // TODO: support modify header information\n  }\n\n  // -------------------------------------------------------------------\n  //  Submit Btn Text Modifier\n  // -------------------------------------------------------------------\n\n  private originalSubmitBtnText = 'Send'\n\n  private updateSubmitBtnText(text: string) {\n    this.originalSubmitBtnText = this.kit.useUI().$submitBtn.innerText\n    this.kit.useUI().$submitBtn.innerText = text\n  }\n\n  private restoreSubmitBtnText() {\n    this.kit.useUI().$submitBtn.innerText = this.originalSubmitBtnText\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport default class Closable extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onOpen = () => this.open()\n    const onClose = () => this.close()\n\n    this.kit.useMounted(() => {\n      this.kit.useEvents().on('editor-open', onOpen)\n      this.kit.useEvents().on('editor-close', onClose)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('editor-open', onOpen)\n      this.kit.useEvents().off('editor-close', onClose)\n    })\n  }\n\n  private open() {\n    this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed')?.remove()\n    this.kit.useUI().$textarea.style.display = ''\n    this.kit.useUI().$bottom.style.display = ''\n  }\n\n  private close() {\n    if (!this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed'))\n      this.kit\n        .useUI()\n        .$textareaWrap.prepend(\n          Utils.createElement(`<div class=\"atk-comment-closed\">${$t('onlyAdminCanReply')}</div>`),\n        )\n\n    if (!this.kit.useUser().getData().is_admin) {\n      this.kit.useUI().$textarea.style.display = 'none'\n      this.kit.useEvents().trigger('panel-close')\n      this.kit.useUI().$bottom.style.display = 'none'\n    } else {\n      // 管理员一直打开评论\n      this.kit.useUI().$textarea.style.display = ''\n      this.kit.useUI().$bottom.style.display = ''\n    }\n  }\n}\n","import type { PlugManager } from '../editor-kit'\nimport type EditorPlug from './_plug'\n\n/**\n * PlugKit provides a set of methods to help you develop editor plug\n */\nexport default class PlugKit {\n  constructor(private plugs: PlugManager) {}\n\n  /** Use the editor */\n  useEditor() {\n    return this.plugs.editor\n  }\n\n  /**\n   * Use the context of global\n   *\n   * @deprecated The calls to this function should be reduced as much as possible\n   */\n  useGlobalCtx() {\n    return this.plugs.editor.ctx\n  }\n\n  /** Use the config of Artalk */\n  useConf() {\n    return this.plugs.editor.ctx.conf\n  }\n\n  /** Use the http api client */\n  useApi() {\n    return this.plugs.editor.ctx.getApi()\n  }\n\n  /** Use the user manager */\n  useUser() {\n    return this.plugs.editor.ctx.get('user')\n  }\n\n  /** Use the ui of editor */\n  useUI() {\n    return this.plugs.editor.getUI()\n  }\n\n  /** Use the events in editor scope */\n  useEvents() {\n    return this.plugs.getEvents()\n  }\n\n  /** Listen the event when plug is mounted */\n  useMounted(func: () => void) {\n    this.useEvents().on('mounted', func)\n  }\n\n  /** Listen the event when plug is unmounted */\n  useUnmounted(func: () => void) {\n    this.useEvents().on('unmounted', func)\n  }\n\n  /** Use the deps of other plug */\n  useDeps<T extends typeof EditorPlug>(plug: T) {\n    return this.plugs.get(plug)\n  }\n}\n","import { getEnabledPlugs } from './editor'\nimport EditorPlug from './editor/_plug'\nimport PlugKit from './editor/_kit'\nimport EventManager from '@/lib/event-manager'\nimport type { EditorApi, ArtalkPlugin } from '@/types'\n\nexport interface EditorEventPayloadMap {\n  mounted: undefined\n  unmounted: undefined\n  'header-input': { field: string; $input: HTMLInputElement }\n  'header-change': { field: string; $input: HTMLInputElement }\n  'content-updated': string\n  'panel-show': EditorPlug\n  'panel-hide': EditorPlug\n  'panel-close': undefined\n\n  'editor-close': undefined\n  'editor-open': undefined\n}\n\nexport const EditorKit: ArtalkPlugin = (ctx) => {\n  const editor = ctx.get('editor')\n\n  const editorPlugs = new PlugManager(editor)\n  ctx.inject('editorPlugs', editorPlugs)\n}\n\nexport class PlugManager {\n  private plugs: EditorPlug[] = []\n  private openedPlug: EditorPlug | null = null\n  private events = new EventManager<EditorEventPayloadMap>()\n\n  getPlugs() {\n    return this.plugs\n  }\n  getEvents() {\n    return this.events\n  }\n\n  private clear() {\n    this.plugs = []\n    this.events = new EventManager()\n    if (this.openedPlug) this.closePlugPanel()\n  }\n\n  constructor(public editor: EditorApi) {\n    let confLoaded = false // config not loaded at first time\n    this.editor.ctx.watchConf(\n      ['imgUpload', 'emoticons', 'preview', 'editorTravel', 'locale'],\n      (conf) => {\n        // trigger unmount event will call all plugs' unmount function\n        // (this will only be called while conf reloaded, not be called at first time)\n        confLoaded && this.getEvents().trigger('unmounted')\n\n        // reset the plugs\n        this.clear()\n\n        // init the all enabled plugs\n        getEnabledPlugs(conf).forEach((Plug) => {\n          // create the plug instance\n          const kit = new PlugKit(this)\n          this.plugs.push(new Plug(kit))\n        })\n\n        // trigger event for plug initialization\n        this.getEvents().trigger('mounted')\n        confLoaded = true\n\n        // refresh the plug UI\n        this.loadPluginUI()\n      },\n    )\n\n    this.events.on('panel-close', () => this.closePlugPanel())\n  }\n\n  private loadPluginUI() {\n    // handle ui, clear and reset the plug btns and plug panels\n    this.editor.getUI().$plugPanelWrap.innerHTML = ''\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\n    this.editor.getUI().$plugBtnWrap.innerHTML = ''\n\n    // load the plug UI\n    this.plugs.forEach((plug) => this.loadPluginItem(plug))\n  }\n\n  /** Load the plug btn and plug panel on editor ui */\n  private loadPluginItem(plug: EditorPlug) {\n    const $btn = plug.$btn\n    if (!$btn) return\n    this.editor.getUI().$plugBtnWrap.appendChild($btn)\n\n    // bind the event when click plug btn\n    !$btn.onclick &&\n      ($btn.onclick = () => {\n        // removing the active class from all the buttons\n        this.editor\n          .getUI()\n          .$plugBtnWrap.querySelectorAll('.active')\n          .forEach((item) => item.classList.remove('active'))\n\n        // if the plug is not the same as the openedPlug,\n        if (plug !== this.openedPlug) {\n          // then open the plug current clicked plug panel\n          this.openPlugPanel(plug)\n\n          // add active class for current plug panel\n          $btn.classList.add('active')\n        } else {\n          // then close the plug\n          this.closePlugPanel()\n        }\n      })\n\n    // initialization of plug panel\n    const $panel = plug.$panel\n    if ($panel) {\n      $panel.style.display = 'none'\n      this.editor.getUI().$plugPanelWrap.appendChild($panel)\n    }\n  }\n\n  get<T extends typeof EditorPlug>(plug: T) {\n    return this.plugs.find((p) => p instanceof plug) as InstanceType<T> | undefined\n  }\n\n  /** Open the editor plug panel */\n  openPlugPanel(plug: EditorPlug) {\n    this.plugs.forEach((aPlug) => {\n      const plugPanel = aPlug.$panel\n      if (!plugPanel) return\n\n      if (aPlug === plug) {\n        plugPanel.style.display = ''\n        this.events.trigger('panel-show', plug)\n      } else {\n        plugPanel.style.display = 'none'\n        this.events.trigger('panel-hide', plug)\n      }\n    })\n\n    this.editor.getUI().$plugPanelWrap.style.display = ''\n    this.openedPlug = plug\n  }\n\n  /** Close the editor plug panel */\n  closePlugPanel() {\n    if (!this.openedPlug) return\n\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\n    this.events.trigger('panel-hide', this.openedPlug)\n    this.openedPlug = null\n  }\n\n  /** Get the content which is transformed by plugs */\n  getTransformedContent(rawContent: string) {\n    let result = rawContent\n    this.plugs.forEach((aPlug) => {\n      if (!aPlug.contentTransformer) return\n      result = aPlug.contentTransformer(result)\n    })\n    return result\n  }\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const GotoFocus: ArtalkPlugin = (ctx) => {\n  ctx.on('list-goto', async (commentID) => {\n    // find the comment node\n    let comment = ctx.getCommentNodes().find((c) => c.getID() === commentID)\n    if (!comment) {\n      // fetch and insert the comment from the server\n      const data = (await ctx.getApi().comments.getComment(commentID)).data\n      ctx\n        .get('list')\n        .getListLayout({ forceFlatMode: true })\n        .insert(data.comment, data.reply_comment)\n      comment = ctx.getCommentNodes().find((c) => c.getID() === commentID)\n    }\n    if (!comment) return\n    comment.focus()\n  })\n}\n","import * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\n\nexport interface ErrorDialogOptions {\n  $err: HTMLElement\n\n  errMsg: string\n  errData?: any\n  retryFn?: () => void\n\n  onOpenSidebar?: () => void\n}\n\nexport function showErrorDialog(opts: ErrorDialogOptions) {\n  const errEl = Utils.createElement(`<span><span class=\"error-message\"></span><br/><br/></span>`)\n  errEl.querySelector<HTMLElement>('.error-message')!.innerText =\n    `${$t('listLoadFailMsg')}\\n${opts.errMsg}`\n\n  if (opts.retryFn) {\n    const $retryBtn = Utils.createElement(`<span style=\"cursor:pointer;\">${$t('listRetry')}</span>`)\n    $retryBtn.onclick = () => opts.retryFn && opts.retryFn()\n    errEl.appendChild($retryBtn)\n  }\n\n  if (opts.onOpenSidebar) {\n    const $openSidebar = Utils.createElement(\n      `<span atk-only-admin-show> | <span style=\"cursor:pointer;\">${$t('openName', { name: $t('ctrlCenter') })}</span></span>`,\n    )\n    errEl.appendChild($openSidebar)\n    $openSidebar.onclick = () => opts.onOpenSidebar && opts.onOpenSidebar()\n  }\n\n  Ui.setError(opts.$err, errEl)\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { version as ARTALK_VERSION } from '~/package.json'\nimport type List from '~/src/list/list'\nimport * as Ui from '@/lib/ui'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nlet IgnoreVersionCheck = false\n\nexport const VersionCheck: ArtalkPlugin = (ctx) => {\n  ctx.watchConf(['apiVersion', 'versionCheck'], (conf) => {\n    const list = ctx.get('list')\n    if (conf.apiVersion && conf.versionCheck && !IgnoreVersionCheck)\n      versionCheck(list, ARTALK_VERSION, conf.apiVersion)\n  })\n}\n\nfunction versionCheck(list: List, feVer: string, beVer: string) {\n  const comp = Utils.versionCompare(feVer, beVer)\n  const sameVer = comp === 0\n  if (sameVer) return\n\n  const errEl = Utils.createElement(\n    `<div class=\"atk-version-check-notice\">${$t('updateMsg', {\n      name: comp < 0 ? $t('frontend') : $t('backend'),\n    })} <span class=\"atk-info\">` +\n      `${$t('currentVersion')}: ${$t('frontend')} ${feVer} / ${$t('backend')} ${beVer}` +\n      `</span></div>`,\n  )\n  const ignoreBtn = Utils.createElement(`<span class=\"atk-ignore-btn\">${$t('ignore')}</span>`)\n  ignoreBtn.onclick = () => {\n    errEl.remove()\n    IgnoreVersionCheck = true\n  }\n  errEl.append(ignoreBtn)\n  list.$el.parentElement!.prepend(errEl)\n}\n","import type { ArtalkPlugin } from '@/types'\n\n// Notice: Singleton pattern needs to be loaded as lazy as possible,\n//         because the SSG application does not have a `window` context.\nlet darkModeMedia: MediaQueryList | undefined\n\nfunction updateClassnames($els: HTMLElement[], darkMode: boolean) {\n  const DarkModeClassName = 'atk-dark-mode'\n\n  $els.forEach(($el) => {\n    if (darkMode) $el.classList.add(DarkModeClassName)\n    else $el.classList.remove(DarkModeClassName)\n  })\n}\n\nexport const DarkMode: ArtalkPlugin = (ctx) => {\n  // the handler bind to Artalk instance, don't forget to remove it when Artalk instance destroyed\n  let darkModeAutoHandler: ((evt: MediaQueryListEvent) => void) | undefined\n\n  const sync = (darkMode: boolean | 'auto') => {\n    // the elements that classnames need to be updated when darkMode changed\n    const $els = [ctx.$root, ctx.get('layerManager').getEl()]\n\n    // init darkModeMedia if not exists, and only create once\n    if (!darkModeMedia) {\n      darkModeMedia = window.matchMedia('(prefers-color-scheme: dark)')\n    }\n\n    if (darkMode === 'auto') {\n      // if darkMode is 'auto', add handler\n      if (!darkModeAutoHandler) {\n        // the handler that will be called when darkModeMedia changed\n        darkModeAutoHandler = (evt) => updateClassnames($els, evt.matches)\n        darkModeMedia.addEventListener('change', darkModeAutoHandler)\n      }\n\n      // update classnames immediately\n      updateClassnames($els, darkModeMedia.matches)\n    } else {\n      // if darkMode is boolean, remove handler\n      if (darkModeAutoHandler) {\n        darkModeMedia.removeEventListener('change', darkModeAutoHandler)\n        darkModeAutoHandler = undefined\n      }\n\n      // update classnames immediately\n      updateClassnames($els, darkMode)\n    }\n  }\n\n  ctx.watchConf(['darkMode'], (conf) => sync(conf.darkMode))\n  ctx.on('created', () => sync(ctx.conf.darkMode))\n  ctx.on('unmounted', () => {\n    // if handler exists, don't forget to remove it, or it will cause memory leak\n    darkModeAutoHandler && darkModeMedia?.removeEventListener('change', darkModeAutoHandler)\n    darkModeAutoHandler = undefined\n  })\n}\n","import { Markdown } from './markdown'\nimport { EditorKit } from './editor-kit'\nimport { ListPlugins } from './list'\nimport { Notifies } from './notifies'\nimport { PvCountWidget } from './stat'\nimport { VersionCheck } from './version-check'\nimport { AdminOnlyElem } from './admin-only-elem'\nimport { DarkMode } from './dark-mode'\nimport type { ArtalkPlugin } from '@/types'\n\nexport const DefaultPlugins: ArtalkPlugin[] = [\n  Markdown,\n  EditorKit,\n  AdminOnlyElem,\n  ...ListPlugins,\n  Notifies,\n  PvCountWidget,\n  VersionCheck,\n  DarkMode,\n]\n","import type { ArtalkPlugin } from '@/types'\n\nexport const AdminOnlyElem: ArtalkPlugin = (ctx) => {\n  const scanApply = () => {\n    applyAdminOnlyEls(\n      ctx.get('user').getData().is_admin,\n      getAdminOnlyEls({\n        $root: ctx.$root,\n      }),\n    )\n  }\n\n  ctx.on('list-loaded', () => {\n    scanApply()\n  })\n\n  ctx.on('user-changed', (user) => {\n    scanApply()\n  })\n}\n\nfunction getAdminOnlyEls(opts: { $root: HTMLElement }): HTMLElement[] {\n  const els: HTMLElement[] = []\n\n  // elements in $root\n  opts.$root\n    .querySelectorAll<HTMLElement>(`[atk-only-admin-show]`)\n    .forEach((item) => els.push(item))\n\n  // TODO: provide a Artalk.conf hook to set whitelist of admin-only elements,\n  // and move following code to that hook (move into @artalk/artalk-sidebar)\n\n  // elements in sidebar\n  const $sidebarEl = document.querySelector<HTMLElement>('.atk-sidebar')\n  if ($sidebarEl)\n    $sidebarEl\n      .querySelectorAll<HTMLElement>(`[atk-only-admin-show]`)\n      .forEach((item) => els.push(item))\n\n  return els\n}\n\nfunction applyAdminOnlyEls(isAdmin: boolean, els: HTMLElement[]) {\n  els.forEach(($item: HTMLElement) => {\n    if (isAdmin) $item.classList.remove('atk-hide')\n    else $item.classList.add('atk-hide')\n  })\n}\n","import { WithEditor } from './with-editor'\nimport { Unread } from './unread'\nimport { Count } from './count'\nimport { SidebarBtn } from './sidebar-btn'\nimport { UnreadBadge } from './unread-badge'\nimport { GotoDispatcher } from './goto-dispatcher'\nimport { GotoFocus } from './goto-focus'\nimport { Copyright } from './copyright'\nimport { NoComment } from './no-comment'\nimport { Dropdown } from './dropdown'\nimport { TimeTicking } from './time-ticking'\nimport { ErrorDialog } from './error-dialog'\nimport { Loading } from './loading'\nimport { Fetch } from './fetch'\nimport { ReachBottom } from './reach-bottom'\nimport { GotoFirst } from './goto-first'\nimport type { ArtalkPlugin } from '@/types'\n\nconst ListPlugins: ArtalkPlugin[] = [\n  Fetch,\n  Loading,\n  Unread,\n  WithEditor,\n  Count,\n  SidebarBtn,\n  UnreadBadge,\n  Dropdown,\n  GotoDispatcher,\n  GotoFocus,\n  NoComment,\n  Copyright,\n  TimeTicking,\n  ErrorDialog,\n  ReachBottom,\n  GotoFirst,\n]\n\nexport { ListPlugins }\n","import type { ListFetchParams, ArtalkPlugin } from '@/types'\n\nexport const Fetch: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (_params) => {\n    if (ctx.getData().getLoading()) return\n    ctx.getData().setLoading(true)\n\n    const params: ListFetchParams = {\n      // default params\n      offset: 0,\n      limit: ctx.conf.pagination.pageSize,\n      flatMode: ctx.conf.flatMode as boolean, // always be boolean because had been handled in Artalk.init\n      paramsModifier: ctx.conf.listFetchParamsModifier,\n      ..._params,\n    }\n\n    // must before other function call\n    ctx.getData().setListLastFetch({\n      params,\n    })\n\n    // prepare params for request\n    const reqParams = {\n      limit: params.limit,\n      offset: params.offset,\n      flat_mode: params.flatMode,\n      page_key: ctx.getConf().pageKey,\n      site_name: ctx.getConf().site,\n    }\n\n    // call the modifier function\n    if (params.paramsModifier) params.paramsModifier(reqParams)\n\n    // start request\n    ctx\n      .getApi()\n      .comments.getComments({\n        ...reqParams,\n        ...ctx.getApi().getUserFields(),\n      })\n      .then(({ data }) => {\n        // Must before all other function call and event trigger,\n        // because it will depend on the lastData\n        // TODO: this is global variable, easy to use, but not good, consider to refactor.\n        // refactor work is hard, because it is used in many places.\n        ctx.getData().setListLastFetch({ params, data })\n\n        // 装置评论\n        ctx.getData().loadComments(data.comments)\n\n        // 更新页面数据\n        ctx.getData().updatePage(data.page)\n\n        // trigger events when success\n        params.onSuccess && params.onSuccess(data)\n\n        ctx.trigger('list-fetched', { params, data })\n      })\n      .catch((e) => {\n        // 显示错误对话框\n        const error = {\n          msg: e.msg || String(e),\n          data: e.data,\n        }\n\n        params.onError && params.onError(error)\n\n        // trigger events when error\n        ctx.trigger('list-failed', error)\n        ctx.trigger('list-fetched', { params, error })\n\n        throw e\n      })\n      .finally(() => {\n        ctx.getData().setLoading(false)\n      })\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Ui from '@/lib/ui'\n\nexport const Loading: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (p) => {\n    const list = ctx.get('list')\n\n    if (p.offset === 0)\n      // only show loading when fetch first page\n      Ui.setLoading(true, list.$el)\n    // else if not first page, show loading in paginator (code not there)\n  })\n\n  ctx.on('list-fetched', () => {\n    const list = ctx.get('list')\n    Ui.setLoading(false, list.$el)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport const Unread: ArtalkPlugin = (ctx) => {\n  ctx.on('comment-rendered', (comment) => {\n    // comment unread highlight\n    if (ctx.conf.listUnreadHighlight === true) {\n      const notifies = ctx.getData().getNotifies()\n      const notify = notifies.find((o) => o.comment_id === comment.getID())\n\n      if (notify) {\n        // if comment contains in unread list\n        comment.getRender().setUnread(true)\n        comment.getRender().setOpenAction(() => {\n          window.open(notify.read_link)\n\n          // remove notify which has been read\n          ctx.getData().updateNotifies(notifies.filter((o) => o.comment_id !== comment.getID()))\n        })\n      } else {\n        // comment not in unread list\n        comment.getRender().setUnread(false)\n      }\n    }\n  })\n\n  ctx.on('list-goto', (commentID) => {\n    const notifyKey = Utils.getQueryParam('atk_notify_key')\n    if (notifyKey) {\n      // mark as read\n      ctx\n        .getApi()\n        .notifies.markNotifyRead(commentID, notifyKey)\n        .then(() => {\n          // remove from unread list\n          ctx.getData().updateNotifies(\n            ctx\n              .getData()\n              .getNotifies()\n              .filter((o) => o.comment_id !== commentID),\n          )\n        })\n    }\n  })\n}\n","import type { ContextApi, ArtalkPlugin, PageData } from '@/types'\nimport $t from '@/i18n'\n\nexport const WithEditor: ArtalkPlugin = (ctx) => {\n  let $closeCommentBtn: HTMLElement | undefined\n\n  // on Artalk mounted\n  // (after all components had mounted)\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    $closeCommentBtn = list.$el.querySelector<HTMLElement>('[data-action=\"admin-close-comment\"]')!\n\n    // bind editor close button click event\n    $closeCommentBtn.addEventListener('click', () => {\n      const page = ctx.getData().getPage()\n      if (!page) throw new Error('Page data not found')\n\n      page.admin_only = !page.admin_only\n      adminPageEditSave(ctx, page)\n    })\n  })\n\n  // on comment list loaded (it will include page data update)\n  ctx.on('page-loaded', (page) => {\n    const editor = ctx.get('editor')\n\n    // if page comment is closed\n    if (page?.admin_only === true) {\n      // then close editor\n      editor.getPlugs()?.getEvents().trigger('editor-close')\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('openComment'))\n    } else {\n      // the open editor\n      editor.getPlugs()?.getEvents().trigger('editor-open')\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('closeComment'))\n    }\n  })\n\n  ctx.on('list-loaded', (comments) => {\n    // 防止评论框被吞\n    ctx.editorResetState()\n  })\n}\n\n/** 管理员设置页面信息 */\nfunction adminPageEditSave(ctx: ContextApi, page: PageData) {\n  ctx.editorShowLoading()\n  ctx\n    .getApi()\n    .pages.updatePage(page.id, page)\n    .then(({ data }) => {\n      ctx.getData().updatePage(data)\n    })\n    .catch((err) => {\n      ctx.editorShowNotify(`${$t('editFail')}: ${err.message || String(err)}`, 'e')\n    })\n    .finally(() => {\n      ctx.editorHideLoading()\n    })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport const Count: ArtalkPlugin = (ctx) => {\n  const refreshCountNumEl = () => {\n    const list = ctx.get('list')\n\n    const $count = list.$el.querySelector('.atk-comment-count .atk-text')\n    if (!$count) return\n\n    const text = Utils.htmlEncode(\n      $t('counter', {\n        count: `${Number(ctx.getData().getListLastFetch()?.data?.count) || 0}`,\n      }),\n    )\n    $count.innerHTML = text.replace(/(\\d+)/, '<span class=\"atk-comment-count-num\">$1</span>')\n  }\n\n  ctx.on('list-loaded', () => {\n    refreshCountNumEl()\n  })\n\n  ctx.on('comment-inserted', () => {\n    // 评论数增加 1\n    const last = ctx.getData().getListLastFetch()\n    if (last?.data) last.data.count += 1\n  })\n\n  ctx.on('comment-deleted', () => {\n    // 评论数减 1\n    const last = ctx.getData().getListLastFetch()\n    if (last?.data) last.data.count -= 1\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport $t from '@/i18n'\n\nexport const SidebarBtn: ArtalkPlugin = (ctx) => {\n  let $openSidebarBtn: HTMLElement | null = null\n\n  const syncByUser = () => {\n    if (!$openSidebarBtn) return\n    const user = ctx.get('user').getData()\n\n    // 已输入个人信息\n    if (!!user.name && !!user.email) {\n      $openSidebarBtn.classList.remove('atk-hide')\n\n      // update button text (normal user or admin)\n      const $btnText = $openSidebarBtn.querySelector<HTMLElement>('.atk-text')\n      if ($btnText) $btnText.innerText = !user.is_admin ? $t('msgCenter') : $t('ctrlCenter')\n    } else {\n      $openSidebarBtn.classList.add('atk-hide')\n    }\n  }\n\n  ctx.watchConf(['locale'], (conf) => {\n    const list = ctx.get('list')\n\n    $openSidebarBtn = list.$el.querySelector<HTMLElement>('[data-action=\"open-sidebar\"]')\n    if (!$openSidebarBtn) return\n\n    $openSidebarBtn.onclick = () => {\n      // use onclick rather than addEventListener to prevent duplicate event\n      ctx.showSidebar()\n    }\n\n    syncByUser()\n  })\n\n  ctx.on('user-changed', (user) => {\n    syncByUser()\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const UnreadBadge: ArtalkPlugin = (ctx) => {\n  let $unreadBadge: HTMLElement | null = null\n\n  const showUnreadBadge = (count: number) => {\n    if (!$unreadBadge) return\n\n    if (count > 0) {\n      $unreadBadge.innerText = `${Number(count || 0)}`\n      $unreadBadge.style.display = 'block'\n    } else {\n      $unreadBadge.style.display = 'none'\n    }\n  }\n\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    $unreadBadge = list.$el.querySelector<HTMLElement>('.atk-unread-badge')\n  })\n\n  ctx.on('notifies-updated', (notifies) => {\n    showUnreadBadge(notifies.length || 0)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport const Dropdown: ArtalkPlugin = (ctx) => {\n  const reloadUseParamsEditor = (func: (p: any) => void) => {\n    ctx.conf.listFetchParamsModifier = func\n    ctx.reload()\n  }\n\n  const initDropdown = ($dropdownOn: HTMLElement) => {\n    renderDropdown({\n      $dropdownWrap: $dropdownOn,\n      dropdownList: [\n        [\n          $t('sortLatest'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.sort_by = 'date_desc'\n            })\n          },\n        ],\n        [\n          $t('sortBest'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.sort_by = 'vote'\n            })\n          },\n        ],\n        [\n          $t('sortOldest'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.sort_by = 'date_asc'\n            })\n          },\n        ],\n        [\n          $t('sortAuthor'),\n          () => {\n            reloadUseParamsEditor((p) => {\n              p.view_only_admin = true\n            })\n          },\n        ],\n      ],\n    })\n  }\n\n  ctx.watchConf(['listSort', 'locale'], (conf) => {\n    const list = ctx.get('list')\n\n    const $count = list.$el.querySelector<HTMLElement>('.atk-comment-count')\n    if (!$count) return\n\n    // 评论列表排序 Dropdown 下拉选择层\n    if (conf.listSort) {\n      initDropdown($count)\n    } else {\n      removeDropdown({\n        $dropdownWrap: $count,\n      })\n    }\n  })\n}\n\n/** 评论排序方式选择下拉菜单 */\nfunction renderDropdown(conf: {\n  $dropdownWrap: HTMLElement\n  dropdownList: [string, () => void][]\n}) {\n  const { $dropdownWrap, dropdownList } = conf\n  if ($dropdownWrap.querySelector('.atk-dropdown')) return\n\n  // 修改 class\n  $dropdownWrap.classList.add('atk-dropdown-wrap')\n\n  // 插入图标\n  $dropdownWrap.append(Utils.createElement(`<span class=\"atk-arrow-down-icon\"></span>`))\n\n  // 列表项点击事件\n  let curtActive = 0 // 当前选中\n  const onItemClick = (i: number, $item: HTMLElement, name: string, action: () => void) => {\n    action()\n\n    // set active\n    curtActive = i\n    $dropdown.querySelectorAll('.active').forEach((e) => {\n      e.classList.remove('active')\n    })\n    $item.classList.add('active')\n\n    // 关闭层 (临时消失，取消 :hover)\n    $dropdown.style.display = 'none'\n    setTimeout(() => {\n      $dropdown.style.display = ''\n    }, 80)\n  }\n\n  // 生成列表元素\n  const $dropdown = Utils.createElement(`<ul class=\"atk-dropdown atk-fade-in\"></ul>`)\n  dropdownList.forEach((item, i) => {\n    const [name, action] = item\n\n    const $item = Utils.createElement(`<li class=\"atk-dropdown-item\"><span></span></li>`)\n    const $link = $item.querySelector<HTMLElement>('span')!\n    $link.innerText = name\n    $link.onclick = () => {\n      onItemClick(i, $item, name, action)\n    }\n    $dropdown.append($item)\n\n    if (i === curtActive) $item.classList.add('active') // 默认选中项\n  })\n\n  $dropdownWrap.append($dropdown)\n}\n\n/** 删除评论排序方式选择下拉菜单 */\nfunction removeDropdown(conf: { $dropdownWrap: HTMLElement }) {\n  const { $dropdownWrap } = conf\n  $dropdownWrap.classList.remove('atk-dropdown-wrap')\n  $dropdownWrap.querySelector('.atk-arrow-down-icon')?.remove()\n  $dropdownWrap.querySelector('.atk-dropdown')?.remove()\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport const GotoDispatcher: ArtalkPlugin = (ctx) => {\n  let lastID = 0\n  const check = ({ locker }: { locker: boolean }) => {\n    const commentID = extractCommentID()\n    if (!commentID) return\n\n    if (locker && lastID === commentID) return // if the commentID is the same as the last one, do nothing\n    lastID = commentID // record the last commentID\n\n    ctx.trigger('list-goto', commentID) // trigger event\n  }\n\n  const hashChangeHandler = () => check({ locker: false })\n  const listLoadedHandler = () => check({ locker: true })\n  ctx.on('mounted', () => {\n    window.addEventListener('hashchange', hashChangeHandler)\n    ctx.on('list-loaded', listLoadedHandler)\n  })\n  ctx.on('unmounted', () => {\n    window.removeEventListener('hashchange', hashChangeHandler)\n    ctx.off('list-loaded', listLoadedHandler)\n  })\n}\n\nfunction extractCommentID(): number | null {\n  // Try get from hash\n  // Hash retrieval priority is higher than query,\n  // Because click goto will change hash.\n  const match = window.location.hash.match(/#atk-comment-([0-9]+)/)\n  let commentId =\n    match && match[1] && !Number.isNaN(parseFloat(match[1])) ? parseFloat(match[1]) : null\n\n  // Fail over to get from query\n  if (!commentId) {\n    commentId = Number(Utils.getQueryParam('atk_comment')) // same as backend GetReplyLink()\n  }\n\n  return commentId || null\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport { sanitize } from '@/lib/sanitizer'\n\nexport const NoComment: ArtalkPlugin = (ctx) => {\n  ctx.on('list-loaded', (comments) => {\n    const list = ctx.get('list')!\n\n    // 无评论\n    const isNoComment = comments.length <= 0\n    let $noComment = list.getCommentsWrapEl().querySelector<HTMLElement>('.atk-list-no-comment')\n\n    if (isNoComment) {\n      if (!$noComment) {\n        $noComment = Utils.createElement('<div class=\"atk-list-no-comment\"></div>')\n\n        // sanitize before set innerHTML\n        $noComment.innerHTML = sanitize(list.ctx.conf.noComment || list.ctx.$t('noComment'))\n        list.getCommentsWrapEl().appendChild($noComment)\n      }\n    } else {\n      $noComment?.remove()\n    }\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { version as ARTALK_VERSION } from '~/package.json'\n\nexport const Copyright: ArtalkPlugin = (ctx) => {\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    const $copyright = list.$el.querySelector<HTMLElement>('.atk-copyright')\n    if (!$copyright) return\n\n    $copyright.innerHTML =\n      `Powered By <a href=\"https://artalk.js.org\" ` +\n      `target=\"_blank\" title=\"Artalk v${ARTALK_VERSION}\">` +\n      `Artalk</a>`\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/** 评论时间自动更新 */\nexport const TimeTicking: ArtalkPlugin = (ctx) => {\n  let timer: number | null = null\n\n  ctx.on('mounted', () => {\n    timer = window.setInterval(() => {\n      const list = ctx.get('list')\n\n      list.$el.querySelectorAll<HTMLElement>('[data-atk-comment-date]').forEach((el) => {\n        const date = new Date(Number(el.getAttribute('data-atk-comment-date')))\n        el.innerText = ctx.getConf().dateFormatter?.(date) || Utils.timeAgo(date, ctx.$t)\n      })\n    }, 30 * 1000) // 30s 更新一次\n  })\n\n  ctx.on('unmounted', () => {\n    timer && window.clearInterval(timer)\n  })\n}\n","import * as Ui from '../../lib/ui'\nimport type { ArtalkPlugin, ContextApi } from '@/types'\nimport { showErrorDialog } from '@/components/error-dialog'\n\nexport const ErrorDialog: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', () => {\n    const list = ctx.get('list')\n\n    // clear the original error when a new fetch is triggered\n    Ui.setError(list.$el, null)\n  })\n\n  ctx.on('list-failed', (err) => {\n    showErrorDialog({\n      $err: ctx.get('list').$el,\n      errMsg: err.msg,\n      errData: err.data,\n      retryFn: () => ctx.fetch({ offset: 0 }),\n    })\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const ReachBottom: ArtalkPlugin = (ctx) => {\n  let observer: IntersectionObserver | null = null\n\n  const setupObserver = ($target: HTMLElement) => {\n    const scrollEvtAt = (ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()) || null\n\n    observer = new IntersectionObserver(\n      ([entries]) => {\n        if (entries.isIntersecting) {\n          clearObserver() // clear before trigger event to avoid trigger twice `list-reach-bottom`\n\n          // note that this event will be triggered only once\n          // until the next list is loaded\n          ctx.trigger('list-reach-bottom')\n        }\n      },\n      {\n        threshold: 0.9, // when the target is 90% visible\n\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/root\n        // If the root is null, then the bounds of the actual document viewport are used.\n        root: scrollEvtAt,\n      },\n    )\n    observer.observe($target)\n  }\n\n  const clearObserver = () => {\n    observer?.disconnect()\n    observer = null\n  }\n\n  ctx.on('list-loaded', () => {\n    clearObserver()\n\n    const list = ctx.get('list')\n\n    // get the second last child\n    const children = list.getCommentsWrapEl().childNodes\n    const $target = children.length > 2 ? (children[children.length - 2] as HTMLElement) : null\n    if (!$target) return\n\n    // check IntersectionObserver support\n    if (!('IntersectionObserver' in window)) {\n      console.warn('IntersectionObserver api not supported')\n      return\n    }\n\n    // use IntersectionObserver to detect reach bottom\n    setupObserver($target)\n  })\n\n  ctx.on('unmounted', () => {\n    clearObserver()\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/** List scroll to the first comment */\nexport const GotoFirst: ArtalkPlugin = (ctx) => {\n  const handler = () => {\n    const list = ctx.get('list')\n\n    const $relative = ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()\n    ;($relative || window).scroll({\n      top: Utils.getOffset(list.$el, $relative).top,\n      left: 0,\n    })\n  }\n\n  ctx.on('mounted', () => {\n    ctx.on('list-goto-first', handler)\n  })\n\n  ctx.on('unmounted', () => {\n    ctx.off('list-goto-first', handler)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const Notifies: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (params) => {\n    if (params.offset !== 0) return\n\n    const user = ctx.getApi().getUserFields()\n    if (!user) return\n\n    // Fetch all unread notifies\n    ctx\n      .getApi()\n      .notifies.getNotifies(user)\n      .then((res) => {\n        ctx.getData().updateNotifies(res.data.notifies)\n      })\n  })\n}\n","import { DefaultPlugins } from './plugins'\nimport type { ArtalkConfig, ArtalkPlugin, ContextApi } from '@/types'\nimport { handleConfFormServer } from '@/config'\nimport { showErrorDialog } from '@/components/error-dialog'\n\n/**\n * Global Plugins for all Artalk instances\n */\nexport const GlobalPlugins: Set<ArtalkPlugin> = new Set([...DefaultPlugins])\n\n/**\n * Plugin options for plugin initialization\n */\nexport const PluginOptions: WeakMap<ArtalkPlugin, any> = new WeakMap()\n\nexport async function load(ctx: ContextApi) {\n  const loadedPlugins = new Set<ArtalkPlugin>()\n  const loadPlugins = (plugins: Set<ArtalkPlugin>) => {\n    plugins.forEach((plugin) => {\n      if (typeof plugin === 'function' && !loadedPlugins.has(plugin)) {\n        plugin(ctx, PluginOptions.get(plugin))\n        loadedPlugins.add(plugin)\n      }\n    })\n  }\n\n  // Load local plugins\n  loadPlugins(GlobalPlugins)\n\n  // Get conf from server\n  const { data } = await ctx\n    .getApi()\n    .conf.conf()\n    .catch((err) => {\n      onLoadErr(ctx, err)\n      throw err\n    })\n\n  // Initial config\n  let conf: Partial<ArtalkConfig> = {\n    apiVersion: data.version?.version, // version info\n  }\n\n  // Reference conf from backend\n  if (ctx.conf.useBackendConf) {\n    if (!data.frontend_conf)\n      throw new Error(\n        'The remote backend does not respond to the frontend conf, but `useBackendConf` conf is enabled',\n      )\n    conf = { ...conf, ...handleConfFormServer(data.frontend_conf) }\n  }\n\n  // Apply conf modifier\n  ctx.conf.remoteConfModifier && ctx.conf.remoteConfModifier(conf)\n\n  // Dynamically load network plugins\n  conf.pluginURLs &&\n    (await loadNetworkPlugins(conf.pluginURLs, ctx.conf.server)\n      .then((plugins) => {\n        loadPlugins(plugins)\n      })\n      .catch((err) => {\n        console.error('Failed to load plugin', err)\n      }))\n\n  // After all plugins are loaded\n  ctx.trigger('created')\n\n  // Apply conf updating\n  ctx.updateConf(conf)\n\n  // Trigger mounted event\n  ctx.trigger('mounted')\n\n  // Load comment list\n  if (!ctx.conf.remoteConfModifier) {\n    // only auto fetch when no remoteConfModifier\n    ctx.fetch({ offset: 0 })\n  }\n}\n\n/**\n * Dynamically load plugins from Network\n */\nasync function loadNetworkPlugins(scripts: string[], apiBase: string): Promise<Set<ArtalkPlugin>> {\n  const networkPlugins = new Set<ArtalkPlugin>()\n  if (!scripts || !Array.isArray(scripts)) return networkPlugins\n\n  const tasks: Promise<void>[] = []\n\n  scripts.forEach((url) => {\n    // check url valid\n    if (!/^(http|https):\\/\\//.test(url))\n      url = `${apiBase.replace(/\\/$/, '')}/${url.replace(/^\\//, '')}`\n\n    tasks.push(\n      new Promise<void>((resolve) => {\n        // check if loaded\n        if (document.querySelector(`script[src=\"${url}\"]`)) {\n          resolve()\n          return\n        }\n\n        // load script\n        const script = document.createElement('script')\n        script.src = url\n        document.head.appendChild(script)\n        script.onload = () => resolve()\n        script.onerror = (err) => {\n          console.error('[artalk] Failed to load plugin', err)\n          resolve()\n        }\n      }),\n    )\n  })\n\n  await Promise.all(tasks)\n\n  // Read ArtalkPlugins object from window\n  Object.values(window.ArtalkPlugins || {}).forEach((plugin) => {\n    if (typeof plugin === 'function') networkPlugins.add(plugin)\n  })\n\n  return networkPlugins\n}\n\nexport function onLoadErr(ctx: ContextApi, err: any) {\n  let sidebarOpenView = ''\n\n  // if response err_no_site, modify the sidebar open view to create site\n  if (err.data?.err_no_site) {\n    const viewLoadParam = {\n      create_name: ctx.conf.site,\n      create_urls: `${window.location.protocol}//${window.location.host}`,\n    }\n    sidebarOpenView = `sites|${JSON.stringify(viewLoadParam)}`\n  }\n\n  showErrorDialog({\n    $err: ctx.get('list').$el,\n    errMsg: err.msg || String(err),\n    errData: err.data,\n    retryFn: () => load(ctx),\n    onOpenSidebar: ctx.get('user').getData().is_admin\n      ? () =>\n          ctx.showSidebar({\n            view: sidebarOpenView as any,\n          })\n      : undefined, // only show open sidebar button when user is admin\n  })\n}\n","import './style/main.scss'\n\nimport type { EventHandler } from './lib/event-manager'\nimport Context from './context'\nimport { handelCustomConf, convertApiOptions } from './config'\nimport Services from './service'\nimport * as Stat from './plugins/stat'\nimport { Api } from './api'\nimport type { TInjectedServices } from './service'\nimport { GlobalPlugins, PluginOptions, load } from './load'\nimport type { ArtalkConfig, EventPayloadMap, ArtalkPlugin, ContextApi } from '@/types'\n\n/**\n * Artalk\n *\n * @see https://artalk.js.org\n */\nexport default class Artalk {\n  public ctx!: ContextApi\n\n  constructor(conf: Partial<ArtalkConfig>) {\n    // Init Config\n    const handledConf = handelCustomConf(conf, true)\n\n    // Init Context\n    this.ctx = new Context(handledConf)\n\n    // Init Services\n    Object.entries(Services).forEach(([name, initService]) => {\n      const obj = initService(this.ctx)\n      obj && this.ctx.inject(name as keyof TInjectedServices, obj) // auto inject deps to ctx\n    })\n\n    if (import.meta.env.DEV && import.meta.env.VITEST) {\n      global.devLoadArtalk = () => load(this.ctx)\n    } else {\n      load(this.ctx)\n    }\n  }\n\n  /** Get the config of Artalk */\n  public getConf() {\n    return this.ctx.getConf()\n  }\n\n  /** Get the root element of Artalk */\n  public getEl() {\n    return this.ctx.$root\n  }\n\n  /** Update config of Artalk */\n  public update(conf: Partial<ArtalkConfig>) {\n    this.ctx.updateConf(conf)\n    return this\n  }\n\n  /** Reload comment list of Artalk */\n  public reload() {\n    this.ctx.reload()\n  }\n\n  /** Destroy instance of Artalk */\n  public destroy() {\n    this.ctx.trigger('unmounted')\n    while (this.ctx.$root.firstChild) {\n      this.ctx.$root.removeChild(this.ctx.$root.firstChild)\n    }\n  }\n\n  /** Add an event listener */\n  public on<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\n    this.ctx.on(name, handler)\n  }\n\n  /** Remove an event listener */\n  public off<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\n    this.ctx.off(name, handler)\n  }\n\n  /** Trigger an event */\n  public trigger<K extends keyof EventPayloadMap>(name: K, payload?: EventPayloadMap[K]) {\n    this.ctx.trigger(name, payload)\n  }\n\n  /** Set dark mode */\n  public setDarkMode(darkMode: boolean) {\n    this.ctx.setDarkMode(darkMode)\n  }\n\n  // ===========================\n  //       Static Members\n  // ===========================\n\n  /** Init Artalk */\n  public static init(conf: Partial<ArtalkConfig>): Artalk {\n    return new Artalk(conf)\n  }\n\n  /** Use plugin, the plugin will be used when Artalk.init */\n  public static use<T = any>(plugin: ArtalkPlugin<T>, options?: T) {\n    GlobalPlugins.add(plugin)\n    PluginOptions.set(plugin, options)\n  }\n\n  /** Load count widget */\n  public static loadCountWidget(c: Partial<ArtalkConfig>) {\n    const conf = handelCustomConf(c, true)\n\n    Stat.initCountWidget({\n      getApi: () => new Api(convertApiOptions(conf)),\n      siteName: conf.site,\n      countEl: conf.countEl,\n      pvEl: conf.pvEl,\n      pageKeyAttr: conf.statPageKeyAttr,\n      pvAdd: false,\n    })\n  }\n\n  // ===========================\n  //         Deprecated\n  // ===========================\n\n  /** @deprecated Please use `getEl()` instead */\n  public get $root() {\n    return this.ctx.$root\n  }\n\n  /** @description Please use `getConf()` instead */\n  public get conf() {\n    return this.ctx.getConf()\n  }\n}\n","import Artalk from './artalk'\nimport type * as ArtalkType from './types'\n\nexport type * from './types'\nexport { ArtalkType }\n\nexport default Artalk\n\n// Expose the static methods from the Artalk class\n// because direct export of static methods is not supported\n// for adapting to different environments like CommonJS and browser IIFE\n// for example, we can use `Artalk.init()` rather than `Artalk.default.init()`\n// therefore, we need to manually expose the static methods in the Artalk class.\nexport const init = Artalk.init\nexport const use = Artalk.use\nexport const loadCountWidget = Artalk.loadCountWidget\n"],"names":["HttpClient","constructor","apiConfig","__publicField","this","Map","fetchParams","fetch","credentials","headers","redirect","referrerPolicy","data","securityData","input","JSON","stringify","Object","keys","reduce","formData","key","property","append","Blob","FormData","toQueryString","cancelToken","abortControllers","has","abortController","get","signal","AbortController","set","abort","delete","_a","__async","_b","body","secure","path","type","query","format","baseUrl","params","__objRest","secureParams","baseApiParams","securityWorker","requestParams","mergeRequestParams","queryString","payloadFormatter","contentFormatters","responseFormat","customFetch","__spreadProps","__spreadValues","createAbortSignal","then","response","r","clone","error","ok","catch","e","assign","encodeQueryParam","value","encodeURIComponent","addQueryParam","addArrayQueryParam","map","v","join","rawQuery","filter","Array","isArray","addQueryParams","params1","params2","super","arguments","loginByEmail","request","method","registerByEmail","sendVerifyEmail","checkDataMerge","applyDataMerge","flushCache","warmUpCache","getCaptcha","getCaptchaStatus","verifyCaptcha","getComments","createComment","comment","getComment","id","updateComment","deleteComment","conf","getSocialLoginProviders","getDomain","getNotifies","markAllNotifyRead","options","markNotifyRead","commentId","notifyKey","getPages","fetchAllPages","getPageFetchStatus","logPv","page","updatePage","deletePage","fetchPage","sendEmail","email","getSettings","applySettings","settings","getSettingsTemplate","locale","getSites","createSite","site","updateSite","deleteSite","getStats","exportArtrans","importArtrans","uploadArtrans","upload","getUser","updateProfile","login","user","getUserStatus","createUser","updateUser","deleteUser","getUsers","getVersion","syncVotes","vote","targetId","Fetch","opts","init","apiToken","getApiToken","Headers","Authorization","resp","json","retry","handlers","promise","item","action","handler","Promise","resolve","code","err","FetchException","message","msg","console","createError","status","Error","Api","ApiV2","baseURL","_opts","getUserFields","userInfo","name","_getDefaults","async","breaks","extensions","gfm","hooks","pedantic","renderer","silent","tokenizer","walkTokens","_defaults","changeDefaults","newDefaults","escapeTest","escapeReplace","RegExp","source","escapeTestNoEncode","escapeReplaceNoEncode","escapeReplacements","getEscapeReplacement","ch","escape$1","html","encode","test","replace","caret","edit","regex","opt","obj","val","valSource","getRegex","cleanUrl","href","encodeURI","noopTest","exec","splitCells","tableRow","count","cells","match","offset","str","escaped","curr","split","i","trim","shift","length","pop","splice","push","rtrim","c","invert","l","suffLen","currChar","charAt","slice","outputLink","cap","link","raw","lexer","title","text","state","inLink","token","tokens","inlineTokens","_Tokenizer","space","src","rules","block","newline","codeBlockStyle","fences","matchIndentToCode","indentToCode","node","matchIndentInNode","indentInNode","indentCodeCompensation","lang","inline","anyPunctuation","heading","trimmed","depth","hr","blockquote","lines","inBlockquote","currentLines","currentRaw","currentText","top","blockTokens","lastToken","oldToken","newText","newToken","substring","list","bull","isordered","ordered","start","loose","items","itemRegex","endsWithBlankLine","endEarly","itemContents","line","t","repeat","nextLine","blankLine","indent","trimStart","search","nextBulletRegex","Math","min","hrRegex","fencesBeginRegex","headingBeginRegex","htmlBeginRegex","rawLine","nextLineWithoutTabs","ischecked","istask","task","checked","trimEnd","spacers","hasMultipleLineBreaks","some","pre","def","tag","toLowerCase","table","aligns","rows","header","align","row","cell","lheading","paragraph","escape","inRawBlock","trimmedUrl","rtrimSlash","lastParenIndex","b","indexOf","level","findClosingBracket","linkLen","reflink","links","nolink","emStrong","maskedSrc","prevChar","emStrongLDelim","punctuation","lLength","rDelim","rLength","delimTotal","midDelimTotal","endReg","emStrongRDelimAst","emStrongRDelimUnd","lastIndex","lastCharLength","index","codespan","hasNonSpaceChars","hasSpaceCharsOnBothEnds","br","del","autolink","url","prevCapZero","_backpedal","inlineText","bullet","_paragraph","_blockLabel","_tag","_comment","blockNormal","gfmTable","blockGfm","blockPedantic","_punctuation","_inlineComment","_inlineLabel","inlineNormal","blockSkip","reflinkSearch","inlinePedantic","inlineGfm","inlineBreaks","normal","_Lexer","create","inlineQueue","lex","lexInline","next","lastParagraphClipped","cutSrc","extTokenizer","call","startBlock","startIndex","Infinity","tempSrc","tempStart","forEach","getStartIndex","errMsg","charCodeAt","keepPrevChar","includes","lastIndexOf","startInline","_Renderer","langString","parser","parse","parseInline","j","listitem","itemBody","checkbox","unshift","tablecell","tablerow","k","content","strong","em","cleanHref","out","image","_TextRenderer","_Parser","textRenderer","anyToken","renderers","genericToken","ret","textToken","_Hooks","preprocess","markdown","postprocess","processAllTokens","provideLexer","provideParser","Set","Marked","args","setOptions","parseMarkdown","use","callback","values","concat","tableToken","listToken","defaults","childTokens","flat","pack","ext","prevRenderer","apply","extLevel","prop","rendererProp","rendererFunc","tokenizerProp","tokenizerFunc","prevTokenizer","hooksProp","hooksFunc","prevHook","passThroughHooks","arg","packWalktokens","blockType","origOpt","throwError","onError","prototype","toString","all","reject","markedInstance","marked","getDefaults","marked$1","Parser","Renderer","TextRenderer","Lexer","Tokenizer","Hooks","escapes","unescapes","rescaped","runescaped","escapeHtmlChar","unescapeHtmlChar","escapeHtml","String","unescapeHtml","she","decode","unescape","version","assignment_1","assignment","result","stack","hasOwnProperty","lowercase","string","asKey","accumulator","toMap_1","attributes","uris","require$$0","elements","voids","he","require$$1","require$$3","rstart","rend","rattrs","rtag","rtagend","require$$2","chars","lastItem","createStack","last","parsePart","substr","parseEdge","parseEndTag","parseStartTag","same","tagName","rest","unary","attrs","low","u","doubleQuotedValue","singleQuotedValue","unquotedValue","pos","end","sanitizer","buffer","context","o","ignoring","ignore","allowedTags","classesOk","allowedClasses","attrsOk","allowedAttributes","lkey","className","colon","questionmark","hash","allowedSchemes","matches","scheme","testUrl","unignore","transformText","reset","a","iframe","img","insane","strict","configuration","insaneOptions","span","reg","class","style","sanitize","exports","createCommonjsModule","fn","module","index$1","defaultColors","toComment","cm","ref","colors","cache","re","m","word","color","factory","renderCode","hanabi","getRenderer","markedLinkRenderer","markedCodeRenderer","markedImageRenderer","orgLinkRenderer","isSameOriginLink","URL","origin","getLinkOrigin","window","location","realLang","colorized","hljs","getLanguage","highlight","orgImageRenderer","imgLazyLoad","instance","replacers","markedOptions","getInstance","markedContent","_","alt","imgSrc","simpleMarked","dest","replacer","mergeDeep","objects","isObject","prev","pVal","oVal","DataManager","events","getLoading","loading","setLoading","getListLastFetch","listLastFetch","setListLastFetch","comments","fetchComments","trigger","findComment","find","clearComments","loadComments","partialComments","insertComment","notifies","updateNotifies","getPage","pageData","createElement","htmlStr","div","document","innerHTML","firstElementChild","htmlEncode","temp","innerText","getQueryParam","decodeURIComponent","getOffset","el","relativeTo","getOffsetRecursive","element","rect","getBoundingClientRect","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","left","elOffset","relativeToOffset","padWithZeros","vNumber","width","numAsString","timeAgo","date","$t","n","oldTime","getTime","diffValue","Date","days","floor","leave1","hours","leave2","minutes","leave3","seconds","round","vDay","getDate","vMonth","getMonth","getFullYear","dateFormat","getCorrectUserAgent","uaRaw","navigator","userAgent","userAgentData","getHighEntropyValues","uaData","uaGot","majorPlatformVersion","Number","platformVersion","platform","isValidURL","urlRaw","protocol","getURLBasedOnApi","base","en","placeholder","noComment","send","signIn","signUp","save","nick","emoticon","preview","uploadImage","uploadFail","commentFail","restoredMsg","onlyAdminCanReply","uploadLoginMsg","counter","sortLatest","sortOldest","sortBest","sortAuthor","openComment","closeComment","listLoadFailMsg","listRetry","loadMore","admin","reply","voteUp","voteDown","voteFail","readMore","actionConfirm","collapse","collapsed","collapsedMsg","expand","approved","pending","pendingMsg","editCancel","deleteConfirm","pin","unpin","now","adminCheck","captchaCheck","confirm","cancel","msgCenter","ctrlCenter","userProfile","noAccountPrompt","haveAccountPrompt","forgetPassword","resetPassword","changePassword","confirmPassword","passwordMismatch","verificationCode","verifySend","verifyResend","waitSeconds","emailVerified","password","username","nextStep","skipVerify","logoutConfirm","accountMergeNotice","accountMergeSelectOne","accountMergeConfirm","dismiss","merge","frontend","backend","loadFail","editing","editFail","deleting","deleteFail","reqGot","reqAborted","updateMsg","currentVersion","open","openName","GLOBAL_LOCALES_KEY","internal","findLocaleSet","p1","p2","toUpperCase","LocaleConf","LocaleDict","setLocale","Utils.htmlEncode","EventManager","on","off","evt","payload","once","pageKey","pageTitle","server","sendBtn","darkMode","editorTravel","flatMode","nestMax","nestSort","emoticons","uaBadge","listSort","countEl","pvEl","statPageKeyAttr","gravatar","mirror","pagination","pageSize","autoLoad","heightLimit","children","scrollable","imgUpload","reqTimeout","versionCheck","useBackendConf","handelCustomConf","customConf","full","Defaults","findEl","querySelector","pathname","language","matchMedia","convertApiOptions","ctx","siteName","timeout","getData","checkHasBasicUserInfo","getApiHandlers","watchConf","effect","lastVal","newVal","getConf","res","Context","getCommentNodes","$root","classList","add","mounted","inject","depName","getApi","apiHandlers","h","remove","findIndex","createApiHandlers","checkCaptcha","checkAdmin","createNewApiHandlers","replyComment","commentData","$comment","editor","setReply","editComment","setEditComment","reload","listGotoFirst","editorShowLoading","showLoading","editorHideLoading","hideLoading","editorShowNotify","showNotify","editorResetState","resetState","showSidebar","sidebarLayer","show","hideSidebar","hide","checkerLauncher","I18n.t","setDarkMode","updateConf","nConf","getEl","getMarked","marked.getInstance","parentElem","$loading","Utils.createElement","transparentBg","background","appendChild","display","$spinner","setTimeout","isConnected","scrollIntoView","elem","enableAnim","containerRect","clientHeight","scrollY","innerHeight","height","scrollOptions","behavior","scroll","playFadeInAnim","after","onAnimEnded","removeEventListener","addEventListener","playFadeAnim","setError","errorTextEl","HTMLElement","iframeBody","checker","$iframeWrap","$iframe","Ui.showLoading","getOpts","getCaptchaIframeURL","onload","Ui.hideLoading","$closeBtn","hideInteractInput","stop","queryStatus","ms","isPass","captcha","is_pass","triggerSuccess","onclick","CaptchaChecker","inputVal","render.iframeBody","imgEl","setAttribute","img_data","render.imgBody","onSuccess","formEl","click","AdminChecker","inputType","update","is_admin","onReload","Dialog","contentEl","$el","$actions","$content","setYes","btn","onBtnClick","setNo","currentTarget","wrapPromise","cancelFn","onCancel","successFn","CheckerLauncher","p","fire","postFire","layer","getCtx","close","destroy","checkerStore","checkerCtx","$input","btnTextOrg","focus","onkeyup","keyCode","preventDefault","dialog","btnEl","btnTextRestore","btnText","tf","onfocus","clearTimeout","onMount","Component","Sel","$header","$name","$email","$link","$textareaWrap","$textarea","$bottom","$submitBtn","$notifyWrap","$bottomLeft","$stateWrap","$plugBtnWrap","$plugPanelWrap","EditorPlug","kit","useBtn","$btn","usePanel","$panel","useContentTransformer","func","contentTransformer","usePanelShow","useEvents","aPlug","usePanelHide","useEditorStateEffect","stateName","effectFn","editorStateEffectWhen","editorStateEffect","Mover","move","afterEl","isMoved","editorEl","useUI","$travelPlace","replaceWith","back","useGlobalCtx","EditorStateManager","stateCurt","stateUnmountFn","getPlugs","moveAfterEl","_c","_d","$relative","scrollRelativeTo","Ui.scrollIntoView","getUI","plugin","_e","Editor","ui","entries","sel","render","getState","getHeaderInputEls","getContentFinal","getContentRaw","plugs","getTransformedContent","getContentMarked","setContent","getEvents","insertContent","selection","createRange","selectionStart","sStart","sEnd","selectionEnd","sT","switch","wrapElem","notifyElem","s","w","notifyRemove","timeoutFn","Ui.showNotify","submit","beforeSubmit","SidebarLayer","refreshWhenShow","transform","initLayer","createIframe","view","iFrameSrc","getDarkMode","iframeLoad","authCheck","animTimer","is_login","setOnAfterHide","Utils.getURLBasedOnApi","time","urlParams","URLSearchParams","createNestStrategy","import","srcData","sortBy","nodeList","rid","root","rootNode","parent","loadChildren","parentNode","child","childNode","sortFunc","vote_up","sortLevels","nodes","sort","ListNest.makeNestCommentNodeList","nestSortBy","rootC","createCommentNode","$commentsWrap","getRender","parentC","replyD","childD","childC","putChild","checkHeightLimit","insert","prepend","findCommentNode","getParents","heightLimitRemoveForChildren","insertMode","is_collapsed","is_allow_reply","visible","$listCommentsWrap","ListLayout","getStrategy","check","max","imgCheck","maxHeight","lock","_check","Utils.getHeight","parseFloat","getComputedStyle","contains","HEIGHT_LIMIT_SCROLL_CSS","applyScrollableHeightLimit","HEIGHT_LIMIT_CSS","overflow","$expandBtn","stopPropagation","disposeHeightLimit","afterExpandBtnClick","applyHeightLimit","imgs","querySelectorAll","from","renderNick","$headerNick","$nickA","Utils.isValidURL","renderVerifyBadge","$headerBadgeWrap","badgeText","badge_name","badgeColor","badge_color","$badge","backgroundColor","is_verified","$verifiedBadge","is_pinned","$pinnedBadge","renderDate","$date","getDateFormatted","renderUABadge","ip_region","$uaWrap","$regionBadge","browser","os","getUserUA","$uaBrowser","$usOS","ActionBtn","getText","adminOnly","isMessaging","msgRecTimer","appendTo","dom","setClick","isLoading","confirmRestore","isConfirming","confirmText","confirmRecTimer","fireMsgRecTimer","clearMsgRecTimer","updateText","loadingText","setMsg","setWarn","setSuccess","duringTime","setMsgRecTimer","msgRecTimerFunc","renderVote","voteBtnUp","getActions","voteBtnDown","vote_down","renderReply","replyBtn","renderCollapse","collapseBtn","adminEdit","renderModerator","pendingBtn","is_pending","renderPin","pinnedBtn","renderEdit","editBtn","renderDel","delBtn","adminDelete","Renders","Avatar","$avatar","$avatarImg","avatarURLBuilder","getGravatarURL","$avatarA","Header","Content","collapsedInfoEl","$body","insertAdjacentElement","contentShowBtn","Ui.playFadeInAnim","ReplyAt","replyTo","$replyAt","goToReplyComment","ReplyTo","$replyTo","$nick","replyContent","Pending","pendingEl","Actions","Render","$main","$childrenWrap","contentMaxH","childrenMaxH","HeightLimit.check","getChildren","HeightLimit.disposeHeightLimit","playFadeAnimForBody","playFlashAnim","getChildrenWrap","setUnread","setOpenable","setOpenURL","setOpenAction","CommentActions","actionBtn","votes","up","down","btnElem","modify","setData","onDelete","origHash","modifyHash","dispatchEvent","Event","CommentNode","nestCurt","actionInstance","renderInstance","CommentUI","newEl","onAfterRender","getParent","getNestCurt","getIsRoot","getID","getChildrenWrapEl","$childComment","flattenParents","emailHash","email_encrypted","dateFormatter","Utils.timeAgo","info","win","nav","osVersion","engine","device","engineMatch","Trident","Presto","WebKit","Gecko","browserMatch","Safari","Chrome","IE","Edge","Firefox","Chromium","Opera","Vivaldi","Yandex","Kindle","UC","QQBrowser","QQ","Baidu","Maxthon","Sogou","LBBROWSER","TheWorld","MIUI","Quark","Qiyu","Wechat","Taobao","Alipay","Weibo","Douban","Suning","iQiYi","osMatch","Windows","Linux","macOS","Android","Ubuntu","FreeBSD","Debian","BlackBerry","MeeGo","Symbian","iOS","WebOS","deviceMatch","Mobile","Tablet","showModalDialog","chrome","arr","browserLanguage","UADetect","ua","ReadMoreBtn","origText","$text","hasMore","total","onClick","checkDisabled","showErr","ReadMorePaginator","readMoreAutoLoad","onReachedBottom","getHasMore","getIsClearComments","dispose","Pagination","oninput","onkeydown","keydown","$prevBtn","$nextBtn","maxPage","ceil","setInput","inputTimer","isNaN","change","onChange","which","UpDownPaginator","PaginationComponent","getPageDataByLastData","roots_count","initListPaginatorFunc","paginator","createPaginatorByConf","$paginator","List","initCrudEvents","getCommentsWrapEl","commentNodes","getListLayout","forceFlatMode","d","bodyOrgOverflow","bodyOrgPaddingRight","getScrollbarHelper","paddingRight","unlock","barPaddingRight","parseInt","getPropertyValue","inner","outer","position","visibility","w1","offsetWidth","w2","clientWidth","removeChild","Ui.getScrollBarWidth","Layer","onAfterHide","setAllowMaskClose","allow","allowMaskClose","getAllowMaskClose","onShow","onHide","LayerWrap","$wrap","$mask","createItem","createItemElement","hideWrap","showWrap","getMask","getWrap","LayerManager","wrap","LOCAL_USER_KEY","User","localUser","localStorage","getItem","isAdmin","setItem","onUserChanged","logout","services","i18n","I18n.setLocale","layerManager","editorPlugs","initCountWidget","loadStatCount","containers","loadCommentCount","cacheData","pvAdd","pvCount","pages","page_key","page_title","site_name","pv","incrementPvCount","loadPvCount","els","selector","retrieveElements","pageKeys","pageKeyAttr","getAttribute","getPageKeys","stats","page_keys","defaultPageKey","updateElementsText","LocalStorageKey","SubmitAddPreset","reqAdd","useApi","getSubmitAddParams","useUser","useConf","useEditor","Utils.getCorrectUserAgent","postSubmitAdd","commentNew","Submit","defaultPreset","onEditorSubmit","do","useMounted","useUnmounted","registerCustom","customs","custom","activeCond","nComment","req","post","Emoticons","transEmoticonImageText","loadEmoticonsData","isImgLoaded","initEmoticonsList","changeListHeight","parentElement","isListLoaded","loadingTask","handleData","Ui.setError","pushGrp","grp","remoteLoad","grpData","isOwOFormat","convertOwO","solveNullKey","solveSameKey","tmp","container","owoData","grpName","nGrp","iconStr","icon","$grpWrap","$grp","$item","$grpSwitcher","openGrp","AllowImgExts","Upload","initDragImg","$imgUploadInput","accept","onchange","files","file","uploadImg","uploadFromFileList","onDragover","onDrop","dataTransfer","onPaste","clipboardData","fileExt","insertPrefix","uploadPlaceholderTxt","customUploaderFn","imgUploader","public_url","imgURL","Preview","isPlugPanelShow","updateContent","EDITOR_PLUGS","onContentUpdated","localContent","$inputs","inputEventFns","changeEventFns","field","timer","abortFn","onInput","fetchUserInfo","placeholders","api","CANCEL_TOKEN","abortRequest","onUserInfoFetched","finally","onLinkChange","onLinkInputChange","onKeydown","adaptiveHeightByContent","diff","offsetHeight","scrollHeight","cancelReply","submitPlug","useDeps","page_url","$sendReplyBtn","cancelEdit","saveData","$editCancelBtn","updateSubmitBtnText","restoreSubmitBtnText","originalSubmitBtnText","onOpen","onClose","PlugKit","plug","PlugManager","confLoaded","clear","confRefs","getEnabledPlugs","Plug","loadPluginUI","closePlugPanel","openedPlug","loadPluginItem","openPlugPanel","plugPanel","rawContent","showErrorDialog","errEl","retryFn","$retryBtn","onOpenSidebar","$openSidebar","$err","IgnoreVersionCheck","darkModeMedia","updateClassnames","$els","DarkModeClassName","DefaultPlugins","initMarked","markedReplacers","scanApply","$sidebarEl","getAdminOnlyEls","_params","limit","paramsModifier","listFetchParamsModifier","reqParams","flat_mode","listUnreadHighlight","notify","comment_id","read_link","commentID","Utils.getQueryParam","$closeCommentBtn","admin_only","adminPageEditSave","$count","$openSidebarBtn","syncByUser","$btnText","$unreadBadge","reloadUseParamsEditor","initDropdown","$dropdownOn","$dropdownWrap","dropdownList","curtActive","onItemClick","$dropdown","renderDropdown","sort_by","view_only_admin","removeDropdown","lastID","locker","extractCommentID","hashChangeHandler","listLoadedHandler","reply_comment","isNoComment","$noComment","$copyright","ARTALK_VERSION","setInterval","clearInterval","errData","observer","clearObserver","disconnect","childNodes","$target","scrollEvtAt","IntersectionObserver","isIntersecting","threshold","observe","setupObserver","warn","Utils.getOffset","apiVersion","feVer","beVer","comp","pa","pb","na","nb","Utils.versionCompare","ignoreBtn","darkModeAutoHandler","sync","GlobalPlugins","PluginOptions","WeakMap","load","loadedPlugins","loadPlugins","plugins","sidebarOpenView","err_no_site","viewLoadParam","create_name","create_urls","host","onLoadErr","frontend_conf","ExcludedKeys","startsWith","handleConfFormServer","remoteConfModifier","pluginURLs","scripts","apiBase","networkPlugins","tasks","script","head","onerror","ArtalkPlugins","loadNetworkPlugins","Artalk","handledConf","Services","initService","firstChild","loadCountWidget"],"mappings":"wrBAmoBO,MAAMA,EAcX,WAAAC,CAAYC,EAAyC,IAb5BC,EAAAC,KAAA,UAAA,WACuBD,EAAAC,KAAA,eAAA,MACxCD,EAAAC,KAAA,kBACAD,EAAAC,KAAA,uBAAuBC,KACvBF,EAAAC,KAAA,eAAc,IAAIE,IAA0CC,SAASD,KAEtCH,EAAAC,KAAA,gBAAA,CACrCI,YAAa,cACbC,QAAS,CAAC,EACVC,SAAU,SACVC,eAAgB,gBAOXR,EAAAC,KAAA,mBAAmBQ,IACxBR,KAAKS,aAAeD,CAAA,IAkCgDT,EAAAC,KAAA,oBAAA,CACpE,mBAAqBU,GACT,OAAVA,GAAoC,iBAAVA,GAAuC,iBAAVA,EAEnDA,EADAC,KAAKC,UAAUF,GAErB,aAAqBA,GACT,OAAVA,GAAmC,iBAAVA,EAAqBC,KAAKC,UAAUF,GAASA,EACxE,sBAAyBA,GACvBG,OAAOC,KAAKJ,GAAS,CAAA,GAAIK,QAAO,CAACC,EAAUC,KACnC,MAAAC,EAAWR,EAAMO,GAShB,OARED,EAAAG,OACPF,EACAC,aAAoBE,KAChBF,EACoB,iBAAbA,GAAsC,OAAbA,EAC9BP,KAAKC,UAAUM,GACf,GAAGA,KAEJF,CAAA,GACN,IAAIK,UACT,oCAA2BX,GAAeV,KAAKsB,cAAcZ,KAgBrDX,EAAAC,KAAA,qBAAqBuB,IAC7B,GAAIvB,KAAKwB,iBAAiBC,IAAIF,GAAc,CAC1C,MAAMG,EAAkB1B,KAAKwB,iBAAiBG,IAAIJ,GAClD,OAAIG,EACKA,EAAgBE,YAElB,CACT,CAEM,MAAAF,EAAkB,IAAIG,gBAE5B,OADK7B,KAAAwB,iBAAiBM,IAAIP,EAAaG,GAChCA,EAAgBE,MAAA,IAGlB7B,EAAAC,KAAA,gBAAgBuB,IACrB,MAAMG,EAAkB1B,KAAKwB,iBAAiBG,IAAIJ,GAE9CG,IACFA,EAAgBK,QACX/B,KAAAwB,iBAAiBQ,OAAOT,GAC/B,IAGKxB,EAAAC,KAAA,WAAmCiC,GAUYC,EAAAlC,KAAA,MAAA,YATpD,IAAAmC,EAAAF,GAAAG,KAAAA,EAAAC,OACAA,EAAAC,KACAA,EAAAC,KACAA,EAAAC,MACAA,EAAAC,OACAA,EAAAC,QACAA,EAAAnB,YACAA,GARwCY,EASrCQ,+JAAAC,CATqCT,EASrC,CARH,OACA,SACA,OACA,OACA,QACA,SACA,UACA,gBAGA,MAAMU,GACgB,kBAAXR,EAAuBA,EAASrC,KAAK8C,cAAcT,SAC1DrC,KAAK+C,uBACE/C,KAAK+C,eAAe/C,KAAKS,gBAClC,GACIuC,EAAgBhD,KAAKiD,mBAAmBN,EAAQE,GAChDK,EAAcV,GAASxC,KAAKsB,cAAckB,GAC1CW,EAAmBnD,KAAKoD,kBAAkBb,GAAQ,oBAClDc,EAAiBZ,GAAUO,EAAcP,OAE/C,OAAOzC,KAAKsD,YACV,GAAGZ,GAAW1C,KAAK0C,SAAW,KAAKJ,IAAOY,EAAc,IAAIA,IAAgB,KAC5EK,OACKP,GADL,CAEE3C,QAASmD,EAAAA,EAAA,CAAA,EACHR,EAAc3C,SAAW,CAAC,GAC1BkC,GAAiB,wBAATA,EAAgC,CAAE,eAAgBA,GAAS,CAAC,GAE1EX,QAASL,EAAcvB,KAAKyD,kBAAkBlC,GAAeyB,EAAcpB,SAAW,KACtFQ,KAAM,MAAOA,EAAwC,KAAOe,EAAiBf,MAE/EsB,MAAYC,GAAazB,EAAAlC,KAAA,MAAA,YACnB,MAAA4D,EAAID,EAASE,QACnBD,EAAEpD,KAAO,KACToD,EAAEE,MAAQ,KAEJ,MAAAtD,EAAQ6C,QAEJM,EAASN,KACZK,MAAMlD,IACDoD,EAAEG,GACJH,EAAEpD,KAAOA,EAEToD,EAAEE,MAAQtD,EAELoD,KAERI,OAAOC,IACNL,EAAEE,MAAQG,EACHL,KAZXA,EAmBA,GAJArC,GACGvB,KAAAwB,iBAAiBQ,OAAOT,IAG1BoC,EAASI,GAAU,MAAAvD,EACjB,OAAAA,CAAA,KACR,MA5JMK,OAAAqD,OAAOlE,KAAMF,EACtB,CAMU,gBAAAqE,CAAiBlD,EAAamD,GAE/B,MAAA,GADYC,mBAAmBpD,MACdoD,mBAAoC,iBAAVD,EAAqBA,EAAQ,GAAGA,MACpF,CAEU,aAAAE,CAAc9B,EAAwBvB,GAC9C,OAAOjB,KAAKmE,iBAAiBlD,EAAKuB,EAAMvB,GAC1C,CAEU,kBAAAsD,CAAmB/B,EAAwBvB,GAE5C,OADOuB,EAAMvB,GACPuD,KAAKC,GAAWzE,KAAKmE,iBAAiBlD,EAAKwD,KAAIC,KAAK,IACnE,CAEU,aAAApD,CAAcqD,GAChB,MAAAnC,EAAQmC,GAAY,GAE1B,OADa9D,OAAOC,KAAK0B,GAAOoC,QAAQ3D,QAAQ,IAAuBuB,EAAMvB,KAE1EuD,KAAKvD,GACJ4D,MAAMC,QAAQtC,EAAMvB,IAChBjB,KAAKuE,mBAAmB/B,EAAOvB,GAC/BjB,KAAKsE,cAAc9B,EAAOvB,KAE/ByD,KAAK,IACV,CAEU,cAAAK,CAAeJ,GACjB,MAAAzB,EAAclD,KAAKsB,cAAcqD,GAChC,OAAAzB,EAAc,IAAIA,IAAgB,EAC3C,CAyBU,kBAAAD,CAAmB+B,EAAwBC,GAC5C,OAAA1B,WACFvD,KAAK8C,eACLkC,GACCC,GAAW,CAAC,GAHX,CAIL5E,QAASmD,EAAAA,EAAAA,EAAA,CAAA,EACHxD,KAAK8C,cAAczC,SAAW,CAAC,GAC/B2E,EAAQ3E,SAAW,CAAC,GACnB4E,GAAWA,EAAQ5E,SAAY,CAAC,IAG3C;;;;;;;;;WAiGK,cAAoDT,EAApD,WAAAC,GAAAqF,SAAAC,WACEpF,EAAAC,KAAA,OAAA,CAkBLoF,aAAc,CAAC5E,EAAoCmC,EAAwB,CAAA,IACzE3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,oBACNgD,OAAQ,OACRlD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,IAoBP4C,gBAAiB,CAAC/E,EAAuCmC,EAAwB,CAAA,IAC/E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,uBACNgD,OAAQ,OACRlD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,IAuBP6C,gBAAiB,CAAChF,EAAmCmC,EAAwB,CAAA,IAC3E3C,KAAKqF,QAOH7B,EAAA,CACAlB,KAAM,mBACNgD,OAAQ,OACRlD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,IAqBP8C,eAAgB,CAAC9C,EAAwB,KACvC3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,cACNgD,OAAQ,MACRjD,QAAQ,EACRI,OAAQ,QACLE,IAqBP+C,eAAgB,CAAClF,EAAwCmC,EAAwB,CAAA,IAC/E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,cACNgD,OAAQ,OACRlD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAsBN2F,WAAY,CAAChD,EAAwB,KACnC3C,KAAKqF,QAOH7B,EAAA,CACAlB,KAAM,eACNgD,OAAQ,OACRjD,QAAQ,EACRI,OAAQ,QACLE,IAwBPiD,YAAa,CAACjD,EAAwB,KACpC3C,KAAKqF,QAOH7B,EAAA,CACAlB,KAAM,iBACNgD,OAAQ,OACRjD,QAAQ,EACRI,OAAQ,QACLE,MAGC5C,EAAAC,KAAA,UAAA,CAcR6F,WAAY,CAAClD,EAAwB,KACnC3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,WACNgD,OAAQ,MACR7C,OAAQ,QACLE,IAYPmD,iBAAkB,CAACnD,EAAwB,KACzC3C,KAAKqF,QAA2C7B,EAAA,CAC9ClB,KAAM,kBACNgD,OAAQ,MACR7C,OAAQ,QACLE,IAgBPoD,cAAe,CAACvF,EAAkCmC,EAAwB,CAAA,IACxE3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,kBACNgD,OAAQ,OACRlD,KAAM5B,EACN+B,KAAM,mBACNE,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAeTgG,YAAa,CACXxD,EA0BAG,EAAwB,CAAA,IAExB3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,YACNgD,OAAQ,MACR9C,QACAH,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAqBPsD,cAAe,CAACC,EAAqCvD,EAAwB,CAAA,IAC3E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,YACNgD,OAAQ,OACRlD,KAAM8D,EACN7D,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAoBPwD,WAAY,CAACC,EAAYzD,EAAwB,CAAA,IAC/C3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,aAAa8D,IACnBd,OAAQ,MACR/C,KAAM,mBACNE,OAAQ,QACLE,IA6BP0D,cAAe,CAACD,EAAYF,EAAqCvD,EAAwB,CAAC,IACxF3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,aAAa8D,IACnBd,OAAQ,MACRlD,KAAM8D,EACN7D,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBP2D,cAAe,CAACF,EAAYzD,EAAwB,CAAA,IAClD3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,aAAa8D,IACnBd,OAAQ,SACRjD,QAAQ,EACRI,OAAQ,QACLE,MAGF5C,EAAAC,KAAA,OAAA,CAULuG,KAAM,CAAC5D,EAAwB,KAC7B3C,KAAKqF,QAA6B7B,EAAA,CAChClB,KAAM,QACNgD,OAAQ,MACR7C,OAAQ,QACLE,IAgBP6D,wBAAyB,CAAC7D,EAAwB,KAChD3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,uBACNgD,OAAQ,MACR7C,OAAQ,QACLE,IAYP8D,UAAW,CACTjE,EAIAG,EAAwB,CAAA,IAExB3C,KAAKqF,QAAwC7B,EAAA,CAC3ClB,KAAM,eACNgD,OAAQ,MACR9C,QACAC,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAkBT0G,YAAa,CACXlE,EAMAG,EAAwB,CAAA,IAExB3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,YACNgD,OAAQ,MACR9C,QACAD,KAAM,mBACNE,OAAQ,QACLE,IAoBPgE,kBAAmB,CAACC,EAAqCjE,EAAwB,CAAA,IAC/E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,iBACNgD,OAAQ,OACRlD,KAAMwE,EACNrE,KAAM,mBACNE,OAAQ,QACLE,IAwBPkE,eAAgB,CAACC,EAAmBC,EAAmBpE,EAAwB,CAAC,IAC9E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,aAAawE,KAAaC,IAChCzB,OAAQ,OACR7C,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAeNgH,SAAU,CACRxE,EAUAG,EAAwB,CAAA,IAExB3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,SACNgD,OAAQ,MACR9C,QACAH,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAqBPsE,cAAe,CAACL,EAAoCjE,EAAwB,CAAA,IAC1E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,eACNgD,OAAQ,OACRlD,KAAMwE,EACNvE,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAaPuE,mBAAoB,CAACvE,EAAwB,KAC3C3C,KAAKqF,QAA6C7B,EAAA,CAChDlB,KAAM,sBACNgD,OAAQ,MACRjD,QAAQ,EACRI,OAAQ,QACLE,IAYPwE,MAAO,CAACC,EAA2BzE,EAAwB,CAAA,IACzD3C,KAAKqF,QAAoC7B,EAAA,CACvClB,KAAM,YACNgD,OAAQ,OACRlD,KAAMgF,EACN7E,KAAM,mBACNE,OAAQ,QACLE,IA6BP0E,WAAY,CAACjB,EAAYgB,EAA+BzE,EAAwB,CAAC,IAC/E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAU8D,IAChBd,OAAQ,MACRlD,KAAMgF,EACN/E,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBP2E,WAAY,CAAClB,EAAYzD,EAAwB,CAAA,IAC/C3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAU8D,IAChBd,OAAQ,SACRjD,QAAQ,EACRI,OAAQ,QACLE,IAqBP4E,UAAW,CAACnB,EAAYzD,EAAwB,CAAA,IAC9C3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAU8D,UAChBd,OAAQ,OACRjD,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGG5C,EAAAC,KAAA,YAAA,CAgBVwH,UAAW,CAACC,EAA+B9E,EAAwB,CAAA,IACjE3C,KAAKqF,QAMH7B,EAAA,CACAlB,KAAM,cACNgD,OAAQ,OACRlD,KAAMqF,EACNpF,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAmBT0H,YAAa,CAAC/E,EAAwB,KACpC3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,YACNgD,OAAQ,MACRjD,QAAQ,EACRI,OAAQ,QACLE,IAqBPgF,cAAe,CAACC,EAAqCjF,EAAwB,CAAA,IAC3E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,YACNgD,OAAQ,MACRlD,KAAMwF,EACNvF,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAaPkF,oBAAqB,CAACC,EAAgBnF,EAAwB,CAAA,IAC5D3C,KAAKqF,QAA6C7B,EAAA,CAChDlB,KAAM,sBAAsBwF,IAC5BxC,OAAQ,MACRjD,QAAQ,EACRI,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAWN+H,SAAU,CAACpF,EAAwB,KACjC3C,KAAKqF,QAAsC7B,EAAA,CACzClB,KAAM,SACNgD,OAAQ,MACRjD,QAAQ,EACRI,OAAQ,QACLE,IAyBPqF,WAAY,CAACC,EAA+BtF,EAAwB,CAAA,IAClE3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,SACNgD,OAAQ,OACRlD,KAAM6F,EACN5F,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAaPuF,WAAY,CAAC9B,EAAY6B,EAA+BtF,EAAwB,CAAC,IAC/E3C,KAAKqF,QAAwC7B,EAAA,CAC3ClB,KAAM,UAAU8D,IAChBd,OAAQ,MACRlD,KAAM6F,EACN5F,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBPwF,WAAY,CAAC/B,EAAYzD,EAAwB,CAAA,IAC/C3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAU8D,IAChBd,OAAQ,SACRjD,QAAQ,EACRI,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CA0BNoI,SAAU,CACR7F,EAWAC,EAQAG,EAAwB,CAAC,IAEzB3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAUC,IAChB+C,OAAQ,MACR9C,QACAD,KAAM,mBACNE,OAAQ,QACLE,MAGE5C,EAAAC,KAAA,WAAA,CAeTqI,cAAe,CAAC1F,EAAwB,KACtC3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,mBACNgD,OAAQ,MACRjD,QAAQ,EACRI,OAAQ,QACLE,IAaP2F,cAAe,CAAC9H,EAAmCmC,EAAwB,CAAA,IACzE3C,KAAKqF,QAAqB7B,EAAA,CACxBlB,KAAM,mBACNgD,OAAQ,OACRlD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,oBACHI,IAoBP4F,cAAe,CACb/H,EAOAmC,EAAwB,CAAA,IAExB3C,KAAKqF,QAOH7B,EAAA,CACAlB,KAAM,mBACNgD,OAAQ,OACRlD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,sBACNE,OAAQ,QACLE,MAGA5C,EAAAC,KAAA,SAAA,CAuBPwI,OAAQ,CACNhI,EAOAmC,EAAwB,CAAA,IAExB3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UACNgD,OAAQ,OACRlD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,sBACNE,OAAQ,QACLE,MAGF5C,EAAAC,KAAA,OAAA,CAeLyI,QAAS,CACPjG,EAMAG,EAAwB,CAAA,IAExB3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,QACNgD,OAAQ,MACR9C,QACAH,QAAQ,EACRI,OAAQ,QACLE,IAqBP+F,cAAe,CAAClI,EAAoCmC,EAAwB,CAAA,IAC1E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,QACNgD,OAAQ,OACRlD,KAAM5B,EACN6B,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IA4BPgG,MAAO,CAACC,EAA8BjG,EAAwB,CAAA,IAC5D3C,KAAKqF,QAWH7B,EAAA,CACAlB,KAAM,qBACNgD,OAAQ,OACRlD,KAAMwG,EACNrG,KAAM,mBACNE,OAAQ,QACLE,IAaPkG,cAAe,CACbrG,EAMAG,EAAwB,CAAA,IAExB3C,KAAKqF,QAAwC7B,EAAA,CAC3ClB,KAAM,eACNgD,OAAQ,MACR9C,QACAH,QAAQ,EACRI,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAuBN8I,WAAY,CAACF,EAA+BjG,EAAwB,CAAA,IAClE3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,SACNgD,OAAQ,OACRlD,KAAMwG,EACNvG,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IA6BPoG,WAAY,CAAC3C,EAAYwC,EAA+BjG,EAAwB,CAAC,IAC/E3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAU8D,IAChBd,OAAQ,MACRlD,KAAMwG,EACNvG,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,IAyBPqG,WAAY,CAAC5C,EAAYzD,EAAwB,CAAA,IAC/C3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAU8D,IAChBd,OAAQ,SACRjD,QAAQ,EACRI,OAAQ,QACLE,IAiBPsG,SAAU,CACR1G,EACAC,EAQAG,EAAwB,CAAC,IAEzB3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAUC,IAChB+C,OAAQ,MACR9C,QACAH,QAAQ,EACRE,KAAM,mBACNE,OAAQ,QACLE,MAGC5C,EAAAC,KAAA,UAAA,CAURkJ,WAAY,CAACvG,EAAwB,KACnC3C,KAAKqF,QAAmC7B,EAAA,CACtClB,KAAM,WACNgD,OAAQ,MACR7C,OAAQ,QACLE,MAGD5C,EAAAC,KAAA,QAAA,CAeNmJ,UAAW,CAACxG,EAAwB,KAClC3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,cACNgD,OAAQ,OACRjD,QAAQ,EACRI,OAAQ,QACLE,IAwBPyG,KAAM,CACJ7G,EACA8G,EACAD,EACAzG,EAAwB,CAExB,IAAA3C,KAAKqF,QAKH7B,EAAA,CACAlB,KAAM,UAAUC,KAAQ8G,IACxB/D,OAAQ,OACRlD,KAAMgH,EACN7G,KAAM,mBACNE,OAAQ,QACLE,KACJ,GC1gFA,MAAM2G,EAAQ,CACnBC,EACA7I,EACA8I,IACGtH,EAAAlC,KAAA,MAAA,YACH,MAAMyJ,EAAWF,EAAKG,aAAeH,EAAKG,cAEpCrJ,EAAU,IAAIsJ,QAAQnG,EAAA,CAC1BoG,cAAeH,EAAW,UAAUA,IAAa,IAC9C,MAAAD,OAAAA,EAAAA,EAAMnJ,UAGNA,EAAQsB,IAAI,kBAAkBtB,EAAQ2B,OAAO,iBAG5C,MAAA6H,QAAa1J,MAAMO,EAAO6C,OAC3BiG,GAD2B,CAE9BnJ,aAGE,IAACwJ,EAAK9F,GAAI,CAEZ,MAAM+F,SAAmBD,EAAKC,OAAO9F,OAAM,WAAc,CAAA,EAEzD,IAAI+F,GAAQ,EAUZ,GATKR,EAAAS,iBACIT,EAAKS,SAASrI,MAAMZ,QAAO,CAAOkJ,EAASC,IAAShI,EAAAlC,KAAA,MAAA,kBACnDiK,GACoB,IAAtBH,EAAKI,EAAKC,gBACND,EAAKE,QAAQN,GACXC,GAAA,EACV,KACCM,QAAQC,YAETP,EAAO,OAAOT,EAAMC,EAAM7I,EAAO8I,GAC/B,MAYD,SAAYe,EAAc/J,GAC3B,MAAAgK,EAAM,IAAIC,EAKT,OAJPD,EAAIE,QAAUlK,EAAKmK,KAAOnK,EAAKkK,SAAW,cAC1CF,EAAID,KAAOA,EACXC,EAAIhK,KAAOA,EACXoK,QAAQ9G,MAAM0G,GACPA,CACT,CAnBUK,CAAYhB,EAAKiB,OAAQhB,EACjC,CAEO,OAAAD,CACT,IAEO,MAAMY,UAAuBM,MAA7B,WAAAlL,GAAAqF,SAAAC,WACUpF,EAAAC,KAAA,OAAA,GACGD,EAAAC,KAAA,UAAA,eAClBD,EAAAC,KAAA,OAAA,ECxCK,MAAMgL,UAAYC,EAGvB,WAAApL,CAAY0J,GACJrE,MAAA,CACJxC,QAAS6G,EAAK2B,QACd5H,YAAa,CAAC5C,EAAO8I,IAASF,EAAMC,EAAM7I,EAAO8I,KAL7CzJ,EAAAC,KAAA,SAQNA,KAAKmL,MAAQ5B,CACf,CAOA,aAAA6B,GACQ,MAAAxC,EAAO5I,KAAKmL,MAAME,SACxB,IAAW,MAANzC,OAAM,EAAAA,EAAA0C,QAAS,MAAA1C,OAAA,EAAAA,EAAMnB,OAC1B,MAAO,CAAE6D,KAAM1C,EAAK0C,KAAM7D,MAAOmB,EAAKnB,MACxC,ECdF,SAAS8D,IACE,MAAA,CACHC,OAAO,EACPC,QAAQ,EACRC,WAAY,KACZC,KAAK,EACLC,MAAO,KACPC,UAAU,EACVC,SAAU,KACVC,QAAQ,EACRC,UAAW,KACXC,WAAY,KAEpB,CACA,IAAIC,EAbO,CACHV,OAAO,EACPC,QAAQ,EACRC,WAAY,KACZC,KAAK,EACLC,MAAO,KACPC,UAAU,EACVC,SAAU,KACVC,QAAQ,EACRC,UAAW,KACXC,WAAY,MAIpB,SAASE,EAAeC,GACRF,EAAAE,CAChB,CAKA,MAAMC,EAAa,UACbC,EAAgB,IAAIC,OAAOF,EAAWG,OAAQ,KAC9CC,EAAqB,oDACrBC,EAAwB,IAAIH,OAAOE,EAAmBD,OAAQ,KAC9DG,EAAqB,CACvB,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,SAEHC,EAAwBC,GAAOF,EAAmBE,GAC/C,SAAAC,EAASC,EAAMC,GACpB,GAAIA,GACI,GAAAX,EAAWY,KAAKF,GACTA,OAAAA,EAAKG,QAAQZ,EAAeM,QAInC,GAAAH,EAAmBQ,KAAKF,GACjBA,OAAAA,EAAKG,QAAQR,EAAuBE,GAG5CG,OAAAA,CACX,CACA,MAAMI,EAAQ,eACL,SAAAC,EAAKC,EAAOC,GACjB,IAAId,EAA0B,iBAAVa,EAAqBA,EAAQA,EAAMb,OACvDc,EAAMA,GAAO,GACb,MAAMC,EAAM,CACRL,QAAS,CAAC5B,EAAMkC,KACZ,IAAIC,EAA2B,iBAARD,EAAmBA,EAAMA,EAAIhB,OAG7C,OAFKiB,EAAAA,EAAUP,QAAQC,EAAO,MAC5BX,EAAAA,EAAOU,QAAQ5B,EAAMmC,GACvBF,CAAA,EAEXG,SAAU,IACC,IAAInB,OAAOC,EAAQc,IAG3B,OAAAC,CACX,CACA,SAASI,EAASC,GACV,IACAA,EAAOC,UAAUD,GAAMV,QAAQ,OAAQ,IAC1C,CACK,MAAAjJ,GACK,OAAA,IACV,CACM,OAAA2J,CACX,CACA,MAAME,EAAW,CAAEC,KAAM,IAAM,MACtB,SAAAC,EAAWC,EAAUC,GAG1B,MAcIC,EAdQF,EAASf,QAAQ,OAAO,CAACkB,EAAOC,EAAQC,KAChD,IAAIC,GAAU,EACVC,EAAOH,EACX,OAASG,GAAQ,GAAmB,OAAdF,EAAIE,IACtBD,GAAWA,EACf,OAAIA,EAGO,IAIA,IACV,IACWE,MAAM,OACtB,IAAIC,EAAI,EAQR,GANKP,EAAM,GAAGQ,QACVR,EAAMS,QAENT,EAAMU,OAAS,IAAMV,EAAMA,EAAMU,OAAS,GAAGF,QAC7CR,EAAMW,MAENZ,EACI,GAAAC,EAAMU,OAASX,EACfC,EAAMY,OAAOb,QAGb,KAAOC,EAAMU,OAASX,GAClBC,EAAMa,KAAK,IAGhB,KAAAN,EAAIP,EAAMU,OAAQH,IAEfP,EAAAO,GAAKP,EAAMO,GAAGC,OAAOzB,QAAQ,QAAS,KAEzC,OAAAiB,CACX,CASS,SAAAc,EAAMX,EAAKY,EAAGC,GACnB,MAAMC,EAAId,EAAIO,OACd,GAAU,IAANO,EACO,MAAA,GAGX,IAAIC,EAAU,EAEd,KAAOA,EAAUD,GAAG,CAChB,MAAME,EAAWhB,EAAIiB,OAAOH,EAAIC,EAAU,GACtC,GAAAC,IAAaJ,GAAMC,EAEtB,IACQG,IAAaJ,IAAKC,EAIvB,MAHAE,GAIH,MAPGA,GAQP,CACD,OAAOf,EAAIkB,MAAM,EAAGJ,EAAIC,EAC5B,CAuBA,SAASI,EAAWC,EAAKC,EAAMC,EAAKC,GAChC,MAAMjC,EAAO+B,EAAK/B,KACZkC,EAAQH,EAAKG,MAAQhD,EAAS6C,EAAKG,OAAS,KAC5CC,EAAOL,EAAI,GAAGxC,QAAQ,cAAe,MAC3C,GAAyB,MAArBwC,EAAI,GAAGH,OAAO,GAAY,CAC1BM,EAAMG,MAAMC,QAAS,EACrB,MAAMC,EAAQ,CACV3N,KAAM,OACNqN,MACAhC,OACAkC,QACAC,OACAI,OAAQN,EAAMO,aAAaL,IAGxB,OADPF,EAAMG,MAAMC,QAAS,EACdC,CACV,CACM,MAAA,CACH3N,KAAM,QACNqN,MACAhC,OACAkC,QACAC,KAAMjD,EAASiD,GAEvB,CAyBA,MAAMM,EAIF,WAAAxQ,CAAY+G,GAHZ7G,EAAAC,KAAA,WACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,SAEIA,KAAK4G,QAAUA,GAAWsF,CAC7B,CACD,KAAAoE,CAAMC,GACF,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMC,QAAQ3C,KAAKwC,GAC1C,GAAIb,GAAOA,EAAI,GAAGb,OAAS,EAChB,MAAA,CACHtM,KAAM,QACNqN,IAAKF,EAAI,GAGpB,CACD,IAAAnF,CAAKgG,GACD,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMlG,KAAKwD,KAAKwC,GACvC,GAAIb,EAAK,CACL,MAAMK,EAAOL,EAAI,GAAGxC,QAAQ,yBAA0B,IAC/C,MAAA,CACH3K,KAAM,OACNqN,IAAKF,EAAI,GACTiB,eAAgB,WAChBZ,KAAO/P,KAAK4G,QAAQiF,SAEdkE,EADAd,EAAMc,EAAM,MAGzB,CACJ,CACD,MAAAa,CAAOL,GACH,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMG,OAAO7C,KAAKwC,GACzC,GAAIb,EAAK,CACC,MAAAE,EAAMF,EAAI,GACVK,EA1DT,SAAuBH,EAAKG,GAC3B,MAAAc,EAAoBjB,EAAIxB,MAAM,iBACpC,GAA0B,OAAtByC,EACO,OAAAd,EAEL,MAAAe,EAAeD,EAAkB,GACvC,OAAOd,EACFtB,MAAM,MACNjK,KAAYuM,IACP,MAAAC,EAAoBD,EAAK3C,MAAM,QACrC,GAA0B,OAAtB4C,EACO,OAAAD,EAEL,MAACE,GAAgBD,EACnB,OAAAC,EAAapC,QAAUiC,EAAajC,OAC7BkC,EAAKvB,MAAMsB,EAAajC,QAE5BkC,CAAA,IAENrM,KAAK,KACd,CAsCyBwM,CAAuBtB,EAAKF,EAAI,IAAM,IAC5C,MAAA,CACHnN,KAAM,OACNqN,MACAuB,KAAMzB,EAAI,GAAKA,EAAI,GAAGf,OAAOzB,QAAQlN,KAAKwQ,MAAMY,OAAOC,eAAgB,MAAQ3B,EAAI,GACnFK,OAEP,CACJ,CACD,OAAAuB,CAAQf,GACJ,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMa,QAAQvD,KAAKwC,GAC1C,GAAIb,EAAK,CACL,IAAIK,EAAOL,EAAI,GAAGf,OAEd,GAAA,KAAK1B,KAAK8C,GAAO,CACX,MAAAwB,EAAUtC,EAAMc,EAAM,KACxB/P,KAAK4G,QAAQiF,SACbkE,EAAOwB,EAAQ5C,OAET4C,IAAW,KAAKtE,KAAKsE,KAE3BxB,EAAOwB,EAAQ5C,OAEtB,CACM,MAAA,CACHpM,KAAM,UACNqN,IAAKF,EAAI,GACT8B,MAAO9B,EAAI,GAAGb,OACdkB,OACAI,OAAQnQ,KAAK6P,MAAMuB,OAAOrB,GAEjC,CACJ,CACD,EAAA0B,CAAGlB,GACC,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMgB,GAAG1D,KAAKwC,GACrC,GAAIb,EACO,MAAA,CACHnN,KAAM,KACNqN,IAAKX,EAAMS,EAAI,GAAI,MAG9B,CACD,UAAAgC,CAAWnB,GACP,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMiB,WAAW3D,KAAKwC,GAC7C,GAAIb,EAAK,CACD,IAAAiC,EAAQ1C,EAAMS,EAAI,GAAI,MAAMjB,MAAM,MAClCmB,EAAM,GACNG,EAAO,GACX,MAAMI,EAAS,GACR,KAAAwB,EAAM9C,OAAS,GAAG,CACrB,IAAI+C,GAAe,EACnB,MAAMC,EAAe,GACjB,IAAAnD,EACJ,IAAKA,EAAI,EAAGA,EAAIiD,EAAM9C,OAAQH,IAE1B,GAAI,WAAWzB,KAAK0E,EAAMjD,IACTmD,EAAA7C,KAAK2C,EAAMjD,IACTkD,GAAA,MAClB,IACSA,EAIN,MAHaC,EAAA7C,KAAK2C,EAAMjD,GAI3B,CAEGiD,EAAAA,EAAMnC,MAAMd,GACd,MAAAoD,EAAaD,EAAanN,KAAK,MAC/BqN,EAAcD,EAEf5E,QAAQ,iCAAkC,YAC1CA,QAAQ,mBAAoB,IAC3B0C,EAAAA,EAAM,GAAGA,MAAQkC,IAAeA,EAC/B/B,EAAAA,EAAO,GAAGA,MAASgC,IAAgBA,EAGpC,MAAAC,EAAMhS,KAAK6P,MAAMG,MAAMgC,IAKzB,GAJChS,KAAA6P,MAAMG,MAAMgC,KAAM,EACvBhS,KAAK6P,MAAMoC,YAAYF,EAAa5B,GAAQ,GACvCnQ,KAAA6P,MAAMG,MAAMgC,IAAMA,EAEF,IAAjBL,EAAM9C,OACN,MAEJ,MAAMqD,EAAY/B,EAAOA,EAAOtB,OAAS,GACrC,GAAoB,UAApB,MAAAqD,OAAA,EAAAA,EAAW3P,MAEX,MACH,GAC4B,gBAAT,MAAX2P,OAAW,EAAAA,EAAA3P,MAAuB,CAEvC,MAAM4P,EAAWD,EACXE,EAAUD,EAASvC,IAAM,KAAO+B,EAAMjN,KAAK,MAC3C2N,EAAWrS,KAAK0R,WAAWU,GAC1BjC,EAAAA,EAAOtB,OAAS,GAAKwD,EACtBzC,EAAAA,EAAI0C,UAAU,EAAG1C,EAAIf,OAASsD,EAASvC,IAAIf,QAAUwD,EAASzC,IAC7DG,EAAAA,EAAKuC,UAAU,EAAGvC,EAAKlB,OAASsD,EAASpC,KAAKlB,QAAUwD,EAAStC,KACxE,KACH,CAAA,GAC4B,UAAT,MAAXmC,OAAW,EAAAA,EAAA3P,WADnB,CAGG,MAAM4P,EAAWD,EACXE,EAAUD,EAASvC,IAAM,KAAO+B,EAAMjN,KAAK,MAC3C2N,EAAWrS,KAAKuS,KAAKH,GACpBjC,EAAAA,EAAOtB,OAAS,GAAKwD,EACtBzC,EAAAA,EAAI0C,UAAU,EAAG1C,EAAIf,OAASqD,EAAUtC,IAAIf,QAAUwD,EAASzC,IAC9DG,EAAAA,EAAKuC,UAAU,EAAGvC,EAAKlB,OAASsD,EAASvC,IAAIf,QAAUwD,EAASzC,IAC/D+B,EAAAS,EAAQE,UAAUnC,EAAOA,EAAOtB,OAAS,GAAGe,IAAIf,QAAQJ,MAAM,KAEzE,CACJ,CACM,MAAA,CACHlM,KAAM,aACNqN,MACAO,SACAJ,OAEP,CACJ,CACD,IAAAwC,CAAKhC,GACD,IAAIb,EAAM1P,KAAKwQ,MAAMC,MAAM8B,KAAKxE,KAAKwC,GACrC,GAAIb,EAAK,CACL,IAAI8C,EAAO9C,EAAI,GAAGf,OACZ,MAAA8D,EAAYD,EAAK3D,OAAS,EAC1B0D,EAAO,CACThQ,KAAM,OACNqN,IAAK,GACL8C,QAASD,EACTE,MAAOF,GAAaD,EAAKhD,MAAM,MAAS,GACxCoD,OAAO,EACPC,MAAO,IAEJL,EAAAC,EAAY,aAAaD,EAAKhD,YAAc,KAAKgD,IACpDxS,KAAK4G,QAAQiF,WACb2G,EAAOC,EAAYD,EAAO,SAG9B,MAAMM,EAAY,IAAIvG,OAAO,WAAWiG,kCACxC,IAAIO,GAAoB,EAExB,KAAOxC,GAAK,CACR,IAAIyC,GAAW,EACXpD,EAAM,GACNqD,EAAe,GACnB,KAAMvD,EAAMoD,EAAU/E,KAAKwC,IACvB,MAEJ,GAAIvQ,KAAKwQ,MAAMC,MAAMgB,GAAGxE,KAAKsD,GACzB,MAEJX,EAAMF,EAAI,GACJa,EAAAA,EAAI+B,UAAU1C,EAAIf,QACxB,IAAIqE,EAAOxD,EAAI,GAAGjB,MAAM,KAAM,GAAG,GAAGvB,QAAQ,QAASiG,GAAM,IAAIC,OAAO,EAAID,EAAEtE,UACxEwE,EAAW9C,EAAI9B,MAAM,KAAM,GAAG,GAC9B6E,GAAaJ,EAAKvE,OAClB4E,EAAS,EAmBb,GAlBIvT,KAAK4G,QAAQiF,UACJ0H,EAAA,EACTN,EAAeC,EAAKM,aAEfF,EACIC,EAAA7D,EAAI,GAAGb,OAAS,GAGzB0E,EAAS7D,EAAI,GAAG+D,OAAO,QACdF,EAAAA,EAAS,EAAI,EAAIA,EACXN,EAAAC,EAAK1D,MAAM+D,GAChBA,GAAA7D,EAAI,GAAGb,QAEjByE,GAAa,WAAWrG,KAAKoG,KAC7BzD,GAAOyD,EAAW,KAClB9C,EAAMA,EAAI+B,UAAUe,EAASxE,OAAS,GAC3BmE,GAAA,IAEVA,EAAU,CACL,MAAAU,EAAkB,IAAInH,OAAO,QAAQoH,KAAKC,IAAI,EAAGL,EAAS,yDAC1DM,EAAU,IAAItH,OAAO,QAAQoH,KAAKC,IAAI,EAAGL,EAAS,wDAClDO,EAAmB,IAAIvH,OAAO,QAAQoH,KAAKC,IAAI,EAAGL,EAAS,qBAC3DQ,EAAoB,IAAIxH,OAAO,QAAQoH,KAAKC,IAAI,EAAGL,EAAS,QAC5DS,EAAiB,IAAIzH,OAAO,QAAQoH,KAAKC,IAAI,EAAGL,EAAS,eAAgB,KAE/E,KAAOhD,GAAK,CACR,MAAM0D,EAAU1D,EAAI9B,MAAM,KAAM,GAAG,GAC/B,IAAAyF,EAWA,GAVOb,EAAAY,EAEPjU,KAAK4G,QAAQiF,UACFwH,EAAAA,EAASnG,QAAQ,0BAA2B,MACjCgH,EAAAb,GAGAa,EAAAb,EAASnG,QAAQ,MAAO,QAG9C4G,EAAiB7G,KAAKoG,GACtB,MAGA,GAAAU,EAAkB9G,KAAKoG,GACvB,MAGA,GAAAW,EAAe/G,KAAKoG,GACpB,MAGA,GAAAK,EAAgBzG,KAAKoG,GACrB,MAGA,GAAAQ,EAAQ5G,KAAKoG,GACb,MAEA,GAAAa,EAAoBT,OAAO,SAAWF,IAAWF,EAAS1E,OAC1CsE,GAAA,KAAOiB,EAAoB1E,MAAM+D,OAEhD,CAED,GAAID,EACA,MAGA,GAAAJ,EAAKhG,QAAQ,MAAO,QAAQuG,OAAO,SAAW,EAC9C,MAEA,GAAAK,EAAiB7G,KAAKiG,GACtB,MAEA,GAAAa,EAAkB9G,KAAKiG,GACvB,MAEA,GAAAW,EAAQ5G,KAAKiG,GACb,MAEJD,GAAgB,KAAOI,CAC1B,CACIC,GAAcD,EAAS1E,SACZ2E,GAAA,GAEhB1D,GAAOqE,EAAU,KACjB1D,EAAMA,EAAI+B,UAAU2B,EAAQpF,OAAS,GAC9BqE,EAAAgB,EAAoB1E,MAAM+D,EACpC,CACJ,CACIhB,EAAKK,QAEFG,EACAR,EAAKK,OAAQ,EAER,oBAAoB3F,KAAK2C,KACVmD,GAAA,IAG5B,IACIoB,EADAC,EAAS,KAGTpU,KAAK4G,QAAQ+E,MACJyI,EAAA,cAAcrG,KAAKkF,GACxBmB,IACYD,EAAc,SAAdC,EAAO,GACJnB,EAAAA,EAAa/F,QAAQ,eAAgB,MAG5DqF,EAAKM,MAAM7D,KAAK,CACZzM,KAAM,YACNqN,MACAyE,OAAQD,EACRE,QAASH,EACTvB,OAAO,EACP7C,KAAMkD,EACN9C,OAAQ,KAEZoC,EAAK3C,KAAOA,CACf,CAED2C,EAAKM,MAAMN,EAAKM,MAAMhE,OAAS,GAAGe,IAAM2C,EAAKM,MAAMN,EAAKM,MAAMhE,OAAS,GAAGe,IAAI2E,UAC9EhC,EAAKM,MAAMN,EAAKM,MAAMhE,OAAS,GAAGkB,KAAOwC,EAAKM,MAAMN,EAAKM,MAAMhE,OAAS,GAAGkB,KAAKwE,UAChFhC,EAAK3C,IAAM2C,EAAK3C,IAAI2E,UAEpB,IAAA,IAAS7F,EAAI,EAAGA,EAAI6D,EAAKM,MAAMhE,OAAQH,IAG/B,GAFC1O,KAAA6P,MAAMG,MAAMgC,KAAM,EACvBO,EAAKM,MAAMnE,GAAGyB,OAASnQ,KAAK6P,MAAMoC,YAAYM,EAAKM,MAAMnE,GAAGqB,KAAM,KAC7DwC,EAAKK,MAAO,CAEP,MAAA4B,EAAUjC,EAAKM,MAAMnE,GAAGyB,OAAOvL,QAAOuO,GAAgB,UAAXA,EAAE5Q,OAC7CkS,EAAwBD,EAAQ3F,OAAS,GAAK2F,EAAQE,MAAKvB,GAAK,SAASlG,KAAKkG,EAAEvD,OACtF2C,EAAKK,MAAQ6B,CAChB,CAGL,GAAIlC,EAAKK,MACL,IAAA,IAASlE,EAAI,EAAGA,EAAI6D,EAAKM,MAAMhE,OAAQH,IACnC6D,EAAKM,MAAMnE,GAAGkE,OAAQ,EAGvBL,OAAAA,CACV,CACJ,CACD,IAAAxF,CAAKwD,GACD,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAM1D,KAAKgB,KAAKwC,GACvC,GAAIb,EAAK,CAQE,MAPO,CACVnN,KAAM,OACNkO,OAAO,EACPb,IAAKF,EAAI,GACTiF,IAAgB,QAAXjF,EAAI,IAA2B,WAAXA,EAAI,IAA8B,UAAXA,EAAI,GACpDK,KAAML,EAAI,GAGjB,CACJ,CACD,GAAAkF,CAAIrE,GACA,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMmE,IAAI7G,KAAKwC,GACtC,GAAIb,EAAK,CACCmF,MAAAA,EAAMnF,EAAI,GAAGoF,cAAc5H,QAAQ,OAAQ,KAC3CU,EAAO8B,EAAI,GAAKA,EAAI,GAAGxC,QAAQ,WAAY,MAAMA,QAAQlN,KAAKwQ,MAAMY,OAAOC,eAAgB,MAAQ,GACnGvB,EAAQJ,EAAI,GAAKA,EAAI,GAAG4C,UAAU,EAAG5C,EAAI,GAAGb,OAAS,GAAG3B,QAAQlN,KAAKwQ,MAAMY,OAAOC,eAAgB,MAAQ3B,EAAI,GAC7G,MAAA,CACHnN,KAAM,MACNsS,IAAAA,EACAjF,IAAKF,EAAI,GACT9B,OACAkC,QAEP,CACJ,CACD,KAAAiF,CAAMxE,GACF,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMsE,MAAMhH,KAAKwC,GACxC,IAAKb,EACD,OAEJ,IAAK,OAAOzC,KAAKyC,EAAI,IAEjB,OAEJ,MAAMrP,EAAU2N,EAAW0B,EAAI,IACzBsF,EAAStF,EAAI,GAAGxC,QAAQ,aAAc,IAAIuB,MAAM,KAChDwG,EAAOvF,EAAI,IAAMA,EAAI,GAAGf,OAASe,EAAI,GAAGxC,QAAQ,YAAa,IAAIuB,MAAM,MAAQ,GAC/EvE,EAAO,CACT3H,KAAM,QACNqN,IAAKF,EAAI,GACTwF,OAAQ,GACRC,MAAO,GACPF,KAAM,IAEN,GAAA5U,EAAQwO,SAAWmG,EAAOnG,OAA1B,CAIJ,IAAA,MAAWsG,KAASH,EACZ,YAAY/H,KAAKkI,GACZjL,EAAAiL,MAAMnG,KAAK,SAEX,aAAa/B,KAAKkI,GAClBjL,EAAAiL,MAAMnG,KAAK,UAEX,YAAY/B,KAAKkI,GACjBjL,EAAAiL,MAAMnG,KAAK,QAGX9E,EAAAiL,MAAMnG,KAAK,MAGxB,IAAA,IAASN,EAAI,EAAGA,EAAIrO,EAAQwO,OAAQH,IAChCxE,EAAKgL,OAAOlG,KAAK,CACbe,KAAM1P,EAAQqO,GACdyB,OAAQnQ,KAAK6P,MAAMuB,OAAO/Q,EAAQqO,IAClCwG,QAAQ,EACRC,MAAOjL,EAAKiL,MAAMzG,KAG1B,IAAA,MAAW0G,KAAOH,EACT/K,EAAA+K,KAAKjG,KAAKhB,EAAWoH,EAAKlL,EAAKgL,OAAOrG,QAAQrK,KAAI,CAAC6Q,EAAM3G,KACnD,CACHqB,KAAMsF,EACNlF,OAAQnQ,KAAK6P,MAAMuB,OAAOiE,GAC1BH,QAAQ,EACRC,MAAOjL,EAAKiL,MAAMzG,QAIvB,OAAAxE,CAjCN,CAkCJ,CACD,QAAAoL,CAAS/E,GACL,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAM6E,SAASvH,KAAKwC,GAC3C,GAAIb,EACO,MAAA,CACHnN,KAAM,UACNqN,IAAKF,EAAI,GACT8B,MAA4B,MAArB9B,EAAI,GAAGH,OAAO,GAAa,EAAI,EACtCQ,KAAML,EAAI,GACVS,OAAQnQ,KAAK6P,MAAMuB,OAAO1B,EAAI,IAGzC,CACD,SAAA6F,CAAUhF,GACN,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAM8E,UAAUxH,KAAKwC,GAC5C,GAAIb,EAAK,CACC,MAAAK,EAA4C,OAArCL,EAAI,GAAGH,OAAOG,EAAI,GAAGb,OAAS,GACrCa,EAAI,GAAGF,MAAM,GAAK,GAClBE,EAAI,GACH,MAAA,CACHnN,KAAM,YACNqN,IAAKF,EAAI,GACTK,OACAI,OAAQnQ,KAAK6P,MAAMuB,OAAOrB,GAEjC,CACJ,CACD,IAAAA,CAAKQ,GACD,MAAMb,EAAM1P,KAAKwQ,MAAMC,MAAMV,KAAKhC,KAAKwC,GACvC,GAAIb,EACO,MAAA,CACHnN,KAAM,OACNqN,IAAKF,EAAI,GACTK,KAAML,EAAI,GACVS,OAAQnQ,KAAK6P,MAAMuB,OAAO1B,EAAI,IAGzC,CACD,MAAA8F,CAAOjF,GACH,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAOoE,OAAOzH,KAAKwC,GAC1C,GAAIb,EACO,MAAA,CACHnN,KAAM,SACNqN,IAAKF,EAAI,GACTK,KAAMjD,EAAS4C,EAAI,IAG9B,CACD,GAAAmF,CAAItE,GACA,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAOyD,IAAI9G,KAAKwC,GACvC,GAAIb,EAaO,OAZF1P,KAAK6P,MAAMG,MAAMC,QAAU,QAAQhD,KAAKyC,EAAI,IACxC1P,KAAA6P,MAAMG,MAAMC,QAAS,EAErBjQ,KAAK6P,MAAMG,MAAMC,QAAU,UAAUhD,KAAKyC,EAAI,MAC9C1P,KAAA6P,MAAMG,MAAMC,QAAS,IAEzBjQ,KAAK6P,MAAMG,MAAMyF,YAAc,iCAAiCxI,KAAKyC,EAAI,IACrE1P,KAAA6P,MAAMG,MAAMyF,YAAa,EAEzBzV,KAAK6P,MAAMG,MAAMyF,YAAc,mCAAmCxI,KAAKyC,EAAI,MAC3E1P,KAAA6P,MAAMG,MAAMyF,YAAa,GAE3B,CACHlT,KAAM,OACNqN,IAAKF,EAAI,GACTO,OAAQjQ,KAAK6P,MAAMG,MAAMC,OACzBwF,WAAYzV,KAAK6P,MAAMG,MAAMyF,WAC7BhF,OAAO,EACPV,KAAML,EAAI,GAGrB,CACD,IAAAC,CAAKY,GACD,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAOzB,KAAK5B,KAAKwC,GACxC,GAAIb,EAAK,CACL,MAAMgG,EAAahG,EAAI,GAAGf,OAC1B,IAAK3O,KAAK4G,QAAQiF,UAAY,KAAKoB,KAAKyI,GAAa,CAEjD,IAAM,KAAKzI,KAAKyI,GACZ,OAGJ,MAAMC,EAAa1G,EAAMyG,EAAWlG,MAAM,GAAG,GAAK,MAClD,IAAKkG,EAAW7G,OAAS8G,EAAW9G,QAAU,GAAM,EAChD,MAEP,KACI,CAED,MAAM+G,EAjkBb,SAAmBtH,EAAKuH,GAC7B,IAA8B,IAA1BvH,EAAIwH,QAAQD,EAAE,IACP,OAAA,EAEX,IAAIE,EAAQ,EACZ,IAAA,IAASrH,EAAI,EAAGA,EAAIJ,EAAIO,OAAQH,IACxB,GAAW,OAAXJ,EAAII,GACJA,YAEKJ,EAAII,KAAOmH,EAAE,GAClBE,YAEKzH,EAAII,KAAOmH,EAAE,KAClBE,IACIA,EAAQ,GACD,OAAArH,EAIZ,OAAA,CACX,CA6iBuCsH,CAAmBtG,EAAI,GAAI,MAClD,GAAIkG,GAAqB,EAAA,CACf,MACAK,GADgC,IAAxBvG,EAAI,GAAGoG,QAAQ,KAAa,EAAI,GACtBpG,EAAI,GAAGb,OAAS+G,EACxClG,EAAI,GAAKA,EAAI,GAAG4C,UAAU,EAAGsD,GACzBlG,EAAA,GAAKA,EAAI,GAAG4C,UAAU,EAAG2D,GAAStH,OACtCe,EAAI,GAAK,EACZ,CACJ,CACG,IAAA9B,EAAO8B,EAAI,GACXI,EAAQ,GACR,GAAA9P,KAAK4G,QAAQiF,SAAU,CAEjB8D,MAAAA,EAAO,gCAAgC5B,KAAKH,GAC9C+B,IACA/B,EAAO+B,EAAK,GACZG,EAAQH,EAAK,GAEpB,MAEWG,EAAAJ,EAAI,GAAKA,EAAI,GAAGF,MAAM,GAAG,GAAM,GAY3C,OAVA5B,EAAOA,EAAKe,OACR,KAAK1B,KAAKW,KAGCA,EAFP5N,KAAK4G,QAAQiF,WAAc,KAAKoB,KAAKyI,GAE9B9H,EAAK4B,MAAM,GAGX5B,EAAK4B,MAAM,GAAK,IAGxBC,EAAWC,EAAK,CACnB9B,KAAMA,EAAOA,EAAKV,QAAQlN,KAAKwQ,MAAMY,OAAOC,eAAgB,MAAQzD,EACpEkC,MAAOA,EAAQA,EAAM5C,QAAQlN,KAAKwQ,MAAMY,OAAOC,eAAgB,MAAQvB,GACxEJ,EAAI,GAAI1P,KAAK6P,MACnB,CACJ,CACD,OAAAqG,CAAQ3F,EAAK4F,GACL,IAAAzG,EACJ,IAAKA,EAAM1P,KAAKwQ,MAAMY,OAAO8E,QAAQnI,KAAKwC,MAClCb,EAAM1P,KAAKwQ,MAAMY,OAAOgF,OAAOrI,KAAKwC,IAAO,CACzC,MACAZ,EAAOwG,GADOzG,EAAI,IAAMA,EAAI,IAAIxC,QAAQ,OAAQ,KACxB4H,eAC9B,IAAKnF,EAAM,CACP,MAAMI,EAAOL,EAAI,GAAGH,OAAO,GACpB,MAAA,CACHhN,KAAM,OACNqN,IAAKG,EACLA,OAEP,CACD,OAAON,EAAWC,EAAKC,EAAMD,EAAI,GAAI1P,KAAK6P,MAC7C,CACJ,CACD,QAAAwG,CAAS9F,EAAK+F,EAAWC,EAAW,IAChC,IAAInI,EAAQpO,KAAKwQ,MAAMY,OAAOoF,eAAezI,KAAKwC,GAClD,IAAKnC,EACD,OAEJ,GAAIA,EAAM,IAAMmI,EAASnI,MAAM,iBAC3B,OAEA,KADaA,EAAM,IAAMA,EAAM,IAAM,MACvBmI,GAAYvW,KAAKwQ,MAAMY,OAAOqF,YAAY1I,KAAKwI,GAAW,CAExE,MAAMG,EAAU,IAAItI,EAAM,IAAIS,OAAS,EACvC,IAAI8H,EAAQC,EAASC,EAAaH,EAASI,EAAgB,EAC3D,MAAMC,EAAyB,MAAhB3I,EAAM,GAAG,GAAapO,KAAKwQ,MAAMY,OAAO4F,kBAAoBhX,KAAKwQ,MAAMY,OAAO6F,kBAI7F,IAHAF,EAAOG,UAAY,EAEnBZ,EAAYA,EAAU9G,OAAW,EAAAe,EAAI1B,OAAS6H,GACH,OAAnCtI,EAAQ2I,EAAOhJ,KAAKuI,KAAqB,CAE7C,GADAK,EAASvI,EAAM,IAAMA,EAAM,IAAMA,EAAM,IAAMA,EAAM,IAAMA,EAAM,IAAMA,EAAM,IACtEuI,EACD,SAEJ,GADUC,EAAA,IAAID,GAAQ9H,OAClBT,EAAM,IAAMA,EAAM,GAAI,CACRyI,GAAAD,EACd,QACH,KACQxI,EAAM,IAAMA,EAAM,KACnBsI,EAAU,MAAQA,EAAUE,GAAW,GAAI,CAC1BE,GAAAF,EACjB,QACH,CAGL,GADcC,GAAAD,EACVC,EAAa,EACb,SAEJD,EAAUjD,KAAKC,IAAIgD,EAASA,EAAUC,EAAaC,GAE7C,MAAAK,EAAiB,IAAI/I,EAAM,IAAI,GAAGS,OAClCe,EAAMW,EAAIf,MAAM,EAAGkH,EAAUtI,EAAMgJ,MAAQD,EAAiBP,GAElE,GAAIjD,KAAKC,IAAI8C,EAASE,GAAW,EAAG,CAChC,MAAM7G,EAAOH,EAAIJ,MAAM,GAAK,GACrB,MAAA,CACHjN,KAAM,KACNqN,MACAG,KAAAA,EACAI,OAAQnQ,KAAK6P,MAAMO,aAAaL,GAEvC,CAED,MAAMA,EAAOH,EAAIJ,MAAM,GAAK,GACrB,MAAA,CACHjN,KAAM,SACNqN,MACAG,OACAI,OAAQnQ,KAAK6P,MAAMO,aAAaL,GAEvC,CACJ,CACJ,CACD,QAAAsH,CAAS9G,GACL,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAO7G,KAAKwD,KAAKwC,GACxC,GAAIb,EAAK,CACL,IAAIK,EAAOL,EAAI,GAAGxC,QAAQ,MAAO,KAC3B,MAAAoK,EAAmB,OAAOrK,KAAK8C,GAC/BwH,EAA0B,KAAKtK,KAAK8C,IAAS,KAAK9C,KAAK8C,GAKtD,OAJHuH,GAAoBC,IACpBxH,EAAOA,EAAKuC,UAAU,EAAGvC,EAAKlB,OAAS,IAEpCkB,EAAAjD,EAASiD,GAAM,GACf,CACHxN,KAAM,WACNqN,IAAKF,EAAI,GACTK,OAEP,CACJ,CACD,EAAAyH,CAAGjH,GACC,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAOoG,GAAGzJ,KAAKwC,GACtC,GAAIb,EACO,MAAA,CACHnN,KAAM,KACNqN,IAAKF,EAAI,GAGpB,CACD,GAAA+H,CAAIlH,GACA,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAOqG,IAAI1J,KAAKwC,GACvC,GAAIb,EACO,MAAA,CACHnN,KAAM,MACNqN,IAAKF,EAAI,GACTK,KAAML,EAAI,GACVS,OAAQnQ,KAAK6P,MAAMO,aAAaV,EAAI,IAG/C,CACD,QAAAgI,CAASnH,GACL,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAOsG,SAAS3J,KAAKwC,GAC5C,GAAIb,EAAK,CACL,IAAIK,EAAMnC,EASH,MARQ,MAAX8B,EAAI,IACGK,EAAAjD,EAAS4C,EAAI,IACpB9B,EAAO,UAAYmC,IAGZA,EAAAjD,EAAS4C,EAAI,IACb9B,EAAAmC,GAEJ,CACHxN,KAAM,OACNqN,IAAKF,EAAI,GACTK,OACAnC,OACAuC,OAAQ,CACJ,CACI5N,KAAM,OACNqN,IAAKG,EACLA,SAIf,CACJ,CACD,GAAA4H,CAAIpH,WACI,IAAAb,EACJ,GAAIA,EAAM1P,KAAKwQ,MAAMY,OAAOuG,IAAI5J,KAAKwC,GAAM,CACvC,IAAIR,EAAMnC,EACN,GAAW,MAAX8B,EAAI,GACGK,EAAAjD,EAAS4C,EAAI,IACpB9B,EAAO,UAAYmC,MAElB,CAEG,IAAA6H,EACD,GACCA,EAAclI,EAAI,GAClBA,EAAI,GAAK,OAAAvN,EAAA,OAAKF,EAAAjC,KAAAwQ,MAAMY,OAAOyG,WAAW9J,KAAK2B,EAAI,UAAtC,EAAAzN,EAA4C,IAAME,EAAA,SACtDyV,IAAgBlI,EAAI,IACtBK,EAAAjD,EAAS4C,EAAI,IAET9B,EADI,SAAX8B,EAAI,GACG,UAAYA,EAAI,GAGhBA,EAAI,EAElB,CACM,MAAA,CACHnN,KAAM,OACNqN,IAAKF,EAAI,GACTK,OACAnC,OACAuC,OAAQ,CACJ,CACI5N,KAAM,OACNqN,IAAKG,EACLA,SAIf,CACJ,CACD,UAAA+H,CAAWvH,GACP,MAAMb,EAAM1P,KAAKwQ,MAAMY,OAAOrB,KAAKhC,KAAKwC,GACxC,GAAIb,EAAK,CACD,IAAAK,EAOG,OALHA,EADA/P,KAAK6P,MAAMG,MAAMyF,WACV/F,EAAI,GAGJ5C,EAAS4C,EAAI,IAEjB,CACHnN,KAAM,OACNqN,IAAKF,EAAI,GACTK,OAEP,CACJ,EAML,MAGM0B,EAAK,qEAELsG,EAAS,wBACTzC,EAAWlI,EAAK,sJACjBF,QAAQ,QAAS6K,GACjB7K,QAAQ,aAAc,qBACtBA,QAAQ,UAAW,yBACnBA,QAAQ,cAAe,WACvBA,QAAQ,WAAY,gBACpBA,QAAQ,QAAS,qBACjBQ,WACCsK,EAAa,uFAEbC,EAAc,8BACdrD,EAAMxH,EAAK,+GACZF,QAAQ,QAAS+K,GACjB/K,QAAQ,QAAS,gEACjBQ,WACC6E,EAAOnF,EAAK,wCACbF,QAAQ,QAAS6K,GACjBrK,WACCwK,EAAO,gWAMPC,EAAW,gCACXpL,EAAOK,EAAK,+dASP,KACNF,QAAQ,UAAWiL,GACnBjL,QAAQ,MAAOgL,GACfhL,QAAQ,YAAa,4EACrBQ,WACC6H,EAAYnI,EAAK4K,GAClB9K,QAAQ,KAAMuE,GACdvE,QAAQ,UAAW,yBACnBA,QAAQ,YAAa,IACrBA,QAAQ,SAAU,IAClBA,QAAQ,aAAc,WACtBA,QAAQ,SAAU,kDAClBA,QAAQ,OAAQ,0BAChBA,QAAQ,OAAQ,+DAChBA,QAAQ,MAAOgL,GACfxK,WAOC0K,EAAc,CAChB1G,WAPetE,EAAK,2CACnBF,QAAQ,YAAaqI,GACrB7H,WAMDnD,KA/Dc,wDAgEdqK,MACAhE,OAhEW,8GAiEXU,QA/DY,uCAgEZG,KACA1E,OACAuI,WACA/C,OACA7B,QAxEY,uBAyEZ6E,YACAR,MAAOjH,EACPiC,KA5Dc,WAiEZsI,EAAWjL,EAAK,+JAGjBF,QAAQ,KAAMuE,GACdvE,QAAQ,UAAW,yBACnBA,QAAQ,aAAc,WACtBA,QAAQ,OAAQ,2BAChBA,QAAQ,SAAU,kDAClBA,QAAQ,OAAQ,0BAChBA,QAAQ,OAAQ,+DAChBA,QAAQ,MAAOgL,GACfxK,WACC4K,EAAW/U,OACV6U,GADU,CAEbrD,MAAOsD,EACP9C,UAAWnI,EAAK4K,GACX9K,QAAQ,KAAMuE,GACdvE,QAAQ,UAAW,yBACnBA,QAAQ,YAAa,IACrBA,QAAQ,QAASmL,GACjBnL,QAAQ,aAAc,WACtBA,QAAQ,SAAU,kDAClBA,QAAQ,OAAQ,0BAChBA,QAAQ,OAAQ,+DAChBA,QAAQ,MAAOgL,GACfxK,aAKH6K,EAAgBhV,OACf6U,GADe,CAElBrL,KAAMK,EAAK,8IAGNF,QAAQ,UAAWiL,GACnBjL,QAAQ,OAAQ,qKAIhBQ,WACLkH,IAAK,oEACLtD,QAAS,yBACTV,OAAQ9C,EACRwH,SAAU,mCACVC,UAAWnI,EAAK4K,GACX9K,QAAQ,KAAMuE,GACdvE,QAAQ,UAAW,mBACnBA,QAAQ,WAAYoI,GACpBpI,QAAQ,SAAU,IAClBA,QAAQ,aAAc,WACtBA,QAAQ,UAAW,IACnBA,QAAQ,QAAS,IACjBA,QAAQ,QAAS,IACjBA,QAAQ,OAAQ,IAChBQ,aAKH8H,EAAS,8CAETgC,EAAK,wBAGLgB,EAAe,eACf/B,EAAcrJ,EAAK,6BAA8B,KAClDF,QAAQ,eAAgBsL,GAAc9K,WAGrC8I,GAAiBpJ,EAAK,oEAAqE,KAC5FF,QAAQ,SAAUsL,GAClB9K,WACCsJ,GAAoB5J,EAAK,wQAOY,MACtCF,QAAQ,SAAUsL,GAClB9K,WAECuJ,GAAoB7J,EAAK,uNAMY,MACtCF,QAAQ,SAAUsL,GAClB9K,WACC2D,GAAiBjE,EAAK,cAAe,MACtCF,QAAQ,SAAUsL,GAClB9K,WACCgK,GAAWtK,EAAK,uCACjBF,QAAQ,SAAU,gCAClBA,QAAQ,QAAS,gJACjBQ,WACC+K,GAAiBrL,EAAK+K,GAAUjL,QAAQ,eAAa,UAAOQ,WAC5DmH,GAAMzH,EAAK,4JAMZF,QAAQ,UAAWuL,IACnBvL,QAAQ,YAAa,+EACrBQ,WACCgL,GAAe,sDACf/I,GAAOvC,EAAK,iDACbF,QAAQ,QAASwL,IACjBxL,QAAQ,OAAQ,wCAChBA,QAAQ,QAAS,+DACjBQ,WACCwI,GAAU9I,EAAK,2BAChBF,QAAQ,QAASwL,IACjBxL,QAAQ,MAAO+K,GACfvK,WACC0I,GAAShJ,EAAK,yBACfF,QAAQ,MAAO+K,GACfvK,WAQCiL,GAAe,CACjBd,WAAY/J,EACZuD,kBACAqG,YACAkB,UAjEc,gDAkEdpB,KACAjN,KA3Ee,sCA4EfkN,IAAK3J,EACL0I,kBACAQ,qBACAC,qBACAzB,SACA7F,QACAyG,UACAK,cACAP,WACA2C,cAvBkBzL,EAAK,wBAAyB,KAC/CF,QAAQ,UAAWgJ,IACnBhJ,QAAQ,SAAUkJ,IAClB1I,WAqBDmH,OACA9E,KArFe,8EAsFf4H,IAAK7J,GAKHgL,GAAiBvV,OAChBoV,IADgB,CAEnBhJ,KAAMvC,EAAK,2BACNF,QAAQ,QAASwL,IACjBhL,WACLwI,QAAS9I,EAAK,iCACTF,QAAQ,QAASwL,IACjBhL,aAKHqL,GAAYxV,OACXoV,IADW,CAEdnD,OAAQpI,EAAKoI,GAAQtI,QAAQ,KAAM,QAAQQ,WAC3CiK,IAAKvK,EAAK,mEAAoE,KACzEF,QAAQ,QAAS,6EACjBQ,WACLmK,WAAY,6EACZJ,IAAK,+CACL1H,KAAM,+NAKJiJ,GAAezV,OACdwV,IADc,CAEjBvB,GAAIpK,EAAKoK,GAAItK,QAAQ,OAAQ,KAAKQ,WAClCqC,KAAM3C,EAAK2L,GAAUhJ,MAChB7C,QAAQ,OAAQ,iBAChBA,QAAQ,UAAW,KACnBQ,aAKH+C,GAAQ,CACVwI,OAAQb,EACRzM,IAAK2M,EACLzM,SAAU0M,GAERnH,GAAS,CACX6H,OAAQN,GACRhN,IAAKoN,GACLtN,OAAQuN,GACRnN,SAAUiN,IAMd,MAAMI,GAMF,WAAArZ,CAAY+G,GALZ7G,EAAAC,KAAA,UACAD,EAAAC,KAAA,WACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,aACAD,EAAAC,KAAA,eAGIA,KAAKmQ,OAAS,GACdnQ,KAAKmQ,OAAOgG,MAAetV,OAAAsY,OAAO,MAClCnZ,KAAK4G,QAAUA,GAAWsF,EAC1BlM,KAAK4G,QAAQoF,UAAYhM,KAAK4G,QAAQoF,WAAa,IAAIqE,EAClDrQ,KAAAgM,UAAYhM,KAAK4G,QAAQoF,UACzBhM,KAAAgM,UAAUpF,QAAU5G,KAAK4G,QAC9B5G,KAAKgM,UAAU6D,MAAQ7P,KACvBA,KAAKoZ,YAAc,GACnBpZ,KAAKgQ,MAAQ,CACTC,QAAQ,EACRwF,YAAY,EACZzD,KAAK,GAET,MAAMxB,EAAQ,CACVC,MAAOA,GAAMwI,OACb7H,OAAQA,GAAO6H,QAEfjZ,KAAK4G,QAAQiF,UACb2E,EAAMC,MAAQA,GAAM5E,SACpB2E,EAAMY,OAASA,GAAOvF,UAEjB7L,KAAK4G,QAAQ+E,MAClB6E,EAAMC,MAAQA,GAAM9E,IAChB3L,KAAK4G,QAAQ6E,OACb+E,EAAMY,OAASA,GAAO3F,OAGtB+E,EAAMY,OAASA,GAAOzF,KAG9B3L,KAAKgM,UAAUwE,MAAQA,CAC1B,CAID,gBAAWA,GACA,MAAA,CACHC,SACAW,UAEP,CAID,UAAOiI,CAAI9I,EAAK3J,GAEL,OADO,IAAIsS,GAAOtS,GACZyS,IAAI9I,EACpB,CAID,gBAAO+I,CAAU/I,EAAK3J,GAEX,OADO,IAAIsS,GAAOtS,GACZwJ,aAAaG,EAC7B,CAID,GAAA8I,CAAI9I,GACMA,EAAAA,EACDrD,QAAQ,WAAY,MACpBlN,KAAAiS,YAAY1B,EAAKvQ,KAAKmQ,QAC3B,IAAA,IAASzB,EAAI,EAAGA,EAAI1O,KAAKoZ,YAAYvK,OAAQH,IAAK,CACxC,MAAA6K,EAAOvZ,KAAKoZ,YAAY1K,GAC9B1O,KAAKoQ,aAAamJ,EAAKhJ,IAAKgJ,EAAKpJ,OACpC,CAED,OADAnQ,KAAKoZ,YAAc,GACZpZ,KAAKmQ,MACf,CACD,WAAA8B,CAAY1B,EAAKJ,EAAS,GAAIqJ,GAAuB,GAI7C,IAAAtJ,EACAgC,EACAuH,EACJ,IANIzZ,KAAK4G,QAAQiF,WACb0E,EAAMA,EAAIrD,QAAQ,MAAO,QAAQA,QAAQ,SAAU,KAKhDqD,GACH,KAAIvQ,KAAK4G,QAAQ8E,YACV1L,KAAK4G,QAAQ8E,WAAW+E,OACxBzQ,KAAK4G,QAAQ8E,WAAW+E,MAAMiE,MAAMgF,MAC/BxJ,EAAQwJ,EAAaC,KAAK,CAAE9J,MAAO7P,MAAQuQ,EAAKJ,MAChDI,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,IACL,MAOnB,GAAIA,EAAQlQ,KAAKgM,UAAUsE,MAAMC,GAC7BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QACL,IAArBqB,EAAMN,IAAIf,QAAgBsB,EAAOtB,OAAS,EAG1CsB,EAAOA,EAAOtB,OAAS,GAAGe,KAAO,KAGjCO,EAAOnB,KAAKkB,QAKpB,GAAIA,EAAQlQ,KAAKgM,UAAUzB,KAAKgG,GAC5BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAClBqD,EAAA/B,EAAOA,EAAOtB,OAAS,IAE/BqD,GAAiC,cAAnBA,EAAU3P,MAA2C,SAAnB2P,EAAU3P,KAM1D4N,EAAOnB,KAAKkB,IALFgC,EAAAtC,KAAO,KAAOM,EAAMN,IACpBsC,EAAAnC,MAAQ,KAAOG,EAAMH,KAC/B/P,KAAKoZ,YAAYpZ,KAAKoZ,YAAYvK,OAAS,GAAG0B,IAAM2B,EAAUnC,WAQtE,GAAIG,EAAQlQ,KAAKgM,UAAU4E,OAAOL,GAC9BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUsF,QAAQf,GAC/BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUyF,GAAGlB,GAC1BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAU0F,WAAWnB,GAClCA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUuG,KAAKhC,GAC5BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUe,KAAKwD,GAC5BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAU4I,IAAIrE,GAC3BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAClBqD,EAAA/B,EAAOA,EAAOtB,OAAS,IAC/BqD,GAAiC,cAAnBA,EAAU3P,MAA2C,SAAnB2P,EAAU3P,KAKpDvC,KAAKmQ,OAAOgG,MAAMjG,EAAM2E,OAC9B7U,KAAKmQ,OAAOgG,MAAMjG,EAAM2E,KAAO,CAC3BjH,KAAMsC,EAAMtC,KACZkC,MAAOI,EAAMJ,SAPPoC,EAAAtC,KAAO,KAAOM,EAAMN,IACpBsC,EAAAnC,MAAQ,KAAOG,EAAMN,IAC/B5P,KAAKoZ,YAAYpZ,KAAKoZ,YAAYvK,OAAS,GAAG0B,IAAM2B,EAAUnC,WAWtE,GAAIG,EAAQlQ,KAAKgM,UAAU+I,MAAMxE,GAC7BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUsJ,SAAS/E,GAChCA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,OAFhB,CAQA,GADSuJ,EAAAlJ,EACLvQ,KAAK4G,QAAQ8E,YAAc1L,KAAK4G,QAAQ8E,WAAWkO,WAAY,CAC/D,IAAIC,EAAaC,IACX,MAAAC,EAAUxJ,EAAIf,MAAM,GACtB,IAAAwK,EACJha,KAAK4G,QAAQ8E,WAAWkO,WAAWK,SAASC,IACxCF,EAAYE,EAAcP,KAAK,CAAE9J,MAAO7P,MAAQ+Z,GACvB,iBAAdC,GAA0BA,GAAa,IACjCH,EAAAlG,KAAKC,IAAIiG,EAAYG,GACrC,IAEDH,EAAaC,KAAYD,GAAc,IACvCJ,EAASlJ,EAAI+B,UAAU,EAAGuH,EAAa,GAE9C,CACG,GAAA7Z,KAAKgQ,MAAMgC,MAAQ9B,EAAQlQ,KAAKgM,UAAUuJ,UAAUkE,IACxCvH,EAAA/B,EAAOA,EAAOtB,OAAS,GAC/B2K,GAA4C,eAAT,MAAXtH,OAAW,EAAAA,EAAA3P,OACzB2P,EAAAtC,KAAO,KAAOM,EAAMN,IACpBsC,EAAAnC,MAAQ,KAAOG,EAAMH,KAC/B/P,KAAKoZ,YAAYtK,MACjB9O,KAAKoZ,YAAYpZ,KAAKoZ,YAAYvK,OAAS,GAAG0B,IAAM2B,EAAUnC,MAG9DI,EAAOnB,KAAKkB,GAEQsJ,EAAAC,EAAO5K,SAAW0B,EAAI1B,OAC9C0B,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,aAIlC,GAAIqB,EAAQlQ,KAAKgM,UAAU+D,KAAKQ,GAC5BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAClBqD,EAAA/B,EAAOA,EAAOtB,OAAS,GAC/BqD,GAAgC,SAAnBA,EAAU3P,MACb2P,EAAAtC,KAAO,KAAOM,EAAMN,IACpBsC,EAAAnC,MAAQ,KAAOG,EAAMH,KAC/B/P,KAAKoZ,YAAYtK,MACjB9O,KAAKoZ,YAAYpZ,KAAKoZ,YAAYvK,OAAS,GAAG0B,IAAM2B,EAAUnC,MAG9DI,EAAOnB,KAAKkB,QAIpB,GAAIK,EAAK,CACL,MAAM4J,EAAS,0BAA4B5J,EAAI6J,WAAW,GACtD,GAAApa,KAAK4G,QAAQmF,OAAQ,CACrBnB,QAAQ9G,MAAMqW,GACd,KACH,CAES,MAAA,IAAIpP,MAAMoP,EAEvB,CAzDA,CA4DE,OADPna,KAAKgQ,MAAMgC,KAAM,EACV7B,CACV,CACD,MAAAiB,CAAOb,EAAKJ,EAAS,IAEV,OADPnQ,KAAKoZ,YAAYpK,KAAK,CAAEuB,MAAKJ,WACtBA,CACV,CAID,YAAAC,CAAaG,EAAKJ,EAAS,IACvB,IAAID,EAAOgC,EAAWuH,EAGlBrL,EACAiM,EAAc9D,EAFdD,EAAY/F,EAIZ,GAAAvQ,KAAKmQ,OAAOgG,MAAO,CACnB,MAAMA,EAAQtV,OAAOC,KAAKd,KAAKmQ,OAAOgG,OAClC,GAAAA,EAAMtH,OAAS,EACP,KAAsE,OAAtET,EAAQpO,KAAKgM,UAAUwE,MAAMY,OAAOyH,cAAc9K,KAAKuI,KACvDH,EAAMmE,SAASlM,EAAM,GAAGoB,MAAMpB,EAAM,GAAGmM,YAAY,KAAO,GAAG,MACjDjE,EAAAA,EAAU9G,MAAM,EAAGpB,EAAMgJ,OAAS,IAAM,IAAIhE,OAAOhF,EAAM,GAAGS,OAAS,GAAK,IAAMyH,EAAU9G,MAAMxP,KAAKgM,UAAUwE,MAAMY,OAAOyH,cAAc3B,WAIrK,CAEO,KAAkE,OAAlE9I,EAAQpO,KAAKgM,UAAUwE,MAAMY,OAAOwH,UAAU7K,KAAKuI,KAC3CA,EAAAA,EAAU9G,MAAM,EAAGpB,EAAMgJ,OAAS,IAAM,IAAIhE,OAAOhF,EAAM,GAAGS,OAAS,GAAK,IAAMyH,EAAU9G,MAAMxP,KAAKgM,UAAUwE,MAAMY,OAAOwH,UAAU1B,WAG9I,KAAuE,OAAvE9I,EAAQpO,KAAKgM,UAAUwE,MAAMY,OAAOC,eAAetD,KAAKuI,KAC5DA,EAAYA,EAAU9G,MAAM,EAAGpB,EAAMgJ,OAAS,KAAOd,EAAU9G,MAAMxP,KAAKgM,UAAUwE,MAAMY,OAAOC,eAAe6F,WAEpH,KAAO3G,GAMH,GALK8J,IACU9D,EAAA,IAEA8D,GAAA,IAEXra,KAAK4G,QAAQ8E,YACV1L,KAAK4G,QAAQ8E,WAAW0F,QACxBpR,KAAK4G,QAAQ8E,WAAW0F,OAAOsD,MAAMgF,MAChCxJ,EAAQwJ,EAAaC,KAAK,CAAE9J,MAAO7P,MAAQuQ,EAAKJ,MAChDI,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,IACL,MAOnB,GAAIA,EAAQlQ,KAAKgM,UAAUwJ,OAAOjF,GAC9BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAU6I,IAAItE,GAC3BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAClBqD,EAAA/B,EAAOA,EAAOtB,OAAS,GAC/BqD,GAA4B,SAAfhC,EAAM3N,MAAsC,SAAnB2P,EAAU3P,MAChD2P,EAAUtC,KAAOM,EAAMN,IACvBsC,EAAUnC,MAAQG,EAAMH,MAGxBI,EAAOnB,KAAKkB,QAKpB,GAAIA,EAAQlQ,KAAKgM,UAAU2D,KAAKY,GAC5BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIZ,GAAAA,EAAQlQ,KAAKgM,UAAUkK,QAAQ3F,EAAKvQ,KAAKmQ,OAAOgG,OAChD5F,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAClBqD,EAAA/B,EAAOA,EAAOtB,OAAS,GAC/BqD,GAA4B,SAAfhC,EAAM3N,MAAsC,SAAnB2P,EAAU3P,MAChD2P,EAAUtC,KAAOM,EAAMN,IACvBsC,EAAUnC,MAAQG,EAAMH,MAGxBI,EAAOnB,KAAKkB,QAKpB,GAAIA,EAAQlQ,KAAKgM,UAAUqK,SAAS9F,EAAK+F,EAAWC,GAChDhG,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUqL,SAAS9G,GAChCA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUwL,GAAGjH,GAC1BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAUyL,IAAIlH,GAC3BA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIhB,GAAIA,EAAQlQ,KAAKgM,UAAU0L,SAASnH,GAChCA,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,QAIZ,GAAClQ,KAAKgQ,MAAMC,UAAWC,EAAQlQ,KAAKgM,UAAU2L,IAAIpH,IAAlD,CAQJ,GADSkJ,EAAAlJ,EACLvQ,KAAK4G,QAAQ8E,YAAc1L,KAAK4G,QAAQ8E,WAAW8O,YAAa,CAChE,IAAIX,EAAaC,IACX,MAAAC,EAAUxJ,EAAIf,MAAM,GACtB,IAAAwK,EACJha,KAAK4G,QAAQ8E,WAAW8O,YAAYP,SAASC,IACzCF,EAAYE,EAAcP,KAAK,CAAE9J,MAAO7P,MAAQ+Z,GACvB,iBAAdC,GAA0BA,GAAa,IACjCH,EAAAlG,KAAKC,IAAIiG,EAAYG,GACrC,IAEDH,EAAaC,KAAYD,GAAc,IACvCJ,EAASlJ,EAAI+B,UAAU,EAAGuH,EAAa,GAE9C,CACD,GAAI3J,EAAQlQ,KAAKgM,UAAU8L,WAAW2B,GAClClJ,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QACF,MAAxBqB,EAAMN,IAAIJ,OAAM,KACL+G,EAAArG,EAAMN,IAAIJ,OAAQ,IAElB6K,GAAA,EACHnI,EAAA/B,EAAOA,EAAOtB,OAAS,GAC/BqD,GAAgC,SAAnBA,EAAU3P,MACvB2P,EAAUtC,KAAOM,EAAMN,IACvBsC,EAAUnC,MAAQG,EAAMH,MAGxBI,EAAOnB,KAAKkB,QAIpB,GAAIK,EAAK,CACL,MAAM4J,EAAS,0BAA4B5J,EAAI6J,WAAW,GACtD,GAAApa,KAAK4G,QAAQmF,OAAQ,CACrBnB,QAAQ9G,MAAMqW,GACd,KACH,CAES,MAAA,IAAIpP,MAAMoP,EAEvB,CA3CA,MAHG5J,EAAMA,EAAI+B,UAAUpC,EAAMN,IAAIf,QAC9BsB,EAAOnB,KAAKkB,GA+Cb,OAAAC,CACV,EAML,MAAMsK,GAGF,WAAA5a,CAAY+G,GAFZ7G,EAAAC,KAAA,WACAD,EAAAC,KAAA,UAEIA,KAAK4G,QAAUA,GAAWsF,CAC7B,CACD,KAAAoE,CAAMJ,GACK,MAAA,EACV,CACD,IAAA3F,EAAKwF,KAAEA,EAAMoB,KAAAA,EAAA5C,QAAMA,UACf,MAAMmM,EAAc,OAAAzY,GAAQkP,GAAA,IAAI/C,MAAM,cAAU,EAAAnM,EAAA,GAC1CsI,EAAOwF,EAAK7C,QAAQ,MAAO,IAAM,KACvC,OAAKwN,EAKE,8BACD5N,EAAS4N,GACT,MACCnM,EAAUhE,EAAOuC,EAASvC,GAAM,IACjC,kBARK,eACAgE,EAAUhE,EAAOuC,EAASvC,GAAM,IACjC,iBAOb,CACD,UAAAmH,EAAWvB,OAAEA,IAEF,MAAA,iBADMnQ,KAAK2a,OAAOC,MAAMzK,mBAElC,CACD,IAAApD,EAAKgD,KAAEA,IACI,OAAAA,CACV,CACD,OAAAuB,EAAQnB,OAAEA,EAAQqB,MAAAA,IACP,MAAA,KAAKA,KAASxR,KAAK2a,OAAOE,YAAY1K,QAAaqB,MAC7D,CACD,EAAAC,CAAGvB,GACQ,MAAA,QACV,CACD,IAAAqC,CAAKrC,GACD,MAAMwC,EAAUxC,EAAMwC,QAChBC,EAAQzC,EAAMyC,MACpB,IAAIvQ,EAAO,GACX,IAAA,IAAS0Y,EAAI,EAAGA,EAAI5K,EAAM2C,MAAMhE,OAAQiM,IAAK,CACnC,MAAA5Q,EAAOgG,EAAM2C,MAAMiI,GACjB1Y,GAAApC,KAAK+a,SAAS7Q,EACzB,CACK,MAAA3H,EAAOmQ,EAAU,KAAO,KAE9B,MAAO,IAAMnQ,GADMmQ,GAAqB,IAAVC,EAAgB,WAAaA,EAAQ,IAAO,IAC1C,MAAQvQ,EAAO,KAAOG,EAAO,KAChE,CACD,QAAAwY,CAAS7Q,GACL,IAAI8Q,EAAW,GACf,GAAI9Q,EAAKmK,KAAM,CACL,MAAA4G,EAAWjb,KAAKib,SAAS,CAAE3G,UAAWpK,EAAKoK,UAC7CpK,EAAK0I,MACD1I,EAAKiG,OAAOtB,OAAS,GAA6B,cAAxB3E,EAAKiG,OAAO,GAAG5N,MACpC2H,EAAAiG,OAAO,GAAGJ,KAAOkL,EAAW,IAAM/Q,EAAKiG,OAAO,GAAGJ,KAClD7F,EAAKiG,OAAO,GAAGA,QAAUjG,EAAKiG,OAAO,GAAGA,OAAOtB,OAAS,GAAuC,SAAlC3E,EAAKiG,OAAO,GAAGA,OAAO,GAAG5N,OACtF2H,EAAKiG,OAAO,GAAGA,OAAO,GAAGJ,KAAOkL,EAAW,IAAM/Q,EAAKiG,OAAO,GAAGA,OAAO,GAAGJ,OAI9E7F,EAAKiG,OAAO+K,QAAQ,CAChB3Y,KAAM,OACNqN,IAAKqL,EAAW,IAChBlL,KAAMkL,EAAW,MAKzBD,GAAYC,EAAW,GAE9B,CAED,OADYD,GAAAhb,KAAK2a,OAAOC,MAAM1Q,EAAKiG,SAAUjG,EAAK0I,OAC3C,OAAOoI,UACjB,CACD,QAAAC,EAAS3G,QAAEA,IACA,MAAA,WACAA,EAAU,cAAgB,IAC3B,8BACT,CACD,SAAAiB,EAAUpF,OAAEA,IACR,MAAO,MAAMnQ,KAAK2a,OAAOE,YAAY1K,UACxC,CACD,KAAA4E,CAAM7E,GACF,IAAIgF,EAAS,GAETG,EAAO,GACX,IAAA,IAASyF,EAAI,EAAGA,EAAI5K,EAAMgF,OAAOrG,OAAQiM,IACrCzF,GAAQrV,KAAKmb,UAAUjL,EAAMgF,OAAO4F,IAExC5F,GAAUlV,KAAKob,SAAS,CAAErL,KAAMsF,IAChC,IAAIjT,EAAO,GACX,IAAA,IAAS0Y,EAAI,EAAGA,EAAI5K,EAAM+E,KAAKpG,OAAQiM,IAAK,CAClC,MAAA1F,EAAMlF,EAAM+E,KAAK6F,GAChBzF,EAAA,GACP,IAAA,IAASgG,EAAI,EAAGA,EAAIjG,EAAIvG,OAAQwM,IAC5BhG,GAAQrV,KAAKmb,UAAU/F,EAAIiG,IAE/BjZ,GAAQpC,KAAKob,SAAS,CAAErL,KAAMsF,GACjC,CAGM,OAFHjT,IACAA,EAAO,UAAUA,aACd,qBAED8S,EACA,aACA9S,EACA,YACT,CACD,QAAAgZ,EAASrL,KAAEA,IACA,MAAA,SAASA,UACnB,CACD,SAAAoL,CAAUjL,GACN,MAAMoL,EAAUtb,KAAK2a,OAAOE,YAAY3K,EAAMC,QACxC5N,EAAO2N,EAAMgF,OAAS,KAAO,KAI5BL,OAHK3E,EAAMiF,MACZ,IAAI5S,YAAe2N,EAAMiF,UACzB,IAAI5S,MACG+Y,EAAU,KAAK/Y,MAC/B,CAID,MAAAgZ,EAAOpL,OAAEA,IACL,MAAO,WAAWnQ,KAAK2a,OAAOE,YAAY1K,aAC7C,CACD,EAAAqL,EAAGrL,OAAEA,IACD,MAAO,OAAOnQ,KAAK2a,OAAOE,YAAY1K,SACzC,CACD,QAAAkH,EAAStH,KAAEA,IACP,MAAO,SAASA,UACnB,CACD,EAAAyH,CAAGtH,GACQ,MAAA,MACV,CACD,GAAAuH,EAAItH,OAAEA,IACF,MAAO,QAAQnQ,KAAK2a,OAAOE,YAAY1K,UAC1C,CACD,IAAAR,EAAK/B,KAAEA,EAAMkC,MAAAA,EAAAK,OAAOA,IAChB,MAAMJ,EAAO/P,KAAK2a,OAAOE,YAAY1K,GAC/BsL,EAAY9N,EAASC,GAC3B,GAAkB,OAAd6N,EACO,OAAA1L,EAGP,IAAA2L,EAAM,aADH9N,EAAA6N,GACwB,IAKxB,OAJH3L,IACA4L,GAAO,WAAa5L,EAAQ,KAEhC4L,GAAO,IAAM3L,EAAO,OACb2L,CACV,CACD,KAAAC,EAAM/N,KAAEA,EAAMkC,MAAAA,EAAAC,KAAOA,IACX,MAAA0L,EAAY9N,EAASC,GAC3B,GAAkB,OAAd6N,EACO,OAAA1L,EAGX,IAAI2L,EAAM,aADH9N,EAAA6N,WAC8B1L,KAK9B,OAJHD,IACA4L,GAAO,WAAW5L,MAEf4L,GAAA,IACAA,CACV,CACD,IAAA3L,CAAKG,GACM,MAAA,WAAYA,GAASA,EAAMC,OAASnQ,KAAK2a,OAAOE,YAAY3K,EAAMC,QAAUD,EAAMH,IAC5F,EAOL,MAAM6L,GAEF,MAAAL,EAAOxL,KAAEA,IACE,OAAAA,CACV,CACD,EAAAyL,EAAGzL,KAAEA,IACM,OAAAA,CACV,CACD,QAAAsH,EAAStH,KAAEA,IACA,OAAAA,CACV,CACD,GAAA0H,EAAI1H,KAAEA,IACK,OAAAA,CACV,CACD,IAAAhD,EAAKgD,KAAEA,IACI,OAAAA,CACV,CACD,IAAAA,EAAKA,KAAEA,IACI,OAAAA,CACV,CACD,IAAAJ,EAAKI,KAAEA,IACH,MAAO,GAAKA,CACf,CACD,KAAA4L,EAAM5L,KAAEA,IACJ,MAAO,GAAKA,CACf,CACD,EAAAyH,GACW,MAAA,EACV,EAML,MAAMqE,GAIF,WAAAhc,CAAY+G,GAHZ7G,EAAAC,KAAA,WACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,gBAEIA,KAAK4G,QAAUA,GAAWsF,EAC1BlM,KAAK4G,QAAQkF,SAAW9L,KAAK4G,QAAQkF,UAAY,IAAI2O,GAChDza,KAAA8L,SAAW9L,KAAK4G,QAAQkF,SACxB9L,KAAA8L,SAASlF,QAAU5G,KAAK4G,QAC7B5G,KAAK8L,SAAS6O,OAAS3a,KAClBA,KAAA8b,aAAe,IAAIF,EAC3B,CAID,YAAOhB,CAAMzK,EAAQvJ,GAEV+T,OADQ,IAAIkB,GAAQjV,GACbgU,MAAMzK,EACvB,CAID,kBAAO0K,CAAY1K,EAAQvJ,GAEhB+T,OADQ,IAAIkB,GAAQjV,GACbiU,YAAY1K,EAC7B,CAID,KAAAyK,CAAMzK,EAAQ6B,GAAM,GAChB,IAAI0J,EAAM,GACV,IAAA,IAAShN,EAAI,EAAGA,EAAIyB,EAAOtB,OAAQH,IAAK,CAC9B,MAAAqN,EAAW5L,EAAOzB,GAExB,GAAI1O,KAAK4G,QAAQ8E,YAAc1L,KAAK4G,QAAQ8E,WAAWsQ,WAAahc,KAAK4G,QAAQ8E,WAAWsQ,UAAUD,EAASxZ,MAAO,CAClH,MAAM0Z,EAAeF,EACfG,EAAMlc,KAAK4G,QAAQ8E,WAAWsQ,UAAUC,EAAa1Z,MAAMoX,KAAK,CAAEgB,OAAQ3a,MAAQic,GACxF,IAAY,IAARC,IAAkB,CAAC,QAAS,KAAM,UAAW,OAAQ,QAAS,aAAc,OAAQ,OAAQ,YAAa,QAAQ5B,SAAS2B,EAAa1Z,MAAO,CAC9ImZ,GAAOQ,GAAO,GACd,QACH,CACJ,CACD,MAAMhM,EAAQ6L,EACd,OAAQ7L,EAAM3N,MACV,IAAK,QACMmZ,GAAA1b,KAAK8L,SAASwE,MAAMJ,GAC3B,SAEJ,IAAK,KACMwL,GAAA1b,KAAK8L,SAAS2F,GAAGvB,GACxB,SAEJ,IAAK,UACMwL,GAAA1b,KAAK8L,SAASwF,QAAQpB,GAC7B,SAEJ,IAAK,OACMwL,GAAA1b,KAAK8L,SAASvB,KAAK2F,GAC1B,SAEJ,IAAK,QACMwL,GAAA1b,KAAK8L,SAASiJ,MAAM7E,GAC3B,SAEJ,IAAK,aACMwL,GAAA1b,KAAK8L,SAAS4F,WAAWxB,GAChC,SAEJ,IAAK,OACMwL,GAAA1b,KAAK8L,SAASyG,KAAKrC,GAC1B,SAEJ,IAAK,OACMwL,GAAA1b,KAAK8L,SAASiB,KAAKmD,GAC1B,SAEJ,IAAK,YACMwL,GAAA1b,KAAK8L,SAASyJ,UAAUrF,GAC/B,SAEJ,IAAK,OAAQ,CACT,IAAIiM,EAAYjM,EACZ9N,EAAOpC,KAAK8L,SAASiE,KAAKoM,GACvB,KAAAzN,EAAI,EAAIyB,EAAOtB,QAAiC,SAAvBsB,EAAOzB,EAAI,GAAGnM,MAC9B4Z,EAAAhM,IAASzB,GACrBtM,GAAQ,KAAOpC,KAAK8L,SAASiE,KAAKoM,GAG3BT,GADP1J,EACOhS,KAAK8L,SAASyJ,UAAU,CAC3BhT,KAAM,YACNqN,IAAKxN,EACL2N,KAAM3N,EACN+N,OAAQ,CAAC,CAAE5N,KAAM,OAAQqN,IAAKxN,EAAM2N,KAAM3N,MAIvCA,EAEX,QACH,CACD,QAAS,CACC,MAAA+X,EAAS,eAAiBjK,EAAM3N,KAAO,wBACzC,GAAAvC,KAAK4G,QAAQmF,OAEN,OADPnB,QAAQ9G,MAAMqW,GACP,GAGD,MAAA,IAAIpP,MAAMoP,EAEvB,EAER,CACM,OAAAuB,CACV,CAID,WAAAb,CAAY1K,EAAQrE,GAChBA,EAAWA,GAAY9L,KAAK8L,SAC5B,IAAI4P,EAAM,GACV,IAAA,IAAShN,EAAI,EAAGA,EAAIyB,EAAOtB,OAAQH,IAAK,CAC9B,MAAAqN,EAAW5L,EAAOzB,GAExB,GAAI1O,KAAK4G,QAAQ8E,YAAc1L,KAAK4G,QAAQ8E,WAAWsQ,WAAahc,KAAK4G,QAAQ8E,WAAWsQ,UAAUD,EAASxZ,MAAO,CAClH,MAAM2Z,EAAMlc,KAAK4G,QAAQ8E,WAAWsQ,UAAUD,EAASxZ,MAAMoX,KAAK,CAAEgB,OAAQ3a,MAAQ+b,GACpF,IAAY,IAARG,IAAkB,CAAC,SAAU,OAAQ,OAAQ,QAAS,SAAU,KAAM,WAAY,KAAM,MAAO,QAAQ5B,SAASyB,EAASxZ,MAAO,CAChImZ,GAAOQ,GAAO,GACd,QACH,CACJ,CACD,MAAMhM,EAAQ6L,EACd,OAAQ7L,EAAM3N,MACV,IAAK,SAoCL,IAAK,OACMmZ,GAAA5P,EAASiE,KAAKG,GACrB,MAlCJ,IAAK,OACMwL,GAAA5P,EAASiB,KAAKmD,GACrB,MAEJ,IAAK,OACMwL,GAAA5P,EAAS6D,KAAKO,GACrB,MAEJ,IAAK,QACMwL,GAAA5P,EAAS6P,MAAMzL,GACtB,MAEJ,IAAK,SACMwL,GAAA5P,EAASyP,OAAOrL,GACvB,MAEJ,IAAK,KACMwL,GAAA5P,EAAS0P,GAAGtL,GACnB,MAEJ,IAAK,WACMwL,GAAA5P,EAASuL,SAASnH,GACzB,MAEJ,IAAK,KACMwL,GAAA5P,EAAS0L,GAAGtH,GACnB,MAEJ,IAAK,MACMwL,GAAA5P,EAAS2L,IAAIvH,GACpB,MAMJ,QAAS,CACC,MAAAiK,EAAS,eAAiBjK,EAAM3N,KAAO,wBACzC,GAAAvC,KAAK4G,QAAQmF,OAEN,OADPnB,QAAQ9G,MAAMqW,GACP,GAGD,MAAA,IAAIpP,MAAMoP,EAEvB,EAER,CACM,OAAAuB,CACV,EAGL,MAAMU,GAGF,WAAAvc,CAAY+G,GAFZ7G,EAAAC,KAAA,WACAD,EAAAC,KAAA,SAEIA,KAAK4G,QAAUA,GAAWsF,CAC7B,CASD,UAAAmQ,CAAWC,GACA,OAAAA,CACV,CAID,WAAAC,CAAYxP,GACDA,OAAAA,CACV,CAID,gBAAAyP,CAAiBrM,GACN,OAAAA,CACV,CAID,YAAAsM,GACI,OAAOzc,KAAKyQ,MAAQyI,GAAOG,IAAMH,GAAOI,SAC3C,CAID,aAAAoD,GACI,OAAO1c,KAAKyQ,MAAQoL,GAAQjB,MAAQiB,GAAQhB,WAC/C,EAxCC9a,EAAAqc,GAMK,mBAAmB,IAAIO,IAAI,CAC9B,aACA,cACA,sBAkCR,MAAMC,GAWF,WAAA/c,IAAegd,GAVf9c,EAAAC,KAAA,WA9jEO,CACHwL,OAAO,EACPC,QAAQ,EACRC,WAAY,KACZC,KAAK,EACLC,MAAO,KACPC,UAAU,EACVC,SAAU,KACVC,QAAQ,EACRC,UAAW,KACXC,WAAY,OAqjEhBlM,EAAAC,KAAA,UAAUA,KAAK8c,YACP/c,EAAAC,KAAA,QAAAA,KAAK+c,eAAc,IACbhd,EAAAC,KAAA,cAAAA,KAAK+c,eAAc,IACxBhd,EAAAC,KAAA,SAAA6b,IACE9b,EAAAC,KAAA,WAAAya,IACI1a,EAAAC,KAAA,eAAA4b,IACP7b,EAAAC,KAAA,QAAAkZ,IACInZ,EAAAC,KAAA,YAAAqQ,GACJtQ,EAAAC,KAAA,QAAAoc,IAECpc,KAAAgd,OAAOH,EACf,CAID,UAAA5Q,CAAWkE,EAAQ8M,WACf,IAAIC,EAAS,GACb,IAAA,MAAWhN,KAASC,EAEhB,OADA+M,EAASA,EAAOC,OAAOF,EAAStD,KAAK3Z,KAAMkQ,IACnCA,EAAM3N,MACV,IAAK,QAAS,CACV,MAAM6a,EAAalN,EACR,IAAA,MAAAmF,KAAQ+H,EAAWlI,OAC1BgI,EAASA,EAAOC,OAAOnd,KAAKiM,WAAWoJ,EAAKlF,OAAQ8M,IAE7C,IAAA,MAAA7H,KAAOgI,EAAWnI,KACzB,IAAA,MAAWI,KAAQD,EACf8H,EAASA,EAAOC,OAAOnd,KAAKiM,WAAWoJ,EAAKlF,OAAQ8M,IAG5D,KACH,CACD,IAAK,OAAQ,CACT,MAAMI,EAAYnN,EAClBgN,EAASA,EAAOC,OAAOnd,KAAKiM,WAAWoR,EAAUxK,MAAOoK,IACxD,KACH,CACD,QAAS,CACL,MAAMhB,EAAe/L,GACjB,OAAA/N,EAAA,cAAKmb,SAAS5R,qBAAY6R,kBAA1B,EAAApb,EAAwC8Z,EAAa1Z,OAChDvC,KAAAsd,SAAS5R,WAAW6R,YAAYtB,EAAa1Z,MAAM0X,SAASsD,IAC7D,MAAMpN,EAAS8L,EAAasB,GAAaC,KAAK1D,KAC9CoD,EAASA,EAAOC,OAAOnd,KAAKiM,WAAWkE,EAAQ8M,GAAS,IAGvDhB,EAAa9L,SAClB+M,EAASA,EAAOC,OAAOnd,KAAKiM,WAAWgQ,EAAa9L,OAAQ8M,IAEnE,EAGF,OAAAC,CACV,CACD,GAAAF,IAAOH,GACG,MAAAnR,EAAa1L,KAAKsd,SAAS5R,YAAc,CAAEsQ,UAAW,CAAE,EAAEuB,YAAa,CAAA,GAwKtE,OAvKFV,EAAA5C,SAASwD,IAEV,MAAMlU,EAAO/F,EAAK,CAAA,EAAAia,GA8DlB,GA5DAlU,EAAKiC,MAAQxL,KAAKsd,SAAS9R,OAASjC,EAAKiC,QAAS,EAE9CiS,EAAK/R,aACA+R,EAAA/R,WAAWuO,SAASyD,IACjB,IAACA,EAAIpS,KACC,MAAA,IAAIP,MAAM,2BAEpB,GAAI,aAAc2S,EAAK,CACnB,MAAMC,EAAejS,EAAWsQ,UAAU0B,EAAIpS,MAG1CI,EAAWsQ,UAAU0B,EAAIpS,MAFzBqS,EAEiC,YAAad,GAC1C,IAAIX,EAAMwB,EAAI5R,SAAS8R,MAAM5d,KAAM6c,GAI5B,OAHK,IAARX,IACMA,EAAAyB,EAAaC,MAAM5d,KAAM6c,IAE5BX,CACvC,EAG6DwB,EAAI5R,QAE5C,CACD,GAAI,cAAe4R,EAAK,CAChB,IAACA,EAAI3H,OAAwB,UAAd2H,EAAI3H,OAAmC,WAAd2H,EAAI3H,MACtC,MAAA,IAAIhL,MAAM,+CAEd,MAAA8S,EAAWnS,EAAWgS,EAAI3H,OAC5B8H,EACSA,EAAA3C,QAAQwC,EAAI1R,WAGrBN,EAAWgS,EAAI3H,OAAS,CAAC2H,EAAI1R,WAE7B0R,EAAI/K,QACc,UAAd+K,EAAI3H,MACArK,EAAWkO,WACAlO,EAAAkO,WAAW5K,KAAK0O,EAAI/K,OAGpBjH,EAAAkO,WAAa,CAAC8D,EAAI/K,OAGd,WAAd+K,EAAI3H,QACLrK,EAAW8O,YACA9O,EAAA8O,YAAYxL,KAAK0O,EAAI/K,OAGrBjH,EAAA8O,YAAc,CAACkD,EAAI/K,QAI7C,CACG,gBAAiB+K,GAAOA,EAAIH,cAC5B7R,EAAW6R,YAAYG,EAAIpS,MAAQoS,EAAIH,YAC1C,IAELhU,EAAKmC,WAAaA,GAGlB+R,EAAK3R,SAAU,CACf,MAAMA,EAAW9L,KAAKsd,SAASxR,UAAY,IAAI2O,GAAUza,KAAKsd,UACnD,IAAA,MAAAQ,KAAQL,EAAK3R,SAAU,CAC1B,KAAEgS,KAAQhS,GACV,MAAM,IAAIf,MAAM,aAAa+S,qBAEjC,GAAI,CAAC,UAAW,UAAUxD,SAASwD,GAE/B,SAEJ,MAAMC,EAAeD,EACfE,EAAeP,EAAK3R,SAASiS,GAC7BJ,EAAe7R,EAASiS,GAErBjS,EAAAiS,GAAgB,IAAIlB,KACzB,IAAIX,EAAM8B,EAAaJ,MAAM9R,EAAU+Q,GAIvC,OAHY,IAARX,IACMA,EAAAyB,EAAaC,MAAM9R,EAAU+Q,IAEhCX,GAAO,EAAA,CAErB,CACD3S,EAAKuC,SAAWA,CACnB,CACD,GAAI2R,EAAKzR,UAAW,CAChB,MAAMA,EAAYhM,KAAKsd,SAAStR,WAAa,IAAIqE,EAAWrQ,KAAKsd,UACtD,IAAA,MAAAQ,KAAQL,EAAKzR,UAAW,CAC3B,KAAE8R,KAAQ9R,GACV,MAAM,IAAIjB,MAAM,cAAc+S,qBAElC,GAAI,CAAC,UAAW,QAAS,SAASxD,SAASwD,GAEvC,SAEJ,MAAMG,EAAgBH,EAChBI,EAAgBT,EAAKzR,UAAUiS,GAC/BE,EAAgBnS,EAAUiS,GAGtBjS,EAAAiS,GAAiB,IAAIpB,KAC3B,IAAIX,EAAMgC,EAAcN,MAAM5R,EAAW6Q,GAIlC,OAHK,IAARX,IACMA,EAAAiC,EAAcP,MAAM5R,EAAW6Q,IAElCX,CAAA,CAEd,CACD3S,EAAKyC,UAAYA,CACpB,CAED,GAAIyR,EAAK7R,MAAO,CACZ,MAAMA,EAAQ5L,KAAKsd,SAAS1R,OAAS,IAAIwQ,GAC9B,IAAA,MAAA0B,KAAQL,EAAK7R,MAAO,CACvB,KAAEkS,KAAQlS,GACV,MAAM,IAAIb,MAAM,SAAS+S,qBAE7B,GAAI,CAAC,UAAW,SAASxD,SAASwD,GAE9B,SAEJ,MAAMM,EAAYN,EACZO,EAAYZ,EAAK7R,MAAMwS,GACvBE,EAAW1S,EAAMwS,GACnBhC,GAAOmC,iBAAiB9c,IAAIqc,GAEtBlS,EAAAwS,GAAcI,IACZ,GAAAxe,KAAKsd,SAAS9R,MACP,OAAAnB,QAAQC,QAAQ+T,EAAU1E,KAAK/N,EAAO4S,IAAM9a,MAAKwY,GAC7CoC,EAAS3E,KAAK/N,EAAOsQ,KAGpC,MAAMA,EAAMmC,EAAU1E,KAAK/N,EAAO4S,GAC3B,OAAAF,EAAS3E,KAAK/N,EAAOsQ,EAAG,EAK7BtQ,EAAAwS,GAAa,IAAIvB,KACnB,IAAIX,EAAMmC,EAAUT,MAAMhS,EAAOiR,GAI1B,OAHK,IAARX,IACMA,EAAAoC,EAASV,MAAMhS,EAAOiR,IAEzBX,CAAA,CAGlB,CACD3S,EAAKqC,MAAQA,CAChB,CAED,GAAI6R,EAAKxR,WAAY,CACX,MAAAA,EAAajM,KAAKsd,SAASrR,WAC3BwS,EAAiBhB,EAAKxR,WACvB1C,EAAA0C,WAAa,SAAUiE,GACxB,IAAIgN,EAAS,GAKN,OAJPA,EAAOlO,KAAKyP,EAAe9E,KAAK3Z,KAAMkQ,IAClCjE,IACAiR,EAASA,EAAOC,OAAOlR,EAAW0N,KAAK3Z,KAAMkQ,KAE1CgN,CAC3B,CACa,CACIld,KAAAsd,SAAW9Z,EAAKA,EAAA,CAAA,EAAAxD,KAAKsd,UAAa/T,EAAA,IAEpCvJ,IACV,CACD,UAAA8c,CAAWxP,GAEA,OADFtN,KAAAsd,SAAW9Z,EAAKA,EAAA,CAAA,EAAAxD,KAAKsd,UAAahQ,GAChCtN,IACV,CACD,KAAA6P,CAAMU,EAAK3J,GACP,OAAOsS,GAAOG,IAAI9I,EAAK,MAAA3J,EAAAA,EAAW5G,KAAKsd,SAC1C,CACD,MAAA3C,CAAOxK,EAAQvJ,GACX,OAAOiV,GAAQjB,MAAMzK,EAAQ,MAAAvJ,EAAAA,EAAW5G,KAAKsd,SAChD,CACD,aAAAP,CAAc2B,GAsDH,MApDO,CAACnO,EAAK3J,KAChB,MAAM+X,EAAUnb,EAAK,CAAA,EAAAoD,GACf0G,EAAM9J,EAAKA,EAAA,CAAA,EAAAxD,KAAKsd,UAAaqB,GAC7BC,EAAa5e,KAAK6e,UAAUvR,EAAIvB,SAAUuB,EAAI9B,OAEpD,IAA4B,IAAxBxL,KAAKsd,SAAS9R,QAAoC,IAAlBmT,EAAQnT,MACxC,OAAOoT,EAAW,IAAI7T,MAAM,uIAGhC,GAAI,MAAOwF,EACP,OAAOqO,EAAW,IAAI7T,MAAM,mDAE5B,GAAe,iBAARwF,EACA,OAAAqO,EAAW,IAAI7T,MAAM,wCACtBlK,OAAOie,UAAUC,SAASpF,KAAKpJ,GAAO,sBAE5CjD,EAAI1B,QACJ0B,EAAI1B,MAAMhF,QAAU0G,EACpBA,EAAI1B,MAAM6E,MAAQiO,GAEhB,MAAA7O,EAAQvC,EAAI1B,MAAQ0B,EAAI1B,MAAM6Q,eAAkBiC,EAAYxF,GAAOG,IAAMH,GAAOI,UAChFqB,EAASrN,EAAI1B,MAAQ0B,EAAI1B,MAAM8Q,gBAAmBgC,EAAY7C,GAAQjB,MAAQiB,GAAQhB,YAC5F,GAAIvN,EAAI9B,MACJ,OAAOnB,QAAQC,QAAQgD,EAAI1B,MAAQ0B,EAAI1B,MAAMyQ,WAAW9L,GAAOA,GAC1D7M,MAAK6M,GAAOV,EAAMU,EAAKjD,KACvB5J,MAAeyM,GAAA7C,EAAI1B,MAAQ0B,EAAI1B,MAAM4Q,iBAAiBrM,GAAUA,IAChEzM,SAAe4J,EAAIrB,WAAa5B,QAAQ2U,IAAIhf,KAAKiM,WAAWkE,EAAQ7C,EAAIrB,aAAavI,MAAK,IAAMyM,IAAUA,IAC1GzM,MAAeiX,GAAAA,EAAOxK,EAAQ7C,KAC9B5J,MAAKqJ,GAAQO,EAAI1B,MAAQ0B,EAAI1B,MAAM2Q,YAAYxP,GAAQA,IACvD/I,MAAM4a,GAEX,IACItR,EAAI1B,QACE2E,EAAAjD,EAAI1B,MAAMyQ,WAAW9L,IAE3B,IAAAJ,EAASN,EAAMU,EAAKjD,GACpBA,EAAI1B,QACKuE,EAAA7C,EAAI1B,MAAM4Q,iBAAiBrM,IAEpC7C,EAAIrB,YACCjM,KAAAiM,WAAWkE,EAAQ7C,EAAIrB,YAE5Bc,IAAAA,EAAO4N,EAAOxK,EAAQ7C,GAInBP,OAHHO,EAAI1B,QACJmB,EAAOO,EAAI1B,MAAM2Q,YAAYxP,IAE1BA,CACV,OACM9I,GACH,OAAO2a,EAAW3a,EACrB,EAGR,CACD,OAAA4a,CAAQ9S,EAAQP,GACZ,OAAQvH,IAEJ,GADAA,EAAEyG,SAAW,8DACTqB,EAAQ,CACR,MAAMpB,EAAM,iCACNmC,EAAS7I,EAAEyG,QAAU,IAAI,GACzB,SACN,OAAIc,EACOnB,QAAQC,QAAQK,GAEpBA,CACV,CACD,GAAIa,EACO,OAAAnB,QAAQ4U,OAAOhb,GAEpB,MAAAA,CAAA,CAEb,EAGC,MAAAib,GAAiB,IAAItC,GAClBuC,SAAAA,GAAO5O,EAAKjD,GACV,OAAA4R,GAAetE,MAAMrK,EAAKjD,EACrC,CAMA6R,GAAOvY,QACHuY,GAAOrC,WAAa,SAAUlW,GAInBuY,OAHPD,GAAepC,WAAWlW,GAC1BuY,GAAO7B,SAAW4B,GAAe5B,SACjCnR,EAAegT,GAAO7B,UACf6B,EACf,EAIAA,GAAOC,YAAc7T,EACrB4T,GAAO7B,SAAWpR,EAIXmT,GAAArC,IAAM,YAAaH,GAIfsC,OAHQD,GAAAlC,OAAOH,GACtBsC,GAAO7B,SAAW4B,GAAe5B,SACjCnR,EAAegT,GAAO7B,UACf6B,EACX,EAIOE,GAAApT,WAAa,SAAUkE,EAAQ8M,GAC3B,OAAAiC,GAAejT,WAAWkE,EAAQ8M,EAC7C,EAQAkC,GAAOtE,YAAcqE,GAAerE,YAIpCsE,GAAOG,OAASzD,GAChBsD,GAAOxE,OAASkB,GAAQjB,MACxBuE,GAAOI,SAAW9E,GAClB0E,GAAOK,aAAe5D,GACtBuD,GAAOM,MAAQvG,GACfiG,GAAOtP,MAAQqJ,GAAOG,IACtB8F,GAAOO,UAAYrP,EACnB8O,GAAOQ,MAAQvD,GACf+C,GAAOvE,MAAQuE,GACQE,GAAAzY,QACGyY,GAAAvC,WACPuC,GAAArC,IACOqC,GAAApT,WACCoT,GAAAxE,YAEJgB,GAAAjB,MACF1B,GAAAG,sPCj8ErB,IAAIuG,GAAU,CACZ,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,SAEHC,GAAY,CACd,QAAS,IACT,OAAQ,IACR,OAAQ,IACR,SAAU,IACV,QAAS,KAEPC,GAAW,kCACXC,GAAa,WAEjB,SAASC,GAAgB5R,GACvB,OAAOwR,GAAQxR,EACjB,CACA,SAAS6R,GAAkB7R,GACzB,OAAOyR,GAAUzR,EACnB,CAEA,SAAS8R,GAAYnQ,GACZ,OAAQ,MAARA,EAAe,GAAKoQ,OAAOpQ,GAAM7C,QAAQ6S,GAAYC,GAC9D,CAEA,SAASI,GAAcrT,GACdA,OAAQ,MAARA,EAAe,GAAKoT,OAAOpT,GAAMG,QAAQ4S,GAAUG,GAC5D,CAEWC,GAAAtZ,QAAUwZ,GAAaxZ,QAAU,GAE5C,IAAAyZ,GAAiB,CACfrT,OAAQkT,GACR1K,OAAQ0K,GACRI,OAAQF,GACRG,SAAUH,GACVI,QAAS,iBCpBX,IAAAC,GAnBA,SAASC,EAAYC,GAInB,IAHA,IACIzW,EACAjJ,EAFA2f,EAAQ/b,MAAMia,UAAUtP,MAAMmK,KAAKxU,UAAW,GAG3Cyb,EAAM/R,QAEX,IAAK5N,KADLiJ,EAAO0W,EAAMhS,QAEP1E,EAAK2W,eAAe5f,KAC8B,oBAAhDJ,OAAOie,UAAUC,SAASpF,KAAKgH,EAAO1f,IACjC0f,EAAA1f,GAAOyf,EAAWC,EAAO1f,GAAMiJ,EAAKjJ,IAEpC0f,EAAA1f,GAAOiJ,EAAKjJ,IAKpB,OAAA0f,CACT,ECjBAG,GAAiB,SAAoBC,GACnC,MAAyB,iBAAXA,EAAsBA,EAAOjM,cAAgBiM,CAC7D,ECES,SAAAC,GAAOC,EAAa/W,GAEpB,OADP+W,EAAY/W,IAAQ,EACb+W,CACT,CAEA,IAAAC,GATA,SAAgB3O,GACd,OAAOA,EAAKxR,OAAOigB,GAAO,CAAE,EAC9B,ECCAG,GAAiB,CACfC,KAJUC,GACD,CAAC,aAAc,OAAQ,OAAQ,OAAQ,WAAY,MAAO,YCErEC,GAAiB,CACfC,MAJUF,GACA,CAAC,OAAQ,KAAM,MAAO,KAAM,MAAO,MAAO,QAAS,OAAQ,WAAY,OAAQ,UCDvFG,GAAKH,GACLP,GAAYW,GAEZH,GAAWI,GACXC,GAAS,6FACTC,GAAO,4BACPC,GAAS,0EACTC,GAAO,KACPC,GAAU,UA8Hd,ICtIIP,GAAKH,GACLP,GAAYW,GACZN,GAAaa,GACbV,GAAWI,GAsIf,ICxIIxd,GAASud,GACT9G,GFgBKA,SAAQ5N,EAAM3C,GAKrB,IAJA,IAEI6X,EAFArB,EATN,WACE,IAAIA,EAAQ,GAIL,OAHDA,EAAAsB,SAAW,WACR,OAAAtB,EAAMA,EAAM/R,OAAS,EAChC,EACS+R,CACT,CAGcuB,GACRC,EAAOrV,EAGJA,OAKP,SAASsV,IACCJ,GAAA,EAWV,WAC4B,YAAtBlV,EAAKuV,OAAO,EAAG,IAoBflL,EAAQrK,EAAK+I,QAAQ,YACZ,IACP1L,EAAQlE,SACVkE,EAAQlE,QAAQ6G,EAAKuF,UAAU,EAAG8E,IAEpCrK,EAAOA,EAAKuF,UAAU8E,EAAQ,GACtB6K,GAAA,GAxBCF,GAAQ9U,KAAKF,GACtBwV,EAAUX,GAAMY,GACPV,GAAK7U,KAAKF,IACnBwV,EAAUZ,GAAQc,GActB,IACMrL,GAUN,WACE,IAAK6K,EACH,OAEE,IAAAlS,EACAqH,EAAQrK,EAAK+I,QAAQ,KACrBsB,GAAS,GACJrK,EAAAA,EAAKuF,UAAU,EAAG8E,GACzBrK,EAAOA,EAAKuF,UAAU8E,KAEfrK,EAAAA,EACPA,EAAO,IAEL3C,EAAQ6X,OACV7X,EAAQ6X,MAAMlS,EAEjB,GAtCA,IAjBC,IAAI2S,EAAO3V,IAASqV,EACbrV,EAAAA,EAEH2V,IACF3V,EAAO,GAEV,CAaQ,SAAAwV,EAAWlV,EAAOsN,GACrB,IAAAvM,EAAQrB,EAAKqB,MAAMf,GACnBe,IACFrB,EAAOA,EAAKuF,UAAUlE,EAAM,GAAGS,QAC/BT,EAAM,GAAGlB,QAAQG,EAAOsN,GAChBsH,GAAA,EAEX,CA+BD,SAASQ,EAAe5N,EAAK8N,EAASC,EAAMC,GAC1C,IAAIC,EAAQ,CAAA,EACRC,EAAMjC,GAAU6B,GAChBK,EAAI1B,GAASC,MAAMwB,MAAUF,EAE5BD,EAAA1V,QAAQ2U,IASb,SAAuBzT,EAAO9C,EAAM2X,EAAmBC,EAAmBC,GAEtEL,EAAMxX,QADkB,IAAtB2X,QAAsD,IAAtBC,QAAkD,IAAlBC,OACpD,EAEA3B,GAAGlB,OAAO2C,GAAqBC,GAAqBC,GAAiB,GAEtF,IAbIH,GACHpC,EAAM5R,KAAK+T,GAET3Y,EAAQuI,OACFvI,EAAAuI,MAAMoQ,EAAKD,EAAOE,EAU7B,CAEQ,SAAAR,EAAa3N,EAAK8N,GACrB,IAAAjU,EACA0U,EAAM,EACNL,EAAMjC,GAAU6B,GACpB,GAAII,EACF,IAAKK,EAAMxC,EAAM/R,OAAS,EAAGuU,GAAO,GAC9BxC,EAAMwC,KAASL,EADkBK,KAMzC,GAAIA,GAAO,EAAG,CACZ,IAAK1U,EAAIkS,EAAM/R,OAAS,EAAGH,GAAK0U,EAAK1U,IAC/BtE,EAAQiZ,KACFjZ,EAAAiZ,IAAIzC,EAAMlS,IAGtBkS,EAAM/R,OAASuU,CAChB,CACF,IACH,EEjIIE,GDEKA,SAAWC,EAAQ3c,GAEtB,IAAA4c,EACAC,EAAI7c,GAAW,GAIZ,WAAA,CACL+L,MASO,SAAOkC,EAAKiO,EAAOD,GACtB,IAAAE,EAAMjC,GAAUjM,GAEpB,GAAI2O,EAAQE,SACG,YAAbC,EAAOZ,GAET,IAA+C,KAA1CU,EAAEG,aAAe,IAAI9N,QAAQiN,GACnB,YAAbY,EAAOZ,GAEL,GAAAU,EAAE7e,SAAW6e,EAAE7e,OAAO,CAAEiQ,IAAKkO,EAAKD,UACvB,YAAba,EAAOZ,GAGTrH,EAAI,KACJA,EAAIqH,GACJliB,OAAOC,KAAKgiB,GAAO7I,SAGnB,SAAgBhZ,GACV,IAAAmD,EAAQ0e,EAAM7hB,GACd4iB,GAAaJ,EAAEK,gBAAkB,CAAA,GAAIf,IAAQ,GAC7CgB,GAAWN,EAAEO,mBAAqB,CAAA,GAAIjB,IAAQ,GAE9CkB,EAAOnD,GAAU7f,IACR,UAATgjB,IAAkD,IAA9BF,EAAQjO,QAAQmO,IAC9B7f,EAAAA,EAAMqK,MAAM,KAAK7J,QAc3B,SAAuBsf,GACrB,OAAOL,IAA8C,IAAjCA,EAAU/N,QAAQoO,EACvC,IAhB+Cxf,KAAK,KAAKiK,QAC1CE,QAEoB,IAA1BkV,EAAQjO,QAAQmO,MAA2C,IAA1B9C,GAAWC,KAAK6C,IAiC/D,SAAkBlU,GACZ4C,IAAAA,EAAQ5C,EAAK,GACb4C,GAAU,MAAVA,GAA2B,MAAVA,EACZ,OAAA,EAEL,IAAAwR,EAAQpU,EAAK+F,QAAQ,KACzB,IAAkB,IAAdqO,EACK,OAAA,EAEL,IAAAC,EAAerU,EAAK+F,QAAQ,KAC5B,IAAuB,IAAvBsO,GAAuBD,EAAQC,EAC1B,OAAA,EAEL,IAAAC,EAAOtU,EAAK+F,QAAQ,KACpB,OAAe,IAAfuO,GAAeF,EAAQE,GAGpBZ,EAAEa,eAAe5P,KAAK6P,GAE7B,SAASA,EAASC,GAChB,OAAsC,IAA/BzU,EAAK+F,QAAQ0O,EAAS,IAC9B,CACF,CAvDgFC,CAAQrgB,OAGnFsX,EAAI,KACJA,EAAIza,GACiB,iBAAVmD,IACTsX,EAAI,MACAA,EAAA8F,GAAGxU,OAAO5I,IACdsX,EAAI,MAMT,IA1BGA,EAAAmH,EAAQ,KAAO,IA2BpB,EAnDCQ,IAqDF,SAAcxO,GACR,IAAAkO,EAAMjC,GAAUjM,IACiC,KAAtC4O,EAAEG,aAAe,IAAI9N,QAAQiN,KAEjB,IAArBS,EAAQE,UACVhI,EAAI,MACJA,EAAIqH,GACJrH,EAAI,MAKNgJ,EAAS3B,EAEZ,EAlECd,MA4FF,SAAgBlS,IACW,IAArByT,EAAQE,UACVhI,EAAI+H,EAAEkB,cAAgBlB,EAAEkB,cAAc5U,GAAQA,EAEjD,GA7FD,SAAS2L,EAAKtX,GACZmf,EAAOvU,KAAK5K,EACb,CA6FD,SAASuf,EAAQ9O,GACXyM,GAASC,MAAM1M,MAGM,IAArB2O,EAAQE,SACVF,EAAU,CAAEE,SAAU7O,EAAKrD,MAAO,GACzBgS,EAAQE,WAAa7O,GACtB2O,EAAAhS,QAEX,CAED,SAASkT,EAAU7P,GACb2O,EAAQE,WAAa7O,KACjB2O,EAAQhS,OAAS,MAI1B,CAED,SAASoT,IACPpB,EAAU,CAAEE,UAAU,EAAOlS,MAAO,EACrC,CACH,ECnII8L,GCJW,CACb0G,kBAAmB,CACjBa,EAAG,CAAC,OAAQ,OAAQ,SAAU,QAAS,cACvCC,OAAQ,CAAC,kBAAmB,cAAe,OAC3CC,IAAK,CAAC,MAAO,MAAO,QAAS,eAE/BjB,eAAgB,CAAE,EAClBQ,eAAgB,CAAC,OAAQ,QAAS,UAClCV,YAAa,CACX,IAAK,OAAQ,UAAW,IAAK,aAAc,KAAM,UAAW,OAAQ,MAAO,UAAW,MAAO,KAC7F,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAK,MAAO,MAAO,MAAO,KAAM,OAAQ,OAClF,KAAM,IAAK,MAAO,UAAW,OAAQ,SAAU,SAAU,MAAO,UAAW,MAAO,QAClF,QAAS,KAAM,KAAM,QAAS,KAAM,IAAK,MAE3Chf,OAAQ,MDRD,SAAAogB,GAAQjY,EAAMnG,EAASqe,GAC9B,IAAI1B,EAAS,GACT2B,GAA2B,IAAXD,EAAkBre,EAAU1C,GAAO,CAAE,EAAEoZ,GAAU1W,GACjEwD,EAAUkZ,GAAUC,EAAQ2B,GAIzB,OAFPvK,GAAO5N,EAAM3C,GAENmZ,EAAO7e,KAAK,GACrB,CAEAsgB,GAAO1H,SAAWA,eACD0H,IEjBXG,GAAgB,CACpBrB,eAAgB,CAAC,EAKjBQ,eAAgB,CACd,OACA,QACA,SACA,QAEFV,YAAa,CACX,IACA,OACA,UACA,IACA,aACA,KACA,UACA,OACA,MACA,UACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,IACA,MACA,MACA,MACA,KACA,OACA,OACA,KACA,IACA,MACA,UACA,OACA,SACA,SACA,MACA,UACA,MACA,QACA,QACA,KACA,KACA,QACA,KACA,IACA,MAEFI,kBAAmB,CACjB,IAAK,CAAC,QAAS,aACfa,EAAG,CAAC,OAAQ,OAAQ,SAAU,aAAc,OAC5CE,IAAK,CAAC,MAAO,MAAO,QAAS,eAAgB,aAAc,WAAY,QAAS,WAEhFxa,KAAM,CAAC,SACP6a,KAAM,CAAC,QAAS,UAElBxgB,OAASmM,IAES,CACd,CAAC,OAAQ,0BACT,CAAC,OAAQ,eACT,CAAC,MAAO,eAEFkJ,SAAQ,EAAEpF,EAAKwQ,MACjBtU,EAAK8D,MAAQA,GAAS9D,EAAK+R,MAAMwC,QAAWD,EAAepY,KAAK8D,EAAK+R,MAAMwC,eACtEvU,EAAK+R,MAAMwC,KACpB,IAKa,SAAbvU,EAAK8D,KACH9D,EAAK+R,MAAMyC,QACZ,kCAAkCtY,KAAK8D,EAAK+R,MAAMyC,eAE5CxU,EAAK+R,MAAMyC,OAGb,IAIJ,SAASC,GAASlK,GAGhB0J,OAAAA,GAAO1J,EAAS6J,GACzB,wBCjGkFM,QAGzE,WAEA,SAAAC,EAAqBC,EAAIC,GAC1BA,OAA0BD,EAA1BC,EAAS,CAAEH,QAAS,CAAA,GAAiBG,EAAOH,SAAUG,EAAOH,OACpE,CAEG,IAAAI,EAAUH,GAAqB,SAAUE,GAGzC,IAAA1f,EAAU0f,EAAOH,QAAU,WAC9B,OAAO,IAAIlZ,OAAO,MAAQrG,EAAQgN,OAAO1G,OAAS,QAAUtG,EAAQuK,QAAQjE,OAAS,IAAK,KAC3F,EAEAtG,EAAQgN,KAAO,WACP,MAAA,sBACR,EAEAhN,EAAQuK,MAAQ,WACR,MAAA,sBACR,CACA,IAEIqV,EAAgB,CAAC,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,SAAU,UAmC7I,SAASC,EAAUC,GACjB,MAAQ,kCAAsCA,EAAK,SACpD,CAEM,OArCK,SAAUtlB,EAAOulB,QACd,IAARA,IAAiBA,EAAM,CAAA,GAC5B,IAAIC,EAASD,EAAIC,YAAwB,IAAXA,IAA6BA,EAAAJ,GAE3D,IAAI1O,EAAQ,EACR+O,EAAQ,CAAA,EAIRC,EAAK,IAAI7Z,OAAQ,IAHR,wFAGsBC,OAAU,IAF3B,IAE8CA,OAAU,MAASqZ,IAAUrZ,OAAU,IAAM,OAC7G,OAAO9L,EACNwM,QAAQkZ,GAAI,SAAUC,EAAGC,EAAMN,GAC9B,GAAIA,EACF,OAAOD,EAAUC,GAGnB,GAAa,MAATM,EACK,MAAA,OAEL,IAAAC,EACAJ,EAAMG,GACRC,EAAQJ,EAAMG,IAEdC,EAAQL,EAAO9O,GACf+O,EAAMG,GAAQC,GAGhB,IAAI7K,EAAM,wBAA2B6K,EAAQ,KAAQD,EAAO,UAErD,OADPlP,IAAUA,EAAQ8O,EAAOrX,OAClB6M,CACX,GACA,CAQA,CAlEkF8K,2BCC3E,SAASC,GAAWlc,GACzB,OAAOmc,GAAOnc,EAChB,CCIO,SAASoc,GAAY/f,GACpB,MAAAkF,EAAW,IAAIqT,GAAOI,SAIrB,OAHPzT,EAAS6D,KAAOiX,GAAmB9a,EAAUA,EAAS6D,MACtD7D,EAASvB,KAAOsc,KAChB/a,EAAS6P,MAAQmL,GAAoBhb,EAAUA,EAAS6P,MAAO/U,GACxDkF,CACT,CAEA,MAAM8a,GACJ,CAAC9a,EAAeib,IAAoDlK,IAC5D,MAOAmK,EAPgB,CAACrX,IACjB,IACK,OAAA,IAAIsX,IAAItX,GAAMuX,MAAA,CACf,MAAAjjB,GACC,MAAA,EACT,GAEuBkjB,CAActK,EAAKjP,QAAUwZ,OAAOC,SAASH,OAEtE,OADaH,EAAgBpN,KAAK7N,EAAU+Q,GAChC3P,QACV,OACA,sBAAuB8Z,EAA0D,GAAvC,wCAAyC,EAInFH,GACJ,IACA,EAAG1V,OAAMpB,WAED,MAAAuX,EAAYnW,GAAO,YACzB,IAAIoW,EAAYxX,EAShB,OARKqX,OAAeI,KACdF,GAAaF,OAAeI,KAAKC,YAAYH,KAC/CC,EAAaH,OAAeI,KAAKE,UAAUJ,EAAUvX,GAAM3L,OAG7DmjB,EAAYd,GAAW1W,GAIvB,aAAauX,mCACiBA,MAAaC,EAAUra,QAAQ,SAAU,qBAAI,EAK3E4Z,GACJ,CACEhb,EACA6b,GACEC,iBAEH/K,IACC,MAAM9P,EAAO4a,EAAiBhO,KAAK7N,EAAU+Q,GACzC,OAAC+K,EACe,WAAhBA,IAAqD,IAAxBA,EACxB7a,EAAKG,QAAQ,SAAU,yCACZ,aAAhB0a,EACK7a,EAAKG,QAAQ,SAAU,0BAA0BA,QAAQ,OAAQ,aACnEH,EALkBA,CAKlBA,ECzDP,IAAA8a,GACAC,GAAwB,GAE5B,MAAMC,GAA+B,CACnCpc,KAAK,EACLF,QAAQ,EACRD,OAAO,GAIF,SAASwc,KACP,OAAAH,EACT,CAiCA,SAAwB1I,GAAO5O,SAC7B,IAAI0X,EAAgB,OAAAhmB,EAAA+lB,WAAA,EAAA/lB,EAAe2Y,MAAMrK,GACpC0X,IAEHA,EAaJ,SAAsB1X,GACpB,OACEA,EAEGrD,QACC,kCACA,CAACgb,EAAG3d,IAAS,cAAckc,GAAWlc,oBAGvC2C,QAAQ,wBAAwB,CAACgb,EAAGC,EAAKC,IAAW,aAAaA,WAAgBD,UACjFjb,QACC,uBACA,CAACgb,EAAGnY,EAAMJ,IAAS,YAAYA,sBAAyBI,UAEzD7C,QAAQ,MAAO,OAEtB,CA7BoBmb,CAAa9X,IAG3B,IAAA+X,EAAO9C,GAASyC,GAOb,OAJGH,GAAA7N,SAASsO,IACO,mBAAbA,IAAyBD,EAAOC,EAASD,GAAI,IAGnDA,CACT,CC/DO,SAASE,MAAgBC,GACxB,MAAAC,EAAYnb,GAAaA,GAAsB,iBAARA,GAAoBA,EAAI1N,cAAgBgB,OAErF,OAAO4nB,EAAQ1nB,QAAO,CAAC4nB,EAAMpb,KAC3B1M,OAAOC,KAAY,MAAPyM,EAAOA,EAAA,CAAE,GAAE0M,SAAShZ,IAE9B,GAAY,cAARA,GAA+B,gBAARA,GAAiC,cAARA,EAClD,OAGI,MAAA2nB,EAAOD,EAAK1nB,GACZ4nB,EAAOtb,EAAItM,GAEb4D,MAAMC,QAAQ8jB,IAAS/jB,MAAMC,QAAQ+jB,GACvCF,EAAK1nB,GAAO2nB,EAAKzL,UAAU0L,GAClBH,EAASE,IAASF,EAASG,GACpCF,EAAK1nB,GAAOunB,GAAUI,EAAMC,GAE5BF,EAAK1nB,GAAO4nB,CACd,IAGKF,IACN,CAAE,EACP,CCpBO,MAAMG,GAOX,WAAAjpB,CAAsBkpB,GANKhpB,EAAAC,KAAA,WAAA,GACnBD,EAAAC,KAAA,iBACAD,EAAAC,KAAA,WAA0B,IAC1BD,EAAAC,KAAA,WAAyB,IACzBD,EAAAC,KAAA,QAEcA,KAAA+oB,OAAAA,CAAwC,CAE9D,UAAAC,GACE,OAAOhpB,KAAKipB,OACd,CAEA,UAAAC,CAAW1b,GACTxN,KAAKipB,QAAUzb,CACjB,CAEA,gBAAA2b,GACE,OAAOnpB,KAAKopB,aACd,CAEA,gBAAAC,CAAiB7b,GACfxN,KAAKopB,cAAgB5b,CACvB,CAKA,WAAAxH,GACE,OAAOhG,KAAKspB,QACd,CAEA,aAAAC,CAAc5mB,GACP3C,KAAA+oB,OAAOS,QAAQ,aAAc7mB,EACpC,CAEA,WAAA8mB,CAAYrjB,GACV,OAAOpG,KAAKspB,SAASI,MAAMxa,GAAMA,EAAE9I,KAAOA,GAC5C,CAEA,aAAAujB,GACE3pB,KAAKspB,SAAW,GAChBtpB,KAAK+oB,OAAOS,QAAQ,cAAexpB,KAAKspB,SAC1C,CAEA,YAAAM,CAAaC,GACN7pB,KAAA+oB,OAAOS,QAAQ,YAAaK,GAE5B7pB,KAAAspB,SAASta,QAAQ6a,GAEtB7pB,KAAK+oB,OAAOS,QAAQ,cAAexpB,KAAKspB,SAC1C,CAEA,aAAAQ,CAAc5jB,GACPlG,KAAAspB,SAASta,KAAK9I,GAEdlG,KAAA+oB,OAAOS,QAAQ,mBAAoBtjB,GACxClG,KAAK+oB,OAAOS,QAAQ,cAAexpB,KAAKspB,SAC1C,CAEA,aAAAjjB,CAAcH,GACZlG,KAAKspB,SAAWtpB,KAAKspB,SAAS9kB,KAAK0K,GAC7BA,EAAE9I,KAAOF,EAAQE,GAAWF,EACzBgJ,IAGJlP,KAAA+oB,OAAOS,QAAQ,kBAAmBtjB,GACvClG,KAAK+oB,OAAOS,QAAQ,cAAexpB,KAAKspB,SAC1C,CAEA,aAAAhjB,CAAcF,GACN,MAAAF,EAAUlG,KAAKspB,SAASI,MAAMxa,GAAMA,EAAE9I,KAAOA,IACnD,IAAKF,EAAS,MAAM,IAAI6E,MAAM,WAAW3E,eACpCpG,KAAAspB,SAAWtpB,KAAKspB,SAAS1kB,QAAQsK,GAAMA,EAAE9I,KAAOA,IAEhDpG,KAAA+oB,OAAOS,QAAQ,kBAAmBtjB,GACvClG,KAAK+oB,OAAOS,QAAQ,cAAexpB,KAAKspB,SAC1C,CAKA,WAAA5iB,GACE,OAAO1G,KAAK+pB,QACd,CAEA,cAAAC,CAAeD,GACb/pB,KAAK+pB,SAAWA,EAEhB/pB,KAAK+oB,OAAOS,QAAQ,mBAAoBxpB,KAAK+pB,SAC/C,CAKA,OAAAE,GACE,OAAOjqB,KAAKoH,IACd,CAEA,UAAAC,CAAW6iB,GACTlqB,KAAKoH,KAAO8iB,EAEPlqB,KAAA+oB,OAAOS,QAAQ,cAAeU,EACrC,EClHc,SAAAC,GAAmDC,EAAkB,IAC7E,MAAAC,EAAMC,SAASH,cAAc,OAEnC,OADIE,EAAAE,UAAYH,EAAQzb,OAChB0b,EAAIG,mBAAqBH,CACnC,CAOO,SAASI,GAAWnc,GACnB,MAAAoc,EAAOJ,SAASH,cAAc,OACpCO,EAAKC,UAAYrc,EAEV,OADQoc,EAAKH,SAEtB,CASO,SAASK,GAActf,GACtB,MAAA8C,EAAQ7B,OAAO,OAAOjB,aAAgByC,KAAKqZ,OAAOC,SAAS5T,QAC1D,OAAArF,GAASyc,mBAAmBzc,EAAM,GAAGlB,QAAQ,MAAO,KAC7D,CAEgB,SAAA4d,GAAUC,EAAiBC,GACnC,MAAAC,EAAsBC,IACpB,MAAAC,EAAOD,EAAQE,wBACfC,EAAajE,OAAOkE,aAAehB,SAASiB,gBAAgBF,WAC5DG,EAAYpE,OAAOqE,aAAenB,SAASiB,gBAAgBC,UAC1D,MAAA,CACLxZ,IAAKmZ,EAAKnZ,IAAMwZ,EAChBE,KAAMP,EAAKO,KAAOL,EAAA,EAIhBM,EAAWV,EAAmBF,GAChC,IAACC,EAAmB,OAAAW,EAElB,MAAAC,EAAmBX,EAAmBD,GAErC,MAAA,CACLhZ,IAAK2Z,EAAS3Z,IAAM4Z,EAAiB5Z,IACrC0Z,KAAMC,EAASD,KAAOE,EAAiBF,KAE3C,CAEgB,SAAAG,GAAaC,EAAiBC,GACxC,IAAAC,EAAcF,EAAQ/M,WACnB,KAAAiN,EAAYnd,OAASkd,GAC1BC,EAAc,IAAIA,IAEb,OAAAA,CACT,CAYO,SAASC,GAAQC,EAAYC,EAAMC,GAAWA,GAC/C,IACI,MAAAC,EAAUH,EAAKI,UAEfC,GADW,IAAIC,MAAOF,UACCD,EAEvBI,EAAO9Y,KAAK+Y,MAAMH,EAAa,OACrC,GAAa,IAATE,EAAY,CAER,MAAAE,EAASJ,EAAa,MACtBK,EAAQjZ,KAAK+Y,MAAMC,EAAA,MACzB,GAAc,IAAVC,EAAa,CAET,MAAAC,EAASF,OACTG,EAAUnZ,KAAK+Y,MAAMG,EAAA,KAC3B,GAAgB,IAAZC,EAAe,CAEX,MAAAC,EAASF,MACTG,EAAUrZ,KAAKsZ,MAAMF,EAAS,KACpC,OAAIC,EAAU,GAAWb,EAAG,OACrB,GAAGa,KAAWb,EAAG,YAC1B,CACA,MAAO,GAAGW,KAAWX,EAAG,YAC1B,CACA,MAAO,GAAGS,KAAST,EAAG,UACxB,CACA,OAAIM,EAAO,EAAUN,EAAG,OAEpBM,EAAO,EACF,GAAGA,KAAQN,EAAG,UAvCpB,SAAoBD,GACzB,MAAMgB,EAAOrB,GAAaK,EAAKiB,UAAW,GACpCC,EAASvB,GAAaK,EAAKmB,WAAa,EAAG,GAKjD,MAAO,GAJOxB,GAAaK,EAAKoB,cAAe,MAI5BF,KAAUF,GAC/B,CAkCWK,CAAWrB,SACXpoB,GAEA,OADP8G,QAAQ9G,MAAMA,GACP,KACT,CACF,CA4BA,SAAsB0pB,KAAsB,OAAAtrB,EAAAlC,KAAA,MAAA,YAC1C,MAAMytB,EAAQC,UAAUC,UACxB,IAAMD,UAAkBE,gBAAmBF,UAAkBE,cAAcC,qBAClE,OAAAJ,EAKT,MAAMK,EAAUJ,UAAkBE,cAClC,IAAIG,EAAa,KACb,IACFA,QAAcD,EAAOD,qBAAqB,CAAC,0BACpCrjB,GAEA,OADPI,QAAQ9G,MAAM0G,GACPijB,CACT,CACM,MAAAO,EAAuBC,OAAOF,EAAMG,gBAAgBzf,MAAM,KAAK,IAEjE,MAAoB,YAApBqf,EAAOK,UACLH,GAAwB,GAInBP,EAAMvgB,QAAQ,kBAAmB,mBAGpB,UAApB4gB,EAAOK,UACLH,GAAwB,GAKnBP,EAAMvgB,QACX,kCACA,YAAY6gB,EAAMG,gBAAgBhhB,QAAQ,MAAO,QAKhDugB,CACT,GAAA,CAGO,SAASW,GAAWC,GAErB,IAAA1W,EACA,IACIA,EAAA,IAAIsP,IAAIoH,SACPnG,GACA,OAAA,CACT,CACA,MAAwB,UAAjBvQ,EAAI2W,UAAyC,WAAjB3W,EAAI2W,QACzC,CAGO,SAASC,GAAiBhlB,GAC/B,OAI4B2B,EAJP3B,EAAKilB,KAImBlsB,EAJbiH,EAAKjH,KAK9B,GAAG4I,EAAQgC,QAAQ,MAAO,OAAO5K,EAAK4K,QAAQ,MAAO,MAD9C,IAAchC,EAAiB5I,CAH/C,CChMA,MAAMmsB,GAAK,CAETC,YAAa,kBACbC,UAAW,aACXC,KAAM,OACNC,OAAQ,UACRC,OAAQ,UACRC,KAAM,OACNC,KAAM,WACNvnB,MAAO,QACPkI,KAAM,UACNsf,SAAU,QACVC,QAAS,UACTC,YAAa,eACbC,WAAY,gBACZC,YAAa,oBACbC,YAAa,4BACbC,kBAAmB,uBACnBC,eAAgB,+CAGhBC,QAAS,mBACTC,WAAY,SACZC,WAAY,SACZC,SAAU,OACVC,WAAY,SACZC,YAAa,eACbC,aAAc,gBACdC,gBAAiB,0BACjBC,UAAW,QACXC,SAAU,YAGVC,MAAO,QACPC,MAAO,QACPC,OAAQ,KACRC,SAAU,OACVC,SAAU,cACVC,SAAU,YACVC,cAAe,UACfC,SAAU,WACVC,UAAW,YACXC,aAAc,kCACdC,OAAQ,SACRC,SAAU,WACVC,QAAS,UACTC,WAAY,sCACZ5jB,KAAM,OACN6jB,WAAY,cACZjvB,OAAQ,SACRkvB,cAAe,UACfC,IAAK,MACLC,MAAO,QAGPpE,QAAS,cACTF,QAAS,cACTF,MAAO,YACPH,KAAM,WACN4E,IAAK,WAGLC,WAAY,wBACZC,aAAc,iCACdC,QAAS,UACTC,OAAQ,SAGRC,UAAW,WACXC,WAAY,YAGZC,YAAa,UACbC,gBAAiB,yBACjBC,kBAAmB,2BACnBC,eAAgB,kBAChBC,cAAe,iBACfC,eAAgB,kBAChBC,gBAAiB,mBACjBC,iBAAkB,yBAClBC,iBAAkB,oBAClBC,WAAY,YACZC,aAAc,SACdC,YAAa,kBACbC,cAAe,0BACfC,SAAU,WACVC,SAAU,WACVC,SAAU,YACVC,WAAY,oBACZC,cAAe,0BACfC,mBAAoB,sDACpBC,sBAAuB,4DACvBC,oBAAqB,4DACrBC,QAAS,UACTC,MAAO,QAGPC,SAAU,WACVC,QAAS,UACTnK,QAAS,UACToK,SAAU,cACVC,QAAS,UACTC,SAAU,cACVC,SAAU,WACVC,WAAY,gBACZC,OAAQ,cACRC,WAAY,+CACZC,UAAW,0DACXC,eAAgB,kBAChBlQ,OAAQ,SACRmQ,KAAM,OACNC,SAAU,eC7GCC,GAAqB,aCQrBC,GAAW,CACtBxF,MACA,QAASA,GACT,QCXiB,CAEjBC,YAAa,UACbC,UAAW,YACXC,KAAM,KACNC,OAAQ,KACRC,OAAQ,KACRC,KAAM,KACNC,KAAM,KACNvnB,MAAO,KACPkI,KAAM,KACNsf,SAAU,KACVC,QAAS,KACTC,YAAa,OACbC,WAAY,OACZC,YAAa,OACbC,YAAa,UACbC,kBAAmB,UACnBC,eAAgB,gBAGhBC,QAAS,cACTC,WAAY,KACZC,WAAY,KACZC,SAAU,KACVC,WAAY,KACZC,YAAa,OACbC,aAAc,OACdC,gBAAiB,aACjBC,UAAW,SACXC,SAAU,OAGVC,MAAO,MACPC,MAAO,KACPC,OAAQ,KACRC,SAAU,KACVC,SAAU,OACVC,SAAU,OACVC,cAAe,OACfC,SAAU,KACVC,UAAW,MACXC,aAAc,gBACdC,OAAQ,KACRC,SAAU,KACVC,QAAS,KACTC,WAAY,aACZ5jB,KAAM,KACN6jB,WAAY,OACZjvB,OAAQ,KACRkvB,cAAe,OACfC,IAAK,KACLC,MAAO,OAGPpE,QAAS,KACTF,QAAS,MACTF,MAAO,MACPH,KAAM,KACN4E,IAAK,KAGLC,WAAY,gBACZC,aAAc,WACdC,QAAS,KACTC,OAAQ,KAGRC,UAAW,OACXC,WAAY,OAGZC,YAAa,OACbC,gBAAiB,QACjBC,kBAAmB,QACnBC,eAAgB,OAChBC,cAAe,OACfC,eAAgB,OAChBC,gBAAiB,OACjBC,iBAAkB,aAClBC,iBAAkB,MAClBC,WAAY,QACZC,aAAc,OACdC,YAAa,gBACbC,cAAe,QACfC,SAAU,KACVC,SAAU,MACVC,SAAU,MACVC,WAAY,OACZC,cAAe,YACfC,mBAAoB,uBACpBC,sBAAuB,oBACvBC,oBAAqB,2BACrBC,QAAS,KACTC,MAAO,KAGPC,SAAU,KACVC,QAAS,KACTnK,QAAS,MACToK,SAAU,OACVC,QAAS,MACTC,SAAU,OACVC,SAAU,MACVC,WAAY,OACZC,OAAQ,OACRC,WAAY,YACZC,UAAW,8BACXC,eAAgB,OAChBlQ,OAAQ,KACRmQ,KAAM,KACNC,SAAU,aD9FL,SAASG,GAAc/iB,GAQxB,OANJA,EAAOA,EAAKjE,QACV,8BACA,CAACgb,EAAGiM,EAAYC,IAAeD,EAAGrf,eAAiBsf,GAAM,IAAIC,gBAI3DJ,GAAS9iB,GACJ8iB,GAAS9iB,GAIdiW,OAAO4M,KAAuB5M,OAAO4M,IAAoB7iB,GACpDiW,OAAO4M,IAAoB7iB,GAK7B8iB,GAASxF,EAClB,CAKA,IAAI6F,GAA4B,KAC5BC,GAAmBL,GAAcI,IAK9B,SAASE,GAAU1sB,GACpBA,IAAWwsB,KACFA,GAAAxsB,EACbysB,GAA+B,iBAAXzsB,EAAsBosB,GAAcpsB,GAAUA,EACpE,CAKO,SAASqL,GAAElS,EAAe4b,EAAkC,IAC7D,IAAAvO,SAAMimB,aAAatzB,KAAQA,EAGxB,OAFDqN,EAAAA,EAAIpB,QAAQ,qBAAqB,CAACgb,EAAGhY,IAAU2M,EAAK3M,IAAU,KAE7DukB,GAAiBnmB,EAC1B,CE5CA,MAAqBomB,GAArB,WAAA70B,GACUE,EAAAC,KAAA,SAA8B,GAAA,CAK/B,EAAA20B,CACLrpB,EACAlB,EACAb,EAAqB,CAAA,GAErBvJ,KAAK+oB,OAAO/Z,KAAKxL,EAAA,CACf8H,OACAlB,WACGb,GAEP,CAKO,GAAAqrB,CAAgCtpB,EAASlB,GACzCA,IACLpK,KAAK+oB,OAAS/oB,KAAK+oB,OAAOnkB,QAAQiwB,KAAUA,EAAIvpB,OAASA,GAAQupB,EAAIzqB,UAAYA,KACnF,CAKO,OAAAof,CAAoCle,EAASwpB,GAClD90B,KAAK+oB,OACFvZ,MAAM,GACN5K,QAAQiwB,GAAQA,EAAIvpB,OAASA,GAA+B,mBAAhBupB,EAAIzqB,UAChD6P,SAAS4a,IACJA,EAAIE,MAAM/0B,KAAK40B,IAAItpB,EAAMupB,EAAIzqB,SACjCyqB,EAAIzqB,QAAQ0qB,EAAQ,GAE1B,ECvDF,MAAMxX,GAAyB,CAC7ByN,GAAI,GACJiK,QAAS,GACTC,UAAW,GACXC,OAAQ,GACRjtB,KAAM,GAENymB,YAAa,GACbC,UAAW,GACXwG,QAAS,GACTC,UAAU,EACVC,cAAc,EAEdC,SAAU,OACVC,QAAS,EACTC,SAAU,WAEVC,UAAW,mEAEXrsB,MAAM,EACNknB,UAAU,EACVoF,SAAS,EACTC,UAAU,EACVzG,SAAS,EACT0G,QAAS,wBACTC,KAAM,mBACNC,gBAAiB,gBAEjBC,SAAU,CACRC,OAAQ,mCACRrzB,OAAQ,uBAGVszB,WAAY,CACVC,SAAU,GACV1F,UAAU,EACV2F,UAAU,GAGZC,YAAa,CACX9a,QAAS,IACT+a,SAAU,IACVC,YAAY,GAGdC,WAAW,EACXC,WAAY,KACZC,cAAc,EACdC,gBAAgB,EAEhB5uB,OAAQ,MClCM,SAAA6uB,GAAiBC,EAAmCC,GAAO,GAEzE,MAAMtwB,EAA8BswB,EAAOrO,GAAUsO,GAAUF,GAAcA,EAG7E,GAAIrwB,EAAKwkB,IAAyB,iBAAZxkB,EAAKwkB,GACrB,IACF,MAAMgM,EAASzM,SAAS0M,cAA2BzwB,EAAKwkB,IACxD,IAAKgM,EAAQ,MAAMhsB,MAAM,mBAAmBxE,EAAKwkB,sBACjDxkB,EAAKwkB,GAAKgM,QACH9yB,GAED,MADN2G,QAAQ9G,MAAMG,GACR,IAAI8G,MAAM,wCAClB,CAqBK,MAjBc,KAAjBxE,EAAKyuB,UAAgBzuB,EAAKyuB,QAAU,GAAG5N,OAAOC,SAAS4P,YAGpC,KAAnB1wB,EAAK0uB,cAAuBA,UAAY,GAAG3K,SAASxa,SAGpDvJ,EAAK2uB,SAAa3uB,EAAA2uB,OAAS3uB,EAAK2uB,OAAOhoB,QAAQ,MAAO,IAAIA,QAAQ,YAAa,KAG/D,SAAhB3G,EAAKuB,SAAmBvB,EAAKuB,OAAS4lB,UAAUwJ,UAG9B,SAAlB3wB,EAAK+uB,WAAqB/uB,EAAK+uB,SAAWlO,OAAO+P,WAAW,sBAAsB5S,SAG1D,iBAAjBhe,EAAKgvB,SAAwBtH,OAAO1nB,EAAKgvB,UAAY,IAAGhvB,EAAK+uB,UAAW,GAE5E/uB,CACT,CA4CgB,SAAA6wB,GAAkB7wB,EAA6B8wB,GACtD,MAAA,CACLnsB,QAAS,GAAG3E,EAAK2uB,gBACjBoC,SAAU/wB,EAAK0B,MAAQ,GACvB+sB,QAASzuB,EAAKyuB,SAAW,GACzBC,UAAW1uB,EAAK0uB,WAAa,GAC7BsC,QAAShxB,EAAKiwB,WACd9sB,YAAa,IAAW,MAAL2tB,OAAK,EAAAA,EAAA11B,IAAI,QAAQ61B,UAAUtnB,MAC9C7E,UAAU,MAAAgsB,OAAA,EAAAA,EAAK11B,IAAI,QAAQ81B,yBACvB,CACEnsB,KAAM,MAAA+rB,OAAA,EAAAA,EAAK11B,IAAI,QAAQ61B,UAAUlsB,KACjC7D,MAAO,MAAA4vB,OAAA,EAAAA,EAAK11B,IAAI,QAAQ61B,UAAU/vB,YAEpC,EACJuC,SAAe,MAALqtB,OAAK,EAAAA,EAAAK,iBAEnB,CC/GgB,SAAAC,GACdN,EACAv2B,EACA82B,GAWA,IAAIC,EAAe,KACnB,MAAMztB,EAAU,KACd,MAAM0tB,EAVI,MACJ,MAAAvxB,EAAO8wB,EAAIU,UACXC,EAAW,CAAA,EAIV,OAHFl3B,EAAAmZ,SAAShZ,IACR+2B,EAAA/2B,GAAOsF,EAAKtF,EAAG,IAEd+2B,CAAA,EAIQxqB,GAXC,IAACqX,EAAQhP,GAYC,MAAXgiB,IAZEhT,EAY4BgT,EAZpBhiB,EAY6BiiB,IAZlBn3B,KAAKC,UAAUikB,KAAOlkB,KAAKC,UAAUiV,QAe7DgiB,EAAAC,EACVF,EAAOE,GACT,EAEET,EAAA1C,GAAG,UAAWvqB,GACditB,EAAA1C,GAAG,UAAWvqB,EACpB,CCGA,MAAM6tB,GAUJ,WAAAp4B,CAAY0G,GARZxG,EAAAC,KAAA,QACAD,EAAAC,KAAA,QACAD,EAAAC,KAAA,SAGQD,EAAAC,KAAA,SAAS,IAAI00B,IACH30B,EAAAC,KAAA,WAAA,GA6BwBD,EAAAC,KAAA,cAAA,MAuC1CD,EAAAC,KAAA,iBAAiBA,KAAKk4B,iBACtBn4B,EAAAC,KAAA,qBAAqBA,KAAKgG,aAlExBhG,KAAKuG,KAAOA,EAEZvG,KAAKm4B,MAAQ5xB,EAAKwkB,GACb/qB,KAAAm4B,MAAMC,UAAUC,IAAI,UACzBr4B,KAAKm4B,MAAM5N,UAAY,GACvBhkB,EAAK6uB,UAAYp1B,KAAKm4B,MAAMC,UAAUC,IAAI,iBAE1Cr4B,KAAKQ,KAAO,IAAIsoB,GAAY9oB,KAAK+oB,QAE5B/oB,KAAA20B,GAAG,WAAW,KACjB30B,KAAKs4B,SAAU,CAAA,GAEnB,CAEA,MAAAC,CAAOC,EAAiBjrB,GACtBvN,KAAKw4B,GAAWjrB,CAClB,CAEA,GAAA5L,CAAI62B,GACF,OAAOx4B,KAAKw4B,EACd,CAEA,MAAAC,GACE,OAAO,IAAIztB,EAAIosB,GAAkBp3B,KAAKuG,KAAMvG,MAC9C,CAGA,cAAA03B,GAEE,OADK13B,KAAK04B,cAAkB14B,KAAA04B,YF6CzB,SAA8BrB,GACnC,MAAMsB,EG9FD,WACL,MAAM3uB,EAAyB,GACxB,MAAA,CACLquB,IAAK,CAACluB,EAAQC,KACZJ,EAASgF,KAAK,CAAE7E,SAAQC,WAAS,EAEnCwuB,OAASzuB,IACP,MAAMiN,EAAQpN,EAAS6uB,WAAWF,GAAMA,EAAExuB,SAAWA,KACvC,IAAViN,GAAuBpN,EAAA+E,OAAOqI,EAAO,EAAC,EAE5CzV,IAAK,IAAMqI,EAEf,CHkFY8uB,GAIH,OAHPH,EAAEN,IAAI,gBAAiBL,GAAQX,EAAI0B,aAAaf,KAChDW,EAAEN,IAAI,cAAc,IAAMhB,EAAI2B,WAAW,CAAE,KAEpCL,CACT,CEnD8CM,CAAqBj5B,OACxDA,KAAK04B,WACd,CAEA,OAAAlB,GACE,OAAOx3B,KAAKQ,IACd,CAEA,YAAA04B,CAAaC,EAA0BC,GAChCp5B,KAAAq5B,OAAOC,SAASH,EAAaC,EACpC,CAEA,WAAAG,CAAYJ,EAA0BC,GAC/Bp5B,KAAAq5B,OAAOG,eAAeL,EAAaC,EAC1C,CAEA,KAAAj5B,CAAMwC,GACC3C,KAAAQ,KAAK+oB,cAAc5mB,EAC1B,CAEA,MAAA82B,GACEz5B,KAAKQ,KAAK+oB,cAAc,CAAElb,OAAQ,GACpC,CAGA,aAAAqrB,GACO15B,KAAA+oB,OAAOS,QAAQ,kBACtB,CAEA,eAAA0O,GACS,OAAAl4B,KAAKuS,KAAK2lB,iBACnB,CAEA,WAAAlyB,GACS,OAAAhG,KAAKQ,KAAKwF,aACnB,CAMA,iBAAA2zB,GACE35B,KAAKq5B,OAAOO,aACd,CAEA,iBAAAC,GACE75B,KAAKq5B,OAAOS,aACd,CAEA,gBAAAC,CAAiBpvB,EAAKpI,GACfvC,KAAAq5B,OAAOW,WAAWrvB,EAAKpI,EAC9B,CAEA,gBAAA03B,GACEj6B,KAAKq5B,OAAOa,YACd,CAGA,WAAAC,CAAYrF,GACL90B,KAAAo6B,aAAaC,KAAKvF,EACzB,CAEA,WAAAwF,GACEt6B,KAAKo6B,aAAaG,MACpB,CAGA,UAAAvB,CAAWlE,GACF,OAAA90B,KAAKw6B,gBAAgBxB,WAAWlE,EACzC,CAEA,YAAAiE,CAAajE,GACJ,OAAA90B,KAAKw6B,gBAAgBzB,aAAajE,EAC3C,CAGA,EAAAH,CAAGrpB,EAAWlB,GACPpK,KAAA+oB,OAAO4L,GAAGrpB,EAAMlB,EACvB,CAEA,GAAAwqB,CAAItpB,EAAWlB,GACRpK,KAAA+oB,OAAO6L,IAAItpB,EAAMlB,EACxB,CAEA,OAAAof,CAAQle,EAAWwpB,GACZ90B,KAAA+oB,OAAOS,QAAQle,EAAMwpB,EAC5B,CAGA,EAAA3I,CAAGlrB,EAAoB4b,EAAkC,IAChD4d,OAAAA,GAAOx5B,EAAK4b,EACrB,CAEA,WAAA6d,CAAYtF,GACLp1B,KAAA26B,WAAW,CAAEvF,YACpB,CAEA,UAAAuF,CAAWC,GACT56B,KAAKuG,KAAOiiB,GAAUxoB,KAAKuG,KAAMowB,GAAiBiE,GAAO,IACzD56B,KAAKs4B,SAAWt4B,KAAK+oB,OAAOS,QAAQ,UAAWxpB,KAAKuG,KACtD,CAEA,OAAAwxB,GACE,OAAO/3B,KAAKuG,IACd,CAEA,KAAAs0B,GACE,OAAO76B,KAAKm4B,KACd,CAEA,SAAA2C,GACE,OAAOC,IACT,CAEA,SAAApD,CACE72B,EACA82B,GAEUD,GAAA33B,KAAMc,EAAM82B,EACxB,EEzLc,SAAAgC,GAAYoB,EAAyBz0B,GAE/C,IAAA00B,EAAWD,EAAWhE,cAA2B,yBAChDiE,IACQC,EAAAA,GACT,+PAMQ,MAAN30B,OAAM,EAAAA,EAAA40B,iBAAwBF,EAAA1V,MAAM6V,WAAa,eACrDJ,EAAWK,YAAYJ,IAEzBA,EAAS1V,MAAM+V,QAAU,GAGnB,MAAAC,EAAWN,EAASjE,cAA2B,wBACjDuE,IACFA,EAAShW,MAAM+V,QAAU,OACzBlU,OAAOoU,YAAW,KACZD,EAASE,cAAsBF,EAAAhW,MAAM+V,QAAU,GAAA,GAClD,KAEP,CAGO,SAASxB,GAAYkB,GACpB,MAAAC,EAAWD,EAAWhE,cAA2B,yBACnDiE,IAAmBA,EAAA1V,MAAM+V,QAAU,OACzC,CAGgB,SAAApS,GAAW1b,EAAcwtB,GACnCxtB,KAAiBwtB,MACJA,EACnB,CAiBO,SAASU,GACdC,EACAC,GAAsB,EACtB5Q,GAEI,IAAAhZ,EAEJ,GAAIgZ,EAAY,CACR,MAAA6Q,EAAgB7Q,EAAWI,wBAG/BpZ,EAFkB2pB,EAAKvQ,wBAEXpZ,IACZ6pB,EAAc7pB,IACdgZ,EAAWQ,UACXR,EAAW8Q,aAAe,EAC1BH,EAAKG,aAAe,CAAA,KACjB,CACC,MAAA3Q,EAAOwQ,EAAKvQ,wBAElBpZ,EADgBmZ,EAAKnZ,IAAMoV,OAAO2U,SACjB3U,OAAO4U,YAAc,EAAI7Q,EAAK8Q,OAAS,EAC1D,CAEA,MAAMC,EAAiC,CACrClqB,MACA0Z,KAAM,EAENyQ,SAAU,WAGRnR,EAAuBA,EAAAoR,OAAOF,GAC7B9U,OAAOgV,OAAOF,EACrB,CAgDgB,SAAAG,GAAeV,EAAmBW,IAZ3C,SAAsBX,EAAmBW,EAAoB/5B,EAAqB,MACvFo5B,EAAKvD,UAAUC,IAAI,YAAY91B,KAE/B,MAAMg6B,EAAc,KAClBZ,EAAKvD,UAAUQ,OAAO,YAAYr2B,KAC7Bo5B,EAAAa,oBAAoB,eAAgBD,EAAW,EAGjDZ,EAAAc,iBAAiB,eAAgBF,EACxC,CAIeG,CAAAf,EAAMW,EAAO,KAC5B,CAQO,SAASK,GACd3B,EACAjuB,EACA+C,EAAgB,qDAEZ,IAAA6rB,EAAOX,EAAWhE,cAA2B,oBACjD,GAAa,OAATjqB,EAEF,YADa,OAAT4uB,GAAeA,EAAK/C,UAGrB+C,IACIT,EAAAA,GACL,gCAAgCprB,+CAElCkrB,EAAWK,YAAYM,IAGnB,MAAAiB,EAAcjB,EAAK3E,cAA2B,mBACpD4F,EAAYrS,UAAY,GACX,OAATxd,IAEAA,aAAgB8vB,YAClBD,EAAYvB,YAAYtuB,GAExB6vB,EAAYjS,UAAY5d,EAE5B,CC/IO,SAAS+vB,GAAWC,GACnB,MAAAC,EAAc9B,GAAoB,+CAClC+B,EAAU/B,GACd,0FAEF+B,EAAQ1X,MAAM+V,QAAU,OACxB4B,GAAeF,EAAa,CAAE7B,eAAe,IAC7C8B,EAAQ1sB,IAAMwsB,EAAQI,UAAUC,sBAChCH,EAAQI,OAAS,KACfJ,EAAQ1X,MAAM+V,QAAU,GACxBgC,GAAeN,EAAW,EAE5BA,EAAY77B,OAAO87B,GAEnB,MAAMM,EAAYrC,GAChB,4EAEF8B,EAAY77B,OAAOo8B,GAEnBR,EAAQS,oBAGR,IAAIC,GAAO,EA6BJ,OAtBN,SAAgBC,IAAc,OAAAx7B,EAAAlC,KAAA,MAAA,YANjB,IAAC29B,EAQb,SARaA,EAOD,IANZ,IAAItzB,SAASC,IACX8c,OAAOoU,YAAW,KAChBlxB,EAAQ,KAAI,GACXqzB,EAAE,KAIHF,EAAM,OACV,IAAIG,GAAS,EACT,IAEFA,SADmBb,EAAQtE,SAASoF,QAAQ/3B,oBAC9BtF,KAAKs9B,OAAA,CACb,MAAA75B,GACG25B,GAAA,CACX,CACIA,EACFb,EAAQgB,oBAGV,IAdD,GAiBDR,EAAUS,QAAU,KACXP,GAAA,EACPV,EAAQtL,QAAO,EAGVuL,CACT,CC9EA,MAAMiB,GAA0B,CAC9B54B,QAAA,CAAQ03B,EAASmB,IACRnB,EAAQtE,SAASoF,QAAQ93B,cAAc,CAC5C3B,MAAO85B,IAIX97B,KAAK26B,GACCA,EAAQp7B,IAAI,UAAkBw8B,GAAkBpB,GDLjD,SAAiBA,GAEtB,MAAMpB,EAAOT,GACX,2CAA2C6B,EAAQp7B,IAAI,aAAe,OAAOwqB,GAAG,0BAgB3E,OAZPwP,EAAK3E,cAA2B,oBAAqBgH,QAAU,KACvD,MAAAI,EAAQzC,EAAK3E,cAAc,oBACjC+F,EACGtE,SACAoF,QAAQh4B,aACRnC,MAAMs0B,IACLoG,EAAOC,aAAa,MAAOrG,EAAIx3B,KAAK89B,SAAQ,IAE7Ct6B,OAAOwG,IACEI,QAAA9G,MAAM,+BAAgC0G,EAAG,GAClD,EAEEmxB,CACT,CCdW4C,CAAexB,GAGxB,SAAAyB,CAAUzB,EAASv8B,EAAM09B,EAAUO,GACzB1B,EAAAj7B,IAAI,MAAOo8B,EACrB,EAEA,OAAArf,CAAQke,EAASvyB,EAAK0zB,EAAUO,GACvBA,EAAAzH,cAA2B,oBAAqB0H,QAChDD,EAAAzH,cAAgC,sBAAuB5yB,MAAQ,EACxE,GClBIu6B,GAA2C,CAC/CC,UAAW,WAEL,OAAAv5B,CAAQ03B,EAASmB,GAAU,OAAAh8B,EAAAlC,KAAA,MAAA,YAC/B,aACQ+8B,EAAQtE,SAAS7vB,KAAKD,MAAM,CAChC2C,KAAMyxB,EAAQt0B,UAAU+uB,UAAUlsB,KAClC7D,MAAOs1B,EAAQt0B,UAAU+uB,UAAU/vB,MACnCgrB,SAAUyL,KAEZ19B,IACJ,GAAA,EAEA4B,KAAK26B,GACI7B,GAAoB,SAAS/O,GAAG,wBAGzC,SAAAqS,CAAUzB,EAAS/E,EAAKkG,EAAUO,GACxB1B,EAAAt0B,UAAUo2B,OAAO,CACvBC,UAAU,EACV5uB,MAAO8nB,EAAI9nB,QAEL6sB,EAAAI,UAAU4B,UACpB,EAEA,OAAAlgB,CAAQke,EAASvyB,EAAK0zB,EAAUO,GAAS,GCrB3C,MAAqBO,GAKnB,WAAAn/B,CAAYo/B,GAJLl/B,EAAAC,KAAA,OACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,YAGLA,KAAKk/B,IAAMhE,GACT,6NASFl7B,KAAKm/B,SAAWn/B,KAAKk/B,IAAIlI,cAA2B,6BAGpDh3B,KAAKo/B,SAAWp/B,KAAKk/B,IAAIlI,cAAc,6BAClCh3B,KAAAo/B,SAAS/D,YAAY4D,EAC5B,CAGO,MAAAI,CAAOj1B,GACZ,MAAMk1B,EAAMpE,GACV,iCAAiC/O,GAAG,uBAK/B,OAHHmT,EAAAtB,QAAUh+B,KAAKu/B,WAAWn1B,GACzBpK,KAAAm/B,SAAS9D,YAAYiE,GAEnBt/B,IACT,CAGO,KAAAw/B,CAAMp1B,GACX,MAAMk1B,EAAMpE,GACV,gCAAgC/O,GAAG,sBAK9B,OAHHmT,EAAAtB,QAAUh+B,KAAKu/B,WAAWn1B,GACzBpK,KAAAm/B,SAAS9D,YAAYiE,GAEnBt/B,IACT,CAEQ,UAAAu/B,CAAWn1B,GACjB,OAAQyqB,IACN,MAAMzO,EAAKhc,EAAQyqB,EAAI4K,cAA8Bz/B,WAC1C,IAAPomB,IAA2B,IAAPA,GACtBpmB,KAAKk/B,IAAItG,QACX,CAEJ,ECjCF,SAAS8G,GAAuD/Z,GAC9D,OAAQmP,GACN,IAAIzqB,SAAc,CAACC,EAAS2U,KAC1B,MAAM0gB,EAAW7K,EAAQ8K,SACzB9K,EAAQ8K,SAAW,KACjBD,GAAYA,IACL1gB,EAAA,IAAIlU,MAAM,6BAA4B,EAE/C,MAAM80B,EAAY/K,EAAQ0J,UAC1B1J,EAAQ0J,UAAY,KAClBqB,GAAaA,SAGfla,EAAGmP,EAAO,GAEhB,CAKA,MAAqBgL,GACnB,WAAAjgC,CAAoB0J,GAEqDxJ,EAAAC,KAAA,eAAA0/B,IAAaK,IACpF//B,KAAKggC,KAAK/B,GAAgB8B,GAAI1I,IACxBA,EAAAv1B,IAAI,WAAYi+B,EAAEzB,UAClBjH,EAAAv1B,IAAI,SAAUi+B,EAAEjb,OAAM,GAC3B,KAG6D/kB,EAAAC,KAAA,aAAA0/B,IAAaK,IACtE//B,KAAAggC,KAAKrB,GAAcoB,EAAC,KAVP//B,KAAAuJ,KAAAA,CAA+B,CAa5C,IAAAy2B,CAAKjD,EAAkBjI,EAAyBmL,GAErD,MAAMC,EAAQlgC,KAAKuJ,KAAK42B,SAASx+B,IAAI,gBAAgBwX,OAAO,gBAAeqT,MAAOF,aAClF4T,EAAM7F,OAEN,MAAM+F,EAAQ,KACZF,EAAMG,SAAQ,EAIVC,EAA6B,CAAA,EACnC,IAAI9C,GAAoB,EACxB,MAAM+C,EAAyB,CAC7Bz+B,IAAK,CAACb,EAAKuM,KACT8yB,EAAar/B,GAAOuM,CAAA,EAEtB7L,IAAMV,GAAQq/B,EAAar/B,GAC3Bk8B,QAAS,IAAMn9B,KAAKuJ,KACpBd,QAAS,IAAMzI,KAAKuJ,KAAK42B,SAASx+B,IAAI,QACtC82B,OAAQ,IAAMz4B,KAAKuJ,KAAKkvB,SACxB+E,kBAAmB,KACGA,GAAA,CAAA,EAEtBO,eAAgB,SAEVhB,EAAQyB,WAAWzB,EAAQyB,UAAU+B,EAAY,GAAI,GAAI9B,GACzD3J,EAAQ0J,WAAW1J,EAAQ0J,WAAU,EAE3C/M,OAAQ,SAEFqD,EAAQ8K,UAAU9K,EAAQ8K,UAAS,GAIvCK,KAAmBM,GAGjB,MAAA9B,EAASvD,KACfuD,EAAOpD,YAAY0B,EAAQ36B,KAAKm+B,IAGhC,MAAMC,EAAStF,GACb,2BAA2B6B,EAAQ6B,WAAa,uDAc9C,IAAA6B,EAZJhC,EAAOpD,YAAYmF,GACnBhF,YAAW,IAAMgF,EAAOE,SAAS,IAG1BF,EAAAG,QAAW9L,IACA,UAAZA,EAAI5zB,KAAmC,KAAhB4zB,EAAI+L,UAE7B/L,EAAIgM,iBACJX,EAAMrF,QAAQ7D,cAAiC,iCAAkC0H,QACnF,EAII,MAAAoC,EAAS,IAAI9B,GAAOP,GAGnBqC,EAAAzB,QAAQ0B,IACP,MAAA7C,EAAWsC,EAAOp8B,MAAMuK,OAGzB8xB,IAAYA,EAAaM,EAAMpW,WAC9B,MAIAqW,EAAiB,KACrBD,EAAMpW,UAAY8V,GAAc,GAC1BM,EAAA3I,UAAUQ,OAAO,QAAO,EA6BzB,OA1BPmI,EAAMpW,UAAY,GAAGwB,GAAG,gBAGxB4Q,EACG13B,QAAQk7B,EAAYrC,GACpBx6B,MAAMlD,QAIDu8B,EAAQyB,WAAWzB,EAAQyB,UAAU+B,EAAY//B,EAAM09B,EAAUO,GACjE3J,EAAQ0J,WAAW1J,EAAQ0J,WAAU,IAE1Cx6B,OAAOwG,IArBS,IAACy2B,IAuBL9gB,OAAO3V,EAAIE,SAAWyV,OAAO3V,IAtB1Cu2B,EAAMpW,UAAYsW,EACZF,EAAA3I,UAAUC,IAAI,SAuBd0E,EAAQle,SAASke,EAAQle,QAAQ0hB,EAAY/1B,EAAK0zB,EAAUO,GAGhE,MAAMyC,EAAK1F,YAAW,IAAMwF,KAAkB,KAC9CR,EAAOW,QAAU,SAEfC,aAAaF,EAAE,CAAA,KAId,CAAA,IAITJ,EAAOtB,OAAM,SAEP1K,EAAQ8K,UAAU9K,EAAQ8K,YACvB,KAGLpC,IACFgD,EAAOjb,MAAM+V,QAAU,OACvBwF,EAAO5B,IAAIlI,cAA2B,6BAA8BzR,MAAM+V,QAAU,QAItF4E,EAAMrF,QAAQ15B,OAAO2/B,EAAO5B,KAGxBpK,EAAQuM,SAAiBvM,EAAAuM,QAAQP,EAAO5B,IAC9C,ECnLF,MAA8BoC,GAMrB,WAAAzhC,CAAmBw3B,GALnBt3B,EAAAC,KAAA,OAKmBA,KAAAq3B,IAAAA,CAAkB,CAJ5C,QAAW9wB,GACT,OAAOvG,KAAKq3B,IAAI9wB,IAClB,CAIA,KAAAs0B,GACE,OAAO76B,KAAKk/B,GACd,ECZa,MCGTqC,GAAM,CACVC,QAAS,cACTC,MAAO,4BACPC,OAAQ,6BACRC,MAAO,4BACPC,cAAe,qBACfC,UAAW,gBACXC,QAAS,cACTC,WAAY,gBACZC,YAAa,mBACbC,YAAa,mBACbC,WAAY,kBACZC,aAAc,qBACdC,eAAgB,wBCTlB,MAAMC,GAOJ,WAAAxiC,CAAsByiC,GANtBviC,EAAAC,KAAA,QACAD,EAAAC,KAAA,UAEAD,EAAAC,KAAA,yBAGsBA,KAAAsiC,IAAAA,CAAe,CAGrC,MAAAC,CAAOx1B,EAAe,eAEpB,OADA/M,KAAKwiC,KAAOtH,GAAoB,8BAA8BnuB,YACvD/M,KAAKwiC,IACd,CAGA,QAAAC,CAAS11B,EAAe,eAEtB,OADK/M,KAAA0iC,OAASxH,GAAoBnuB,GAC3B/M,KAAK0iC,MACd,CAGA,qBAAAC,CAAsBC,GACpB5iC,KAAK6iC,mBAAqBD,CAC5B,CAGA,YAAAE,CAAaF,GACX5iC,KAAKsiC,IAAIS,YAAYpO,GAAG,cAAeqO,IACjCA,IAAUhjC,YAElB,CAGA,YAAAijC,CAAaL,GACX5iC,KAAKsiC,IAAIS,YAAYpO,GAAG,cAAeqO,IACjCA,IAAUhjC,YAElB,CAGA,oBAAAkjC,CAAqBC,EAAwBC,GAC3CpjC,KAAKqjC,sBAAwBF,EAC7BnjC,KAAKsjC,kBAAoBF,CAC3B,EChDF,MAAqBG,WAAclB,GAAnC,WAAAxiC,GAAAqF,SAAAC,WACoBpF,EAAAC,KAAA,WAAA,EAAA,CAElB,IAAAwjC,CAAKC,GACH,GAAIzjC,KAAK0jC,QAAS,OAClB1jC,KAAK0jC,SAAU,EAEf,MAAMC,EAAW3jC,KAAKsiC,IAAIsB,QAAQ1E,IAEzByE,EAAArH,MAAMpB,GAAoB,sDAE7B,MAAA2I,EAAe3I,GAAoB,eACzCuI,EAAQnH,MAAMuH,GACdA,EAAaC,YAAYH,GAEhBA,EAAAvL,UAAUC,IAAI,eACdsL,EAAAvL,UAAUC,IAAI,mBACzB,CAEA,IAAA0L,SACO/jC,KAAK0jC,UACV1jC,KAAK0jC,SAAU,EACf,OAAAzhC,EAAAjC,KAAKsiC,IACF0B,eACA7L,MAAMnB,cAAc,oCAFvB/0B,EAGI6hC,YAAY9jC,KAAKsiC,IAAIsB,QAAQ1E,KACjCl/B,KAAKsiC,IAAIsB,QAAQ1E,IAAI9G,UAAUQ,OAAO,oBACxC,ECzBF,MAAqBqL,GACnB,WAAApkC,CAAoBw5B,GAEat5B,EAAAC,KAAA,YAAA,UACaD,EAAAC,KAAA,iBAAA,MAH1BA,KAAAq5B,OAAAA,CAAiB,CAMrC,GAAA13B,GACE,OAAO3B,KAAKkkC,SACd,CAQA,OAAOl0B,EAAoB8kB,iBAWrB,GATA90B,KAAKmkC,iBACPnkC,KAAKmkC,iBACLnkC,KAAKmkC,eAAiB,KAGtB,OAAAhiC,EAAA,OAAAF,EAAAjC,KAAKq5B,OAAO+K,iBAAY,EAAAniC,EAAAN,IAAI4hC,MAAQphC,EAAA4hC,QAIxB,WAAV/zB,GAAsB8kB,EAAS,CAEjC,IAAIuP,EAAcvP,EAAQsE,SACrBp5B,KAAKq5B,OAAO9yB,KAAK+uB,WACN+O,EAAAA,EAAYrN,cAA2B,gBACvD,OAAAsN,EAAA,OAAAA,EAAAtkC,KAAKq5B,OAAO+K,mBAAZE,EAAwB3iC,IAAI4hC,MAA5BgB,EAAoCf,KAAKa,GAEnC,MAAAG,EACJxkC,KAAKq5B,OAAOhC,IAAI9wB,KAAKk+B,kBAAoBzkC,KAAKq5B,OAAOhC,IAAI9wB,KAAKk+B,mBAChEC,GAAkB1kC,KAAKq5B,OAAOsL,QAAQzF,KAAK,EAAMsF,GAE3C,MAAAI,EAAS,OAAAC,EAAK7kC,KAAAq5B,OACjB+K,iBACC,EAAAS,EAAAT,WACD1a,MAAMqW,GAAMA,EAAEsD,wBAA0BrzB,IACvC40B,GAAUA,EAAOtB,oBACnBtjC,KAAKmkC,eAAiBS,EAAOtB,kBAAkBxO,EAAQ5uB,SAE3D,CAGAlG,KAAKkkC,UAAYl0B,CACnB,EChDF,MAAM80B,WAAexD,GAcnB,WAAAzhC,CAAYw3B,GACVnyB,MAAMmyB,GAdAt3B,EAAAC,KAAA,MACAD,EAAAC,KAAA,SAgBNA,KAAK+kC,GJKF,WACC,MAAA7F,EAAMhE,GD/BC,qwBCgCP6J,EAAK,CAAE7F,OAIN,OAHAr+B,OAAAmkC,QAAQzD,IAAKtnB,SAAQ,EAAEoB,EAAG4pB,MAC/BF,EAAG1pB,GAAK6jB,EAAIlI,cAAciO,EAAG,IAExBF,CACT,CIZcG,GACLllC,KAAAk/B,IAAMl/B,KAAK+kC,GAAG7F,IAGdl/B,KAAAgQ,MAAQ,IAAIi0B,GAAmBjkC,KACtC,CAnBA,KAAA2kC,GACE,OAAO3kC,KAAK+kC,EACd,CACA,QAAAX,GACS,OAAApkC,KAAKq3B,IAAI11B,IAAI,cACtB,CACA,QAAAwjC,GACS,OAAAnlC,KAAKgQ,MAAMrO,KACpB,CAaA,iBAAAyjC,GACE,MAAO,CAAE95B,KAAMtL,KAAK+kC,GAAGtD,MAAOh6B,MAAOzH,KAAK+kC,GAAGrD,OAAQ/xB,KAAM3P,KAAK+kC,GAAGpD,MACrE,CAEA,eAAA0D,GACM,IAAA/pB,EAAUtb,KAAKslC,gBAGb,MAAAC,EAAQvlC,KAAKokC,WAGZ,OAFHmB,IAAOjqB,EAAUiqB,EAAMC,sBAAsBlqB,IAE1CA,CACT,CAEA,aAAAgqB,GACS,OAAAtlC,KAAK+kC,GAAGlD,UAAUz9B,OAAS,EACpC,CAEA,gBAAAqhC,GACS,OAAAtmB,GAAOnf,KAAKqlC,kBACrB,CAEA,UAAAK,CAAWl4B,SACJxN,KAAA+kC,GAAGlD,UAAUz9B,MAAQoJ,EAG1B,OAAAvL,EAAAjC,KAAKokC,aAAYniC,EAAA0jC,YAAYnc,QAAQ,kBAAmBhc,EAC1D,CAEA,aAAAo4B,CAAcp4B,GACZ,GAAK8c,SAAiBub,UACf7lC,KAAA+kC,GAAGlD,UAAUnB,QACCpW,SAAAub,UAAUC,cAAc/1B,KAAOvC,EAC7CxN,KAAA+kC,GAAGlD,UAAUnB,aAAM,GACf1gC,KAAK+kC,GAAGlD,UAAUkE,gBAAuD,IAArC/lC,KAAK+kC,GAAGlD,UAAUkE,eAAsB,CAC/E,MAAAC,EAAShmC,KAAK+kC,GAAGlD,UAAUkE,eAC3BE,EAAOjmC,KAAK+kC,GAAGlD,UAAUqE,aACzBC,EAAKnmC,KAAK+kC,GAAGlD,UAAUrW,UACxBxrB,KAAA0lC,WACH1lC,KAAK+kC,GAAGlD,UAAUz9B,MAAMkO,UAAU,EAAG0zB,GACnCx4B,EACAxN,KAAK+kC,GAAGlD,UAAUz9B,MAAMkO,UAAU2zB,EAAMjmC,KAAK+kC,GAAGlD,UAAUz9B,MAAMyK,SAE/D7O,KAAA+kC,GAAGlD,UAAUnB,QAClB1gC,KAAK+kC,GAAGlD,UAAUkE,eAAiBC,EAASx4B,EAAIqB,OAChD7O,KAAK+kC,GAAGlD,UAAUqE,aAAeF,EAASx4B,EAAIqB,OACzC7O,KAAA+kC,GAAGlD,UAAUrW,UAAY2a,CAAA,MAEzBnmC,KAAA+kC,GAAGlD,UAAUnB,QACb1gC,KAAA+kC,GAAGlD,UAAUz9B,OAASoJ,CAE/B,CAEA,KAAAkzB,GACO1gC,KAAA+kC,GAAGlD,UAAUnB,OACpB,CAEA,KAAA9b,GACE5kB,KAAK0lC,WAAW,IAChB1lC,KAAKk6B,YACP,CAEA,UAAAA,GACOl6B,KAAAgQ,MAAMo2B,OAAO,SACpB,CAEA,QAAA9M,CAASpzB,EAAsBkzB,GAC7Bp5B,KAAKgQ,MAAMo2B,OAAO,QAAS,CAAElgC,UAASkzB,YACxC,CAEA,cAAAI,CAAetzB,EAAsBkzB,GACnCp5B,KAAKgQ,MAAMo2B,OAAO,OAAQ,CAAElgC,UAASkzB,YACvC,CAEA,UAAAY,CAAWrvB,EAAapI,IZfV,SAAW8jC,EAAuB17B,EAAapI,GACvD,MAGA+jC,EAAapL,GACjB,gEAJa,CAAEqL,EAAG,UAAWtiC,EAAG,UAAWuiC,EAAG,UAAW93B,EAAG,WAIWnM,sDAEjD+jC,EAAWtP,cAA2B,uBAC9CzM,UAAYkK,GAAiB9pB,GAAKuC,QAAQ,KAAM,SAEhEm5B,EAAShL,YAAYiL,GAErB,MAAMG,EAAe,KACRH,EAAAlO,UAAUC,IAAI,gBACzBmD,YAAW,KACT8K,EAAW1N,QAAO,GACjB,IAAG,EAGJ,IAAA8N,EAEUA,EAAAtf,OAAOoU,YAAW,WAnBhB,KAwBL8K,EAAA7J,iBAAiB,SAAS,SAEnCrV,OAAOga,aAAasF,EAAS,GAEjC,CYdIC,CAAc3mC,KAAK+kC,GAAG/C,YAAar3B,EAAKpI,EAC1C,CAEA,WAAAq3B,GACiBA,GAAA55B,KAAK+kC,GAAG7F,IACzB,CAEA,WAAApF,GACiBA,GAAA95B,KAAK+kC,GAAG7F,IACzB,CAEA,MAAA0H,GACE,MAAMrtB,EAAO,IAAMvZ,KAAKq3B,IAAI7N,QAAQ,iBAChCxpB,KAAKq3B,IAAI9wB,KAAKsgC,aAChB7mC,KAAKq3B,IAAI9wB,KAAKsgC,aAAa7mC,KAAMuZ,MAIrC,ECtHF,MAAqButB,WAAqBxF,GAOxC,WAAAzhC,CAAYw3B,GACVnyB,MAAMmyB,GAPDt3B,EAAAC,KAAA,SACAD,EAAAC,KAAA,WACAD,EAAAC,KAAA,aACAD,EAAAC,KAAA,eACAD,EAAAC,KAAA,WAqBmBD,EAAAC,KAAA,mBAAA,GAGlBD,EAAAC,KAAA,aAnBDA,KAAAk/B,IAAMhE,GCjBA,wSDkBXl7B,KAAKwhC,QAAUxhC,KAAKk/B,IAAIlI,cAAc,uBACtCh3B,KAAKu9B,UAAYv9B,KAAKwhC,QAAQxK,cAAc,sBAC5Ch3B,KAAKg9B,YAAch9B,KAAKk/B,IAAIlI,cAAc,4BAErCh3B,KAAAu9B,UAAUS,QAAU,KACvBh+B,KAAKu6B,MAAK,EAIPv6B,KAAAq3B,IAAI1C,GAAG,gBAAgB,KAC1B30B,KAAK+mC,iBAAkB,CAAA,GAE3B,CASa,IAAA1M,GAAK,OAAAn4B,EAAAlC,KAAAmF,WAAA,UAAAoB,EAA2B,IAQ3C,GAPKvG,KAAAk/B,IAAI3Z,MAAMyhB,UAAY,GAG3BhnC,KAAKinC,YACLjnC,KAAKkgC,MAAO7F,OAGRr6B,KAAK+mC,gBACP/mC,KAAK+mC,iBAAkB,EACvB/mC,KAAKg9B,YAAYzS,UAAY,GAC7BvqB,KAAKi9B,QAAUj9B,KAAKknC,aAAa3gC,EAAK4gC,MACjCnnC,KAAAg9B,YAAY77B,OAAOnB,KAAKi9B,aACxB,CAEL,MAAMA,EAAUj9B,KAAKi9B,QACfmK,EAAYnK,EAAQ1sB,IACtBvQ,KAAKqnC,gBAAkBD,EAAU9sB,SAAS,gBACvCta,KAAAsnC,WACHrK,EACAmK,EAAUl6B,QAAQ,eAAgB,aAAa+gB,OAAOjuB,KAAKqnC,kBAGjE,CAGArnC,KAAKunC,UAAU,CACb/I,UAAW,IAAMx+B,KAAKq6B,KAAK9zB,KAIxBvG,KAAAwnC,UAAYhM,YAAW,KAC1Bx7B,KAAKwnC,eAAY,EACZxnC,KAAAk/B,IAAI3Z,MAAMyhB,UAAY,kBAE3BxL,YAAW,KACTx7B,KAAKq3B,IAAIG,UAAUxN,eAAe,GAAE,GACnC,GAEEhqB,KAAAq3B,IAAI7N,QAAQ,eAAc,GAC9B,IACL,GAAA,CAGO,IAAA+Q,SACL,OAAAt4B,EAAAjC,KAAKkgC,QAAOj+B,EAAAs4B,MACd,CAIc,SAAAgN,CAAUh+B,GAAiC,OAAArH,EAAAlC,KAAA,MAAA,YACvD,MAAMQ,SACER,KAAKq3B,IAAIoB,SAAS7vB,KAAKC,cAAcrF,EAAA,CAAA,EACtCxD,KAAKq3B,IAAIoB,SAASrtB,mBAEvB5K,KACEA,EAAKs+B,WAAat+B,EAAKinC,WACzBznC,KAAK+mC,iBAAkB,EAGvB/mC,KAAKq3B,IAAI2B,WAAW,CAClBwF,UAAW,KACThD,YAAW,KACTjyB,EAAKi1B,WAAU,GACd,IAAG,EAERoB,SAAU,KACR5/B,KAAKu6B,MAAK,IAKdv6B,KAAKu6B,OAET,GAAA,CAEQ,SAAA0M,GACFjnC,KAAKkgC,QAEJlgC,KAAAkgC,MAAQlgC,KAAKq3B,IAAI11B,IAAI,gBAAgBwX,OAAO,UAAWnZ,KAAKk/B,KAC5Dl/B,KAAAkgC,MAAMwH,gBAAe,KAExB1nC,KAAKq3B,IAAI4C,mBAGJj6B,KAAAwnC,WAAapG,aAAaphC,KAAKwnC,WAG/BxnC,KAAAk/B,IAAI3Z,MAAMyhB,UAAY,GAGtBhnC,KAAAq3B,IAAI7N,QAAQ,eAAc,IAEnC,CAEQ,YAAA0d,CAAaC,GACnB,MAAMlK,EAAU/B,GACd,sEAIIhwB,EAEFy8B,GAAuB,CACrBnZ,KAAMxuB,KAAKq3B,IAAI9wB,KAAK2uB,OACpB5yB,KAAM,cAGNE,EAAa,CACjBwyB,QAASh1B,KAAKuG,KAAKyuB,QACnB/sB,KAAMjI,KAAKuG,KAAK0B,MAAQ,GACxBW,KAAMjI,KAAKC,UAAUZ,KAAKq3B,IAAI11B,IAAI,QAAQ61B,WAC1CoQ,MAAO,IAAIpb,MAGT2a,MAAYA,KAAOA,GACvB3kC,EAAM4yB,SAAWp1B,KAAKqnC,cAAgB,IAAM,IAEtC,MAAAQ,EAAY,IAAIC,gBAAgBtlC,GAG/B,OAFFxC,KAAAsnC,WAAWrK,EAAS,GAAG/xB,KAAW28B,EAAU9oB,cAE1Cke,CACT,CAEQ,WAAAoK,GACC,MAAuB,SAAvBrnC,KAAKuG,KAAK6uB,SACbhO,OAAO+P,WAAW,gCAAgC5S,QAClDvkB,KAAKuG,KAAK6uB,QAChB,CAEQ,UAAAkS,CAAWrK,EAA4B1sB,GAC7C0sB,EAAQ1sB,IAAMA,EAGX2sB,GAAYl9B,KAAKg9B,aACpBC,EAAQI,OAAS,KACZC,GAAYt9B,KAAKg9B,YAAW,CAEnC,EE5KW,MAAA+K,GAA6Cx+B,IAAU,CAClEy+B,OAAS1e,KCOJ,SACL2e,EACAC,EAAqB,YACrB3S,EAAU,GAEV,MAAM4S,EAA0B,GAElBF,EAAQrjC,QAAQ6e,GAAgB,IAAVA,EAAE2kB,MAChCnuB,SAASouB,IACb,MAAMC,EAAwB,CAC5BliC,GAAIiiC,EAAKjiC,GACTF,QAASmiC,EACThS,SAAU,GACVtgB,MAAO,GAGTuyB,EAASC,OAASD,EAClBH,EAASn5B,KAAKs5B,GACZ,SAASE,EAAaC,GAChB,MAAApS,EAAW4R,EAAQrjC,QAAQ6e,GAAMA,EAAE2kB,MAAQK,EAAWriC,KACpC,IAApBiwB,EAASxnB,SACT45B,EAAW1yB,OAASwf,IAASkT,EAAaA,EAAWF,QAChDlS,EAAApc,SAASyuB,IAChB,MAAMC,EAAyB,CAC7BviC,GAAIsiC,EAAMtiC,GACVF,QAASwiC,EACTrS,SAAU,GACVkS,OAAQE,EACR1yB,MAAO0yB,EAAW1yB,MAAQ,GAGjB0yB,EAAApS,SAASrnB,KAAK25B,GACzBH,EAAaG,EAAS,KAdxB,CAgBCL,EAAQ,IAIP,MAAAM,EAAW,CAAC/jB,EAAgBhP,KAC5B,IAAApR,EAAIogB,EAAEze,GAAKyP,EAAEzP,GAKV,MAJQ,aAAX8hC,EAA2BzjC,GAAC,IAAI+nB,KAAK3H,EAAE3e,QAAQgmB,OAAS,IAAIM,KAAK3W,EAAE3P,QAAQgmB,MAC3D,cAAXgc,EAA4BzjC,GAAC,IAAI+nB,KAAK3W,EAAE3P,QAAQgmB,OAAS,IAAIM,KAAK3H,EAAE3e,QAAQgmB,MACjE,cAAXgc,EAAwBzjC,EAAIwjC,EAAQnyB,QAAQ+O,EAAE3e,SAAW+hC,EAAQnyB,QAAQD,EAAE3P,SAChE,iBAAXgiC,IAA2BzjC,EAAIoR,EAAE3P,QAAQ2iC,QAAUhkB,EAAE3e,QAAQ2iC,SAC/DpkC,CAAA,EAUF,OAPL,SAASqkC,EAAWC,GACdA,EAAA9uB,SAASlJ,IACbA,EAAKslB,SAAWtlB,EAAKslB,SAAS2S,KAAKJ,GACnCE,EAAW/3B,EAAKslB,SAAQ,IAH1B,CAKC8R,GAEIA,CACT,ED5DsBc,CAAiC3f,EAAU/f,EAAK2/B,WAAY3/B,EAAKgsB,SACzEtb,SAASquB,UACjB,MAAMa,EAAQ5/B,EAAK6/B,kBAAkBd,EAASpiC,SAG9C,OAAAjE,EAAAsH,EAAK8/B,gBAALpnC,EAAoBo5B,YAAY8N,EAAMtO,SAChCsO,EAAAG,YAAY5M,eAGZ,MAAA8L,EAAe,CAACe,EAAsBd,KAC/BA,EAAApS,SAASpc,SAASlJ,IACrB,MAAAy4B,EAASlgB,EAASI,MAAMxa,GAAMA,EAAE9I,KAAO2K,EAAK7K,QAAQkiC,MACpDqB,EAAS14B,EAAK7K,QACdwjC,EAASngC,EAAK6/B,kBAAkBK,EAAQD,GAG9CD,EAAQI,SAASD,GAGjBlB,EAAakB,EAAQ34B,EAAI,GAC1B,EAEHy3B,EAAaW,EAAOb,GAGda,EAAAG,YAAYM,qBACnB,EAEHC,OAAQ,CAAC3jC,EAASgzB,WAEhB,MAAMnoB,EAAOxH,EAAK6/B,kBAAkBljC,EAASgzB,GAEzC,GAAgB,IAAhBhzB,EAAQkiC,IAEV,OAAAnmC,EAAAsH,EAAK8/B,gBAALpnC,EAAoB6nC,QAAQ/4B,EAAK8pB,aAC5B,CAEL,MAAM0N,EAASh/B,EAAKwgC,gBAAgB7jC,EAAQkiC,KACxCG,IACFA,EAAOoB,SAAS54B,EAA0B,aAApBxH,EAAK2/B,WAA4B,SAAW,WAGlEn4B,EAAKi5B,aAAa/vB,SAAS8lB,IACvBA,EAAAuJ,YAAYW,kCAGpB,CAEKl5B,EAAAu4B,YAAYM,mBAEjB74B,EAAK2qB,iBACA3qB,EAAAu4B,YAAY5M,kBExCrB,SAAS5S,GACPvgB,EACA2gC,EACAhkC,EACAgzB,GAEIhzB,EAAQikC,eAAcjkC,EAAQkkC,gBAAiB,GACnD,MAAMr5B,EAAOxH,EAAK6/B,kBAAkBljC,EAASgzB,GAI7C,GAAIhzB,EAAQmkC,QAAS,CACb,MAAAjR,EAAWroB,EAAK8pB,QAChByP,EAAoB/gC,EAAK8/B,cACZ,WAAfa,IAA4C,MAAAI,GAAAA,EAAAnpC,OAAOi4B,IACpC,YAAf8Q,IAA6C,MAAAI,GAAAA,EAAAR,QAAQ1Q,IACpDroB,EAAAu4B,YAAY5M,cACnB,CAMO,OAFF3rB,EAAAu4B,YAAYM,mBAEV74B,CACT,CCnBO,MAAMw5B,GACX,WAAA1qC,CAAoB+G,GAAA5G,KAAA4G,QAAAA,CAAyB,CAErC,WAAA4jC,GACC,OAAAxqC,KAAK4G,QAAQ0uB,UDxBkC/rB,ECyB/BvJ,KAAK4G,QDzBoC,CAClEohC,OAAS1e,IACEA,EAAArP,SAAS/T,IAChB,MAAMgzB,EACY,IAAhBhzB,EAAQkiC,SAAY,EAAY9e,EAASI,MAAMxa,GAAMA,EAAE9I,KAAOF,EAAQkiC,MAC1Dte,GAAAvgB,EAAM,SAAUrD,EAASgzB,EAAY,GACpD,EAEH2Q,OAAQ,CAAC3jC,EAASgzB,KACHpP,GAAcvgB,EAAM,UAAWrD,EAASgzB,GAChDwC,gBAAe,ICgBhBqM,GAAmB/nC,KAAK4G,SD1ByB,IAAC2C,CC2BxD,CAEA,MAAAy+B,CAAO1e,GACAtpB,KAAAwqC,cAAcxC,OAAO1e,EAC5B,CAEA,MAAAugB,CAAO3jC,EAAsBgzB,GAC3Bl5B,KAAKwqC,cAAcX,OAAO3jC,EAASgzB,EACrC,ECfc,SAAAuR,GAAMlkC,EAAwBiK,GAC5CA,EAAMyJ,SAAQ,EAAG8Q,KAAI2f,MAAKC,eACxB,IAAK5f,EAAI,OAGL4f,IAAa5f,EAAAxF,MAAMqlB,UAAY,GAAGF,EAAM,OAE5C,IAAIG,GAAO,EACX,MAAMC,EAAS,KACb,GAAID,EAAM,OACNE,G9B5BH,SAAmBhgB,GAExB,OADYigB,WAAWC,iBAAiBlgB,EAAI,MAAMkR,OAAO/uB,QAAQ,KAAM,MACzD,CAChB,C8ByBU69B,CAAgBhgB,IAAO2f,EAAK,OAO/BnkC,EAAK+vB,WAoEL,SAAoChpB,GACrC,IAACA,EAAIyd,GAAI,OACb,GAAIzd,EAAIyd,GAAGqN,UAAU8S,SAASC,IAA0B,OACpD79B,EAAAyd,GAAGqN,UAAUC,IAAI8S,IACrB79B,EAAIyd,GAAGxF,MAAM0W,OAAS,GAAG3uB,EAAIo9B,OAC/B,CAvEUU,CAA2B,CAAErgB,KAAI2f,QAsBpC,SAA0Bn9B,GAK3B,IAACA,EAAIwd,GAAI,OACT,IAACxd,EAAIm9B,IAAK,OACd,GAAIn9B,EAAIwd,GAAGqN,UAAU8S,SAASG,IAAmB,OAE7C99B,EAAAwd,GAAGqN,UAAUC,IAAIgT,IACrB99B,EAAIwd,GAAGxF,MAAM0W,OAAS,GAAG1uB,EAAIm9B,QACzBn9B,EAAAwd,GAAGxF,MAAM+lB,SAAW,SAGxB,MAAMC,EAAarQ,GACjB,qCAAqC/O,GAAG,sBAE/Bof,EAAAvN,QAAW/5B,IACpBA,EAAEunC,kBACFC,GAAmBl+B,EAAIwd,IAEnBxd,EAAIm+B,qBAAyBn+B,EAAAm+B,oBAAoBznC,EAAC,EAEpDsJ,EAAAwd,GAAG5pB,OAAOoqC,EAChB,CA/CUI,CAAiB,CAAE5gB,KAAI2f,MAAKgB,oBANJ,WACnBb,GAAA,EACP,OAAA5oC,EAAAsE,EAAKmlC,sBAALzpC,EAAA0X,KAAApT,EAAA,GAKwC,EAO5C,OAAIokC,EAAU,CAEN,MAAAiB,EAAO7gB,EAAG8gB,iBAAmC,oBAC/B,IAAhBD,EAAK/8B,SAAckc,EAAGxF,MAAMqlB,UAAY,IACvCgB,EAAA3xB,SAAS8K,IACRA,EAAAsY,OAAS,IAAMyN,MAEvB,IAEJ,CAGA,MAAMO,GAAmB,mBA8BlB,SAASI,GAAmBvM,GAC5BA,GACAA,EAAI9G,UAAU8S,SAASG,MAExBnM,EAAA9G,UAAUQ,OAAOyS,IACrBxmC,MAAMinC,KAAK5M,EAAI7I,UAAUpc,SAAShW,IAC5BA,EAAEm0B,UAAU8S,SAAS,2BAA2BtS,YAEtDsG,EAAI3Z,MAAM0W,OAAS,GACnBiD,EAAI3Z,MAAMqlB,UAAY,GACtB1L,EAAI3Z,MAAM+lB,SAAW,GACvB,CAGA,MAAMH,GAA0B,0BCxFhC,SAASY,GAAWnoC,GAGd,GAFJA,EAAEooC,YAAcpoC,EAAEs7B,IAAIlI,cAA2B,aAE7CpzB,EAAEpD,KAAKmP,KAAM,CACf,MAAMs8B,EAAS/Q,GACb,8DAEK+Q,EAAAthB,UAAY/mB,EAAEpD,KAAKwuB,KAC1Bid,EAAOr+B,KAAOs+B,GAAiBtoC,EAAEpD,KAAKmP,MAAQ/L,EAAEpD,KAAKmP,KAAO,WAAW/L,EAAEpD,KAAKmP,OAC5E/L,EAAAooC,YAAY7qC,OAAO8qC,EAAM,MAEzBroC,EAAAooC,YAAYrhB,UAAY/mB,EAAEpD,KAAKwuB,IAErC,CAEA,SAASmd,GAAkB9U,GACzBA,EAAI+U,iBAAmB/U,EAAI6H,IAAIlI,cAA2B,mBAC1DK,EAAI+U,iBAAiB7hB,UAAY,GAE3B,MAAA8hB,EAAYhV,EAAI72B,KAAK8rC,WACrBC,EAAalV,EAAI72B,KAAKgsC,YAC5B,GAAIH,EAAW,CACP,MAAAI,EAASvR,GAAoB,mCACnCuR,EAAO9hB,UAAY0hB,EAAUn/B,QAAQ,MAAOif,GAAG,UACxCsgB,EAAAlnB,MAAMmnB,gBAAkBH,GAAc,GACzClV,EAAA+U,iBAAiBjrC,OAAOsrC,EAAM,MAAA,GACzBpV,EAAI72B,KAAKmsC,YAAa,CAC/B,MAAMC,EAAiB1R,GACrB,0CAA0C/O,GAAG,6BAE3CkL,EAAA+U,iBAAiBjrC,OAAOyrC,EAC9B,CAEI,GAAAvV,EAAI72B,KAAKqsC,UAAW,CACtB,MAAMC,EAAe5R,GAAoB,kCAAkC/O,GAAG,iBAC1EkL,EAAA+U,iBAAiBjrC,OAAO2rC,EAC9B,CACF,CAEA,SAASC,GAAW1V,GAClB,MAAM2V,EAAQ3V,EAAI6H,IAAIlI,cAA2B,aAC3CgW,EAAAriB,UAAY0M,EAAInxB,QAAQ+mC,mBACxBD,EAAA3O,aAAa,wBAAyBle,QAAQ,IAAIqM,KAAK6K,EAAI72B,KAAK0rB,OACxE,CAEA,SAASghB,GAAc7V,GACrB,IAAKA,EAAI9tB,KAAKmsB,UAAY2B,EAAI72B,KAAK2sC,UAAW,OAE9C,IAAIC,EAAU/V,EAAImK,QAAQxK,cAAc,eAQpC,GAPCoW,IACOA,EAAAlS,GAAoB,qCAC1B7D,EAAAmK,QAAQrgC,OAAOisC,IAGrBA,EAAQ7iB,UAAY,GAEhB8M,EAAI72B,KAAK2sC,UAAW,CAChB,MAAAE,EAAenS,GAAoB,0CAC5BmS,EAAA1iB,UAAY0M,EAAI72B,KAAK2sC,UAClCC,EAAQjsC,OAAOksC,EACjB,CAEI,GAAAhW,EAAI9tB,KAAKmsB,QAAS,CACpB,MAAM4X,QAAEA,EAASC,GAAAA,GAAOlW,EAAInxB,QAAQsnC,YACpC,GAAIrtB,OAAOmtB,GAAS3+B,OAAQ,CACpB,MAAA8+B,EAAavS,GAAoB,2CACvCuS,EAAW9iB,UAAY2iB,EACvBF,EAAQjsC,OAAOssC,EACjB,CAEA,GAAIttB,OAAOotB,GAAI5+B,OAAQ,CACf,MAAA++B,EAAQxS,GAAoB,sCAClCwS,EAAM/iB,UAAY4iB,EAClBH,EAAQjsC,OAAOusC,EACjB,CACF,CACF,CC1EA,MAAqBC,GAgBnB,WAAA9tC,CAAY0J,GAfJxJ,EAAAC,KAAA,QACDD,EAAAC,KAAA,OAEYD,EAAAC,KAAA,aAAA,GAEZD,EAAAC,KAAA,eACAD,EAAAC,KAAA,mBAKeD,EAAAC,KAAA,gBAAA,GACfD,EAAAC,KAAA,mBAIAA,KAAAk/B,IAAMhE,GAAoB,+CAE/Bl7B,KAAKuJ,KAAuB,iBAATA,EAAoB,CAAEwG,KAAMxG,GAASA,EACnDvJ,KAAAk/B,IAAIvU,UAAY3qB,KAAK4tC,UAGtB5tC,KAAKuJ,KAAKskC,gBAAgB3O,IAAIb,aAAa,sBAAuB,GACxE,CAhBA,eAAWyP,GACF,QAAE9tC,KAAK+tC,WAChB,CAiBO,QAAAC,CAASC,GAEP,OADHA,EAAA9sC,OAAOnB,KAAKk/B,KACTl/B,IACT,CAGQ,OAAA4tC,GACC,MAA0B,iBAAnB5tC,KAAKuJ,KAAKwG,KAAoB/P,KAAKuJ,KAAKwG,KAAO/P,KAAKuJ,KAAKwG,MACzE,CAGO,QAAAm+B,CAAStL,GACT5iC,KAAAk/B,IAAIlB,QAAW/5B,IAIlB,GAHAA,EAAEunC,mBAGExrC,KAAKmuC,UAAT,CAKA,GAAInuC,KAAKuJ,KAAKioB,UAAYxxB,KAAK8tC,YAAa,CAC1C,MAAMM,EAAiB,KACrBpuC,KAAKquC,cAAe,EACfruC,KAAAk/B,IAAI9G,UAAUQ,OAAO,mBACrB54B,KAAAk/B,IAAIvU,UAAY3qB,KAAK4tC,SAAQ,EAGhC,IAAC5tC,KAAKquC,aAKR,OAJAruC,KAAKquC,cAAe,EACfruC,KAAAk/B,IAAI9G,UAAUC,IAAI,mBACvBr4B,KAAKk/B,IAAIvU,UAAY3qB,KAAKuJ,KAAK+kC,aAAeniB,GAAG,sBACjDnsB,KAAKuuC,gBAAkBnnB,OAAOoU,YAAW,IAAM4S,KAAkB,MAI/DpuC,KAAKuuC,iBAAwBnnB,OAAAga,aAAaphC,KAAKuuC,oBAErD,CAGA,GAAIvuC,KAAK+tC,YAGP,OAFA/tC,KAAKwuC,uBACLxuC,KAAKyuC,sBAzBP,EAgCJ,CAGO,UAAAC,CAAW3+B,GACZA,IAAW/P,KAAAuJ,KAAKwG,KAAOA,GAC3B/P,KAAKkpB,YAAW,GACXlpB,KAAAk/B,IAAIvU,UAAY3qB,KAAK4tC,SAC5B,CAGO,UAAA1kB,CAAW9kB,EAAgBuqC,GAC5B3uC,KAAKmuC,YAAc/pC,IACvBpE,KAAKmuC,UAAY/pC,EACbA,GACGpE,KAAAk/B,IAAI9G,UAAUC,IAAI,mBACvBr4B,KAAKk/B,IAAIvU,UAAYgkB,GAAe,GAAGxiB,GAAG,kBAErCnsB,KAAAk/B,IAAI9G,UAAUQ,OAAO,mBACrB54B,KAAAk/B,IAAIvU,UAAY3qB,KAAK4tC,WAE9B,CAGO,QAAAjR,CAAS5sB,GACT/P,KAAA4uC,OAAO7+B,EAAM,gBACpB,CAGO,OAAA8+B,CAAQ9+B,GACR/P,KAAA4uC,OAAO7+B,EAAM,eACpB,CAGO,UAAA++B,CAAW/+B,GACX/P,KAAA4uC,OAAO7+B,EAAM,kBACpB,CAGO,MAAA6+B,CAAO7+B,EAAcmU,EAAoB6qB,EAAqBzS,GACnEt8B,KAAKkpB,YAAW,GACZhF,GAAWlkB,KAAKk/B,IAAI9G,UAAUC,IAAInU,GACtClkB,KAAKk/B,IAAIvU,UAAY5a,EAGrB/P,KAAKgvC,gBAAe,KACbhvC,KAAAk/B,IAAIvU,UAAY3qB,KAAK4tC,UACtB1pB,GAAWlkB,KAAKk/B,IAAI9G,UAAUQ,OAAO1U,GACrCoY,SACHyS,GAAc,KACnB,CAGQ,cAAAC,CAAepM,EAAkBmM,GACvC/uC,KAAKwuC,kBACLxuC,KAAKyuC,mBAELzuC,KAAKivC,gBAAkBrM,EAClB5iC,KAAA+tC,YAAc3mB,OAAOoU,YAAW,SAEnCx7B,KAAKyuC,kBAAiB,GACrBM,EACL,CAGQ,eAAAP,GACFxuC,KAAKivC,iBAAiBjvC,KAAKivC,iBACjC,CAGQ,gBAAAR,GACFzuC,KAAK+tC,aAAoB3mB,OAAAga,aAAaphC,KAAK+tC,aAC/C/tC,KAAK+tC,iBAAc,EACnB/tC,KAAKivC,qBAAkB,CACzB,EClJF,SAASC,GAAWtrC,GACbA,EAAE2F,KAAKH,OAGZxF,EAAEurC,UAAY,IAAIxB,IAAU,IAAM,GAAGxhB,GAAG,cAAcvoB,EAAEpD,KAAKqoC,SAAW,OAAMmF,SAASpqC,EAAEu7B,UACvFv7B,EAAAurC,UAAUjB,UAAS,KACnBtqC,EAAEsC,QAAQkpC,aAAahmC,KAAK,KAAI,IAI9BxF,EAAE2F,KAAK+mB,WACT1sB,EAAEyrC,YAAc,IAAI1B,IAAU,IAAM,GAAGxhB,GAAG,gBAAgBvoB,EAAEpD,KAAK8uC,WAAa,OAAMtB,SAClFpqC,EAAEu7B,UAEFv7B,EAAAyrC,YAAYnB,UAAS,KACrBtqC,EAAEsC,QAAQkpC,aAAahmC,KAAK,OAAM,KAGxC,CAGA,SAASmmC,GAAY3rC,GACf,IAACA,EAAEpD,KAAK4pC,eAAgB,OAE5B,MAAMoF,EAAWtU,GAAoB,SAAS/O,GAAG,mBAC/CvoB,EAAAu7B,SAASh+B,OAAOquC,GACTA,EAAA/S,iBAAiB,SAAUx4B,IAClCA,EAAEunC,kBACF5nC,EAAE2F,KAAK2vB,aAAat1B,EAAEpD,KAAMoD,EAAEs7B,IAAG,GAErC,CAGA,SAASuQ,GAAe7rC,GAChB,MAAA8rC,EAAc,IAAI/B,GAAU,CAChC59B,KAAM,IAAOnM,EAAEpD,KAAK2pC,aAAehe,GAAG,UAAYA,GAAG,YACrD0hB,WAAW,IAED6B,EAAA1B,SAASpqC,EAAEu7B,UACvBuQ,EAAYxB,UAAS,KACnBtqC,EAAEsC,QAAQkpC,aAAaO,UAAU,YAAaD,EAAW,GAE7D,CAGA,SAASE,GAAgBhsC,GACjB,MAAAisC,EAAa,IAAIlC,GAAU,CAC/B59B,KAAM,IAAOnM,EAAEpD,KAAKsvC,WAAa3jB,GAAG,WAAaA,GAAG,YACpD0hB,WAAW,IAEFgC,EAAA7B,SAASpqC,EAAEu7B,UACtB0Q,EAAW3B,UAAS,KAClBtqC,EAAEsC,QAAQkpC,aAAaO,UAAU,UAAWE,EAAU,GAE1D,CAGA,SAASE,GAAUnsC,GACX,MAAAosC,EAAY,IAAIrC,GAAU,CAC9B59B,KAAM,IAAOnM,EAAEpD,KAAKqsC,UAAY1gB,GAAG,SAAWA,GAAG,OACjD0hB,WAAW,IAEHmC,EAAAhC,SAASpqC,EAAEu7B,UACrB6Q,EAAU9B,UAAS,KACjBtqC,EAAEsC,QAAQkpC,aAAaO,UAAU,SAAUK,EAAS,GAExD,CAGA,SAASC,GAAWrsC,GACZ,MAAAssC,EAAU,IAAIvC,GAAU,CAC5B59B,KAAMoc,GAAG,QACT0hB,WAAW,IAELqC,EAAAlC,SAASpqC,EAAEu7B,UACnB+Q,EAAQhC,UAAS,KACftqC,EAAE2F,KAAKgwB,YAAY31B,EAAEpD,KAAMoD,EAAEs7B,IAAG,GAEpC,CAGA,SAASiR,GAAUvsC,GACX,MAAAwsC,EAAS,IAAIzC,GAAU,CAC3B59B,KAAMoc,GAAG,UACTqF,SAAS,EACT8c,YAAaniB,GAAG,iBAChB0hB,WAAW,IAENuC,EAAApC,SAASpqC,EAAEu7B,UAClBiR,EAAOlC,UAAS,KACdtqC,EAAEsC,QAAQkpC,aAAaiB,YAAYD,EAAM,GAE7C,CC3GA,MAAME,GAAU,CAAAC,OCHhB,SAAqC3sC,GACnC,MAAM4sC,EAAU5sC,EAAEs7B,IAAIlI,cAA2B,eAC3CyZ,EAAavV,GAAsC,WAEnDwV,EAAmB9sC,EAAE2F,KAAKmnC,iBAG5B,GAFOD,EAAAlgC,IAAMmgC,EAAmBA,EAAiB9sC,EAAEpD,MAAQoD,EAAEsC,QAAQyqC,iBAErE/sC,EAAEpD,KAAKmP,KAAM,CACf,MAAMihC,EAAW1V,GACf,8DAEF0V,EAAShjC,KAAOs+B,GAAiBtoC,EAAEpD,KAAKmP,MAAQ/L,EAAEpD,KAAKmP,KAAO,WAAW/L,EAAEpD,KAAKmP,OAChFihC,EAASzvC,OAAOsvC,GAChBD,EAAQrvC,OAAOyvC,EAAQ,MAEvBJ,EAAQrvC,OAAOsvC,EAEnB,EDbEI,OHHF,SAAqCjtC,GACnC/C,OAAOmkC,QAAQ,CACb+G,cACAI,qBACAY,cACAG,mBACCjzB,SAAQ,EAAE3O,EAAM45B,MACjBA,EAAOthC,EAAC,GAEZ,EGLEktC,QEHF,SAAsCltC,GAChC,IAACA,EAAEpD,KAAK2pC,aAGV,OAFAvmC,EAAEw7B,SAAS7U,UAAY3mB,EAAEsC,QAAQu/B,wBACjC7hC,EAAEw7B,SAAShH,UAAUQ,OAAO,WAAY,iBAK1Ch1B,EAAEw7B,SAAShH,UAAUC,IAAI,WAAY,sBAC/B,MAAA0Y,EAAkB7V,GAAoB,mEAEf/O,GAAG,4DACCA,GAAG,gCAElCvoB,EAAAotC,MAAMC,sBAAsB,YAAaF,GAErC,MAAAG,EAAiBH,EAAgB/Z,cAA2B,iBACnDka,EAAAzU,iBAAiB,SAAUx4B,IACxCA,EAAEunC,kBAEE5nC,EAAEw7B,SAAShH,UAAU8S,SAAS,aAChCtnC,EAAEw7B,SAAS7U,UAAY3mB,EAAEsC,QAAQu/B,mBAC/B7hC,EAAAw7B,SAAShH,UAAUQ,OAAO,YACzBuY,GAAevtC,EAAEw7B,UACL8R,EAAAvmB,UAAYwB,GAAG,cAE9BvoB,EAAEw7B,SAAS7U,UAAY,GACrB3mB,EAAAw7B,SAAShH,UAAUC,IAAI,YACV6Y,EAAAvmB,UAAYwB,GAAG,UAChC,GAEJ,EF3BEilB,QGNF,SAAsCxtC,GAChCA,EAAE2F,KAAK+rB,UAA2B,IAAf1xB,EAAEpD,KAAK4nC,KACzBxkC,EAAE2F,KAAK8nC,UAEZztC,EAAE0tC,SAAWpW,GACX,4GAEAt3B,EAAA0tC,SAASta,cAA2B,aAAcrM,UAAY,GAAG/mB,EAAE2F,KAAK8nC,QAAQriB,OAChFprB,EAAA0tC,SAAStT,QAAU,KACjBp6B,EAAAsC,QAAQkpC,aAAamC,kBAAiB,EAG1C3tC,EAAEwoC,iBAAiB6E,sBAAsB,WAAYrtC,EAAE0tC,UACzD,EHNEE,QILF,SAAsC5tC,GAChC,IAACA,EAAE2F,KAAK+rB,SAAU,OAClB,IAAC1xB,EAAE2F,KAAK8nC,QAAS,OAEnBztC,EAAA6tC,SAAWvW,GAAoB,iEAEL/O,GAAG,qGAK/B,MAAMulB,EAAQ9tC,EAAE6tC,SAASza,cAA2B,aACpD0a,EAAM/mB,UAAY,IAAI/mB,EAAE2F,KAAK8nC,QAAQriB,OACrC0iB,EAAM1T,QAAU,KACZp6B,EAAAsC,QAAQkpC,aAAamC,kBAAiB,EAI1C,IAAII,EAAexyB,GAAOvb,EAAE2F,KAAK8nC,QAAQ/1B,SACrC1X,EAAE2F,KAAK8nC,QAAQlH,iBAA6B,IAAIhe,GAAG,iBACvDvoB,EAAE6tC,SAASza,cAA2B,gBAAiBzM,UAAYonB,EAGjE/tC,EAAAotC,MAAMlH,QAAQlmC,EAAE6tC,SACpB,EJlBEG,QKPF,SAAsChuC,GAChC,IAACA,EAAEpD,KAAKsvC,WAAY,OAExB,MAAM+B,EAAY3W,GAAoB,4BAA4B/O,GAAG,uBACnEvoB,EAAAotC,MAAMlH,QAAQ+H,EAClB,ELGEC,QDPF,SAAsCluC,GACpC/C,OAAOmkC,QAAQ,CACbkK,cACAK,eAEAE,kBACAG,mBACAG,aACAE,cACAE,eACCl2B,SAAQ,EAAE3O,EAAM45B,MACjBA,EAAOthC,EAAC,GAEZ,GOZA,MAAqBmuC,GAyBZ,WAAAlyC,CAAYqG,GAxBZnG,EAAAC,KAAA,WASAD,EAAAC,KAAA,OACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,WACAD,EAAAC,KAAA,eACAD,EAAAC,KAAA,oBACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,iBACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,aACAD,EAAAC,KAAA,eAEAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,YAGLA,KAAKkG,QAAUA,CACjB,CAxBA,QAAW1F,GACF,OAAAR,KAAKkG,QAAQsxB,SACtB,CACA,QAAWjuB,GACF,OAAAvJ,KAAKkG,QAAQi3B,SACtB,CA8BO,MAAA+H,GN5BT,IAAoCthC,EMgDhC,OAlBK5D,KAAAk/B,IAAMhE,GCjDA,ygBDmDXl7B,KAAKgyC,MAAQhyC,KAAKk/B,IAAIlI,cAAc,aACpCh3B,KAAKwhC,QAAUxhC,KAAKk/B,IAAIlI,cAAc,eACtCh3B,KAAKgxC,MAAQhxC,KAAKk/B,IAAIlI,cAAc,aACpCh3B,KAAKo/B,SAAWp/B,KAAKgxC,MAAMha,cAAc,gBACzCh3B,KAAKm/B,SAAWn/B,KAAKk/B,IAAIlI,cAAc,gBAEvCh3B,KAAKk/B,IAAIb,aAAa,KAAM,eAAer+B,KAAKQ,KAAK4F,MNtCrBxC,EMyCpB5D,KNxCPa,OAAAmkC,QAAQsL,IAASr2B,SAAQ,EAAE3O,EAAM45B,MACtCA,EAAOthC,EAAC,IM0CJ5D,KAAKiyC,eACFjyC,KAAAgyC,MAAM7wC,OAAOnB,KAAKiyC,eAGlBjyC,KAAKk/B,GACd,CAGO,gBAAA0K,GACC,MAAArjC,EAAOvG,KAAKuJ,KAAK6sB,YACvB,IAAK7vB,IAASA,EAAK+U,UAAY/U,EAAK8vB,SAAU,OAE9C,MAAM6b,EAAc3rC,EAAK+U,QACnB62B,EAAe5rC,EAAK8vB,SAEd+b,GACV,CACE1G,oBAAqB,KAEb,MAAArV,EAAWr2B,KAAKkG,QAAQmsC,cACN,IAApBhc,EAASxnB,QACXyjC,GAA+Bjc,EAAS,GAAGiT,YAAYlK,SAAQ,EAEnE9I,WAAY/vB,EAAK+vB,YAEnB,CAEE,CAAEvL,GAAI/qB,KAAKo/B,SAAUsL,IAAKwH,EAAavH,UAAU,GACjD,CAAE5f,GAAI/qB,KAAKyxC,SAAU/G,IAAKwH,EAAavH,UAAU,GAEjD,CAAE5f,GAAI/qB,KAAKiyC,cAAevH,IAAKyH,EAAcxH,UAAU,IAG7D,CAGO,4BAAAV,GACAjqC,KAAKiyC,eACEK,GAAmBtyC,KAAKiyC,cACtC,CAGA,YAAAvV,GACEyU,GAAkBnxC,KAAKkG,QAAQojC,YAAYpK,IAC7C,CAGA,mBAAAqT,GACEpB,GAAkBnxC,KAAKkG,QAAQojC,YAAY0H,MAC7C,CAGA,aAAAwB,GAEOxyC,KAAAk/B,IAAI9G,UAAUQ,OAAO,kBAC1BxR,OAAOoU,YAAW,KAEXx7B,KAAAk/B,IAAI9G,UAAUC,IAAI,iBAAgB,GACtC,IACL,CAGO,eAAAoa,GAML,OALKzyC,KAAKiyC,gBAEHjyC,KAAAiyC,cAAgB/W,GAAoB,4CACpCl7B,KAAAgyC,MAAM7wC,OAAOnB,KAAKiyC,gBAElBjyC,KAAKiyC,aACd,CAGO,SAAAS,CAAUllC,GACXA,EAAKxN,KAAKk/B,IAAI9G,UAAUC,IAAI,cACtBr4B,KAAAk/B,IAAI9G,UAAUQ,OAAO,aACjC,CAGO,WAAA+Z,CAAYnlC,GACbA,EAAKxN,KAAKk/B,IAAI9G,UAAUC,IAAI,gBACtBr4B,KAAAk/B,IAAI9G,UAAUQ,OAAO,eACjC,CAGO,UAAAga,CAAWj7B,GAChB3X,KAAK2yC,aAAY,GACZ3yC,KAAAk/B,IAAIlB,QAAWnJ,IAClBA,EAAI2W,kBACJpkB,OAAO0M,KAAKnc,EAAG,CAEnB,CAGO,aAAAk7B,CAAc1oC,GACnBnK,KAAK2yC,aAAY,GACZ3yC,KAAAk/B,IAAIlB,QAAWnJ,IAClBA,EAAI2W,sBAGR,EE9JF,MAAqBsH,GAaZ,WAAAjzC,CAAYqG,GAZXnG,EAAAC,KAAA,WAaNA,KAAKkG,QAAUA,CACjB,CAZA,QAAY1F,GACH,OAAAR,KAAKkG,QAAQsxB,SACtB,CACA,QAAYjuB,GACH,OAAAvJ,KAAKkG,QAAQi3B,SACtB,CACQ,MAAA1E,GACN,OAAOz4B,KAAKkG,QAAQi3B,UAAU1E,QAChC,CAOO,IAAArvB,CAAK7G,GACJ,MAAAwwC,EACK,OAATxwC,EAAgBvC,KAAKkG,QAAQojC,YAAY6F,UAAYnvC,KAAKkG,QAAQojC,YAAY+F,YAE3ErvC,KAAAy4B,SACFua,MAAM5pC,KAAK,WAAW7G,IAAQvC,KAAKQ,KAAK4F,GAAI5C,EACxC,CAAA,EAAAxD,KAAKy4B,SAASrtB,kBAElB1H,MAAMs0B,YACAh4B,KAAAQ,KAAKqoC,QAAU7Q,EAAIx3B,KAAKyyC,GACxBjzC,KAAAQ,KAAK8uC,UAAYtX,EAAIx3B,KAAK0yC,KAC/B,OAAAjxC,EAAAjC,KAAKkG,QAAQojC,YAAY6F,YAAWltC,EAAAysC,aACpC,OAAAvsC,EAAAnC,KAAKkG,QAAQojC,YAAY+F,cAAaltC,EAAAusC,YAAA,IAEvC1qC,OAAOwG,IACK,MAAAuoC,GAAAA,EAAApW,SAASxQ,GAAG,aACvBvhB,QAAQ9G,MAAM0G,EAAG,GAEvB,CAGO,SAAAmlC,CAAUptC,EAA0C4wC,GACzD,GAAIA,EAAQhF,UAAW,OAEvBgF,EAAQjqB,YAAW,EAAM,GAAGiD,GAAG,iBAGzB,MAAAinB,EAAS5vC,KAAKxD,KAAKQ,MACZ,cAAT+B,EACK6wC,EAAAjJ,cAAgBiJ,EAAOjJ,aACZ,YAAT5nC,EACF6wC,EAAAtD,YAAcsD,EAAOtD,WACV,WAATvtC,IACF6wC,EAAAvG,WAAauG,EAAOvG,WAG7B7sC,KAAKy4B,SACFnP,SAASjjB,cAAcrG,KAAKQ,KAAK4F,GAAI5C,EAAA,CAAA,EACjC4vC,IAEJ1vC,MAAMs0B,IACLmb,EAAQjqB,YAAW,GAGdlpB,KAAAkG,QAAQmtC,QAAQrb,EAAIx3B,KAAI,IAE9BwD,OAAOwG,IACNI,QAAQ9G,MAAM0G,GACN2oC,EAAAxW,SAASxQ,GAAG,YAAW,GAErC,CAGO,WAAAkkB,CAAY8C,GACbA,EAAQhF,YAEZgF,EAAQjqB,YAAW,EAAM,GAAGiD,GAAG,kBAC1BnsB,KAAAy4B,SACFnP,SAAShjB,cAActG,KAAKQ,KAAK4F,IACjC1C,MAAK,KACJyvC,EAAQjqB,YAAW,GACflpB,KAAKuJ,KAAK+pC,eAAe/pC,KAAK+pC,SAAStzC,KAAKkG,QAAO,IAExDlC,OAAOC,IACN2G,QAAQ9G,MAAMG,GACNkvC,EAAAxW,SAASxQ,GAAG,cAAa,IAEvC,CAGO,gBAAAolB,GACC,MAAAgC,EAAWnsB,OAAOC,SAAShD,KAC3BmvB,EAAa,gBAAgBxzC,KAAKQ,KAAK4nC,MAE7ChhB,OAAOC,SAAShD,KAAOmvB,EACnBA,IAAeD,GAAUnsB,OAAOqsB,cAAc,IAAIC,MAAM,cAC9D,EC9DF,MAAqBC,GAcnB,WAAA9zC,CAAYW,EAAmB+I,GAb/BxJ,EAAAC,KAAA,OAEQD,EAAAC,KAAA,kBACAD,EAAAC,KAAA,kBAEAD,EAAAC,KAAA,QACAD,EAAAC,KAAA,QAEAD,EAAAC,KAAA,UACAD,EAAAC,KAAA,WAA0B,IAE1BD,EAAAC,KAAA,YAGNA,KAAKuJ,KAAOA,EACPvJ,KAAAQ,KAAOgD,EAAK,CAAA,EAAAhD,GACjBR,KAAKQ,KAAK0rB,KAAOlsB,KAAKQ,KAAK0rB,KAAKhf,QAAQ,KAAM,KAE9ClN,KAAKuoC,OAAS,KACdvoC,KAAK4zC,SAAW,EAEX5zC,KAAA6zC,eAAiB,IAAIf,GAAe9yC,MACpCA,KAAA8zC,eAAiB,IAAIC,GAAU/zC,KACtC,CAGO,MAAAklC,GACC,MAAA8O,EAAQh0C,KAAK8zC,eAAe5O,SAE9BllC,KAAKk/B,KAAUl/B,KAAAk/B,IAAI4E,YAAYkQ,GACnCh0C,KAAKk/B,IAAM8U,EAMPh0C,KAAKuJ,KAAK0qC,eAAej0C,KAAKuJ,KAAK0qC,eACzC,CAGO,UAAA7E,GACL,OAAOpvC,KAAK6zC,cACd,CAGO,SAAAvK,GACL,OAAOtpC,KAAK8zC,cACd,CAGO,OAAAtc,GACL,OAAOx3B,KAAKQ,IACd,CAGO,OAAA6yC,CAAQ7yC,GACbR,KAAKQ,KAAOA,EAEZR,KAAKklC,SACAllC,KAAAspC,YAAYiJ,qBACnB,CAGO,SAAA2B,GACL,OAAOl0C,KAAKuoC,MACd,CAGO,WAAA8J,GACL,OAAOryC,KAAKq2B,QACd,CAGO,WAAA8d,GACL,OAAOn0C,KAAK4zC,QACd,CAGO,SAAAQ,GACE,OAAkB,IAAlBp0C,KAAKQ,KAAK4nC,GACnB,CAGO,KAAAiM,GACL,OAAOr0C,KAAKQ,KAAK4F,EACnB,CAGO,QAAAujC,CAAShB,EAAwBuB,EAAmC,UACzEvB,EAAUJ,OAASvoC,KACT2oC,EAAAiL,SAAW5zC,KAAK4zC,SAAW,EAChC5zC,KAAAq2B,SAASrnB,KAAK25B,GAEb,MAAAsJ,EAAgBjyC,KAAKs0C,oBACrBC,EAAgB5L,EAAU9N,QACb,WAAfqP,EAAuC+H,EAAA9wC,OAAOozC,GAC1B,YAAfrK,GAAwC+H,EAAAnI,QAAQyK,GAE/C5L,EAAAW,YAAY5M,eACZiM,EAAAW,YAAYM,kBACxB,CAGO,iBAAA0K,GAEL,OAAIt0C,KAAK4zC,UAAY5zC,KAAKuJ,KAAKgsB,QACtBv1B,KAAKuoC,OAAQ+L,oBAEft0C,KAAKspC,YAAYmJ,iBAC1B,CAGO,UAAAzI,GACL,MAAMwK,EAAgC,GACtC,IAAIjM,EAASvoC,KAAKuoC,OAClB,KAAOA,GACLiM,EAAexlC,KAAKu5B,GACpBA,EAASA,EAAO2L,YAEX,OAAAM,CACT,CAQO,KAAA3Z,GACL,IAAK76B,KAAKk/B,IAAW,MAAA,IAAIn0B,MAAM,oDAC/B,OAAO/K,KAAKk/B,GACd,CAOA,KAAAwB,GACE,IAAK1gC,KAAKk/B,IAAW,MAAA,IAAIn0B,MAAM,oDAG/B/K,KAAKgqC,aAAa/vB,SAAS8lB,IACvBA,EAAAuJ,YAAYW,kCAIhBjqC,KAAK07B,iBAGA17B,KAAAspC,YAAYkJ,eACnB,CAEA,cAAA9W,GACO17B,KAAAk/B,KACHwF,GAAkB1kC,KAAKk/B,KAAK,EAAOl/B,KAAKuJ,KAAKk7B,kBAAoBzkC,KAAKuJ,KAAKk7B,mBAC/E,CAKA,MAAA7L,SACE,OAAA32B,EAAAjC,KAAKk/B,MAAKj9B,EAAA22B,QACZ,CAGO,cAAA+X,GACL,M3C9FK,IADsBpnC,E2C+FC,CAC1BysB,OAAQh2B,KAAKuJ,KAAKwsB,SAASC,OAC3BrzB,OAAQ3C,KAAKuJ,KAAKwsB,SAASpzB,OAC3B8xC,UAAWz0C,KAAKQ,KAAKk0C,kB3CjGV1e,OAAO9oB,QAAQ,MAAO,OAAO3D,EAAKkrC,aAAalrC,EAAK5G,OAAOuK,QAAQ,MAAO,MADpF,IAAwB3D,C2CoG7B,CAGO,gBAAAk8B,GACE,OAAAtmB,GAAOnf,KAAKQ,KAAK8a,QAC1B,CAGO,gBAAA2xB,WACL,MAAM/gB,EAAO,IAAIM,KAAKxsB,KAAKQ,KAAK0rB,MACzB,OAAA,OAAA/pB,UAAKoH,MAAKorC,+BAAgBzoB,KAAS0oB,GAAc1oB,EAAMC,GAChE,CAGO,SAAAqhB,GACL,MAAMqH,EChOV,SAAgBlnB,GACR,MAAAmnB,EAAO1tB,QAAkB,GACzB2tB,EAAMrnB,WAAa,GAEnB1K,EAAI7C,OAAOwN,GAAaonB,EAAIpnB,WAC5BrF,EAAO,CACXilB,GAAI,GACJyH,UAAW,GACXC,OAAQ,GACR3H,QAAS,GACT4H,OAAQ,GACRhe,SAAU,GACV1W,QAAS,IAIL20B,EAAc,CAClBC,QAASpyB,EAAE1I,SAAS,YAAc0I,EAAE1I,SAAS,WAC7C+6B,OAAQryB,EAAE1I,SAAS,UACnBg7B,OAAQtyB,EAAE1I,SAAS,eACnBi7B,MAAOvyB,EAAE1I,SAAS,WAIdk7B,EAAe,CACnBC,OAAQzyB,EAAE1I,SAAS,UACnBo7B,OAAQ1yB,EAAE1I,SAAS,WAAa0I,EAAE1I,SAAS,SAC3Cq7B,GAAI3yB,EAAE1I,SAAS,SAAW0I,EAAE1I,SAAS,WACrCs7B,KAAM5yB,EAAE1I,SAAS,SAAW0I,EAAE1I,SAAS,OACvCu7B,QAAS7yB,EAAE1I,SAAS,YAAc0I,EAAE1I,SAAS,SAC7C,gBAAiB0I,EAAE1I,SAAS,SAC5Bw7B,SAAU9yB,EAAE1I,SAAS,YACrBy7B,MAAO/yB,EAAE1I,SAAS,UAAY0I,EAAE1I,SAAS,OACzC07B,QAAShzB,EAAE1I,SAAS,WACpB27B,OAAQjzB,EAAE1I,SAAS,aACnB47B,OAAQlzB,EAAE1I,SAAS,WAAa0I,EAAE1I,SAAS,SAC3C,IAAK0I,EAAE1I,SAAS,UAAY0I,EAAE1I,SAAS,SACvC67B,GAAInzB,EAAE1I,SAAS,OAAS0I,EAAE1I,SAAS,aACnC87B,UAAWpzB,EAAE1I,SAAS,aACtB+7B,GAAIrzB,EAAE1I,SAAS,OACfg8B,MAAOtzB,EAAE1I,SAAS,UAAY0I,EAAE1I,SAAS,eACzCi8B,QAASvzB,EAAE1I,SAAS,WACpBk8B,MAAOxzB,EAAE1I,SAAS,WAAa0I,EAAE1I,SAAS,SAC1Cm8B,UAAWzzB,EAAE1I,SAAS,aACtB,eAAgB0I,EAAE1I,SAAS,gBAC3Bo8B,SAAU1zB,EAAE1I,SAAS,YACrBq8B,KAAM3zB,EAAE1I,SAAS,eACjBs8B,MAAO5zB,EAAE1I,SAAS,SAClBu8B,KAAM7zB,EAAE1I,SAAS,QACjBw8B,OAAQ9zB,EAAE1I,SAAS,kBACnBy8B,OAAQ/zB,EAAE1I,SAAS,aACnB08B,OAAQh0B,EAAE1I,SAAS,aACnB28B,MAAOj0B,EAAE1I,SAAS,SAClB48B,OAAQl0B,EAAE1I,SAAS,oBACnB68B,OAAQn0B,EAAE1I,SAAS,cACnB88B,MAAOp0B,EAAE1I,SAAS,aAId+8B,EAAU,CACdC,QAASt0B,EAAE1I,SAAS,WACpBi9B,MAAOv0B,EAAE1I,SAAS,UAAY0I,EAAE1I,SAAS,OACzCk9B,MAASx0B,EAAE1I,SAAS,aACpBm9B,QAASz0B,EAAE1I,SAAS,YAAc0I,EAAE1I,SAAS,OAC7Co9B,OAAQ10B,EAAE1I,SAAS,UACnBq9B,QAAS30B,EAAE1I,SAAS,WACpBs9B,OAAQ50B,EAAE1I,SAAS,UACnB,gBAAiB0I,EAAE1I,SAAS,aAAe0I,EAAE1I,SAAS,iBACtDu9B,WAAY70B,EAAE1I,SAAS,eAAiB0I,EAAE1I,SAAS,OACnDw9B,MAAO90B,EAAE1I,SAAS,SAClBy9B,QAAS/0B,EAAE1I,SAAS,WACpB09B,IAAKh1B,EAAE1I,SAAS,iBAChB,YAAa0I,EAAE1I,SAAS,QACxB29B,MAAOj1B,EAAE1I,SAAS,UAId49B,EAAc,CAClBC,OAAQn1B,EAAE1I,SAAS,SAAW0I,EAAE1I,SAAS,QAAU0I,EAAE1I,SAAS,OAC9D89B,OAAQp1B,EAAE1I,SAAS,WAAa0I,EAAE1I,SAAS,QAAU0I,EAAE1I,SAAS,YAI9D49B,EAAYC,OACdD,EAAYC,QAAWn1B,EAAE1I,SAAS,QACzBk7B,EAAaE,QAAU1yB,EAAE1I,SAAS,QAE3Ck7B,EAAaE,QAAS,EACtBF,EAAaI,MAAO,GACXd,EAAIuD,iBAAmBvD,EAAIwD,SACpC9C,EAAaE,QAAS,EACtBF,EAAa,MAAS,GAIxBltB,EAAK4sB,OAAS,KAGd5sB,EAAK4O,eACG,MACAqhB,GADMxD,EAAYyD,iBAAmBzD,EAAI7d,UACjCzoB,MAAM,KAEb,OADH8pC,EAAI,KAAIA,EAAI,GAAKA,EAAI,GAAGlkB,eACrBkkB,EAAI7zC,KAAK,SAIlB,MAAM2f,EAAO,CACX4wB,OAAQE,EACR7H,QAASkI,EACTjI,GAAI8J,EACJnC,OAAQgD,GAEHr3C,OAAAmkC,QAAQ3gB,GAAMpK,SAAQ,EAAE1X,EAAM6L,MAC5BvN,OAAAmkC,QAAQ52B,GAAO6L,SAAQ,EAAE3O,EAAMqV,OACrB,IAAXA,IAAsB2H,EAAA/lB,GAAQ+I,EAAA,GACnC,IAIH,MAAM0pC,EAAY,CAChBsC,QAAS,KACP,MAAM7yC,EAAIue,EAAE9V,QAAQ,6BAA8B,MAa3C,MAZQ,CACb,IAAO,KACP,IAAO,MACP,IAAO,IACP,IAAO,IACP,MAAO,QACP,IAAO,KACP,IAAO,KACP,MAAO,OACP,OAAQ,KACR,OAAQ,MAEIzI,IAAMA,CAAA,EAEtBgzC,QAAS,IAAMz0B,EAAE9V,QAAQ,0BAA2B,MACpD8qC,IAAK,IAAMh1B,EAAE9V,QAAQ,yBAA0B,MAAMA,QAAQ,KAAM,KACnE0qC,OAAQ,IAAM50B,EAAE9V,QAAQ,yBAA0B,MAClD,gBAAiB,IAAM8V,EAAE9V,QAAQ,sCAAuC,MACxEsqC,MAAS,IAAMx0B,EAAE9V,QAAQ,0BAA2B,MAAMA,QAAQ,KAAM,KACxE+qC,MAAO,IAAMj1B,EAAE9V,QAAQ,yBAA0B,OAGnDob,EAAK0sB,UAAY,GACbA,EAAU1sB,EAAKilB,MACjBjlB,EAAK0sB,UAAYA,EAAU1sB,EAAKilB,MAC5BjlB,EAAK0sB,YAAchyB,IACrBsF,EAAK0sB,UAAY,KAKrB,MAAMx0B,EAAU,CACdi1B,OAAQ,IAAMzyB,EAAE9V,QAAQ,0BAA2B,MACnDwoC,OAAQ,IAAM1yB,EAAE9V,QAAQ,yBAA0B,MAAMA,QAAQ,wBAAyB,MACzFyoC,GAAI,IAAM3yB,EAAE9V,QAAQ,sBAAuB,MAAMA,QAAQ,oBAAqB,MAC9E0oC,KAAM,IAAM5yB,EAAE9V,QAAQ,yCAA0C,MAChE2oC,QAAS,IAAM7yB,EAAE9V,QAAQ,0BAA2B,MAAMA,QAAQ,wBAAyB,MAC3F,gBAAiB,IAAM8V,EAAE9V,QAAQ,wBAAyB,MAC1D4oC,SAAU,IAAM9yB,EAAE9V,QAAQ,2BAA4B,MACtD6oC,MAAO,IAAM/yB,EAAE9V,QAAQ,wBAAyB,MAAMA,QAAQ,sBAAuB,MACrF8oC,QAAS,IAAMhzB,EAAE9V,QAAQ,0BAA2B,MACpD+oC,OAAQ,IAAMjzB,EAAE9V,QAAQ,4BAA6B,MACrDgpC,OAAQ,IAAMlzB,EAAE9V,QAAQ,0BAA2B,MACnDqpC,QAAS,IAAMvzB,EAAE9V,QAAQ,0BAA2B,MACpDkpC,UAAW,IAAMpzB,EAAE9V,QAAQ,4BAA6B,MACxDmpC,GAAI,IAAMrzB,EAAE9V,QAAQ,qBAAsB,MAC1CopC,MAAO,IAAMtzB,EAAE9V,QAAQ,iCAAkC,MACzDipC,GAAI,IAAMnzB,EAAE9V,QAAQ,6BAA8B,MAClDspC,MAAO,IAAMxzB,EAAE9V,QAAQ,qBAAsB,MAAMA,QAAQ,qCAAsC,MACjG,eAAgB,IAAM8V,EAAE9V,QAAQ,+BAAgC,MAChEwpC,SAAU,IAAM1zB,EAAE9V,QAAQ,0BAA2B,MACrDypC,KAAM,IAAM3zB,EAAE9V,QAAQ,8BAA+B,MACrD0pC,MAAO,IAAM5zB,EAAE9V,QAAQ,wBAAyB,MAChD2pC,KAAM,IAAM7zB,EAAE9V,QAAQ,uBAAwB,MAC9C4pC,OAAQ,IAAM9zB,EAAE9V,QAAQ,iCAAkC,MAC1D6pC,OAAQ,IAAM/zB,EAAE9V,QAAQ,6BAA8B,MACtD8pC,OAAQ,IAAMh0B,EAAE9V,QAAQ,6BAA8B,MACtD+pC,MAAO,IAAMj0B,EAAE9V,QAAQ,wBAAyB,MAChDgqC,OAAQ,IAAMl0B,EAAE9V,QAAQ,mCAAoC,MAC5DiqC,OAAQ,IAAMn0B,EAAE9V,QAAQ,2BAA4B,MACpDkqC,MAAO,IAAMp0B,EAAE9V,QAAQ,+BAAgC,OAoClD,OAjCPob,EAAK9H,QAAU,GACXA,EAAQ8H,EAAKglB,WACfhlB,EAAK9H,QAAUA,EAAQ8H,EAAKglB,WACxBhlB,EAAK9H,UAAYwC,IACnBsF,EAAK9H,QAAU,KAQf8H,EAAK9H,QAAQ1K,QAAQ,OAClBwS,EAAA9H,QAAU8H,EAAK9H,QAAQlO,UAAU,EAAGgW,EAAK9H,QAAQ1K,QAAQ,OAIhD,QAAZwS,EAAKilB,IAAgBvqB,EAAE1I,SAAS,QAClCgO,EAAKilB,GAAK,SACgB,SAAjBjlB,EAAKglB,SAAuBtqB,EAAE1I,SAAS,OAEtB,SAAjBgO,EAAKglB,QACdhlB,EAAKilB,GAAK,UACgB,WAAjBjlB,EAAKglB,SAAwBrf,OAAO3F,EAAK9H,SAAW,IAEnC,UAAjB8H,EAAKglB,SAAuBrf,OAAO3F,EAAK9H,SAAW,IAElC,WAAjB8H,EAAKglB,QAHdhlB,EAAK2sB,OAAS,aAKY,IAAjB3sB,EAAKglB,UACdhlB,EAAKglB,QAAU,cAVfhlB,EAAK2sB,OAAS,WAaT3sB,CACT,CDKiBmwB,CAASz4C,KAAKQ,KAAKk4C,IACzB,MAAA,CACLpL,QAAS,GAAGuH,EAAKvH,WAAWuH,EAAKr0B,UACjC+sB,GAAI,GAAGsH,EAAKtH,MAAMsH,EAAKG,YAE3B,CAGO,OAAA7X,GACL,OAAOn9B,KAAKuJ,IACd,EE5NF,MAAqBovC,GAcZ,WAAA94C,CAAY0J,GAbZxJ,EAAAC,KAAA,QACAD,EAAAC,KAAA,OACCD,EAAAC,KAAA,YACAD,EAAAC,KAAA,SACiBD,EAAAC,KAAA,SAAA,GACDD,EAAAC,KAAA,QAAA,GACGD,EAAAC,KAAA,WAAA,aAQzBA,KAAKuJ,KAAOA,EACZvJ,KAAK44C,SAAW54C,KAAKuJ,KAAKwG,MAAQ/P,KAAK44C,SAEvC54C,KAAKk/B,IAAMhE,GACT,8MAG2Bl7B,KAAK44C,6CAKlC54C,KAAKi7B,SAAWj7B,KAAKk/B,IAAIlI,cAA2B,qBACpDh3B,KAAK64C,MAAQ74C,KAAKk/B,IAAIlI,cAA2B,aAE5Ch3B,KAAAk/B,IAAIlB,QAAU,KACjBh+B,KAAK0+B,OAAM,CAEf,CAvBA,WAAIoa,GACF,OAAO94C,KAAK+4C,MAAQ/4C,KAAKqO,OAASrO,KAAKuJ,KAAK2sB,QAC9C,CAuBA,KAAAwI,GACM1+B,KAAK84C,SAAc94C,KAAAuJ,KAAKyvC,QAAQh5C,KAAKqO,OAASrO,KAAKuJ,KAAK2sB,UAC5Dl2B,KAAKi5C,eACP,CAGA,IAAA5e,GACOr6B,KAAAk/B,IAAI3Z,MAAM+V,QAAU,EAC3B,CAGA,IAAAf,GACOv6B,KAAAk/B,IAAI3Z,MAAM+V,QAAU,MAC3B,CAGA,UAAApS,CAAWilB,GACTnuC,KAAKi7B,SAAS1V,MAAM+V,QAAU6S,EAAY,GAAK,OAC/CnuC,KAAK64C,MAAMtzB,MAAM+V,QAAU6S,EAAY,OAAS,EAClD,CAGA,OAAA+K,CAAQ/+B,GACNna,KAAKkpB,YAAW,GAEhBlpB,KAAK64C,MAAMluB,UAAYxQ,EAClBna,KAAAk/B,IAAI9G,UAAUC,IAAI,WACvBjR,OAAOoU,YAAW,KACXx7B,KAAA64C,MAAMluB,UAAY3qB,KAAK44C,SACvB54C,KAAAk/B,IAAI9G,UAAUQ,OAAO,UAAS,GAClC,IACL,CAGO,MAAAiG,CAAOxwB,EAAgB0qC,GAC5B/4C,KAAKqO,OAASA,EACdrO,KAAK+4C,MAAQA,EAEb/4C,KAAKi5C,eACP,CAEO,aAAAA,GACDj5C,KAAK84C,QAAS94C,KAAKq6B,YACbE,MACZ,ECrFF,MAAqB4e,GAArB,WAAAt5C,GACUE,EAAAC,KAAA,YACuCD,EAAAC,KAAA,kBAAA,MACvCD,EAAAC,KAAA,MAAA,CAER,MAAAmZ,CAAO7L,GAsBL,OArBAtN,KAAKsN,IAAMA,EAENtN,KAAA6nB,SAAW,IAAI8wB,GAAY,CAC9BziB,SAAU5oB,EAAI4oB,SACd8iB,QAAgBv1B,GAAMvhB,EAAAlC,KAAA,MAAA,YACpBsN,EAAI+pB,IAAIl3B,MAAM,CACZkO,OAAQoV,GAEZ,IACA1T,KAAMoc,GAAG,cAIP7e,EAAI8rC,mBACNp5C,KAAKq5C,gBAAkB,KAChBr5C,KAAK6nB,SAASixB,UAAW94C,KAAKsN,IAAI+pB,IAAIG,UAAUxO,cACrDhpB,KAAK6nB,SAAS6W,SAEhB1+B,KAAKsN,IAAI+pB,IAAI1C,GAAG,oBAAqB30B,KAAKq5C,kBAGrCr5C,KAAK6nB,SAASqX,GACvB,CAEA,UAAAhW,CAAW1b,GACJxN,KAAA6nB,SAASqB,WAAW1b,EAC3B,CAEA,MAAAqxB,CAAOxwB,EAAgB0qC,GAChB/4C,KAAA6nB,SAASgX,OAAOxwB,EAAQ0qC,EAC/B,CAEA,OAAAG,CAAQvuC,GACD3K,KAAA6nB,SAASqxB,QAAQvuC,EACxB,CAEA,IAAA4O,GACEvZ,KAAK6nB,SAAS6W,OAChB,CAEA,UAAA4a,GACE,OAAOt5C,KAAK6nB,SAASixB,OACvB,CAEA,kBAAAS,CAAmB52C,GACjB,OAAyB,IAAlBA,EAAO0L,MAChB,CAEA,OAAAmrC,GACEx5C,KAAKq5C,iBAAmBr5C,KAAKsN,IAAI+pB,IAAIzC,IAAI,oBAAqB50B,KAAKq5C,iBAC9Dr5C,KAAA6nB,SAASqX,IAAItG,QACpB,ECtDF,MAAqB6gB,GAoBZ,WAAA55C,CAAYk5C,EAAexvC,GAnB1BxJ,EAAAC,KAAA,QACDD,EAAAC,KAAA,SACAD,EAAAC,KAAA,OACAD,EAAAC,KAAA,UACAD,EAAAC,KAAA,cACAD,EAAAC,KAAA,YACAD,EAAAC,KAAA,YAEeD,EAAAC,KAAA,OAAA,GAYpBA,KAAK+4C,MAAQA,EACb/4C,KAAKuJ,KAAOA,EAEZvJ,KAAKk/B,IAAMhE,GACT,okCAYFl7B,KAAKwgC,OAASxgC,KAAKk/B,IAAIlI,cAAc,cACrCh3B,KAAKwgC,OAAOp8B,MAAQ,GAAGpE,KAAKoH,OAE5BpH,KAAKwgC,OAAOkZ,QAAU,IAAM15C,KAAKU,QACjCV,KAAKwgC,OAAOmZ,UAAa11C,GAAMjE,KAAK45C,QAAQ31C,GAE5CjE,KAAK65C,SAAW75C,KAAKk/B,IAAIlI,cAAc,iBACvCh3B,KAAK85C,SAAW95C,KAAKk/B,IAAIlI,cAAc,iBAEvCh3B,KAAK65C,SAAS7b,QAAU,IAAMh+B,KAAK2oB,OACnC3oB,KAAK85C,SAAS9b,QAAU,IAAMh+B,KAAKuZ,OAEnCvZ,KAAKi5C,eACP,CAxCA,YAAI/iB,GACF,OAAOl2B,KAAKuJ,KAAK2sB,QACnB,CACA,UAAI7nB,GACK,OAAArO,KAAKk2B,UAAYl2B,KAAKoH,KAAO,EACtC,CACA,WAAI2yC,GACF,OAAOpmC,KAAKqmC,KAAKh6C,KAAK+4C,MAAQ/4C,KAAKk2B,SACrC,CAkCO,MAAA2I,CAAOxwB,EAAgB0qC,GAC5B/4C,KAAKoH,KAAOuM,KAAKqmC,KAAK3rC,EAASrO,KAAKk2B,UAAY,EAChDl2B,KAAK+4C,MAAQA,EAER/4C,KAAAi6C,SAASj6C,KAAKoH,MACnBpH,KAAKi5C,eACP,CAEO,QAAAgB,CAAS7yC,GACTpH,KAAAwgC,OAAOp8B,MAAQ,GAAGgD,GACzB,CAEO,KAAA1G,CAAM2wB,GAAe,GACnBjK,OAAAga,aAAaphC,KAAKk6C,YAEzB,MAAM91C,EAAQpE,KAAKwgC,OAAOp8B,MAAMuK,OAE1BykC,EAAS,KACb,GAAc,KAAVhvC,EAEF,YADKpE,KAAAi6C,SAASj6C,KAAKoH,MAGjB,IAAAA,EAAO6mB,OAAO7pB,GACd6pB,OAAOksB,MAAM/yC,IAIbA,EAAO,EAHJpH,KAAAi6C,SAASj6C,KAAKoH,OAOjBA,EAAOpH,KAAK+5C,UACT/5C,KAAAi6C,SAASj6C,KAAK+5C,SACnB3yC,EAAOpH,KAAK+5C,SAEd/5C,KAAKo6C,OAAOhzC,GAAI,EAIbiqB,MAAUrxB,KAAAk6C,WAAa9yB,OAAOoU,YAAW,IAAM4X,KAAU,IAEhE,CAEO,IAAAzqB,GACC,MAAAvhB,EAAOpH,KAAKoH,KAAO,EACrBA,EAAO,GAGXpH,KAAKo6C,OAAOhzC,EACd,CAEO,IAAAmS,GACC,MAAAnS,EAAOpH,KAAKoH,KAAO,EACrBA,EAAOpH,KAAK+5C,SAGhB/5C,KAAKo6C,OAAOhzC,EACd,CAEO,UAAAkyC,GACE,OAAAt5C,KAAKoH,KAAO,GAAKpH,KAAK+5C,OAC/B,CAEO,MAAAK,CAAOhzC,GACZpH,KAAKoH,KAAOA,EACPpH,KAAAuJ,KAAK8wC,SAASr6C,KAAKqO,QACxBrO,KAAKi6C,SAAS7yC,GACdpH,KAAKi5C,eACP,CAEO,aAAAA,GACDj5C,KAAKoH,KAAO,EAAIpH,KAAK+5C,QAClB/5C,KAAA85C,SAAS1hB,UAAUC,IAAI,gBAEvBr4B,KAAA85C,SAAS1hB,UAAUQ,OAAO,gBAG7B54B,KAAKoH,KAAO,EAAI,EACbpH,KAAA65C,SAASzhB,UAAUC,IAAI,gBAEvBr4B,KAAA65C,SAASzhB,UAAUQ,OAAO,eAEnC,CAEO,OAAAghB,CAAQ31C,GACP,MAAA28B,EAAU38B,EAAE28B,SAAW38B,EAAEq2C,MAE/B,GAAgB,KAAZ1Z,EAAgB,CAElB,MAAMx5B,EAAO6mB,OAAOjuB,KAAKwgC,OAAOp8B,OAAS,EACrC,GAAAgD,EAAOpH,KAAK+5C,QACd,OAEF/5C,KAAKi6C,SAAS7yC,GACdpH,KAAKU,OAAM,MAAA,GACU,KAAZkgC,EAAgB,CAEzB,MAAMx5B,EAAO6mB,OAAOjuB,KAAKwgC,OAAOp8B,OAAS,EACzC,GAAIgD,EAAO,EACT,OAEFpH,KAAKi6C,SAAS7yC,GACdpH,KAAKU,OAAM,MACU,KAAZkgC,GAET5gC,KAAKU,OAAM,EAEf,CAGA,UAAAwoB,CAAWilB,GACLA,EAA0BvU,GAAA55B,KAAKk/B,KAC9B5B,GAAet9B,KAAKk/B,IAC3B,EC1KF,MAAqBqb,GAArB,WAAA16C,GACUE,EAAAC,KAAA,WAAA,CAER,MAAAmZ,CAAO7L,GAeL,OAdAtN,KAAK6nB,SAAW,IAAI2yB,GAAoBltC,EAAIyrC,MAAO,CACjD7iB,SAAU5oB,EAAI4oB,SACdmkB,SAAiB52B,GAAMvhB,EAAAlC,KAAA,MAAA,YACrBsN,EAAI+pB,IAAI4C,mBAER3sB,EAAI+pB,IAAIl3B,MAAM,CACZkO,OAAQoV,EACR+a,UAAW,KACTlxB,EAAI+pB,IAAIqC,kBAGd,MAGK15B,KAAK6nB,SAASqX,GACvB,CAEA,UAAAhW,CAAW1b,GACJxN,KAAA6nB,SAASqB,WAAW1b,EAC3B,CAEA,MAAAqxB,CAAOxwB,EAAgB0qC,GAChB/4C,KAAA6nB,SAASgX,OAAOxwB,EAAQ0qC,EAC/B,CAEA,IAAAx/B,GACEvZ,KAAK6nB,SAAStO,MAChB,CAEA,UAAA+/B,GACS,OAAAt5C,KAAK6nB,SAASyxB,YACvB,CAEA,kBAAAC,GACS,OAAA,CACT,CAEA,OAAAC,GACOx5C,KAAA6nB,SAASqX,IAAItG,QACpB,ECtCF,SAAS6hB,GAAsBpjB,GAI7B,MAAMjV,EAAOiV,EAAIG,UAAUrO,mBACrBvlB,EAAI,CAAEyK,OAAQ,EAAG0qC,MAAO,GAC1B,OAAC32B,GAEHxe,EAAAyK,OAAS+T,EAAKzf,OAAO0L,OACnB+T,EAAK5hB,OAAMoD,EAAEm1C,MAAQ32B,EAAKzf,OAAO2yB,SAAWlT,EAAK5hB,KAAK0N,MAAQkU,EAAK5hB,KAAKk6C,aAErE92C,GALWA,CAMpB,CAEa,MAAA+2C,GAAyBtjB,IACpC,IAAIujB,EAA8B,KAGlCvjB,EAAIM,UAAU,CAAC,aAAc,WAAYpxB,IACjCgM,MAAAA,EAAO8kB,EAAI11B,IAAI,QAEjBi5C,KAAqBpB,UAGzBoB,EA7BJ,SAA+Br0C,GAC7B,OAAIA,EAAK0vB,WAAWzF,SAAiB,IAAI2oB,GAClC,IAAIoB,EACb,CA0BgBM,CAAsBt0C,GAGlC,MAAM8H,OAAEA,EAAA0qC,MAAQA,GAAU0B,GAAsBpjB,GAC1CyjB,EAAaF,EAAUzhC,OAAO,CAClCke,MACAnB,SAAU3vB,EAAK0vB,WAAWC,SAC1B6iB,QAEAK,iBAAkB7yC,EAAK0vB,WAAWE,WAI/B5jB,EAAA82B,cAAc/M,MAAMwe,GAGd,MAAAF,GAAAA,EAAA/b,OAAOxwB,EAAQ0qC,EAAA,IAIxB1hB,EAAA1C,GAAG,eAAgBrL,IAErB,MAAMjb,OAAEA,EAAA0qC,MAAQA,GAAU0B,GAAsBpjB,GACrC,MAAAujB,GAAAA,EAAA/b,OAAOxwB,EAAQ0qC,EAAA,IAIxB1hB,EAAA1C,GAAG,cAAehyB,IAEhB00B,EAAIG,UAAUxxB,cAAc6I,OAAS,IAAgB,MAAX+rC,OAAW,EAAAA,EAAArB,mBAAmB52C,KACtE00B,EAAAG,UAAU7N,eAChB,IAIE0N,EAAA1C,GAAG,eAAe,WACT,OAAA1yB,EAAA,MAAA24C,OAAA,EAAAA,EAAA1B,UAAU/sB,EAAAA,KAAAA,EAAAA,GAAG,YAAU,IAIhCkL,EAAA1C,GAAG,cAAehyB,IACpB,MAAAi4C,GAAAA,EAAW1xB,YAAW,EAAA,IAExBmO,EAAI1C,GAAG,gBAAgB,EAAGhyB,aACxB,MAAAi4C,GAAAA,EAAW1xB,YAAW,EAAA,GACvB,ECvEH,MAAqB6xB,WAAazZ,GAYhC,WAAAzhC,CAAYw3B,GACVnyB,MAAMmyB,GAXRt3B,EAAAC,KAAA,iBAKUD,EAAAC,KAAA,eAA8B,IASjCA,KAAAk/B,IAAMhE,GCzBA,upBD0BXl7B,KAAKqpC,cAAgBrpC,KAAKk/B,IAAIlI,cAAc,2BAG5C2jB,GAAsBtjB,GAGtBr3B,KAAKg7C,gBACP,CArBO,iBAAAC,GACL,OAAOj7C,KAAKqpC,aACd,CAGA,eAAAnR,GACE,OAAOl4B,KAAKk7C,YACd,CAgBA,aAAAC,EAAcC,cAAEA,GAA+C,IAC7D,OAAO,IAAI7Q,GAAW,CACpBlB,cAAerpC,KAAKqpC,cACpBH,WAAYlpC,KAAKq3B,IAAI9wB,KAAKivB,SAC1BD,QAASv1B,KAAKq3B,IAAI9wB,KAAKgvB,QACvBD,SAC2B,kBAAlB8lB,EAA8BA,EAAiBp7C,KAAKq3B,IAAI9wB,KAAK+uB,SAEtE8T,kBAAmB,CAACiS,EAAGz3C,KACf,MAAAmN,EErCP,SACLsmB,EACAnxB,EACAgzB,EACA3vB,GAEMse,MAAAA,EAAW,IAAI8rB,GAAYztC,EAAS,CACxC+tC,cAAe,KACT5c,EAAA7N,QAAQ,mBAAoB3B,EAAQ,EAE1CyrB,SAAWpkC,IACTmoB,EAAIG,UAAUlxB,cAAc4I,EAAEmlC,QAAO,EAGvChD,QAASnY,EAGT5D,SACiC,kBAAlB,MAAN/rB,OAAM,EAAAA,EAAA6xC,eACH,MAAN7xC,OAAM,EAAAA,EAAA6xC,cACL/jB,EAAI9wB,KAAK+uB,SAChBS,SAAUsB,EAAI9wB,KAAKwvB,SACnBR,QAAS8B,EAAI9wB,KAAKgvB,QAClBa,YAAaiB,EAAI9wB,KAAK6vB,YACtBsa,iBAAkBrZ,EAAI9wB,KAAKmqC,iBAC3BjM,iBAAkBpN,EAAI9wB,KAAKk+B,iBAC3Br7B,KAAMiuB,EAAI9wB,KAAK6C,KACfknB,SAAU+G,EAAI9wB,KAAK+pB,SACnBoF,QAAS2B,EAAI9wB,KAAKmvB,QAClBif,cAAetd,EAAI9wB,KAAKouC,cAGxBlc,OAAQ,IAAMpB,EAAIoB,SAClBS,aAAc,CAAChqB,EAAGgwB,IAAQ7H,EAAI6B,aAAahqB,EAAGgwB,GAC9C3F,YAAa,CAACrqB,EAAGgwB,IAAQ7H,EAAIkC,YAAYrqB,EAAGgwB,KAMvCrX,OAFPA,EAASqd,SAEFrd,CACT,CFJqBuhB,CAAkBppC,KAAKq3B,IAAKgkB,EAAGz3C,EAAG,CAAEw3C,kBAE1C,OADFp7C,KAAAk7C,aAAalsC,KAAK+B,GAChBA,CAAA,EAETg5B,gBAAkB3jC,GAAOpG,KAAKk7C,aAAaxxB,MAAMxa,GAAMA,EAAEmlC,UAAYjuC,KAEzE,CAEQ,cAAA40C,GACNh7C,KAAKq3B,IAAI1C,GAAG,aAAcrL,IAEnBtpB,KAAAm7C,gBAAgBnT,OAAO1e,EAAQ,IAGtCtpB,KAAKq3B,IAAI1C,GAAG,eAAgBrL,IACF,IAApBA,EAASza,SACX7O,KAAKk7C,aAAe,GACpBl7C,KAAKqpC,cAAc9e,UAAY,GACjC,IAIFvqB,KAAKq3B,IAAI1C,GAAG,oBAAqBzuB,UAC/B,MAAMgzB,EAAehzB,EAAQkiC,IACzB,OAAAnmC,EAAAjC,KAAKk7C,aAAaxxB,MAAMxa,GAAMA,EAAEmlC,UAAYnuC,EAAQkiC,gBAAM5Q,eAC1D,EACJx3B,KAAKm7C,gBAAgBtR,OAAO3jC,EAASgzB,EAAY,IAInDl5B,KAAKq3B,IAAI1C,GAAG,mBAAoBzuB,IACxB,MAAA6K,EAAO/Q,KAAKk7C,aAAaxxB,MAAMxa,GAAMA,EAAEmlC,UAAYnuC,EAAQE,KAC5D2K,GAILA,EAAK6nB,SACA54B,KAAAk7C,aAAel7C,KAAKk7C,aAAat2C,QAAQsK,GAAMA,EAAEmlC,UAAYnuC,EAAQE,MAJxEwE,QAAQ9G,MAAM,mBAAmBoC,EAAQE,eAIiC,IAK9EpG,KAAKq3B,IAAI1C,GAAG,mBAAoBzuB,IACxB,MAAA6K,EAAO/Q,KAAKk7C,aAAaxxB,MAAMxa,GAAMA,EAAEmlC,UAAYnuC,EAAQE,KACzD2K,GAAAA,EAAKsiC,QAAQntC,EAAO,GAEhC,EGxFE,IAAAo1C,GACAC,GAEG,SAASC,KACP,MAAA,CACL,IAAAhyC,GACoB8xC,GAAAhxB,SAASloB,KAAKmjB,MAAM+lB,SAChBiQ,GAAAjxB,SAASloB,KAAKmjB,MAAMk2B,YAC5C,EAEA,MAAAC,GACWpxB,SAAAloB,KAAKmjB,MAAM+lB,SAAWgQ,GACtBhxB,SAAAloB,KAAKmjB,MAAMk2B,aAAeF,EACrC,EAEA,IAAA1Q,GACWvgB,SAAAloB,KAAKmjB,MAAM+lB,SAAW,SAC/B,MAAMqQ,EAAkBC,SACtBx0B,OAAO6jB,iBAAiB3gB,SAASloB,KAAM,MAAMy5C,iBAAiB,iBAC9D,IAEOvxB,SAAAloB,KAAKmjB,MAAMk2B,aAAe,G1CuJlC,WACC,MAAAK,EAAQxxB,SAASH,cAAc,KACrC2xB,EAAMv2B,MAAMwG,MAAQ,OACpB+vB,EAAMv2B,MAAM0W,OAAS,QAEf,MAAA8f,EAAQzxB,SAASH,cAAc,OACrC4xB,EAAMx2B,MAAMy2B,SAAW,WACvBD,EAAMx2B,MAAMvT,IAAM,MAClB+pC,EAAMx2B,MAAMmG,KAAO,MACnBqwB,EAAMx2B,MAAM02B,WAAa,SACzBF,EAAMx2B,MAAMwG,MAAQ,QACpBgwB,EAAMx2B,MAAM0W,OAAS,QACrB8f,EAAMx2B,MAAM+lB,SAAW,SACvByQ,EAAM1gB,YAAYygB,GAETxxB,SAAAloB,KAAKi5B,YAAY0gB,GAC1B,MAAMG,EAAKJ,EAAMK,YACjBJ,EAAMx2B,MAAM+lB,SAAW,SACvB,IAAI8Q,EAAKN,EAAMK,YAKf,OAJID,IAAOE,IAAIA,EAAKL,EAAMM,aAEjB/xB,SAAAloB,KAAKk6C,YAAYP,GAEnBG,EAAKE,CACd,C0C/K4CG,GAAyBZ,GAAmB,KACpF,EAEJ,CCnBO,MAAMa,GAIX,WAAA38C,CACUq/B,EACA31B,GALexJ,EAAAC,KAAA,kBAAA,GACjBD,EAAAC,KAAA,eAGEA,KAAAk/B,IAAAA,EACAl/B,KAAAuJ,KAAAA,CACP,CAEH,cAAAm+B,CAAe9E,GACb5iC,KAAKy8C,YAAc7Z,CACrB,CAEA,iBAAA8Z,CAAkBC,GAChB38C,KAAK48C,eAAiBD,CACxB,CAEA,iBAAAE,GACE,OAAO78C,KAAK48C,cACd,CAEA,KAAA/hB,GACE,OAAO76B,KAAKk/B,GACd,CAEA,IAAA7E,GACEr6B,KAAKuJ,KAAKuzC,SACL98C,KAAAk/B,IAAI3Z,MAAM+V,QAAU,EAC3B,CAEA,IAAAf,GACEv6B,KAAKuJ,KAAKwzC,SACL/8C,KAAAk/B,IAAI3Z,MAAM+V,QAAU,OACpBt7B,KAAAy8C,aAAez8C,KAAKy8C,aAC3B,CAEA,OAAApc,GACErgC,KAAKuJ,KAAKwzC,SACV/8C,KAAKk/B,IAAItG,SACJ54B,KAAAy8C,aAAez8C,KAAKy8C,aAC3B,EC3CK,MAAMO,GAKX,WAAAn9C,GAJQE,EAAAC,KAAA,SACAD,EAAAC,KAAA,SACAD,EAAAC,KAAA,QAAiB,IAGvBA,KAAKi9C,MAAQ/hB,GACX,+FAEFl7B,KAAKk9C,MAAQl9C,KAAKi9C,MAAMjmB,cAA2B,kBACrD,CAEA,UAAAmmB,CAAW7xC,EAAcyf,IAElBA,EAAAA,GAAM/qB,KAAKo9C,kBAAkB9xC,IAC/B+yB,aAAa,kBAAmB/yB,GAC9BtL,KAAAi9C,MAAM5hB,YAAYtQ,GAGjB,MAAAmV,EAAQ,IAAIsc,GAAMzxB,EAAI,CAC1BgyB,OAAQ,IAAM/8C,KAAKq9C,SAAStyB,GAC5B+xB,OAAQ,IAAM98C,KAAKs9C,aAWd,OAPPt9C,KAAKu9C,UAAU9gB,iBAAiB,SAAS,KACjCyD,EAAA2c,qBAAuB3c,EAAM3F,MAAK,IAIrCv6B,KAAA6S,MAAM7D,KAAKkxB,GAETA,CACT,CAEQ,iBAAAkd,CAAkB9xC,GAClB,MAAAyf,EAAKT,SAASH,cAAc,OAI3B,OAHJY,EAAAqN,UAAUC,IAAI,kBACjBtN,EAAGxF,MAAM+V,QAAU,OACdt7B,KAAAi9C,MAAM5hB,YAAYtQ,GAChBA,CACT,CAEA,OAAAyyB,GACE,OAAOx9C,KAAKi9C,KACd,CAEA,OAAAM,GACE,OAAOv9C,KAAKk9C,KACd,CAEA,QAAAI,GACOt9C,KAAAi9C,MAAM13B,MAAM+V,QAAU,QACtBt7B,KAAAk9C,MAAM33B,MAAM+V,QAAU,QACtBt7B,KAAAk9C,MAAM9kB,UAAUC,IAAI,eACzBmjB,KAAqB3Q,MACvB,CAEA,QAAAwS,CAASne,GAGLl/B,KAAK6S,MACFrO,KAAK4K,GAAMA,EAAEyrB,UACbj2B,QAAQX,GAAMA,IAAMi7B,GAAOj7B,EAAEw3B,aAAmC,SAApBx3B,EAAEshB,MAAM+V,UAAoBzsB,OAAS,IAKjF7O,KAAAi9C,MAAM13B,MAAM+V,QAAU,OAC3BkgB,KAAqBE,SACvB,ECtEK,MAAM+B,GAGX,WAAA59C,CAAYw3B,GAFJt3B,EAAAC,KAAA,QAGDA,KAAA09C,KAAO,IAAIV,GAChB1yB,SAASloB,KAAKi5B,YAAYr7B,KAAK09C,KAAKF,WAEhCnmB,EAAA1C,GAAG,aAAa,KACb30B,KAAA09C,KAAKF,UAAU5kB,QAAO,IAI7B4iB,KAAqBhyC,MACvB,CAEA,KAAAqxB,GACS,OAAA76B,KAAK09C,KAAKF,SACnB,CAEA,MAAArkC,CAAO7N,EAAcyf,GACnB,OAAO/qB,KAAK09C,KAAKP,WAAW7xC,EAAMyf,EACpC,ECvBF,MAAM4yB,GAAiB,aAMvB,MAAMC,GAGJ,WAAA/9C,CAAoB0J,GAFZxJ,EAAAC,KAAA,QAEYA,KAAAuJ,KAAAA,EAEZ,MAAAs0C,EAAYl9C,KAAKia,MAAMwM,OAAO02B,aAAaC,QAAQJ,KAAmB,MAG5E39C,KAAKQ,KAAO,CACV8K,KAAMuyC,EAAUvyC,MAAQuyC,EAAU7uB,MAAQ,GAC1CvnB,MAAOo2C,EAAUp2C,OAAS,GAC1BkI,KAAMkuC,EAAUluC,MAAQ,GACxBO,MAAO2tC,EAAU3tC,OAAS,GAC1B4uB,SAAU+e,EAAU/e,UAAY+e,EAAUG,UAAW,EAEzD,CAEA,OAAAxmB,GACE,OAAOx3B,KAAKQ,IACd,CAGA,MAAAq+B,CAAOtxB,EAA0B,IACxB1M,OAAAmkC,QAAQz3B,GAAK0M,SAAQ,EAAEhZ,EAAKmD,MAC5BpE,KAAAQ,KAAKS,GAAOmD,CAAA,IAGnBgjB,OAAO02B,aAAaG,QAAQN,GAAgBh9C,KAAKC,UAAUZ,KAAKQ,OAChER,KAAKuJ,KAAK20C,eAAiBl+C,KAAKuJ,KAAK20C,cAAcl+C,KAAKQ,KAC1D,CAOA,MAAA29C,GACEn+C,KAAK6+B,OAAO,CACV3uB,MAAO,GACP4uB,UAAU,GAEd,CAGA,qBAAArH,GACS,QAAEz3B,KAAKQ,KAAK8K,QAAUtL,KAAKQ,KAAKiH,KACzC,ECrCF,MAAM22C,GAAW,CAEf,IAAAC,CAAKhnB,GACY7C,GAAA6C,EAAI9wB,KAAKuB,QAExBuvB,EAAIM,UAAU,CAAC,WAAYpxB,IACpB+3C,GAAU/3C,EAAKuB,OAAM,GAE9B,EAGAc,KAAKyuB,GACU,IAAIumB,GAAK,CACpBM,cAAgB19C,IACV62B,EAAA7N,QAAQ,eAAgBhpB,EAAI,IAOtC+9C,aAAalnB,GACJ,IAAIomB,GAAapmB,GAI1BmD,gBAAgBnD,GACU,IAAIyI,GAAgB,CAC1CK,OAAQ,IAAM9I,EACdoB,OAAQ,IAAMpB,EAAIoB,SAClBsG,SAAU,IAAM1H,EAAIoC,SAGpB2D,oBAAqB,IAAM,GAAG/F,EAAI9wB,KAAK2uB,6BAAiC,IAAA1I,SAM5E,MAAA6M,CAAOhC,GACC,MAAAgC,EAAS,IAAIyL,GAAOzN,GAEnB,OADHA,EAAAc,MAAMkD,YAAYhC,EAAO6F,KACtB7F,CACT,EAGA,IAAA9mB,CAAK8kB,GACG9kB,MAAAA,EAAO,IAAIwoC,GAAK1jB,GAEf9kB,OADH8kB,EAAAc,MAAMkD,YAAY9oB,EAAK2sB,KACpB3sB,CACT,EAGA6nB,aAAa/C,GACU,IAAIyP,GAAazP,GAUxC,WAAAmnB,GAEA,GChDF,SAAsBC,GAAgBnxC,GAAmB,OAAApL,EAAAlC,KAAA,MAAA,kBA6BzD,SAAgCsN,GAAmB,OAAApL,EAAAlC,KAAA,MAAA,kBAC3C0+C,GAAc,CAAEpxC,MAAK9K,MAAO,eAAgBm8C,WAAY,CAACrxC,EAAIsoB,QAAS,iBAC9E,GAAA,CA7BQgpB,CAAiBtxC,GAGjB,MAAAuxC,QAOR,SAAgCvxC,GAAmB,OAAApL,EAAAlC,KAAA,MAAA,YACjD,IAAKsN,EAAIwxC,QAAUxxC,EAAI0nB,QAAgB,OAEvC,MAAM+pB,SACEzxC,EAAImrB,SAASumB,MAAM73C,MAAM,CAC7B83C,SAAU3xC,EAAI0nB,QACdkqB,WAAY5xC,EAAI2nB,UAChBkqB,UAAW7xC,EAAIgqB,YAEjB92B,KAAK4+C,GAEA,MAAA,CACL,CAAC9xC,EAAI0nB,SAAU+pB,EAEnB,GAAA,CArB0BM,CAAiB/xC,SA6B5B,SAAYA,EAAmB6Y,GAAoB,OAAAjkB,EAAAlC,KAAA,MAAA,kBAC1D0+C,GAAc,CAAEpxC,MAAK9K,MAAO,UAAWm8C,WAAY,CAACrxC,EAAIuoB,KAAM,aAAc1P,SACpF,GAAA,CA5BQm5B,CAAYhyC,EAAKuxC,EACzB,GAAA,CA6BA,SAAeH,GAAc7hC,GAK1B,OAAA3a,EAAAlC,KAAA,MAAA,YACK,MAAAsN,IAAEA,GAAQuP,EACZ,IAAAsJ,EAAoBtJ,EAAKsJ,OAAS,GAGhC,MAAAo5B,EAoBR,SAA0BZ,GAClB,MAAAY,MAAU5iC,IAIT,OAHP,IAAIA,IAAIgiC,GAAY1kC,SAASulC,IAClBl1B,SAAAuhB,iBAA8B2T,GAAUvlC,SAAS8Q,GAAOw0B,EAAIlnB,IAAItN,IAAG,IAEvEw0B,CACT,CA1BcE,CAAiB5iC,EAAK8hC,YAG5Be,EA0BR,SACEH,EACAI,EACA3qB,EACA7O,GAEM,MAAAu5B,EAAW76C,MAAMinC,KAAKyT,GACzB/6C,KAAKumB,GAAOA,EAAG60B,aAAaD,IAAgB3qB,IAC5CpwB,QAAQ3D,GAAQA,GAA6B,iBAAfklB,EAAMllB,KAEvC,MAAO,IAAI,IAAI0b,IAAI+iC,GACrB,CArCmBG,CAAYN,EAAKjyC,EAAIqyC,YAAaryC,EAAI0nB,QAAS7O,GAG5D,GAAAu5B,EAAS7wC,OAAS,EAAG,CACjB,MAAAmpB,SACE1qB,EAAImrB,SAASqnB,MAAM13C,SAASyU,EAAKra,MAAO,CAC5Cu9C,UAAWL,EAASh7C,KAAK,KACzBy6C,UAAW7xC,EAAIgqB,YAEjB92B,KAAKA,KACP2lB,EAAQ3iB,OAAK2iB,GAAU6R,EACzB,EA6BO,SAAmBunB,EAAuB/+C,EAAkBw/C,GAC/DT,EAAAtlC,SAAS8Q,IACL,MAAAiK,EAAUjK,EAAG60B,aAAa,iBAC1B1xC,EAAS8mB,GAAWx0B,EAAKw0B,IAAcgrB,GAAkBx/C,EAAKw/C,IAAoB,EACxFj1B,EAAGJ,UAAY,GAAGsD,OAAO/f,IAAM,GAEnC,CAjCqB+xC,CAAAV,EAAKp5B,EAAO7Y,EAAI0nB,QACrC,GAAA,CCjGa,MCCPkrB,GAAkB,gBCAxB,MAAqBC,GACnB,WAAAtgD,CAAoByiC,GAAAtiC,KAAAsiC,IAAAA,CAAe,CAE7B,MAAA8d,GAAS,OAAAl+C,EAAAlC,KAAA,MAAA,YAMN,aAJCA,KAAKsiC,IAAI+d,SAAS/2B,SAASrjB,cAAczC,EACzC,CAAA,QAAMxD,KAAKsgD,wBAEjB9/C,IAEJ,GAAA,CAEM,kBAAA8/C,GAAqB,OAAAp+C,EAAAlC,KAAA,MAAA,YACnB,MAAAsL,KAAEA,EAAM7D,MAAAA,EAAOkI,KAAAA,GAAS3P,KAAKsiC,IAAIie,UAAU/oB,UAC3CjxB,EAAOvG,KAAKsiC,IAAIke,UAEf,MAAA,CACLllC,QAAStb,KAAKsiC,IAAIme,YAAYpb,kBAC9B/5B,OACA7D,QACAkI,KAAAA,EACAy4B,IAAK,EACL6W,SAAU14C,EAAKyuB,QACfkqB,WAAY34C,EAAK0uB,UACjBkqB,UAAW54C,EAAK0B,KAChBywC,SAAUgI,KAEd,GAAA,CAEA,aAAAC,CAAcC,GAEZ5gD,KAAKsiC,IAAI0B,eAAexM,UAAU1N,cAAc82B,EAClD,ECtBF,MAAqBC,WAAexe,GAIlC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAJAviC,EAAAC,KAAA,UAA0B,IAC1BD,EAAAC,KAAA,iBAKNA,KAAK8gD,cAAgB,IAAIX,GAAgBngD,KAAKsiC,KAExC,MAAAye,EAAiB,IAAM/gD,KAAKghD,KAE7BhhD,KAAAsiC,IAAI2e,YAAW,KAElBjhD,KAAKsiC,IAAI0B,eAAerP,GAAG,gBAAiBosB,EAAc,IAEvD/gD,KAAAsiC,IAAI4e,cAAa,KACpBlhD,KAAKsiC,IAAI0B,eAAepP,IAAI,gBAAiBmsB,EAAc,GAE/D,CAEA,cAAAI,CAAejyC,GACRlP,KAAAohD,QAAQpyC,KAAKE,EACpB,CAEc,KAAK,OAAAhN,EAAAlC,KAAA,MAAA,YACb,GAAkD,KAAlDA,KAAKsiC,IAAIme,YAAYpb,kBAAkB12B,OAEzC,YADK3O,KAAAsiC,IAAIme,YAAY/f,QAIjB,MAAA2gB,EAASrhD,KAAKohD,QAAQ13B,MAAMjG,GAAMA,EAAE69B,eAErCthD,KAAAsiC,IAAIme,YAAY7mB,cAEjB,IAIE,IAAA2nB,GAFA,MAAAF,OAAA,EAAAA,EAAQ1sC,MAAK0sC,EAAO1sC,MAKI4sC,GAAhB,MAARF,OAAQ,EAAAA,EAAAG,WAAsBH,EAAOG,YACnBxhD,KAAK8gD,cAAcV,UAG7B,MAARiB,OAAQ,EAAAA,EAAAI,MAAaJ,EAAAI,KAAKF,GACzBvhD,KAAK8gD,cAAcH,cAAcY,SAC/B/2C,GAIP,OAFAI,QAAQ9G,MAAM0G,QACdxK,KAAKsiC,IAAIme,YAAYzmB,WAAW,GAAG7N,GAAG,mBAAmB3hB,EAAIE,SAAWyV,OAAO3V,KAAQ,IACvF,CACA,QACKxK,KAAAsiC,IAAIme,YAAY3mB,aACvB,CAEK95B,KAAAsiC,IAAIme,YAAY77B,QACrB5kB,KAAKsiC,IAAI0B,eAAexa,QAAQ,mBAClC,GAAA,ECxDF,MAAqBk4B,WAAkBrf,GAOrC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAPAviC,EAAAC,KAAA,YAA8B,IACMD,EAAAC,KAAA,cAAA,MAEpCD,EAAAC,KAAA,YACAD,EAAAC,KAAA,gBAwCeD,EAAAC,KAAA,gBAAA,GACDD,EAAAC,KAAA,eAAA,GApCfA,KAAAsiC,IAAI2e,YAAW,KAClBjhD,KAAKyiC,SAAS,iDACTziC,KAAAuiC,OACH,kBAAkBpW,GAAG,u7BAAW,IAG/BnsB,KAAAsiC,IAAI4e,cAAa,SAEtBlhD,KAAK2iC,uBAAuB/yB,GAAQ5P,KAAK2hD,uBAAuB/xC,KAChE5P,KAAK8iC,cAAa,KACf,MAAa5gC,EAAAlC,KAAA,MAAA,kBACNA,KAAK4hD,oBAGN5hD,KAAK6hD,cACR7hD,KAAK8hD,oBACL9hD,KAAK6hD,aAAc,GAIrBrmB,YAAW,KACTx7B,KAAK+hD,kBAAiB,GACrB,GAAE,KAZN,MAeH/hD,KAAKijC,cAAa,KACXjjC,KAAA0iC,OAAQsf,cAAez8B,MAAM0W,OAAS,EAAA,IAI7C7U,OAAOoU,YAAW,KAChBx7B,KAAK4hD,mBAAkB,GACtB,IACL,CAKa,iBAAAA,GAAoB,OAAA1/C,EAAAlC,KAAA,MAAA,YAC3BA,KAAKiiD,eACgB,OAArBjiD,KAAKkiD,aAMTliD,KAAKkiD,iBAA2BhgD,EAAAlC,KAAA,MAAA,YAC3Bk9B,GAAYl9B,KAAK0iC,QACf1iC,KAAAy1B,gBAAkBz1B,KAAKmiD,WAAWniD,KAAKsiC,IAAIke,UAAU/qB,WACvD6H,GAAYt9B,KAAK0iC,QACpB1iC,KAAKkiD,YAAc,KACnBliD,KAAKiiD,cAAe,CAAA,aAEhBjiD,KAAKkiD,mBAZHliD,KAAKkiD,YAaf,GAAA,CAEc,UAAAC,CAAW3hD,GAA2B,OAAA0B,EAAAlC,KAAA,MAAA,YAKlD,IAJK6E,MAAMC,QAAQtE,IAAS,CAAC,SAAU,UAAU8Z,gBAAgB9Z,KAC/DA,EAAO,CAACA,KAGLqE,MAAMC,QAAQtE,GAGjB,OAFA4hD,GAAYpiD,KAAK0iC,OAAS,IAAIvW,GAAG,yDAC9BmR,GAAYt9B,KAAK0iC,QACb,GAGH,MAAA2f,EAAWC,IACI,iBAARA,IACPA,EAAIh3C,MAAQ9K,EAAKkpB,MAAMjG,GAAMA,EAAEnY,OAASg3C,EAAIh3C,QAChD9K,EAAKwO,KAAKszC,GAAG,EAITC,EAAoBlH,GAAan5C,EAAAlC,KAAA,MAAA,kBAC/BqK,QAAQ2U,IACZq8B,EAAE72C,KAAI,CAAO89C,EAAKlrC,IAAUlV,EAAAlC,KAAA,MAAA,YAC1B,GAAmB,iBAARsiD,GAAqBz9C,MAAMC,QAAQw9C,IAEnC,GAAAz9C,MAAMC,QAAQw9C,SACjBC,EAAWD,QAAG,GACI,iBAARA,EAAkB,CAClC,MAAME,QAAgBxiD,KAAKuiD,WAAWD,GAElCz9C,MAAMC,QAAQ09C,SAAgBD,EAAWC,GACjB,iBAAZA,GAAsBH,EAAQG,EAChD,OAREH,EAAQC,EAQV,MAEJ,IA4BK,aA1BDC,EAAW/hD,GAGZA,EAAAyZ,SAAS/P,IACR,GAAAlK,KAAKyiD,YAAYv4C,GAAO,CAChBlK,KAAK0iD,WAAWx4C,GACxB+P,SAASqoC,IACTD,EAAQC,EAAG,GAEJ,MAAAz9C,MAAMC,QAAQoF,IAClBA,EAAA+P,SAASqoC,IACZD,EAAQC,EAAG,GAEf,IAIF9hD,EAAOA,EAAKoE,QACTsF,GAA8B,iBAATA,IAAsBrF,MAAMC,QAAQoF,MAAWA,KAAUA,EAAKoB,OAKtFtL,KAAK2iD,aAAaniD,GAClBR,KAAK4iD,aAAapiD,GAEXA,CACT,GAAA,CAGc,UAAA+hD,CAAW5qC,GAA2B,OAAAzV,EAAAlC,KAAA,MAAA,YAC9C,IAAC2X,EAAK,MAAO,GAEb,IACI,MAAA9N,QAAa1J,MAAMwX,GAElB,aADY9N,EAAKC,aAEjBU,GAIP,OAHG8yB,GAAYt9B,KAAK0iC,QACZ93B,QAAA9G,MAAM,2BAA4B0G,GAC1C43C,GAAYpiD,KAAK0iC,OAAS,IAAIvW,GAAG,gBAAgBA,GAAG,gBAAgBhM,OAAO3V,MACpE,EACT,CACF,GAAA,CAGQ,YAAAm4C,CAAaniD,GACdA,EAAAyZ,SAASqoC,IACZA,EAAIzvC,MAAMoH,SAAQ,CAAC/P,EAAMkN,KAClBlN,EAAKjJ,MAAUiJ,EAAAjJ,IAAM,GAAGqhD,EAAIh3C,QAAQ8L,EAAQ,IAAC,GACnD,GAEL,CAGQ,YAAAwrC,CAAapiD,GACnB,MAAMqiD,EAAiC,CAAA,EAClCriD,EAAAyZ,SAASqoC,IACRA,EAAAzvC,MAAMoH,SAAS/P,IACZA,EAAKjJ,KAAmC,KAA5Bkf,OAAOjW,EAAKjJ,KAAK0N,SAC7Bk0C,EAAI34C,EAAKjJ,KACT4hD,EAAI34C,EAAKjJ,OADU4hD,EAAA34C,EAAKjJ,KAAO,EAGhC4hD,EAAI34C,EAAKjJ,KAAO,IAAQiJ,EAAAjJ,IAAM,GAAGiJ,EAAKjJ,OAAO4hD,EAAI34C,EAAKjJ,QAAI,GAC/D,GAEL,CAGQ,WAAAwhD,CAAYjiD,GACd,IACF,MACkB,iBAATA,KACLK,OAAOqc,OAAO1c,GAAMqO,QACtBhK,MAAMC,QAAQjE,OAAOC,KAAKD,OAAOqc,OAAY1c,GAAM,GAAGsiD,aACtDjiD,OAAOC,KAAKD,OAAOqc,OAAY1c,GAAM,GAAGsiD,UAAU,IAAIxoC,SAAS,OAAM,CAEjE,MAAArW,GACC,OAAA,CACT,CACF,CAGQ,UAAAy+C,CAAWK,GACjB,MAAMz6B,EAAyB,GAiBxB,OAhBAznB,OAAAmkC,QAAQ+d,GAAS9oC,SAAQ,EAAE+oC,EAASV,MACnC,MAAAW,EAAwB,CAAE33C,KAAM03C,EAASzgD,KAAM+/C,EAAI//C,KAAMsQ,MAAO,IACtEyvC,EAAIQ,UAAU7oC,SAAQ,CAAC/P,EAAMkN,KAE3B,MAAM8rC,EAAUh5C,EAAKi5C,KACjB,GAAA,aAAal2C,KAAKi2C,GAAU,CACxB,MAAAx5B,EAAO,oBAAoB3b,KAAKm1C,GAClCx5B,GAAQA,EAAK7a,OAAS,IAAQ3E,EAAAi5C,KAAOz5B,EAAK,GAChD,CACAu5B,EAAKpwC,MAAM7D,KAAK,CACd/N,IAAKiJ,EAAK6F,MAAQ,GAAGizC,KAAW5rC,EAAQ,IACxC5J,IAAKtD,EAAKi5C,MACX,IAEH76B,EAAKtZ,KAAKi0C,EAAI,IAET36B,CACT,CAGQ,iBAAAw5B,GAED9hD,KAAAojD,SAAWloB,GAAoB,oCAC/Bl7B,KAAA0iC,OAAQvhC,OAAOnB,KAAKojD,UAEzBpjD,KAAKy1B,UAAUxb,SAAQ,CAACqoC,EAAKlrC,KACrB,MAAAisC,EAAOnoB,GAAoB,sDAC5Bl7B,KAAAojD,SAASjiD,OAAOkiD,GACrBA,EAAKhlB,aAAa,aAAcle,OAAO/I,IAClCisC,EAAAhlB,aAAa,gBAAiBikB,EAAIh3C,MAClC+3C,EAAAhlB,aAAa,YAAaikB,EAAI//C,MAC/B+/C,EAAAzvC,MAAMoH,SAAS/P,IACX,MAAAo5C,EAAQpoB,GAAoB,kCAM9B,GALJmoB,EAAKliD,OAAOmiD,GAENp5C,EAAKjJ,MAAQ,IAAIsL,OAAO,KAAK+1C,EAAIh3C,qBAAqB2B,KAAK/C,EAAKjJ,MAC9DqiD,EAAAjlB,aAAa,QAASn0B,EAAKjJ,KAElB,UAAbqhD,EAAI//C,KAAkB,CAClB,MAAA67B,EAAQ9T,SAASH,cAAc,OACrCiU,EAAM7tB,IAAMrG,EAAKsD,IACjB4wB,EAAMjW,IAAMje,EAAKjJ,IACjBqiD,EAAMniD,OAAOi9B,EAAK,MAElBklB,EAAM34B,UAAYzgB,EAAKsD,IAGzB81C,EAAMtlB,QAAU,KACG,UAAbskB,EAAI//C,KACNvC,KAAKsiC,IAAIme,YAAY7a,cAAc,KAAK17B,EAAKjJ,QAE7CjB,KAAKsiC,IAAIme,YAAY7a,cAAc17B,EAAKsD,KAAO,GACjD,CAAA,GAEH,IAICxN,KAAKy1B,UAAU5mB,OAAS,IACrB7O,KAAAujD,aAAeroB,GAAoB,wCACnCl7B,KAAA0iC,OAAQvhC,OAAOnB,KAAKujD,cACzBvjD,KAAKy1B,UAAUxb,SAAQ,CAACqoC,EAAKlrC,KACrB,MAAAksC,EAAQpoB,GAAoB,YAClCooB,EAAM34B,UAAY23B,EAAIh3C,KACtBg4C,EAAMjlB,aAAa,aAAcle,OAAO/I,IACxCksC,EAAMtlB,QAAU,IAAMh+B,KAAKwjD,QAAQpsC,GAC9BpX,KAAAujD,aAAapiD,OAAOmiD,EAAK,KAK9BtjD,KAAKy1B,UAAU5mB,OAAS,GAAG7O,KAAKwjD,QAAQ,EAC9C,CAGO,OAAAA,CAAQpsC,aACbvS,MAAMinC,KAAK9rC,KAAKojD,SAAS/sB,UAAUpc,SAAS/P,IAC1C,MAAM6gB,EAAK7gB,EACP6gB,EAAG60B,aAAa,gBAAkBz/B,OAAO/I,GAC3C2T,EAAGxF,MAAM+V,QAAU,OAEnBvQ,EAAGxF,MAAM+V,QAAU,EACrB,IAGG,OAAAr5B,EAAAjC,KAAAujD,eACDthD,EAAA4pC,iBAAiB,eAClB5xB,SAAS/P,GAASA,EAAKkuB,UAAUQ,OAAO,YACtC,OAAA0L,EAAA,OAAAniC,EAAAnC,KAAAujD,mBAAc,EAAAphD,EAAA60B,cAAc,oBAAoB5f,SAAhDktB,EAA4DlM,UAAUC,IAAI,UAE/Er4B,KAAK+hD,kBACP,CAEQ,gBAAAA,GAGR,CAGO,sBAAAJ,CAAuB5xC,GACxB,OAAC/P,KAAKy1B,WAAc5wB,MAAMC,QAAQ9E,KAAKy1B,YAEtCz1B,KAAAy1B,UAAUxb,SAASqoC,IACL,UAAbA,EAAI//C,MACD1B,OAAAmkC,QAAQsd,EAAIzvC,OAAOoH,SAAQ,EAAE7C,EAAOlN,MACzC6F,EAAOA,EACJtB,MAAM,KAAKvE,EAAKjJ,QAChByD,KAAK,aAAawF,EAAKsD,sBAAsBtD,EAAKjJ,QAAO,GAC7D,IAGI8O,GAXuDA,CAYhE,ECnTI,MAAA0zC,GAAe,CAAC,MAAO,MAAO,OAAQ,MAAO,MAAO,MAAO,QAEjE,MAAqBC,WAAerhB,GAGlC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAHAviC,EAAAC,KAAA,mBAKNA,KAAKsiC,IAAI2e,YAAW,IAAMjhD,KAAKwJ,SAE/BxJ,KAAK2jD,aACP,CAEQ,IAAAn6C,GACDxJ,KAAA4jD,gBAAkBt5B,SAASH,cAAc,SAC9CnqB,KAAK4jD,gBAAgBrhD,KAAO,OACvBvC,KAAA4jD,gBAAgBr+B,MAAM+V,QAAU,OAChCt7B,KAAA4jD,gBAAgBC,OAASJ,GAAaj/C,KAAKif,GAAM,IAAIA,MAAK/e,KAAK,KAGpE,MAAM89B,EAAOxiC,KAAKuiC,OAChB,kBAAkBpW,GAAG,+yBAElBqW,EAAAlG,MAAMt8B,KAAK4jD,iBAChBphB,EAAKxE,QAAU,KAEb,MAAMwC,EAASxgC,KAAK4jD,gBACpBpjB,EAAOsjB,SAAW,KACf,MAAa5hD,EAAAlC,KAAA,MAAA,YAEZ,IAAKwgC,EAAOujB,OAAiC,IAAxBvjB,EAAOujB,MAAMl1C,OAAc,OAC1C,MAAAm1C,EAAOxjB,EAAOujB,MAAM,GAC1B/jD,KAAKikD,UAAUD,EAAI,KAJpB,IAOHxjB,EAAO9B,OAAM,EAGV1+B,KAAKsiC,IAAIke,UAAUjqB,WACjBv2B,KAAAwiC,KAAMnE,aAAa,sBAAuB,GAEnD,CAEQ,WAAAslB,GAEA,MAAAO,EAAsBH,IAC1B,GAAKA,EAEL,IAAA,IAASr1C,EAAI,EAAGA,EAAIq1C,EAAMl1C,OAAQH,IAAK,CAC/B,MAAAs1C,EAAOD,EAAMr1C,GACnB1O,KAAKikD,UAAUD,EACjB,GAMIG,EAActvB,IAClBA,EAAI2W,kBACJ3W,EAAIgM,gBAAe,EAGfujB,EAAUvvB,UACR,MAAAkvB,EAAQ,OAAA9hD,EAAI4yB,EAAAwvB,mBAAc,EAAApiD,EAAA8hD,aAC5BA,WAAOl1C,UACTgmB,EAAIgM,iBACJqjB,EAAmBH,GACrB,EAIIO,EAAWzvB,UACT,MAAAkvB,EAAQ,OAAA9hD,EAAI4yB,EAAA0vB,oBAAe,EAAAtiD,EAAA8hD,aAC7BA,WAAOl1C,UACTgmB,EAAIgM,iBACJqjB,EAAmBH,GACrB,EAGG/jD,KAAAsiC,IAAI2e,YAAW,KAClBjhD,KAAKsiC,IAAIsB,QAAQ/B,UAAUpF,iBAAiB,WAAY0nB,GACxDnkD,KAAKsiC,IAAIsB,QAAQ/B,UAAUpF,iBAAiB,OAAQ2nB,GACpDpkD,KAAKsiC,IAAIsB,QAAQ/B,UAAUpF,iBAAiB,QAAS6nB,EAAO,IAEzDtkD,KAAAsiC,IAAI4e,cAAa,KACpBlhD,KAAKsiC,IAAIsB,QAAQ/B,UAAUrF,oBAAoB,WAAY2nB,GAC3DnkD,KAAKsiC,IAAIsB,QAAQ/B,UAAUrF,oBAAoB,OAAQ4nB,GACvDpkD,KAAKsiC,IAAIsB,QAAQ/B,UAAUrF,oBAAoB,QAAS8nB,EAAO,GAEnE,CAEM,SAAAL,CAAUD,GAAY,OAAA9hD,EAAAlC,KAAA,MAAA,YAC1B,MAAMwkD,EAAU,SAASz2C,KAAKi2C,EAAK14C,MACnC,IAAKk5C,IAAYf,GAAanpC,SAAS6F,OAAOqkC,EAAQ,IAAI1vC,eAAgB,OAG1E,IAAK9U,KAAKsiC,IAAIie,UAAU9oB,wBAEtB,YADAz3B,KAAKsiC,IAAIme,YAAYzmB,WAAW7N,GAAG,kBAAmB,KAKxD,IAAIs4B,EAAe,KAC6B,KAA5CzkD,KAAKsiC,IAAIsB,QAAQ/B,UAAUz9B,MAAMuK,SAA8B81C,EAAA,IAGnE,MAAMC,EAAuB,GAAGD,kBAA6BT,EAAK14C,WAI9D,IAAAzB,EAHJ7J,KAAKsiC,IAAIme,YAAY7a,cAAc8e,GAI/B,IACF,MAAMC,EAAmB3kD,KAAKsiC,IAAIke,UAAUoE,YAM1C/6C,EALG86C,EAKI,CAAEE,iBAAkBF,EAAiBX,WAH9BhkD,KAAKsiC,IAAI+d,SAAS73C,OAAOA,OAAO,CAAEw7C,UAASxjD,WAKpDgK,GACPI,QAAQ9G,MAAM0G,GACdxK,KAAKsiC,IAAIme,YAAYzmB,WAAW,GAAG7N,GAAG,kBAAkB3hB,EAAIE,UAAW,IACzE,CACA,GAAMb,GAAQA,EAAKg7C,WAAY,CAC7B,IAAIC,EAASj7C,EAAKg7C,WAGb3Y,GAAiB4Y,KACpBA,EAASnd,GAAuB,CAC9BnZ,KAAMxuB,KAAKsiC,IAAIke,UAAUtrB,OACzB5yB,KAAMwiD,KAIL9kD,KAAAsiC,IACFme,YACA/a,WACC1lC,KAAKsiC,IACFsB,QACA/B,UAAUz9B,MAAM8I,QAAQw3C,EAAsB,GAAGD,QAAmBK,MACzE,MAGF9kD,KAAKsiC,IACFme,YACA/a,WAAW1lC,KAAKsiC,IAAIsB,QAAQ/B,UAAUz9B,MAAM8I,QAAQw3C,EAAsB,IAEjF,GAAA,ECnJF,MAAqBK,WAAgB1iB,GAGnC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAHkBviC,EAAAC,KAAA,mBAAA,GAKnBA,KAAAsiC,IAAI2e,YAAW,KAClBjhD,KAAKyiC,SAAS,+CAGTziC,KAAAuiC,OACH,kBAAkBpW,GAAG,iWAAU,IAG9BnsB,KAAAsiC,IAAI4e,cAAa,SAGtBlhD,KAAKsiC,IAAIS,YAAYpO,GAAG,mBAAoBrZ,IACrCtb,KAAAglD,iBAAmBhlD,KAAKilD,mBAG/BjlD,KAAK8iC,cAAa,KAChB9iC,KAAKglD,iBAAkB,EACvBhlD,KAAKilD,eAAc,IAErBjlD,KAAKijC,cAAa,KAChBjjC,KAAKglD,iBAAkB,CAAA,GAE3B,CAEA,aAAAC,GACEjlD,KAAK0iC,OAAQnY,UAAYvqB,KAAKsiC,IAAIme,YAAYhb,kBAChD,ECrBF,MAAMyf,GAAsC,CNZ5C,cAA0C7iB,GACxC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAEN,MAAM6iB,EAAmB,KACvBnlD,KAAK+uB,MAAK,EAGP/uB,KAAAsiC,IAAI2e,YAAW,KAElB,MAAMmE,EAAeh+B,OAAO02B,aAAaC,QAAQmC,KAAoB,GACzC,KAAxBkF,EAAaz2C,SACf3O,KAAKsiC,IAAIme,YAAYzmB,WAAW7N,GAAG,eAAgB,KACnDnsB,KAAKsiC,IAAIme,YAAY/a,WAAW0f,IAIlCplD,KAAKsiC,IAAIS,YAAYpO,GAAG,kBAAmBwwB,EAAgB,IAGxDnlD,KAAAsiC,IAAI4e,cAAa,KACpBlhD,KAAKsiC,IAAIS,YAAYnO,IAAI,kBAAmBuwB,EAAgB,GAEhE,CAGO,IAAAp2B,GACE3H,OAAA02B,aAAaG,QAAQiC,GAAiBlgD,KAAKsiC,IAAIme,YAAYnb,gBAAgB32B,OACpF,GO/BF,cAAyC0zB,GACvC,WAAYgjB,GACV,OAAOrlD,KAAKsiC,IAAIme,YAAYrb,mBAC9B,CAEA,WAAAvlC,CAAYyiC,GACVp9B,MAAMo9B,GAEN,MAAMgjB,EAAgD,CAAA,EAChDC,EAAiD,CAAA,EAEjD/7B,EACJ,CAACqL,EAAuC2L,EAA0BglB,IAAkB,KAC7ExlD,KAAAsiC,IAAIS,YAAYvZ,QAAQqL,EAAK,CAAE2wB,QAAOhlB,UAAQ,EAGlDxgC,KAAAsiC,IAAI2e,YAAW,KAEXpgD,OAAAmkC,QAAQhlC,KAAKqlD,SAASprC,SAAQ,EAAEhZ,EAAKu/B,MACnCA,EAAA/D,iBACL,QACC6oB,EAAcrkD,GAAOuoB,EAAQ,eAAgBgX,EAAQv/B,IAEjDu/B,EAAA/D,iBACL,SACC8oB,EAAetkD,GAAOuoB,EAAQ,gBAAiBgX,EAAQv/B,GAAG,GAE9D,IAGEjB,KAAAsiC,IAAI4e,cAAa,KAEbrgD,OAAAmkC,QAAQhlC,KAAKqlD,SAASprC,SAAQ,EAAEhZ,EAAKu/B,MAC1CA,EAAOhE,oBAAoB,QAAS8oB,EAAcrkD,IAClDu/B,EAAOhE,oBAAoB,SAAU+oB,EAAetkD,GAAI,GACzD,GAEL,GCnCF,cAAwCohC,GACtC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAoCQviC,EAAAC,KAAA,QAAA,CACdylD,MAAsB,KACtBC,QAA8B,OApC9B,MAAMC,EAAU,EAAGnlB,SAAQglB,YACe,SAApCxlD,KAAKsiC,IAAIme,YAAYtb,aAGzBnlC,KAAKsiC,IAAIie,UAAU1hB,OAAO,CAAE2mB,CAACA,GAAQhlB,EAAOp8B,MAAMuK,SAGpC,SAAV62C,GAA8B,UAAVA,QAAwBI,kBAG5CC,EAAe,CACnBv6C,KAAM6gB,GAAG,QACT1kB,MAAO0kB,GAAG,SACVxc,KAAMwc,GAAG,SAGNnsB,KAAAsiC,IAAI2e,YAAW,KAClBpgD,OAAOmkC,QAAQhlC,KAAKsiC,IAAIme,YAAYrb,qBAAqBnrB,SAAQ,EAAEhZ,EAAKu/B,MAE/DA,EAAA9R,YAAcm3B,EAAa5kD,GAG3Bu/B,EAAAp8B,MAAQpE,KAAKsiC,IAAIie,UAAU/oB,UAAUv2B,IAAQ,EAAA,IAItDjB,KAAKsiC,IAAIS,YAAYpO,GAAG,eAAgBgxB,EAAO,IAG5C3lD,KAAAsiC,IAAI4e,cAAa,KACpBlhD,KAAKsiC,IAAIS,YAAYnO,IAAI,eAAgB+wB,EAAO,GAEpD,CAUQ,aAAAC,GACD5lD,KAAAsiC,IAAIie,UAAUpC,SAEfn+C,KAAKwC,MAAMijD,cAAcrkB,aAAaphC,KAAKwC,MAAMijD,OACjDzlD,KAAKwC,MAAMkjD,SAAS1lD,KAAKwC,MAAMkjD,UAEnC1lD,KAAKwC,MAAMijD,MAAQr+B,OAAOoU,YAAW,KACnCx7B,KAAKwC,MAAMijD,MAAQ,KAEb,MAAAK,EAAM9lD,KAAKsiC,IAAI+d,SACf0F,EAAe,qBACrB/lD,KAAKwC,MAAMkjD,QAAU,IAAMI,EAAIE,aAAaD,GAE5CD,EAAIl9C,KACDH,QACCjF,EAAA,CAAA,EAAKsiD,EAAI16C,iBACT,CACE7J,YAAawkD,IAGhBriD,MAAMs0B,GAAQh4B,KAAKimD,kBAAkBjuB,EAAIx3B,QACzCwD,OAAOwG,IAAD,IACN07C,SAAQ,KACPlmD,KAAKwC,MAAMkjD,QAAU,IAAA,GACtB,GACF,IACL,CAOQ,iBAAAO,CAAkBzlD,SAEnBA,EAAKinC,eAAenF,IAAIie,UAAUpC,SAGvCn+C,KAAKsiC,IAAI0B,eAAexM,UAAUxN,eAAexpB,EAAKupB,UAGlD/pB,KAAKsiC,IAAIie,UAAU9oB,0BAA4Bj3B,EAAKinC,WAAY,OAAAxlC,EAAAzB,EAAKoI,WAAL,EAAA3G,EAAW68B,WAExE9+B,KAAAsiC,IAAI0B,eAAehL,WAAW,CACjCwF,UAAW,SAKXh+B,EAAKoI,MAAQpI,EAAKoI,KAAK+G,OACzB3P,KAAKsiC,IAAIsB,QAAQjC,MAAMv9B,MAAQ5D,EAAKoI,KAAK+G,KACpC3P,KAAAsiC,IAAIie,UAAU1hB,OAAO,CAAElvB,KAAMnP,EAAKoI,KAAK+G,OAEhD,GCrGF,cAAwC0yB,GACtC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAEN,MAAM6jB,EAAe,EAAGX,YACR,SAAVA,GAAkBxlD,KAAKomD,mBAAkB,EAI1CpmD,KAAAsiC,IAAI2e,YAAW,KAClBjhD,KAAKsiC,IAAIS,YAAYpO,GAAG,gBAAiBwxB,EAAY,IAGlDnmD,KAAAsiC,IAAI4e,cAAa,KACpBlhD,KAAKsiC,IAAIS,YAAYnO,IAAI,gBAAiBuxB,EAAY,GAE1D,CAEQ,iBAAAC,GAEN,MAAMz2C,EAAO3P,KAAKsiC,IAAIsB,QAAQjC,MAAMv9B,MAAMuK,OACpCgB,IAAS,qBAAqB1C,KAAK0C,KACvC3P,KAAKsiC,IAAIsB,QAAQjC,MAAMv9B,MAAQ,WAAWuL,IAC1C3P,KAAKsiC,IAAIie,UAAU1hB,OAAO,CAAElvB,KAAM3P,KAAKsiC,IAAIsB,QAAQjC,MAAMv9B,QAE7D,GCxBF,cAAsCi+B,GACpC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAEN,MAAM+jB,EAAapiD,GAAqBjE,KAAKqmD,UAAUpiD,GACjD0hD,EAAU,IAAM3lD,KAAK2lD,UAEtB3lD,KAAAsiC,IAAI2e,YAAW,KAEbjhD,KAAAsiC,IAAIsB,QAAQ/B,UAAUnT,YAAc1uB,KAAKsiC,IAAIke,UAAU9xB,aAAevC,GAAG,eAG9EnsB,KAAKsiC,IAAIsB,QAAQ/B,UAAUpF,iBAAiB,UAAW4pB,GACvDrmD,KAAKsiC,IAAIsB,QAAQ/B,UAAUpF,iBAAiB,QAASkpB,EAAO,IAGzD3lD,KAAAsiC,IAAI4e,cAAa,KAEpBlhD,KAAKsiC,IAAIsB,QAAQ/B,UAAUrF,oBAAoB,UAAW6pB,GAC1DrmD,KAAKsiC,IAAIsB,QAAQ/B,UAAUrF,oBAAoB,QAASmpB,EAAO,IAGjE3lD,KAAKsiC,IAAIS,YAAYpO,GAAG,mBAAmB,KAEzCvN,OAAOoU,YAAW,KAChBx7B,KAAKsmD,yBAAwB,GAC5B,GAAE,GAET,CAGQ,SAAAD,CAAUpiD,GAGA,KAFAA,EAAE28B,SAAW38B,EAAEq2C,SAG7Br2C,EAAE48B,iBACF7gC,KAAKsiC,IAAIme,YAAY7a,cAAc,MAEvC,CAEQ,OAAA+f,GACD3lD,KAAAsiC,IAAIS,YAAYvZ,QAAQ,kBAAmBxpB,KAAKsiC,IAAIme,YAAYnb,gBACvE,CAGO,uBAAAghB,GACC,MAAAC,EAAOvmD,KAAKsiC,IAAIsB,QAAQ/B,UAAU2kB,aAAexmD,KAAKsiC,IAAIsB,QAAQ/B,UAAU/F,aAClF97B,KAAKsiC,IAAIsB,QAAQ/B,UAAUtc,MAAM0W,OAAS,MAC1Cj8B,KAAKsiC,IAAIsB,QAAQ/B,UAAUtc,MAAM0W,OAAS,GAAGj8B,KAAKsiC,IAAIsB,QAAQ/B,UAAU4kB,aAAeF,KACzF,GJ5BA1F,GKrBF,cAAuCxe,GACrC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAEN,MAAM0W,EAAU,KACTh5C,KAAAsiC,IAAIme,YAAY7Z,QAAO,EAGzB5mC,KAAAsiC,IAAI2e,YAAW,KAEbjhD,KAAAsiC,IAAIsB,QAAQ7B,WAAWpX,UAAY3qB,KAAKsiC,IAAIke,UAAUrrB,SAAWhJ,GAAG,QAGzEnsB,KAAKsiC,IAAIsB,QAAQ7B,WAAWtF,iBAAiB,QAASuc,EAAO,IAG1Dh5C,KAAAsiC,IAAI4e,cAAa,KACpBlhD,KAAKsiC,IAAIsB,QAAQ7B,WAAWvF,oBAAoB,QAASwc,EAAO,GAEpE,GLIAzV,GMlBF,cAAwClB,GAGtC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAHAviC,EAAAC,KAAA,WAMDA,KAAAkjC,qBAAqB,SAAU/J,IAClCn5B,KAAKs5B,SAASH,GAEP,KACLn5B,KAAK0mD,aAAY,KAKrB1mD,KAAKsiC,IAAIS,YAAYpO,GAAG,WAAW,KACjC,MAAMgyB,EAAa3mD,KAAKsiC,IAAIskB,QAAQ/F,IACpC,IAAK8F,EAAkB,MAAA57C,MAAM,8BAE7B,MAAM+1C,EAAgB,IAAIX,GAAgBngD,KAAKsiC,KAE/CqkB,EAAWxF,eAAe,CACxBG,WAAY,MAAQthD,KAAKkG,QACzBs7C,IAAK,IAAYt/C,EAAAlC,KAAA,MAAA,YACf,IAAKA,KAAKkG,QAAe,MAAA,IAAI6E,MAAM,iCAY5B,aATC/K,KAAKsiC,IAAI+d,SAAS/2B,SAASrjB,cAAc1C,EACzCC,EAAA,CAAA,QAAMs9C,EAAcR,sBADqB,CAE7ClY,IAAKpoC,KAAKkG,QAAQE,GAClB64C,SAAUj/C,KAAKkG,QAAQ+4C,SACvBC,gBAAY,EACZC,UAAWn/C,KAAKkG,QAAQi5C,cAE1B3+C,IAGJ,IACAihD,KAAOF,IAEC,MAAAh7C,EAAOvG,KAAKsiC,IAAIke,UAClBe,EAAStC,WAAa14C,EAAKyuB,SAC7B5N,OAAO0M,KAAK,GAAGytB,EAASsF,wBAAwBtF,EAASn7C,MAG3D06C,EAAcH,cAAcY,EAAQ,GAEvC,GAEL,CAEQ,QAAAjoB,CAASH,GACT,MAAA4L,EAAK/kC,KAAKsiC,IAAIsB,QAChB,IAACmB,EAAG+hB,cAAe,CACrB,MAAMtkB,EAAOtH,GACX,2DAEK/O,GAAG,iHAKVqW,EAAKxL,cAA2B,aAAcrM,UAAY,IAAIwO,EAAYnK,OACrEwT,EAAA/F,iBAAiB,SAAS,KACxBz8B,KAAAsiC,IAAIme,YAAYvmB,YAAW,IAE/B6K,EAAA7C,WAAW/gC,OAAOqhC,GACrBuC,EAAG+hB,cAAgBtkB,CACrB,CAEAxiC,KAAKkG,QAAUizB,EAEf4L,EAAGlD,UAAUnB,OACf,CAEQ,WAAAgmB,GACF,IAAC1mD,KAAKkG,QAAS,OAEb,MAAA6+B,EAAK/kC,KAAKsiC,IAAIsB,QAChBmB,EAAG+hB,gBACL/hB,EAAG+hB,cAAcluB,SACjBmM,EAAG+hB,mBAAgB,GAErB9mD,KAAKkG,aAAU,CACjB,GCvFF,cAAuCm8B,GAGrC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAHAviC,EAAAC,KAAA,WAoGwBD,EAAAC,KAAA,wBAAA,QA9FzBA,KAAAkjC,qBAAqB,QAASh9B,IACjClG,KAAKoN,KAAKlH,GAEH,KACLlG,KAAK+mD,YAAW,KAKf/mD,KAAAsiC,IAAI2e,YAAW,KAClB,MAAM0F,EAAa3mD,KAAKsiC,IAAIskB,QAAQ/F,IACpC,IAAK8F,EAAkB,MAAA57C,MAAM,8BAE7B47C,EAAWxF,eAAe,CACxBG,WAAY,MAAQthD,KAAKkG,QACzBs7C,IAAK,IAAYt/C,EAAAlC,KAAA,MAAA,YACf,MAAMgnD,EAAW,CACf1rC,QAAStb,KAAKsiC,IAAIme,YAAYpb,kBAC9BrW,KAAMhvB,KAAKsiC,IAAIsB,QAAQnC,MAAMr9B,MAC7BqD,MAAOzH,KAAKsiC,IAAIsB,QAAQlC,OAAOt9B,MAC/BuL,KAAM3P,KAAKsiC,IAAIsB,QAAQjC,MAAMv9B,OAEzB8B,EAAUlG,KAAKkG,QAKrB,aAJuBlG,KAAKsiC,IAAI+d,SAAS/2B,SAASjjB,cAAcH,EAAQE,GAAI5C,EACvEA,EAAA,CAAA,EAAA0C,GACA8gD,KAEWxmD,IAClB,IACAihD,KAAOF,IACLvhD,KAAKsiC,IAAI0B,eAAexM,UAAUnxB,cAAck7C,EAAQ,GAE3D,GAEL,CAEQ,IAAAn0C,CAAKlH,GACL,MAAA6+B,EAAK/kC,KAAKsiC,IAAIsB,QAChB,IAACmB,EAAGkiB,eAAgB,CACtB,MAAMzkB,EAAOtH,GACX,2DAEK/O,GAAG,uFAKVqW,EAAKxE,QAAU,KACRh+B,KAAAsiC,IAAIme,YAAYvmB,YAAW,EAE/B6K,EAAA7C,WAAW/gC,OAAOqhC,GACrBuC,EAAGkiB,eAAiBzkB,CACtB,CACAxiC,KAAKkG,QAAUA,EAEZ6+B,EAAAvD,QAAQjc,MAAM+V,QAAU,OAExByJ,EAAAtD,MAAMr9B,MAAQ8B,EAAQ8oB,MAAQ,GAC9B+V,EAAArD,OAAOt9B,MAAQ8B,EAAQuB,OAAS,GAChCs9B,EAAApD,MAAMv9B,MAAQ8B,EAAQyJ,MAAQ,GAEjC3P,KAAKsiC,IAAIme,YAAY/a,WAAWx/B,EAAQoV,SACxCypB,EAAGlD,UAAUnB,QAER1gC,KAAAknD,oBAAoB/6B,GAAG,QAC9B,CAEQ,UAAA46B,GACF,IAAC/mD,KAAKkG,QAAS,OAEb,MAAA6+B,EAAK/kC,KAAKsiC,IAAIsB,QAEhBmB,EAAGkiB,iBACLliB,EAAGkiB,eAAeruB,SAClBmM,EAAGkiB,oBAAiB,GAGtBjnD,KAAKkG,aAAU,EAET,MAAAoF,KAAEA,EAAM7D,MAAAA,EAAOkI,KAAAA,GAAS3P,KAAKsiC,IAAIie,UAAU/oB,UACjDuN,EAAGtD,MAAMr9B,MAAQkH,EACjBy5B,EAAGrD,OAAOt9B,MAAQqD,EAClBs9B,EAAGpD,MAAMv9B,MAAQuL,EAEjB3P,KAAKsiC,IAAIme,YAAY/a,WAAW,IAChC1lC,KAAKmnD,uBAEFpiB,EAAAvD,QAAQjc,MAAM+V,QAAU,EAC7B,CAQQ,mBAAA4rB,CAAoBn3C,GAC1B/P,KAAKonD,sBAAwBpnD,KAAKsiC,IAAIsB,QAAQ7B,WAAWpX,UACzD3qB,KAAKsiC,IAAIsB,QAAQ7B,WAAWpX,UAAY5a,CAC1C,CAEQ,oBAAAo3C,GACNnnD,KAAKsiC,IAAIsB,QAAQ7B,WAAWpX,UAAY3qB,KAAKonD,qBAC/C,GChHF,cAAsC/kB,GACpC,WAAAxiC,CAAYyiC,GACVp9B,MAAMo9B,GAEA,MAAA+kB,EAAS,IAAMrnD,KAAK8zB,OACpBwzB,EAAU,IAAMtnD,KAAKogC,QAEtBpgC,KAAAsiC,IAAI2e,YAAW,KAClBjhD,KAAKsiC,IAAIS,YAAYpO,GAAG,cAAe0yB,GACvCrnD,KAAKsiC,IAAIS,YAAYpO,GAAG,eAAgB2yB,EAAO,IAE5CtnD,KAAAsiC,IAAI4e,cAAa,KACpBlhD,KAAKsiC,IAAIS,YAAYnO,IAAI,cAAeyyB,GACxCrnD,KAAKsiC,IAAIS,YAAYnO,IAAI,eAAgB0yB,EAAO,GAEpD,CAEQ,IAAAxzB,SACN,OAAA7xB,EAAAjC,KAAKsiC,IAAIsB,QAAQhC,cAAc5K,cAAc,yBAAwB/0B,EAAA22B,SACrE54B,KAAKsiC,IAAIsB,QAAQ/B,UAAUtc,MAAM+V,QAAU,GAC3Ct7B,KAAKsiC,IAAIsB,QAAQ9B,QAAQvc,MAAM+V,QAAU,EAC3C,CAEQ,KAAA8E,GACDpgC,KAAKsiC,IAAIsB,QAAQhC,cAAc5K,cAAc,wBAC3Ch3B,KAAAsiC,IACFsB,QACAhC,cAAckI,QACb5O,GAAoB,mCAAmC/O,GAAG,+BAG3DnsB,KAAKsiC,IAAIie,UAAU/oB,UAAUsH,UAMhC9+B,KAAKsiC,IAAIsB,QAAQ/B,UAAUtc,MAAM+V,QAAU,GAC3Ct7B,KAAKsiC,IAAIsB,QAAQ9B,QAAQvc,MAAM+V,QAAU,KANzCt7B,KAAKsiC,IAAIsB,QAAQ/B,UAAUtc,MAAM+V,QAAU,OAC3Ct7B,KAAKsiC,IAAIS,YAAYvZ,QAAQ,eAC7BxpB,KAAKsiC,IAAIsB,QAAQ9B,QAAQvc,MAAM+V,QAAU,OAM7C,GRZAomB,GACAgC,GACAqB,IS7BF,MAAqBwC,GACnB,WAAA1nD,CAAoB0lC,GAAAvlC,KAAAulC,MAAAA,CAAqB,CAGzC,SAAAkb,GACE,OAAOzgD,KAAKulC,MAAMlM,MACpB,CAOA,YAAA2K,GACS,OAAAhkC,KAAKulC,MAAMlM,OAAOhC,GAC3B,CAGA,OAAAmpB,GACS,OAAAxgD,KAAKulC,MAAMlM,OAAOhC,IAAI9wB,IAC/B,CAGA,MAAA85C,GACE,OAAOrgD,KAAKulC,MAAMlM,OAAOhC,IAAIoB,QAC/B,CAGA,OAAA8nB,GACE,OAAOvgD,KAAKulC,MAAMlM,OAAOhC,IAAI11B,IAAI,OACnC,CAGA,KAAAiiC,GACS,OAAA5jC,KAAKulC,MAAMlM,OAAOsL,OAC3B,CAGA,SAAA5B,GACS,OAAA/iC,KAAKulC,MAAMI,WACpB,CAGA,UAAAsb,CAAWre,GACT5iC,KAAK+iC,YAAYpO,GAAG,UAAWiO,EACjC,CAGA,YAAAse,CAAate,GACX5iC,KAAK+iC,YAAYpO,GAAG,YAAaiO,EACnC,CAGA,OAAAgkB,CAAqCY,GAC5B,OAAAxnD,KAAKulC,MAAM5jC,IAAI6lD,EACxB,EClCK,MAAMC,GAkBX,WAAA5nD,CAAmBw5B,GAjBXt5B,EAAAC,KAAA,QAAsB,IACUD,EAAAC,KAAA,aAAA,MAChCD,EAAAC,KAAA,SAAS,IAAI00B,IAeF10B,KAAAq5B,OAAAA,EACjB,IAAIquB,GAAa,EACjB1nD,KAAKq5B,OAAOhC,IAAIM,UACd,CAAC,YAAa,YAAa,UAAW,eAAgB,WACrDpxB,IAGCmhD,GAAc1nD,KAAK2lC,YAAYnc,QAAQ,aAGvCxpB,KAAK2nD,QVdN,SACLphD,GAIM,MAAAqhD,MAAe3nD,IAMrB,OALS2nD,EAAA9lD,IAAI4hD,GAAQn9C,EAAKgwB,WACjBqxB,EAAA9lD,IAAI4/C,GAAWn7C,EAAKkvB,WACpBmyB,EAAA9lD,IAAIijD,GAASx+C,EAAK2oB,SAClB04B,EAAA9lD,IAAIyhC,GAAOh9B,EAAK8uB,cAElB6vB,GAAatgD,QAAQm7B,IAAO6nB,EAASnmD,IAAIs+B,MAAQ6nB,EAASjmD,IAAIo+B,IACvE,CUKQ8nB,CAAgBthD,GAAM0T,SAAS6tC,IAEvB,MAAAxlB,EAAM,IAAIilB,GAAQvnD,MACxBA,KAAKulC,MAAMv2B,KAAK,IAAI84C,EAAKxlB,GAAI,IAI1BtiC,KAAA2lC,YAAYnc,QAAQ,WACZk+B,GAAA,EAGb1nD,KAAK+nD,cAAa,IAItB/nD,KAAK+oB,OAAO4L,GAAG,eAAe,IAAM30B,KAAKgoD,kBAC3C,CA1CA,QAAA5jB,GACE,OAAOpkC,KAAKulC,KACd,CACA,SAAAI,GACE,OAAO3lC,KAAK+oB,MACd,CAEQ,KAAA4+B,GACN3nD,KAAKulC,MAAQ,GACRvlC,KAAA+oB,OAAS,IAAI2L,GACd10B,KAAKioD,YAAYjoD,KAAKgoD,gBAC5B,CAiCQ,YAAAD,GAEN/nD,KAAKq5B,OAAOsL,QAAQvC,eAAe7X,UAAY,GAC/CvqB,KAAKq5B,OAAOsL,QAAQvC,eAAe7c,MAAM+V,QAAU,OACnDt7B,KAAKq5B,OAAOsL,QAAQxC,aAAa5X,UAAY,GAG7CvqB,KAAKulC,MAAMtrB,SAASutC,GAASxnD,KAAKkoD,eAAeV,IACnD,CAGQ,cAAAU,CAAeV,GACrB,MAAMhlB,EAAOglB,EAAKhlB,KAClB,IAAKA,EAAM,OACXxiC,KAAKq5B,OAAOsL,QAAQxC,aAAa9G,YAAYmH,IAG5CA,EAAKxE,UACHwE,EAAKxE,QAAU,KAEdh+B,KAAKq5B,OACFsL,QACAxC,aAAa0J,iBAAiB,WAC9B5xB,SAAS/P,GAASA,EAAKkuB,UAAUQ,OAAO,YAGvC4uB,IAASxnD,KAAKioD,YAEhBjoD,KAAKmoD,cAAcX,GAGdhlB,EAAApK,UAAUC,IAAI,WAGnBr4B,KAAKgoD,gBACP,GAIJ,MAAMtlB,EAAS8kB,EAAK9kB,OAChBA,IACFA,EAAOnd,MAAM+V,QAAU,OACvBt7B,KAAKq5B,OAAOsL,QAAQvC,eAAe/G,YAAYqH,GAEnD,CAEA,GAAA/gC,CAAiC6lD,GAC/B,OAAOxnD,KAAKulC,MAAM7b,MAAMqW,GAAMA,aAAaynB,GAC7C,CAGA,aAAAW,CAAcX,GACPxnD,KAAAulC,MAAMtrB,SAAS+oB,IAClB,MAAMolB,EAAYplB,EAAMN,OACnB0lB,IAEDplB,IAAUwkB,GACZY,EAAU7iC,MAAM+V,QAAU,GACrBt7B,KAAA+oB,OAAOS,QAAQ,aAAcg+B,KAElCY,EAAU7iC,MAAM+V,QAAU,OACrBt7B,KAAA+oB,OAAOS,QAAQ,aAAcg+B,IACpC,IAGFxnD,KAAKq5B,OAAOsL,QAAQvC,eAAe7c,MAAM+V,QAAU,GACnDt7B,KAAKioD,WAAaT,CACpB,CAGA,cAAAQ,GACOhoD,KAAKioD,aAEVjoD,KAAKq5B,OAAOsL,QAAQvC,eAAe7c,MAAM+V,QAAU,OACnDt7B,KAAK+oB,OAAOS,QAAQ,aAAcxpB,KAAKioD,YACvCjoD,KAAKioD,WAAa,KACpB,CAGA,qBAAAziB,CAAsB6iB,GACpB,IAAI1nC,EAAS0nC,EAKN,OAJFroD,KAAAulC,MAAMtrB,SAAS+oB,IACbA,EAAMH,qBACFliB,EAAAqiB,EAAMH,mBAAmBliB,GAAM,IAEnCA,CACT,EChKW,iBCYN,SAAS2nC,GAAgB/+C,GACxB,MAAAg/C,EAAQrtB,GAAoB,8DAIlC,GAHAqtB,EAAMvxB,cAA2B,kBAAmBrM,UAClD,GAAGwB,GAAG,uBAAuB5iB,EAAK4Q,SAEhC5Q,EAAKi/C,QAAS,CAChB,MAAMC,EAAYvtB,GAAoB,iCAAiC/O,GAAG,uBAC1Es8B,EAAUzqB,QAAU,IAAMz0B,EAAKi/C,SAAWj/C,EAAKi/C,UAC/CD,EAAMltB,YAAYotB,EACpB,CAEA,GAAIl/C,EAAKm/C,cAAe,CACtB,MAAMC,EAAeztB,GACnB,8DAA8D/O,GAAG,WAAY,CAAE7gB,KAAM6gB,GAAG,iCAE1Fo8B,EAAMltB,YAAYstB,GAClBA,EAAa3qB,QAAU,IAAMz0B,EAAKm/C,eAAiBn/C,EAAKm/C,eAC1D,CAEY/rB,GAAApzB,EAAKq/C,KAAML,EACzB,CC3BA,IAAIM,IAAqB,ECHrB,IAAAC,GAEK,SAAAC,GAAiBC,EAAqB5zB,GAC7C,MAAM6zB,EAAoB,gBAErBD,EAAA/uC,SAASilB,IACR9J,EAAU8J,EAAI9G,UAAUC,IAAI4wB,GAC3B/pB,EAAI9G,UAAUQ,OAAOqwB,EAAiB,GAE/C,CAEa,MCLAC,GAAiC,CtBPP7xB,IACrCA,EAAIM,UAAU,CAAC,cAAe,kBAAmBpxB,K/D8B5C,SAAoBK,GACrB,IACE,IAACgW,GAAOtR,KAAM,MAAA,CACZ,MAAArH,GACN,MACF,CAGMkb,MAAAA,EAAS,IAAIvC,GACnBuC,EAAOrC,WAAWtZ,EAAAA,EAAA,CAChBsI,SAAU6a,GAAY,CACpBiB,YAAahhB,EAAQghB,eAEpBG,IACAnhB,EAAQmhB,gBAGF5I,GAAAA,CACb,C+D/CsBgqC,CAAA,CAChBphC,cAAesP,EAAIU,UAAUhQ,cAC7BH,YAAayP,EAAIU,UAAUnQ,aAC5B,IAGHyP,EAAIM,UAAU,CAAC,oBAAqBpxB,I/Da/B,IAAsBgyC,E+DZpBhyC,EAAA6iD,kB/DYoB7Q,E+DZmBhyC,EAAK6iD,gB/DavCthC,GAAAywB,E+DbsD,GACjE,EiBOqClhB,IAChC,MAAAgC,EAAShC,EAAI11B,IAAI,UAEjB68C,EAAc,IAAIiJ,GAAYpuB,GAChChC,EAAAkB,OAAO,cAAeimB,EAAW,EMtBKnnB,IAC1C,MAAMgyB,EAAY,KAuCX,IAAkBrL,IArCrB3mB,EAAI11B,IAAI,QAAQ61B,UAAUsH,SAgBhC,SAAyBv1B,GACvB,MAAMg2C,EAAqB,GAGtBh2C,EAAA4uB,MACF0T,iBAA8B,yBAC9B5xB,SAAS/P,GAASq1C,EAAIvwC,KAAK9E,KAMxB,MAAAo/C,EAAah/B,SAAS0M,cAA2B,gBAMhD,OALHsyB,GAECA,EAAAzd,iBAA8B,yBAC9B5xB,SAAS/P,GAASq1C,EAAIvwC,KAAK9E,KAEzBq1C,CACT,CAlCMgK,CAAgB,CACdpxB,MAAOd,EAAIc,QAoCble,SAASqpC,IACPtF,EAASsF,EAAMlrB,UAAUQ,OAAO,YAC/B0qB,EAAMlrB,UAAUC,IAAI,WAAU,GArChC,EAIDhB,EAAA1C,GAAG,eAAe,YAIlB0C,EAAA1C,GAAG,gBAAiB/rB,UAEvB,KCAiC,CChBAyuB,IAC9BA,EAAA1C,GAAG,cAAe60B,IACpB,GAAInyB,EAAIG,UAAUxO,aAAc,OAC5BqO,EAAAG,UAAUtO,YAAW,GAEzB,MAAMvmB,EAA0Ba,EAAA,CAE9B6K,OAAQ,EACRo7C,MAAOpyB,EAAI9wB,KAAK0vB,WAAWC,SAC3BZ,SAAU+B,EAAI9wB,KAAK+uB,SACnBo0B,eAAgBryB,EAAI9wB,KAAKojD,yBACtBH,GAIDnyB,EAAAG,UAAUnO,iBAAiB,CAC7B1mB,WAIF,MAAMinD,EAAY,CAChBH,MAAO9mD,EAAO8mD,MACdp7C,OAAQ1L,EAAO0L,OACfw7C,UAAWlnD,EAAO2yB,SAClB2pB,SAAU5nB,EAAIU,UAAU/C,QACxBmqB,UAAW9nB,EAAIU,UAAU9vB,MAIvBtF,EAAO+mD,gBAAuB/mD,EAAA+mD,eAAeE,GAI9CvyB,EAAAoB,SACAnP,SAAStjB,YAAYxC,EAAAA,EAAA,CAAA,EACjBomD,GACAvyB,EAAIoB,SAASrtB,kBAEjB1H,MAAK,EAAGlD,WAKP62B,EAAIG,UAAUnO,iBAAiB,CAAE1mB,SAAQnC,SAGzC62B,EAAIG,UAAU5N,aAAappB,EAAK8oB,UAGhC+N,EAAIG,UAAUnwB,WAAW7G,EAAK4G,MAGvBzE,EAAA67B,WAAa77B,EAAO67B,UAAUh+B,GAErC62B,EAAI7N,QAAQ,eAAgB,CAAE7mB,SAAQnC,QAAM,IAE7CwD,OAAOC,IAEN,MAAMH,EAAQ,CACZ6G,IAAK1G,EAAE0G,KAAOwV,OAAOlc,GACrBzD,KAAMyD,EAAEzD,MASJ,MANCmC,EAAAkc,SAAWlc,EAAOkc,QAAQ/a,GAG7BuzB,EAAA7N,QAAQ,cAAe1lB,GAC3BuzB,EAAI7N,QAAQ,eAAgB,CAAE7mB,SAAQmB,UAEhCG,CAAA,IAEPiiD,SAAQ,KACH7uB,EAAAG,UAAUtO,YAAW,EAAK,GAC/B,GACJ,ECzEmCmO,IAChCA,EAAA1C,GAAG,cAAeoL,IACdxtB,MAAAA,EAAO8kB,EAAI11B,IAAI,QAEJ,IAAbo+B,EAAE1xB,QAEU6a,IAAA,EAAM3W,EAAK2sB,IAAG,IAI5B7H,EAAA1C,GAAG,gBAAgB,KAEPzL,IAAA,EADDmO,EAAI11B,IAAI,QACKu9B,IAAG,GAC9B,ECbkC7H,IAC/BA,EAAA1C,GAAG,oBAAqBzuB,IAEtB,IAAiC,IAAjCmxB,EAAI9wB,KAAKujD,oBAA8B,CACzC,MAAM//B,EAAWsN,EAAIG,UAAU9wB,cACzBqjD,EAAShgC,EAASL,MAAMjG,GAAMA,EAAEumC,aAAe9jD,EAAQmuC,UAEzD0V,GAEM7jD,EAAAojC,YAAYoJ,WAAU,GACtBxsC,EAAAojC,YAAYuJ,eAAc,KACzBzrB,OAAA0M,KAAKi2B,EAAOE,WAGnB5yB,EAAIG,UAAUxN,eAAeD,EAASnlB,QAAQ6e,GAAMA,EAAEumC,aAAe9jD,EAAQmuC,UAAQ,KAI/EnuC,EAAAojC,YAAYoJ,WAAU,EAElC,KAGErb,EAAA1C,GAAG,aAAcu1B,IACb,MAAAnjD,EAAYojD,GAAoB,kBAClCpjD,GAGCswB,EAAAoB,SACA1O,SAASljB,eAAeqjD,EAAWnjD,GACnCrD,MAAK,KAEJ2zB,EAAIG,UAAUxN,eACZqN,EACGG,UACA9wB,cACA9B,QAAQ6e,GAAMA,EAAEumC,aAAeE,IAAS,GAGnD,GACD,ECxCsC7yB,IACnC,IAAA+yB,EAIA/yB,EAAA1C,GAAG,WAAW,KACVpiB,MAAAA,EAAO8kB,EAAI11B,IAAI,QAEF4Q,EAAAA,EAAK2sB,IAAIlI,cAA2B,uCAGtCozB,EAAA3tB,iBAAiB,SAAS,KACzC,MAAMr1B,EAAOiwB,EAAIG,UAAUvN,UAC3B,IAAK7iB,EAAY,MAAA,IAAI2D,MAAM,uBAEtB3D,EAAAijD,YAAcjjD,EAAKijD,WA4BrB,SAAkBhzB,EAAiBjwB,GAC1CiwB,EAAIsC,oBACJtC,EACGoB,SACAumB,MAAM33C,WAAWD,EAAKhB,GAAIgB,GAC1B1D,MAAK,EAAGlD,WACH62B,EAAAG,UAAUnwB,WAAW7G,EAAI,IAE9BwD,OAAOwG,IACN6sB,EAAI0C,iBAAiB,GAAG5N,GAAG,gBAAgB3hB,EAAIE,SAAWyV,OAAO3V,KAAQ,IAAG,IAE7E07C,SAAQ,KACP7uB,EAAIwC,mBAAkB,GAE5B,CAzCMywB,CAAkBjzB,EAAKjwB,EAAI,GAC5B,IAICiwB,EAAA1C,GAAG,eAAgBvtB,YACf,MAAAiyB,EAAShC,EAAI11B,IAAI,WAGE,KAArB,MAAAyF,OAAA,EAAAA,EAAMijD,aAER,OAAApoD,EAAAo3B,EAAO+K,aAAYniC,EAAA0jC,YAAYnc,QAAQ,gBAClB4gC,IAAAA,EAAiBz/B,UAAYwB,GAAG,kBAGrD,OAAAhqB,EAAAk3B,EAAO+K,aAAYjiC,EAAAwjC,YAAYnc,QAAQ,eAClB4gC,IAAAA,EAAiBz/B,UAAYwB,GAAG,iBACvD,IAGEkL,EAAA1C,GAAG,eAAgBrL,IAErB+N,EAAI4C,kBAAiB,GACtB,ECtCiC5C,IAe9BA,EAAA1C,GAAG,eAAe,KAdI,cAClBpiB,MAEAg4C,EAFOlzB,EAAI11B,IAAI,QAEDu9B,IAAIlI,cAAc,gCACtC,IAAKuzB,EAAQ,OAEb,MAAMx6C,EAAO0kB,GACXtI,GAAG,UAAW,CACZje,MAAO,GAAG+f,OAAO,OAAA9rB,EAAA,OAAAF,EAAAo1B,EAAIG,UAAUrO,yBAAoB,EAAAlnB,EAAAzB,WAAM,EAAA2B,EAAA+L,QAAU,OAGvEq8C,EAAOhgC,UAAYxa,EAAK7C,QAAQ,QAAS,gDAA+C,QAOtFmqB,EAAA1C,GAAG,oBAAoB,KAEzB,MAAMvS,EAAOiV,EAAIG,UAAUrO,oBACjB,MAAN/G,OAAM,EAAAA,EAAA5hB,QAAW4hB,EAAA5hB,KAAK0N,OAAS,EAAA,IAGjCmpB,EAAA1C,GAAG,mBAAmB,KAExB,MAAMvS,EAAOiV,EAAIG,UAAUrO,oBACjB,MAAN/G,OAAM,EAAAA,EAAA5hB,QAAW4hB,EAAA5hB,KAAK0N,OAAS,EAAA,GACpC,EC9BsCmpB,IACvC,IAAImzB,EAAsC,KAE1C,MAAMC,EAAa,KACjB,IAAKD,EAAiB,OACtB,MAAM5hD,EAAOyuB,EAAI11B,IAAI,QAAQ61B,UAG7B,GAAM5uB,EAAK0C,MAAU1C,EAAKnB,MAAO,CACf+iD,EAAApyB,UAAUQ,OAAO,YAG3B,MAAA8xB,EAAWF,EAAgBxzB,cAA2B,aACxD0zB,IAAmBA,EAAA//B,UAAa/hB,EAAKk2B,SAA6B3S,GAAG,cAArBA,GAAG,aAA8B,MAErEq+B,EAAApyB,UAAUC,IAAI,WAChC,EAGFhB,EAAIM,UAAU,CAAC,WAAYpxB,IACnBgM,MAAAA,EAAO8kB,EAAI11B,IAAI,QAEH4Q,EAAAA,EAAK2sB,IAAIlI,cAA2B,gCACjDwzB,IAELA,EAAgBxsB,QAAU,KAExB3G,EAAI8C,aAAY,UAMhB9C,EAAA1C,GAAG,gBAAiB/rB,UAEvB,ECpCuCyuB,IACxC,IAAIszB,EAAmC,KAanCtzB,EAAA1C,GAAG,WAAW,KACVpiB,MAAAA,EAAO8kB,EAAI11B,IAAI,QAEN4Q,EAAAA,EAAK2sB,IAAIlI,cAA2B,oBAAmB,IAGpEK,EAAA1C,GAAG,oBAAqB5K,IAjBJ,IAAC7b,IAkBP6b,EAASlb,QAAU,EAjB9B87C,IAEDz8C,EAAQ,GACVy8C,EAAahgC,UAAY,GAAGsD,OAAO/f,GAAS,KAC5Cy8C,EAAaplC,MAAM+V,QAAU,SAE7BqvB,EAAaplC,MAAM+V,QAAU,OAWK,GACrC,ECpBoCjE,IAC/B,MAAAuzB,EAAyBhoB,IAC7BvL,EAAI9wB,KAAKojD,wBAA0B/mB,EACnCvL,EAAIoC,QAAO,EAGPoxB,EAAgBC,KA0DxB,SAAwBvkD,GAIhB,MAAAwkD,cAAEA,EAAeC,aAAAA,GAAiBzkD,EACpC,GAAAwkD,EAAc/zB,cAAc,iBAAkB,OAGpC+zB,EAAA3yB,UAAUC,IAAI,qBAGd0yB,EAAA5pD,OAAO+5B,GAAoB,8CAGzC,IAAI+vB,EAAa,EACjB,MAAMC,EAAc,CAACx8C,EAAW40C,EAAoBh4C,EAAcnB,SAInD8gD,EAAAv8C,EACby8C,EAAUtf,iBAAiB,WAAW5xB,SAAShW,IAC3CA,EAAAm0B,UAAUQ,OAAO,SAAQ,IAEvB0qB,EAAAlrB,UAAUC,IAAI,UAGpB8yB,EAAU5lC,MAAM+V,QAAU,OAC1BE,YAAW,KACT2vB,EAAU5lC,MAAM+V,QAAU,EAAA,GACzB,GAAE,EAID6vB,EAAYjwB,GAAoB,8CACzB8vB,EAAA/wC,SAAQ,CAAC/P,EAAMwE,KACpB,MAACpD,EAAMnB,GAAUD,EAEjBo5C,EAAQpoB,GAAoB,oDAC5ByG,EAAQ2hB,EAAMtsB,cAA2B,QAC/C2K,EAAMhX,UAAYrf,EAClBq2B,EAAM3D,QAAU,KACFktB,EAAAx8C,EAAG40C,EAAOh4C,EAAMnB,EAAM,EAEpCghD,EAAUhqD,OAAOmiD,GAEb50C,IAAMu8C,GAAkB3H,EAAAlrB,UAAUC,IAAI,SAAQ,IAGpD0yB,EAAc5pD,OAAOgqD,EACvB,CA1GmBC,CAAA,CACbL,cAAeD,EACfE,aAAc,CACZ,CACE7+B,GAAG,cACH,KACEy+B,GAAuB7qB,IACrBA,EAAEsrB,QAAU,WAAA,GACb,GAGL,CACEl/B,GAAG,YACH,KACEy+B,GAAuB7qB,IACrBA,EAAEsrB,QAAU,MAAA,GACb,GAGL,CACEl/B,GAAG,cACH,KACEy+B,GAAuB7qB,IACrBA,EAAEsrB,QAAU,UAAA,GACb,GAGL,CACEl/B,GAAG,cACH,KACEy+B,GAAuB7qB,IACrBA,EAAEurB,iBAAkB,CAAA,GACrB,KAIR,EAGHj0B,EAAIM,UAAU,CAAC,WAAY,WAAYpxB,IAC/BgM,MAEAg4C,EAFOlzB,EAAI11B,IAAI,QAEDu9B,IAAIlI,cAA2B,sBAC9CuzB,IAGDhkD,EAAKovB,SACPk1B,EAAaN,GA8DnB,SAAwBhkD,WAChB,MAAAwkD,cAAEA,GAAkBxkD,EACZwkD,EAAA3yB,UAAUQ,OAAO,qBACjB,OAAA32B,EAAA8oD,EAAA/zB,cAAc,0BAAyB/0B,EAAA22B,SACvC,OAAAz2B,EAAA4oD,EAAA/zB,cAAc,mBAAkB70B,EAAAy2B,QAChD,CAjEqB2yB,CAAA,CACbR,cAAeR,IAEnB,GACD,EC7D0ClzB,IAC3C,IAAIm0B,EAAS,EACb,MAAM/gB,EAAQ,EAAGghB,aACf,MAAMvB,EAqBV,WAIE,MAAM97C,EAAQgZ,OAAOC,SAAShD,KAAKjW,MAAM,yBACzC,IAAItH,EACFsH,GAASA,EAAM,KAAO6f,OAAOksB,MAAMnP,WAAW58B,EAAM,KAAO48B,WAAW58B,EAAM,IAAM,KAG/EtH,IACSA,EAAAmnB,OAAOk8B,GAAoB,iBAGzC,OAAOrjD,GAAa,IACtB,CAnCsB4kD,GACbxB,IAEDuB,GAAUD,IAAWtB,IAChBsB,EAAAtB,EAEL7yB,EAAA7N,QAAQ,YAAa0gC,IAAS,EAG9ByB,EAAoB,IAAMlhB,EAAM,CAAEghB,QAAQ,IAC1CG,EAAoB,IAAMnhB,EAAM,CAAEghB,QAAQ,IAC5Cp0B,EAAA1C,GAAG,WAAW,KACTvN,OAAAqV,iBAAiB,aAAckvB,GAClCt0B,EAAA1C,GAAG,cAAei3B,EAAiB,IAErCv0B,EAAA1C,GAAG,aAAa,KACXvN,OAAAoV,oBAAoB,aAAcmvB,GACrCt0B,EAAAzC,IAAI,cAAeg3B,EAAiB,GACzC,EftBqCv0B,IAClCA,EAAA1C,GAAG,aAAoBu1B,GAAchoD,EAAAlC,KAAA,MAAA,YAEnC,IAAAkG,EAAUmxB,EAAIa,kBAAkBxO,MAAMxa,GAAMA,EAAEmlC,UAAY6V,IAC9D,IAAKhkD,EAAS,CAEN,MAAA1F,SAAc62B,EAAIoB,SAASnP,SAASnjB,WAAW+jD,IAAY1pD,KACjE62B,EACG11B,IAAI,QACJw5C,cAAc,CAAEC,eAAe,IAC/BvR,OAAOrpC,EAAK0F,QAAS1F,EAAKqrD,eACnB3lD,EAAAmxB,EAAIa,kBAAkBxO,MAAMxa,GAAMA,EAAEmlC,UAAY6V,GAC5D,CACKhkD,GACLA,EAAQw6B,OAAM,KACf,EgBbqCrJ,IAClCA,EAAA1C,GAAG,eAAgBrL,IACf/W,MAAAA,EAAO8kB,EAAI11B,IAAI,QAGfmqD,EAAcxiC,EAASza,QAAU,EACvC,IAAIk9C,EAAax5C,EAAK0oC,oBAAoBjkB,cAA2B,wBAEjE80B,EACGC,IACUA,EAAA7wB,GAAoB,2CAGtB6wB,EAAAxhC,UAAY/E,GAASjT,EAAK8kB,IAAI9wB,KAAKooB,WAAapc,EAAK8kB,IAAIlL,GAAG,cAClE5Z,EAAA0oC,oBAAoB5f,YAAY0wB,IAG3B,MAAAA,GAAAA,EAAAnzB,QACd,GACD,ECpBqCvB,IAClCA,EAAA1C,GAAG,WAAW,KACVpiB,MAEAy5C,EAFO30B,EAAI11B,IAAI,QAEGu9B,IAAIlI,cAA2B,kBAClDg1B,IAEMA,EAAAzhC,UACT,6EACkC0hC,iBAAc,GAEnD,ECVuC50B,IACxC,IAAIouB,EAAuB,KAEvBpuB,EAAA1C,GAAG,WAAW,KACR8wB,EAAAr+B,OAAO8kC,aAAY,KACZ70B,EAAI11B,IAAI,QAEhBu9B,IAAI2M,iBAA8B,2BAA2B5xB,SAAS8Q,YACnE,MAAAmB,EAAO,IAAIM,KAAKyB,OAAOlD,EAAG60B,aAAa,2BAC1C70B,EAAAJ,WAAY,OAAAxoB,GAAIF,EAAAo1B,EAAAU,WAAU4c,+BAAgBzoB,KAAS0oB,GAAc1oB,EAAMmL,EAAIlL,GAAE,GACjF,GACA,IAAS,IAGVkL,EAAA1C,GAAG,aAAa,KACT8wB,GAAAr+B,OAAO+kC,cAAc1G,EAAK,GACpC,EChBuCpuB,IACpCA,EAAA1C,GAAG,cAAc,KAIPpiB,GAHC8kB,EAAI11B,IAAI,QAGJu9B,IAAK,KAAI,IAGxB7H,EAAA1C,GAAG,eAAgBnqB,IACL89C,GAAA,CACdM,KAAMvxB,EAAI11B,IAAI,QAAQu9B,IACtB/kB,OAAQ3P,EAAIG,IACZyhD,QAAS5hD,EAAIhK,KACbgoD,QAAS,IAAMnxB,EAAIl3B,MAAM,CAAEkO,OAAQ,KACpC,GACF,ECjBuCgpB,IACxC,IAAIg1B,EAAwC,KAEtC,MAwBAC,EAAgB,KACV,MAAAD,GAAAA,EAAAE,aACCF,EAAA,IAAA,EAGTh1B,EAAA1C,GAAG,eAAe,SAGdpiB,MAGA8jB,EAHOgB,EAAI11B,IAAI,QAGCs5C,oBAAoBuR,WACpCC,EAAUp2B,EAASxnB,OAAS,EAAKwnB,EAASA,EAASxnB,OAAS,GAAqB,KAClF49C,IAGC,yBAA0BrlC,OAxCZ,CAACqlC,IACrB,MAAMC,EAAer1B,EAAI9wB,KAAKk+B,kBAAoBpN,EAAI9wB,KAAKk+B,oBAAuB,KAElF4nB,EAAW,IAAIM,sBACb,EAAE3nB,MACIA,EAAQ4nB,qBAKVv1B,EAAI7N,QAAQ,qBACd,GAEF,CACEqjC,UAAW,GAIXxkB,KAAMqkB,IAGVL,EAASS,QAAQL,EAAO,EAyBxBM,CAAcN,GALZ7hD,QAAQoiD,KAAK,0CAKM,IAGnB31B,EAAA1C,GAAG,aAAa,WAEnB,ECpDqC0C,IACtC,MAAMjtB,EAAU,KACRmI,MAAAA,EAAO8kB,EAAI11B,IAAI,QAEf6iC,EAAYnN,EAAI9wB,KAAKk+B,kBAAoBpN,EAAI9wB,KAAKk+B,oBACtDD,GAAapd,QAAQgV,OAAO,CAC5BpqB,IAAKi7C,GAAgB16C,EAAK2sB,IAAKsF,GAAWxyB,IAC1C0Z,KAAM,GACP,EAGC2L,EAAA1C,GAAG,WAAW,KACZ0C,EAAA1C,GAAG,kBAAmBvqB,EAAO,IAG/BitB,EAAA1C,GAAG,aAAa,KACd0C,EAAAzC,IAAI,kBAAmBxqB,EAAO,GACnC,GCnBoCitB,IACjCA,EAAA1C,GAAG,cAAehyB,IAChB,GAAkB,IAAlBA,EAAO0L,OAAc,OAEzB,MAAMzF,EAAOyuB,EAAIoB,SAASrtB,gBACrBxC,GAIFyuB,EAAAoB,SACA1O,SAASrjB,YAAYkC,GACrBlF,MAAMs0B,IACLX,EAAIG,UAAUxN,eAAegO,EAAIx3B,KAAKupB,SAAQ,GAC/C,GACJ,EzCGyCsN,IACtCA,EAAAM,UAAU,CAAC,OAAQ,UAAW,YAAa,UAAW,OAAQ,oBAAqBpxB,IACrEk4C,GAAA,CACdhmB,OAAQ,IAAMpB,EAAIoB,SAClBnB,SAAU/wB,EAAK0B,KACf+sB,QAASzuB,EAAKyuB,QACdC,UAAW1uB,EAAK0uB,UAChBW,QAASrvB,EAAKqvB,QACdC,KAAMtvB,EAAKsvB,KACX8pB,YAAap5C,EAAKuvB,gBAClBgpB,MAAiC,kBAAnBznB,EAAI9wB,KAAKu4C,OAAsBznB,EAAI9wB,KAAKu4C,OACvD,GACF,EqBtBwCznB,IACzCA,EAAIM,UAAU,CAAC,aAAc,iBAAkBpxB,IACvCgM,MAAAA,EAAO8kB,EAAI11B,IAAI,QACjB4E,EAAK2mD,YAAc3mD,EAAKkwB,eAAiBoyB,IAKxC,SAAat2C,EAAY46C,EAAeC,GACzC,MAAAC,EhFsGQ,SAAexoC,EAAWhP,GAClC,MAAAy3C,EAAKzoC,EAAEpW,MAAM,KACb8+C,EAAK13C,EAAEpH,MAAM,KACnB,IAAA,IAASC,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,MAAM8+C,EAAKv/B,OAAOq/B,EAAG5+C,IACf++C,EAAKx/B,OAAOs/B,EAAG7+C,IACjB,GAAA8+C,EAAKC,EAAW,OAAA,EAChB,GAAAA,EAAKD,EAAW,OAAA,EAChB,IAACv/B,OAAOksB,MAAMqT,IAAOv/B,OAAOksB,MAAMsT,GAAY,OAAA,EAC9C,GAAAx/B,OAAOksB,MAAMqT,KAAQv/B,OAAOksB,MAAMsT,GAAY,OAAA,CACpD,CACO,OAAA,CACT,CgFlHeC,CAAqBP,EAAOC,GAEzC,GADyB,IAATC,EACH,OAEb,MAAM9E,EAAQrtB,GACZ,yCAAyC/O,GAAG,YAAa,CACvD7gB,KAAiB6gB,GAAXkhC,EAAO,EAAO,WAAiB,uCAElClhC,GAAG,sBAAsBA,GAAG,eAAeghC,OAAWhhC,GAAG,cAAcihC,kBAGxEO,EAAYzyB,GAAoB,gCAAgC/O,GAAG,oBACzEwhC,EAAU3vB,QAAU,KAClBuqB,EAAM3vB,SACeiwB,IAAA,CAAA,EAEvBN,EAAMpnD,OAAOwsD,GACRp7C,EAAA2sB,IAAI8iB,cAAelY,QAAQye,EAClC,CAvBmBh2C,CAAAA,EAAM05C,GAAgB1lD,EAAK2mD,WAAU,GACrD,ECCoC71B,IAEjC,IAAAu2B,EAEE,MAAAC,EAAQz4B,IAEN,MAAA4zB,EAAO,CAAC3xB,EAAIc,MAAOd,EAAI11B,IAAI,gBAAgBk5B,SAG5CiuB,KACaA,GAAA1hC,OAAO+P,WAAW,iCAGnB,SAAb/B,GAEGw4B,IAEHA,EAAuB/4B,GAAQk0B,GAAiBC,EAAMn0B,EAAItQ,SAC5CukC,GAAArsB,iBAAiB,SAAUmxB,IAI1B7E,GAAAC,EAAMF,GAAcvkC,WAGjCqpC,IACY9E,GAAAtsB,oBAAoB,SAAUoxB,GACtBA,OAAA,GAIxB7E,GAAiBC,EAAM5zB,GACzB,EAGEiC,EAAAM,UAAU,CAAC,aAAcpxB,GAASsnD,EAAKtnD,EAAK6uB,YAChDiC,EAAI1C,GAAG,WAAW,IAAMk5B,EAAKx2B,EAAI9wB,KAAK6uB,YAClCiC,EAAA1C,GAAG,aAAa,KAEKi5B,IAAA,MAAA9E,IAAAA,GAAetsB,oBAAoB,SAAUoxB,IAC9CA,OAAA,CAAA,GACvB,GoBhDUE,GAAuC,IAAAnxC,IAAI,IAAIusC,KAK/C6E,OAAgDC,QAE7D,SAAsBC,GAAK52B,GAAiB,OAAAn1B,EAAAlC,KAAA,MAAA,kBACpC,MAAAkuD,MAAoBvxC,IACpBwxC,EAAeC,IACXA,EAAAn0C,SAAS2qB,IACO,mBAAXA,GAA0BspB,EAAczsD,IAAImjC,KACrDA,EAAOvN,EAAK02B,GAAcpsD,IAAIijC,IAC9BspB,EAAc71B,IAAIuM,GACpB,GACD,EAIHupB,EAAYL,IAGZ,MAAMttD,KAAEA,SAAe62B,EACpBoB,SACAlyB,KAAKA,OACLvC,OAAOwG,IAEA,MA2FI,SAAU6sB,EAAiB7sB,SACzC,IAAI6jD,EAAkB,GAGlB,GAAA,OAAApsD,EAAAuI,EAAIhK,WAAJ,EAAAyB,EAAUqsD,YAAa,CACzB,MAAMC,EAAgB,CACpBC,YAAan3B,EAAI9wB,KAAK0B,KACtBwmD,YAAa,GAAGrnC,OAAOC,SAASiH,aAAalH,OAAOC,SAASqnC,QAE/DL,EAAkB,SAAS1tD,KAAKC,UAAU2tD,IAC5C,CAEgBjG,GAAA,CACdM,KAAMvxB,EAAI11B,IAAI,QAAQu9B,IACtB/kB,OAAQ3P,EAAIG,KAAOwV,OAAO3V,GAC1B4hD,QAAS5hD,EAAIhK,KACbgoD,QAAS,IAAMyF,GAAK52B,GACpBqxB,cAAerxB,EAAI11B,IAAI,QAAQ61B,UAAUsH,SACrC,IACEzH,EAAI8C,YAAY,CACdgN,KAAMknB,SAEV,GAER,CApHMM,CAAUt3B,EAAK7sB,GACTA,CAAA,IAIV,IAAIjE,EAA8B,CAChC2mD,WAAY,OAAAjrD,EAAKzB,EAAAggB,cAAS,EAAAve,EAAAue,SAIxB,GAAA6W,EAAI9wB,KAAKmwB,eAAgB,CAC3B,IAAKl2B,EAAKouD,cACR,MAAM,IAAI7jD,MACR,kGAEJxE,EAAO/C,EAAKA,EAAA,CAAA,EAAA+C,G9FYT,SAA8BA,GACnC,MAAMsoD,EAAuC,CAC3C,KACA,UACA,YACA,SACA,OACA,OACA,UACA,mBAiBK,OAfPhuD,OAAOC,KAAKyF,GAAM0T,SAASoB,IACrBwzC,EAAav0C,SAASe,WAAkB9U,EAAK8U,GACvC,aAANA,GAAgC,SAAZ9U,EAAK8U,WAAsB9U,EAAK8U,EAAC,IAIvD9U,EAAKkvB,WAAuC,iBAAnBlvB,EAAKkvB,YAC3BlvB,EAAAkvB,UAAYlvB,EAAKkvB,UAAU9mB,OAC5BpI,EAAKkvB,UAAUq5B,WAAW,MAAQvoD,EAAKkvB,UAAUq5B,WAAW,KAC9DvoD,EAAKkvB,UAAY90B,KAAKia,MAAMrU,EAAKkvB,WACL,UAAnBlvB,EAAKkvB,YACdlvB,EAAKkvB,WAAY,IAIdlvB,CACT,C8FvCyBwoD,CAAqBvuD,EAAKouD,eACjD,CAGAv3B,EAAI9wB,KAAKyoD,oBAAsB33B,EAAI9wB,KAAKyoD,mBAAmBzoD,GAGtDA,EAAA0oD,mBA4BQ,SAAmBC,EAAmBC,GAA6C,OAAAjtD,EAAAlC,KAAA,MAAA,YAC1F,MAAAovD,MAAqBzyC,IAC3B,IAAKuyC,IAAYrqD,MAAMC,QAAQoqD,GAAiB,OAAAE,EAEhD,MAAMC,EAAyB,GAmCxB,OAjCCH,EAAAj1C,SAAStC,IAEV,qBAAqB1K,KAAK0K,KACvBA,EAAA,GAAGw3C,EAAQjiD,QAAQ,MAAO,OAAOyK,EAAIzK,QAAQ,MAAO,OAEtDmiD,EAAArgD,KACJ,IAAI3E,SAAeC,IAEjB,GAAIggB,SAAS0M,cAAc,eAAerf,OAExC,gBAII,MAAA23C,EAAShlC,SAASH,cAAc,UACtCmlC,EAAO/+C,IAAMoH,EACJ2S,SAAAilC,KAAKl0B,YAAYi0B,GACnBA,EAAAjyB,OAAS,IAAM/yB,IACfglD,EAAAE,QAAWhlD,IACRI,QAAA9G,MAAM,iCAAkC0G,OACxC,IAEX,UAICH,QAAQ2U,IAAIqwC,GAGXxuD,OAAAqc,OAAOkK,OAAOqoC,eAAiB,CAAA,GAAIx1C,SAAS2qB,IAC3B,mBAAXA,GAAuBwqB,EAAe/2B,IAAIuM,EAAM,IAGtDwqB,CACT,GAAA,CAnEWM,CAAmBnpD,EAAK0oD,WAAY53B,EAAI9wB,KAAK2uB,QACjDxxB,MAAM0qD,IACLD,EAAYC,EAAO,IAEpBpqD,OAAOwG,IACEI,QAAA9G,MAAM,wBAAyB0G,EAAG,KAIhD6sB,EAAI7N,QAAQ,WAGZ6N,EAAIsD,WAAWp0B,GAGf8wB,EAAI7N,QAAQ,WAGP6N,EAAI9wB,KAAKyoD,oBAEZ33B,EAAIl3B,MAAM,CAAEkO,OAAQ,GAExB,GAAA,CC9DA,MAAqBshD,GAGnB,WAAA9vD,CAAY0G,GAFLxG,EAAAC,KAAA,OAIC,MAAA4vD,EAAcj5B,GAAiBpwB,GAAM,GAGtCvG,KAAAq3B,IAAM,IAAIY,GAAQ23B,GAGhB/uD,OAAAmkC,QAAQ6qB,IAAU51C,SAAQ,EAAE3O,EAAMwkD,MACjC,MAAAviD,EAAMuiD,EAAY9vD,KAAKq3B,KAC7B9pB,GAAOvN,KAAKq3B,IAAIkB,OAAOjtB,EAAiCiC,EAAG,IAM3D0gD,GAAKjuD,KAAKq3B,IAEd,CAGO,OAAAU,GACE,OAAA/3B,KAAKq3B,IAAIU,SAClB,CAGO,KAAA8C,GACL,OAAO76B,KAAKq3B,IAAIc,KAClB,CAGO,MAAA0G,CAAOt4B,GAEL,OADFvG,KAAAq3B,IAAIsD,WAAWp0B,GACbvG,IACT,CAGO,MAAAy5B,GACLz5B,KAAKq3B,IAAIoC,QACX,CAGO,OAAA4G,GAEE,IADFrgC,KAAAq3B,IAAI7N,QAAQ,aACVxpB,KAAKq3B,IAAIc,MAAM43B,YACpB/vD,KAAKq3B,IAAIc,MAAMmkB,YAAYt8C,KAAKq3B,IAAIc,MAAM43B,WAE9C,CAGO,EAAAp7B,CAAoCrpB,EAASlB,GAC7CpK,KAAAq3B,IAAI1C,GAAGrpB,EAAMlB,EACpB,CAGO,GAAAwqB,CAAqCtpB,EAASlB,GAC9CpK,KAAAq3B,IAAIzC,IAAItpB,EAAMlB,EACrB,CAGO,OAAAof,CAAyCle,EAASwpB,GAClD90B,KAAAq3B,IAAI7N,QAAQle,EAAMwpB,EACzB,CAGO,WAAA4F,CAAYtF,GACZp1B,KAAAq3B,IAAIqD,YAAYtF,EACvB,CAOA,WAAc5rB,CAAKjD,GACV,OAAA,IAAIopD,GAAOppD,EACpB,CAGA,UAAcyW,CAAa4nB,EAAyBh+B,GAClDknD,GAAcz1B,IAAIuM,GACJmpB,GAAAjsD,IAAI8iC,EAAQh+B,EAC5B,CAGA,sBAAcopD,CAAgB9gD,GACtB,MAAA3I,EAAOowB,GAAiBznB,GAAG,GAEZuvC,GAAA,CACnBhmB,OAAQ,IAAM,IAAIztB,EAAIosB,GAAkB7wB,IACxC+wB,SAAU/wB,EAAK0B,KACf2tB,QAASrvB,EAAKqvB,QACdC,KAAMtvB,EAAKsvB,KACX8pB,YAAap5C,EAAKuvB,gBAClBgpB,OAAO,GAEX,CAOA,SAAW3mB,GACT,OAAOn4B,KAAKq3B,IAAIc,KAClB,CAGA,QAAW5xB,GACF,OAAAvG,KAAKq3B,IAAIU,SAClB,ECrHK,MAAMvuB,GAAOmmD,GAAOnmD,KACdwT,GAAM2yC,GAAO3yC,IACbgzC,GAAkBL,GAAOK","x_google_ignoreList":[3,4,5,6,7,8,9,10,11,12,13,15]}